<?php
//事件系统
//刷新事件
function e0()
{
    //显示当前模板
    $in_ctm = value::get_game_user_value('in_ctm');
    if (!$in_ctm) {
        c_need_login();
        cmd::set_show_return_game(false);
        return;
    }
    ctm::show_ctm($in_ctm, false);
}

//注册事件
function e1($game_area)
{
    //处理注册事件
    $user_id = uid();
    //登录时间
    $login_time = date('Y-m-d H:i:s');
    //插入用户数据
    $sql = ("INSERT INTO `game_user` (`user_id`,`game_area`,`id`,`name`,`sex`,`reg_time`,`login_time`,`refresh_time`,`max_cmd`,`sid`) VALUES ('{$user_id}','{$game_area}','{$user_id}','','男','" . $login_time . "','" . $login_time . "','" . $login_time . "','1','" . session_id() . "')");
    sql($sql);
    //赠送100金币 初始药品与设置杂货铺存款
    value::set_user_value('money', 10);
    value::set_user_value('lvl', 1);
    value::set_user_value('exp', 1);
    value::set_user_value('zahuopu.money', 0);
    item::set_item(2, 5);
    item::set_item(7, 5);
    item::set_item(45, 5);
    // 注册时直接分配初始攻击技能(1)，避免通过e2函数重复分配
    cj_e10005(1);
    //调用登录事件
    e2($game_area, true);
    cmd::set_show_return_game(false);
}

//登录事件
function e2($game_area, $is_login = false)
{
    //vip添加广播
    $vip_lvl = user::getVipLvl();
    $xs_vip_lvl = user::showVipLogo();
    $uid = uid();
    if ($uid < 1) {
        $qh = "738323424";
        $wz = "仙盟会-梦回";
    } else {
        $qh = "qq-738323424";
        $wz = "仙盟会-梦回";
    } 
    $xt_xx = "<span style=color:blue>请您记住绿色传奇官网{$wz}手机浏览器可直接游戏,官方qq群：{$qh}〈新手指引及详细攻略请参考官网及官群〉</span>";
    c_add_xiaoxi($xt_xx, 0, $uid, $uid);
    
    // 确保玩家拥有基础攻击技能，技能ID为1的"攻击"是初始技能
    $u = new game_user_object($uid);
    $uSkillArr = $u->jget('skill.arr');
    if (!is_array($uSkillArr) || !in_array(1, $uSkillArr)) {
        // 如果没有初始的"攻击"技能(1)，则添加它
        $u->jpush('skill.arr', NULL, 1);
        // 如果没有默认技能，设置"攻击"技能为默认技能
        if (!$u->get('skill_moren.id')) {
            $u->set('skill_moren.id', 1);
        }
    }
    $in_map_id = value::get_game_user_value('in_map_id', $uid);
    $name = value::get_game_user_value('name', $uid);
    $in_map_name = value::get_map_value($in_map_id, 'name');
    $m_cs_map = value::get_user_value('cs_map', $uid);
    $m_ts_map = value::get_user_value('ts_map', $uid);
    $txdy_id1 = value::get_system_value('txdy_id1');
    //登陆删除宠物
    $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`=$uid AND `is_yj`<1";
    $rs = sql($sql);
    while (list($d_pet_id) = $rs->fetch_row()) {
        pet::del_pet($d_pet_id);
    }
    if ($m_ts_map) {
        value::set_game_user_value('in_map_id', $m_cs_map);
        e0();
    }
    //天下第一通知
    $txdy_id1 = value::get_system_value('txdy_id1');
    if ($txdy_id1 == $uid) {
        c_add_guangbo("尊贵的<img src=res/img/ch/txdy1.gif>{$name}在{$in_map_name}上线了!");
    }
    $txdy_id2 = value::get_system_value('txdy_id2');
    if ($txdy_id2 == $uid) {
        c_add_guangbo("尊贵的<img src=res/img/ch/txdy2.gif>{$name}在{$in_map_name}上线了!");
    }
    $txdy_id3 = value::get_system_value('txdy_id3');
    if ($txdy_id3 == $uid) {
        c_add_guangbo("尊贵的<img src=res/img/ch/txdy3.gif>{$name}在{$in_map_name}上线了!");
    }
    if ($vip_lvl > 0) {
        c_add_guangbo("尊贵的{$xs_vip_lvl}{$name}在{$in_map_name}上线了!");
    }
    if (c_is_black_list()) {
        if ($GLOBALS['uid'] || $_COOKIE['community_url']) {
            $community_url = $_COOKIE['community_url'] ? $_COOKIE['community_url'] : user::get_community_url($GLOBALS['uid']);
            echo "<span>恭喜,您已被永久封号!</span><br><a href='{$community_url}'>返回社区</a>";
        } else {
            echo "<span>恭喜,您已被永久封号!</span>";
        }
        exit;
    }
    //登录时间
    $login_time = date('Y-m-d H:i:s');
    //记录game_area
    if (!$game_area) {
        $game_area = $_SESSION['game_area'];
    }
    //现行时间
    $now_time = time();
    //查询用户是否录入
    $uid = uid();
    $sql = "SELECT `reg_time`,`name`,`is_online` FROM `game_user` WHERE `id`={$uid} LIMIT 1";
    $result = sql($sql);
    //提取时间
    list($reg_time, $name, $is_online) = $result->fetch_row();
    if ($reg_time) {
        if (!$is_login) {
            //当前在线
            if ($is_online && $name) {
                e0();
                return;
            }
        }
        $sql = "SELECT COUNT(*) FROM game_user WHERE ip='$ip' AND login_time>='" . date("Y-m-d") . "'";
        $rs = sql($sql);
        list($one_ip_count) = $rs->fetch_row();
        if ($one_ip_count >= 6) {
            $xiane_arr = config::getConfigByName("xiane");
            $day_max_money = $xiane_arr['day_max_money'];
            value::set_user_value("today.jq", $day_max_money + 1);
        }
        //获取所在地图
        $in_map_id = value::get_game_user_value('in_map_id', $uid);
        //聊天系统
        //默认设置地区聊天
        value::set_user_value('chat_mode', 1, $uid);
        //在线系统
        //获取最后刷新时间
        $last_refresh_time = value::get_user_value('last_refresh_time', $uid);
        //设置最后刷新时间
        value::set_user_value('last_refresh_time', $now_time, $uid);
        //结婚系统
        //设置伴侣亲密时间
        $bl_id = value::get_user_value('bl.id', $uid);
        if ($bl_id) {
            value::set_user_value('last_qinmi_time', $now_time, $uid);
        }
        //悬赏系统
        //设置红名刷新时间
        value::set_user_value('last_hongming_time', $now_time, $uid);
        //战斗系统
        //设置结算完成
        value::set_user_value('is_pk_settlement_doing', 0, $uid);
        //更新登录事件
        $sql = "UPDATE `game_user` SET `is_online`=1,`login_time`='{$login_time}',`refresh_time`='{$login_time}',`in_ctm`='ctm_shouye' WHERE `id`={$uid} LIMIT 1";
        sql($sql);
        //删除所有命令
        cmd::delallcmd($uid);
    } else {
        //更新注册事件
        e1($game_area);
        return;
    }
    if (!$is_login) {
        value::set_game_user_value('max_cmd', 1);
    }
    if ($name) {
        e166();
    } else {
        e182($game_area);
    }
}

//取名事件
function e3($game_area)
{
    $name = value::real_escape_string($_POST['name']);
    $sex = value::real_escape_string($_POST['sex']);
    $zhiye = value::real_escape_string($_POST['zhiye']);
    $js_id = value::real_escape_string($_POST['js_id']);
    value::set_game_user_value('zhiye', $zhiye);
    value::set_game_user_value('tp', $name);
    value::set_game_user_value('js_id', $js_id);
    //判断用户输入
    if ($name && $sex) {
        //判断过滤文本
        if (c_check_str($name, 1, 5)) {
            //判断是否中文
            if (preg_match("/^[\x{4e00}-\x{9fa5}]+$/u", $name)) {
                //判断是否重名
                if (!value::getvalue('game_user', 'id', 'name', $name)) {
                    value::set_game_user_value('name', strip_tags($name));
                    if ($sex == "女") {
                        value::set_game_user_value('sex', '女');
                    }
                    if ($zhiye == "战士") {
                        value::set_game_user_value('zhiye', '战士');
                    }
                    if (value::get_game_user_value('name')) {
                        e2($game_area, true);
                        return;
                    }
                } else {
                    echo "<span>昵称已被使用!</span>";
                    br();
                }
            } else {
                echo "<span>昵称必须全部中文!</span>";
                br();
            }
        } else {
            echo "<span>昵称无法使用!</span>";
            br();
        }
    } else {
        echo "<span>请输入人物昵称!</span>";
        br();
    }
    cmd::addcmd('e2,true', '返回游戏');
    cmd::set_show_return_game(false);
}

//显示首页模板事件
function e4()
{
    //竞技事件
    if (user::get('pkjjzt')) {
        echo "竞技比赛即将开始,你无法离开竞技场!";
        br();
        e5();
        return;
    }
    ctm::show_ctm('ctm_shouye');
}

//显示首页模板事件
function e401()
{
    $user_id = uid();
    if (!user::get_pet_count($user_id, 1)) {
        echo '进入传奇你最想获得什么套装！';
        br();
        cmd::addcmd('e67', '1.祈祷套装');
        br();
        cmd::addcmd('e67', '2.记忆套装');
        br();
        cmd::addcmd('e67', '3.虹魔套装');
        br();
        cmd::addcmd('e67', '4.魔血套装');
        br();
        cmd::addcmd('e67', '5.金刚套装');
        br();
        cmd::addcmd('e67', '6.诺玛套装');
        br();
        cmd::set_show_return_game(false);
        return;
    }
}

//显示首页模板事件
function e402()
{
    $user_id = uid();
    echo "<img src='res/img/js/js2.gif'>";
    br();
    echo "<span style='color:green'>      他们肩负全人类的命运出发了,但想不到的是,通道里有无数的岔道,迷宫和怪兽,人数越来越变少,最后被迫分成几组与怪物浴血奋战。<br>有的小组受到怪物疯狂攻击全军覆没,有的小组牢牢套进迷宫永远出不来。但也有一些幸运儿克服重重难关,终于到达了通道的另一端出口。<br>值得庆幸的是,后来被传为神话人物的战士啊龙也在这为数不多的生存者名单里。</span>";
    br();
    br();
    value::set_user_value('user_cj', 1, $user_id);
    cmd::addcmd('e403', '继续');
    cmd::set_show_return_game(false);
    return;
}

//显示首页模板事件
function e403()
{
    echo "<img src='res/img/js/js3.gif'>";
    br();
    echo "<span style='color:green'>     但是,他们万万没有想到真正的苦难这时候才开始。在眼前的不是绿油油的大草原,而是一望无际的沙漠,被石头和黄沙覆盖着…<br>    白天,干燥而酷热的狂风卷着黄沙；夜里,寒风刺骨,这种天气日复一日,折磨着人的肉体和灵魂,简直就是死亡之地。<br>在他们的视野里,永远只有万里黄沙和怪物的骷髅残骸,人们渐渐失去希望…身上带着的干粮和水也快见底了,偏偏这时候他们遇到了一群强大的怪物,是迄今为止见过的所有怪物当中最强大的敌人。<br>它们力大无比,还精通魔法,啊龙一行勇士队伍奋勇抵抗,但根本不是这些怪物的对手。最后,虽然千辛万苦突围逃命,但还是遭受了巨大的损伤。随之而来的饥饿和持续的艰难使他们的身心疲惫不堪,终于全部都昏迷在沙漠上…</span>";
    br();
    br();
    cmd::addcmd('e404', '继续');
    cmd::set_show_return_game(false);
    return;
}

//显示首页模板事件
function e404()
{
    echo "<img src='res/img/js/js4.gif'>";
    br();
    echo "<span style='color:green'>     是沙漠中的游牧民挽救了他们的生命。离他们倒下的地方不远的地方就有一块小绿洲,围绕这一绿洲形成一个小村庄。<br>牧民们为他们疗伤,提供丰盛的食物和舒适的住处。经过一段时间的疗伤和休息,勇士们很快恢复了体力。但是,这里是个与世隔绝的地方,这里的牧民对他们的故乡一无所知。<br>多方打听,终于得到一个消息,就在他们来这里的个天前,有一群人,和他们一样的打扮,刚刚也经过这里!原来除了我们,还有伙伴顺利突围! 他们有了更大的勇气。<br>他们急忙准备启程,迫切希望赶快与伙伴会合。村庄的首领劝勇士们不要走,说沙漠里隐藏着恶魔。但是,勇士们已经下定决心要离开,因为还有很多人在急切地等着他们去救,这些人的性命可全掌握在他们手里啊!</span>";
    br();
    br();
    cmd::addcmd('e405', '继续');
    cmd::set_show_return_game(false);
    return;
}

//显示首页模板事件
function e405()
{
    echo "<img src='res/img/js/js5.gif'>";
    br();
    echo "<span style='color:green'>   他们离开了村庄,又开始了艰难的沙漠长征。已经走了好几天了,遇到许许多多的怪物,惊险之极,但是茫茫沙漠不见边际。<br>
    　　走到一个土城附近,伙伴没遇见,却遭到了山贼的袭击。时时刻刻被恐怖包围着,勇士们神经高度紧张,疲惫不堪。</span>";
    br();
    br();
    cmd::addcmd('e406', '继续');
    cmd::set_show_return_game(false);
    return;
}

//显示首页模板事件
function e406()
{
    echo "<img src='res/img/js/js6.gif'>";
    br();
    echo "<span style='color:green'>     继续前行,他们已经忘却了时间和方向。连开口说话的力气都没有,头脑一片空白,唯一能做的就是默默拖着沉重的脚,往前走……<br>
    　　有一天晚上,他们忽然发现不远处有奇怪的东西透出一种神秘的光线,英雄们向前靠近物体。突然,随着一束刺眼的光线,人们都失去了知觉,昏倒在地上。当他们苏醒过来,展现在他们眼前的是被奇特的天光笼罩的广阔大地。他们还看到了一个非常惊人的东西,那是一个造型奇特的巨船… 在这里,他们将经历一场终身难忘的、最恐怖的噩梦……</span> ";
    br();
    br();
    cmd::addcmd('e401', '继续');
    cmd::set_show_return_game(false);
    return;
}

//显示地图模板事件
function e5()
{
    ctm::show_ctm('ctm_map');
}

//退出游戏事件
function e6()
{
    $id = uid();
    //设置玩家离线
    value::set_game_user_value('is_online', '0', $id);
    //删除所有CMD
    cmd::delallcmd($id);
    //结束会话
    unset($_SESSION['uid']);
    //退出组队
    team::exit_team($id);
    //返回首页
    echo "<span>退出游戏成功~</span><br><a href='{$_COOKIE['community_url']}'>返回首页</a>";
    cmd::set_show_return_game(false);
}

function e6_ip($id = 0)
{
    if (!$id) {
        $id = uid();
    }
    //设置玩家离线
    value::set_game_user_value('is_online', '0', $id);
    //删除所有CMD
    cmd::delallcmd($id);
    //结束会话
    unset($_SESSION[$id]);
    //退出组队
    team::exit_team($id);
    //返回首页
    cmd::addcmd("e2", "再次尝试");
    br();
    cmd::set_show_return_game(false);
}

//退出游戏事件
function gd()
{
    cmd::addcmd('e13,2', '状态');
    echo ">> 操作列表";
    br();
    echo "-";
    br();
    cmd::addcmd('e13,2', '个人状态');
    echo " . ";
    cmd::addcmd('e40,2', '随身物品');
    br();
    cmd::addcmd('e51,2', '好友列表');
    echo " . ";
    cmd::addcmd('e105', '师徒关系');
    br();
    cmd::addcmd('e106', '帮派相关');
    echo " . ";
    cmd::addcmd('e107', '组队相关');
    br();
    cmd::addcmd('e96', '快捷设置');
    echo " . ";
    cmd::addcmd('e73', '开关设置');
    br();
    cmd::addcmd('e108', '任务列表');
    echo " . ";
    cmd::addcmd('e47,2', '传奇排行');
    br();
    echo "绿色传奇：仙盟会-梦回";
    br();
    cmd::addcmd('e6', '退出游戏');
    echo " . ";
    cmd::addcmd('e46', 'GM反馈');
    br();
    cmd::set_show_return_game(false);
    echo "-";
    br();
    cmd::addcmd('e0', '返回游戏');
}

//传送地图
function dt($m_area_id)
{
    if ($m_area_id) {
        if ($m_area_id == 1) {
            dt1();
        } else if ($m_area_id == 2) {
            dt2();
        } else if ($m_area_id == 3) {
            dt3();
        } else if ($m_area_id == 4) {
            dt4();
        } else if ($m_area_id == 5) {
            dt5();
        } else if ($m_area_id == 6) {
            dt6();
        } else if ($m_area_id == 7) {
            dt7();
        } else if ($m_area_id == 8) {
            dt8();
        } else if ($m_area_id == 9) {
            dt9();
        } else if ($m_area_id == 10) {
            dt10();
        } else if ($m_area_id == 11) {
            dt11();
        } else if ($m_area_id == 12) {
            dt12();
        } else if ($m_area_id == 13) {
            dt13();
        } else if ($m_area_id == 14) {
            dt14();
        } else if ($m_area_id == 15) {
            dt15();
        } else if ($m_area_id == 16) {
            dt16();
        } else if ($m_area_id == 17) {
            dt17();
        } else if ($m_area_id == 18) {
            dt18();
        } else if ($m_area_id == 19) {
            dt19();
        } else if ($m_area_id == 21) {
            dt21();
        } else if ($m_area_id == 22) {
            dt22();
        } else if ($m_area_id == 23) {
            dt23();
        } else if ($m_area_id == 24) {
            dt24();
        } else if ($m_area_id == 25) {
            dt25();
        } else if ($m_area_id == 26) {
            dt26();
        } else if ($m_area_id == 27) {
            dt27();
        } else if ($m_area_id == 28) {
            dt28();
        } else if ($m_area_id == 29) {
            dt29();
        } else if ($m_area_id == 32) {
            dt32();
        } else if ($m_area_id == 33) {
            dt33();
        } else if ($m_area_id == 34) {
            dt34();
        } else if ($m_area_id == 35) {
            dt35();
        } else if ($m_area_id == 36) {
            dt36();
        } else if ($m_area_id == 37) {
            dt37();
        } else if ($m_area_id == 38) {
            dt38();
        } else if ($m_area_id == 39) {
            dt39();
        } else if ($m_area_id == 40) {
            dt40();
        } else if ($m_area_id == 41) {
            dt41();
        } else if ($m_area_id == 42) {
            dt42();
        } else if ($m_area_id == 43) {
            dt43();
        } else if ($m_area_id == 45) {
            dt45();
        } else if ($m_area_id == 46) {
            dt46();
        } else if ($m_area_id == 47) {
            dt47();
        } else if ($m_area_id == 49) {
            dt49();
        } else if ($m_area_id == 50) {
            dt50();
        } else if ($m_area_id == 51) {
            dt51();
        } else if ($m_area_id == 52) {
            dt52();
        } else if ($m_area_id == 53) {
            dt53();
        } else if ($m_area_id == 54) {
            dt54();
        } else if ($m_area_id == 55) {
            dt55();
        } else {
            dt0();
        }
    } else {
        dt0();
    }
}
//传送地图
function dt0()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_name = value::get_map_value($in_map_id, 'name', $user_id);
    $exit_b = value::get_map_value($in_map_id, 'exit_b', $user_id);
    if ($exit_b) {
        $exit1_b = "|";
    }
    $map_b_name = value::get_map_value($exit_b, 'name', $user_id);
    $exit_x = value::get_map_value($in_map_id, 'exit_x', $user_id);
    $map_x_name = value::get_map_value($exit_x, 'name', $user_id);
    $exit_d = value::get_map_value($in_map_id, 'exit_d', $user_id);
    $map_d_name = value::get_map_value($exit_d, 'name', $user_id);
    $exit_n = value::get_map_value($in_map_id, 'exit_n', $user_id);
    $map_n_name = value::get_map_value($exit_n, 'name', $user_id);
    $exit_b1 = value::get_map_value($exit_b, 'exit_b', $user_id);
    $map_b_name1 = value::get_map_value($exit_b1, 'name', $user_id);
    $exit_b2 = value::get_map_value($exit_b1, 'exit_b', $user_id);
    $map_b_name2 = value::get_map_value($exit_b2, 'name', $user_id);
    $exit_b3 = value::get_map_value($exit_b2, 'exit_b', $user_id);
    $map_b_name3 = value::get_map_value($exit_b3, 'name', $user_id);
    $exit_n1 = value::get_map_value($exit_n, 'exit_n', $user_id);
    $map_n_name1 = value::get_map_value($exit_n1, 'name', $user_id);
    $exit_n2 = value::get_map_value($exit_n1, 'exit_n', $user_id);
    $map_n_name2 = value::get_map_value($exit_n2, 'name', $user_id);
    $exit_n3 = value::get_map_value($exit_n2, 'exit_n', $user_id);
    $map_n_name3 = value::get_map_value($exit_n3, 'name', $user_id);
    $exit_n4 = value::get_map_value($exit_n3, 'exit_n', $user_id);
    $map_n_name4 = value::get_map_value($exit_n4, 'name', $user_id);
    if ($exit_b1) {
        $exit2_b = "|";
    }
    if ($exit_b2) {
        $exit3_b = "|";
    }
    if ($exit_b3) {
        $exit4_b = "|";
    }
    if ($exit_n) {
        $exit1_n = "|";
    }
    if ($exit_n1) {
        $exit2_n = "|";
    }
    if ($exit_n2) {
        $exit3_n = "|";
    }
    if ($exit_n3) {
        $exit4_n = "|";
    }
    if ($exit_n4) {
        $exit5_n = "|";
    }
    $exit_b11 = value::get_map_value($exit_x, 'exit_b', $user_id);
    $map_b_name11 = value::get_map_value($exit_b11, 'name', $user_id);
    $exit_b12 = value::get_map_value($exit_b11, 'exit_b', $user_id);
    $map_b_name12 = value::get_map_value($exit_b12, 'name', $user_id);
    $exit_b13 = value::get_map_value($exit_b12, 'exit_b', $user_id);
    $map_b_name13 = value::get_map_value($exit_b13, 'name', $user_id);
    $exit_b14 = value::get_map_value($exit_b13, 'exit_b', $user_id);
    $map_b_name14 = value::get_map_value($exit_b14, 'name', $user_id);
    $exit_n11 = value::get_map_value($exit_x, 'exit_n', $user_id);
    $map_n_name11 = value::get_map_value($exit_n11, 'name', $user_id);
    $exit_n12 = value::get_map_value($exit_n11, 'exit_n', $user_id);
    $map_n_name12 = value::get_map_value($exit_n12, 'name', $user_id);
    $exit_n13 = value::get_map_value($exit_n12, 'exit_n', $user_id);
    $map_n_name13 = value::get_map_value($exit_n13, 'name', $user_id);
    $exit_n14 = value::get_map_value($exit_n13, 'exit_n', $user_id);
    $map_n_name14 = value::get_map_value($exit_n14, 'name', $user_id);
    $exit_n15 = value::get_map_value($exit_n14, 'exit_n', $user_id);
    $map_n_name15 = value::get_map_value($exit_n15, 'name', $user_id);
    $exit_x1 = value::get_map_value($exit_x, 'exit_x', $user_id);
    $map_x_name1 = value::get_map_value($exit_x1, 'name', $user_id);
    $exit_x2 = value::get_map_value($exit_x1, 'exit_x', $user_id);
    $map_x_name2 = value::get_map_value($exit_x2, 'name', $user_id);
    if ($exit_b11) {
        $exit11_b = "|";
    }
    if ($exit_b12) {
        $exit12_b = "|";
    }
    if ($exit_b13) {
        $exit13_b = "|";
    }
    if ($exit_b14) {
        $exit14_b = "|";
    }
    if ($exit_n11) {
        $exit11_n = "|";
    }
    if ($exit_n12) {
        $exit12_n = "|";
    }
    if ($exit_n13) {
        $exit13_n = "|";
    }
    if ($exit_n14) {
        $exit14_n = "|";
    }
    if ($exit_n15) {
        $exit15_n = "|";
    }
    if ($exit_x) {
        $exit1_x = "—";
    }
    if ($exit_x1) {
        $exit2_x = "—";
    }
    if ($exit_x2) {
        $exit3_x = "—";
    }
    if ($exit_d) {
        $exit1_d = "—";
    }
    $exit_d1 = value::get_map_value($exit_d, 'exit_d', $user_id);
    $map_d_name1 = value::get_map_value($exit_d1, 'name', $user_id);
    $exit_d2 = value::get_map_value($exit_d1, 'exit_d', $user_id);
    $map_d_name2 = value::get_map_value($exit_d2, 'name', $user_id);
    $exit_d3 = value::get_map_value($exit_d2, 'exit_d', $user_id);
    $map_d_name3 = value::get_map_value($exit_d3, 'name', $user_id);
    if ($exit_d1) {
        $exit2_d = "—";
    }
    if ($exit_d2) {
        $exit3_d = "—";
    }
    if ($exit_d3) {
        $exit3_d = "—";
    }
    $exit_b21 = value::get_map_value($exit_x1, 'exit_b', $user_id);
    $map_b_name21 = value::get_map_value($exit_b21, 'name', $user_id);
    $exit_b22 = value::get_map_value($exit_b21, 'exit_b', $user_id);
    $map_b_name22 = value::get_map_value($exit_b22, 'name', $user_id);
    $exit_b23 = value::get_map_value($exit_b22, 'exit_b', $user_id);
    $map_b_name23 = value::get_map_value($exit_b23, 'name', $user_id);
    $exit_b24 = value::get_map_value($exit_b23, 'exit_b', $user_id);
    $map_b_name24 = value::get_map_value($exit_b24, 'name', $user_id);
    $exit_n21 = value::get_map_value($exit_x1, 'exit_n', $user_id);
    $map_n_name21 = value::get_map_value($exit_n21, 'name', $user_id);
    $exit_n22 = value::get_map_value($exit_n21, 'exit_n', $user_id);
    $map_n_name22 = value::get_map_value($exit_n22, 'name', $user_id);
    $exit_n23 = value::get_map_value($exit_n22, 'exit_n', $user_id);
    $map_n_name23 = value::get_map_value($exit_n23, 'name', $user_id);
    $exit_n24 = value::get_map_value($exit_n23, 'exit_n', $user_id);
    $map_n_name24 = value::get_map_value($exit_n24, 'name', $user_id);
    $exit_n25 = value::get_map_value($exit_n24, 'exit_n', $user_id);
    $map_n_name25 = value::get_map_value($exit_n25, 'name', $user_id);
    if ($exit_b21) {
        $exit21_b = "|";
    }
    if ($exit_b22) {
        $exit22_b = "|";
    }
    if ($exit_b23) {
        $exit23_b = "|";
    }
    if ($exit_b24) {
        $exit24_b = "|";
    }
    if ($exit_n21) {
        $exit21_n = "|";
    }
    if ($exit_n22) {
        $exit22_n = "|";
    }
    if ($exit_n23) {
        $exit23_n = "|";
    }
    if ($exit_n24) {
        $exit24_n = "|";
    }
    if ($exit_n25) {
        $exit25_n = "|";
    }

    $exit_b31 = value::get_map_value($exit_x2, 'exit_b', $user_id);
    $map_b_name31 = value::get_map_value($exit_b31, 'name', $user_id);
    $exit_b32 = value::get_map_value($exit_b31, 'exit_b', $user_id);
    $map_b_name32 = value::get_map_value($exit_b32, 'name', $user_id);
    $exit_b33 = value::get_map_value($exit_b32, 'exit_b', $user_id);
    $map_b_name33 = value::get_map_value($exit_b33, 'name', $user_id);
    $exit_b34 = value::get_map_value($exit_b33, 'exit_b', $user_id);
    $map_b_name34 = value::get_map_value($exit_b34, 'name', $user_id);
    $exit_n31 = value::get_map_value($exit_x2, 'exit_n', $user_id);
    $map_n_name31 = value::get_map_value($exit_n31, 'name', $user_id);
    $exit_n32 = value::get_map_value($exit_n31, 'exit_n', $user_id);
    $map_n_name32 = value::get_map_value($exit_n32, 'name', $user_id);
    $exit_n33 = value::get_map_value($exit_n32, 'exit_n', $user_id);
    $map_n_name33 = value::get_map_value($exit_n33, 'name', $user_id);
    $exit_n34 = value::get_map_value($exit_n33, 'exit_n', $user_id);
    $map_n_name34 = value::get_map_value($exit_n34, 'name', $user_id);
    $exit_n35 = value::get_map_value($exit_n34, 'exit_n', $user_id);
    $map_n_name35 = value::get_map_value($exit_n35, 'name', $user_id);
    if ($exit_b31) {
        $exit31_b = "|";
    }
    if ($exit_b32) {
        $exit32_b = "|";
    }
    if ($exit_b33) {
        $exit33_b = "|";
    }
    if ($exit_b34) {
        $exit34_b = "|";
    }
    if ($exit_n31) {
        $exit31_n = "|";
    }
    if ($exit_n32) {
        $exit32_n = "|";
    }
    if ($exit_n33) {
        $exit33_n = "|";
    }
    if ($exit_n34) {
        $exit34_n = "|";
    }
    if ($exit_n35) {
        $exit35_n = "|";
    }
    $exit_b41 = value::get_map_value($exit_d, 'exit_b', $user_id);
    $map_b_name41 = value::get_map_value($exit_b41, 'name', $user_id);
    $exit_b42 = value::get_map_value($exit_b41, 'exit_b', $user_id);
    $map_b_name42 = value::get_map_value($exit_b42, 'name', $user_id);
    $exit_b43 = value::get_map_value($exit_b42, 'exit_b', $user_id);
    $map_b_name43 = value::get_map_value($exit_b43, 'name', $user_id);
    $exit_b44 = value::get_map_value($exit_b43, 'exit_b', $user_id);
    $map_b_name44 = value::get_map_value($exit_b44, 'name', $user_id);
    $exit_n41 = value::get_map_value($exit_d, 'exit_n', $user_id);
    $map_n_name41 = value::get_map_value($exit_n41, 'name', $user_id);
    $exit_n42 = value::get_map_value($exit_n41, 'exit_n', $user_id);
    $map_n_name42 = value::get_map_value($exit_n42, 'name', $user_id);
    $exit_n43 = value::get_map_value($exit_n42, 'exit_n', $user_id);
    $map_n_name43 = value::get_map_value($exit_n43, 'name', $user_id);
    $exit_n44 = value::get_map_value($exit_n43, 'exit_n', $user_id);
    $map_n_name44 = value::get_map_value($exit_n44, 'name', $user_id);
    $exit_n45 = value::get_map_value($exit_n44, 'exit_n', $user_id);
    $map_n_name45 = value::get_map_value($exit_n45, 'name', $user_id);
    if ($exit_b41) {
        $exit41_b = "|";
    }
    if ($exit_b42) {
        $exit42_b = "|";
    }
    if ($exit_b43) {
        $exit43_b = "|";
    }
    if ($exit_b44) {
        $exit44_b = "|";
    }
    if ($exit_n41) {
        $exit41_n = "|";
    }
    if ($exit_n42) {
        $exit42_n = "|";
    }
    if ($exit_n43) {
        $exit43_n = "|";
    }
    if ($exit_n44) {
        $exit44_n = "|";
    }
    if ($exit_n45) {
        $exit45_n = "|";
    }
    $exit_b51 = value::get_map_value($exit_d1, 'exit_b', $user_id);
    $map_b_name51 = value::get_map_value($exit_b51, 'name', $user_id);
    $exit_b52 = value::get_map_value($exit_b51, 'exit_b', $user_id);
    $map_b_name52 = value::get_map_value($exit_b52, 'name', $user_id);
    $exit_b53 = value::get_map_value($exit_b52, 'exit_b', $user_id);
    $map_b_name53 = value::get_map_value($exit_b53, 'name', $user_id);
    $exit_b54 = value::get_map_value($exit_b53, 'exit_b', $user_id);
    $map_b_name54 = value::get_map_value($exit_b54, 'name', $user_id);
    $exit_n51 = value::get_map_value($exit_d1, 'exit_n', $user_id);
    $map_n_name51 = value::get_map_value($exit_n51, 'name', $user_id);
    $exit_n52 = value::get_map_value($exit_n51, 'exit_n', $user_id);
    $map_n_name52 = value::get_map_value($exit_n52, 'name', $user_id);
    $exit_n53 = value::get_map_value($exit_n52, 'exit_n', $user_id);
    $map_n_name53 = value::get_map_value($exit_n53, 'name', $user_id);
    $exit_n54 = value::get_map_value($exit_n53, 'exit_n', $user_id);
    $map_n_name54 = value::get_map_value($exit_n54, 'name', $user_id);
    $exit_n55 = value::get_map_value($exit_n54, 'exit_n', $user_id);
    $map_n_name55 = value::get_map_value($exit_n55, 'name', $user_id);
    if ($exit_b51) {
        $exit51_b = "|";
    }
    if ($exit_b52) {
        $exit52_b = "|";
    }
    if ($exit_b53) {
        $exit53_b = "|";
    }
    if ($exit_b54) {
        $exit54_b = "|";
    }
    if ($exit_n51) {
        $exit51_n = "|";
    }
    if ($exit_n52) {
        $exit52_n = "|";
    }
    if ($exit_n53) {
        $exit53_n = "|";
    }
    if ($exit_n54) {
        $exit54_n = "|";
    }
    if ($exit_n55) {
        $exit55_n = "|";
    }
    $exit_b61 = value::get_map_value($exit_d2, 'exit_b', $user_id);
    $map_b_name61 = value::get_map_value($exit_b61, 'name', $user_id);
    $exit_b62 = value::get_map_value($exit_b61, 'exit_b', $user_id);
    $map_b_name62 = value::get_map_value($exit_b62, 'name', $user_id);
    $exit_b63 = value::get_map_value($exit_b62, 'exit_b', $user_id);
    $map_b_name63 = value::get_map_value($exit_b63, 'name', $user_id);
    $exit_b64 = value::get_map_value($exit_b63, 'exit_b', $user_id);
    $map_b_name64 = value::get_map_value($exit_b64, 'name', $user_id);
    $exit_n61 = value::get_map_value($exit_d2, 'exit_n', $user_id);
    $map_n_name61 = value::get_map_value($exit_n61, 'name', $user_id);
    $exit_n62 = value::get_map_value($exit_n61, 'exit_n', $user_id);
    $map_n_name62 = value::get_map_value($exit_n62, 'name', $user_id);
    $exit_n63 = value::get_map_value($exit_n62, 'exit_n', $user_id);
    $map_n_name63 = value::get_map_value($exit_n63, 'name', $user_id);
    $exit_n64 = value::get_map_value($exit_n63, 'exit_n', $user_id);
    $map_n_name64 = value::get_map_value($exit_n64, 'name', $user_id);
    $exit_n65 = value::get_map_value($exit_n64, 'exit_n', $user_id);
    $map_n_name65 = value::get_map_value($exit_n65, 'name', $user_id);
    if ($exit_b61) {
        $exit61_b = "|";
    }
    if ($exit_b62) {
        $exit62_b = "|";
    }
    if ($exit_b63) {
        $exit63_b = "|";
    }
    if ($exit_b64) {
        $exit64_b = "|";
    }
    if ($exit_n61) {
        $exit61_n = "|";
    }
    if ($exit_n62) {
        $exit62_n = "|";
    }
    if ($exit_n63) {
        $exit63_n = "|";
    }
    if ($exit_n64) {
        $exit64_n = "|";
    }
    if ($exit_n65) {
        $exit65_n = "|";
    }
    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr><th>{$map_b_name34}</th><th></th><th>{$map_b_name24}</th><th></th><th>{$map_b_name14}</th><th></th><th>{$map_b_name3}</th><th></th><th>{$map_b_name44}</th><th></th><th>{$map_b_name54}</th><th></th><th>{$map_b_name64}</th></tr>
    <tr><td>{$exit34_b}</td><th></th><td>{$exit24_b}</td><th></th><td>{$exit14_b}</td><td></td><td>{$exit4_b}</td><td></td><td>{$exit44_b}</td><td></td><td>{$exit54_b}</td><td></td><td>{$exit64_b}</td></tr>
    <tr><th>{$map_b_name33}</th><th></th><th>{$map_b_name23}</th><th></th><th>{$map_b_name13}</th><th></th><th>{$map_b_name2}</th><th></th><th>{$map_b_name43}</th><th></th><th>{$map_b_name53}</th><th></th><th>{$map_b_name63}</th></tr>
    <tr><td>{$exit33_b}</td><th></th><td>{$exit23_b}</td><th></th><td>{$exit13_b}</td><th></th><td>{$exit3_b}</td><td></td><td>{$exit43_b}</td><td></td><td>{$exit53_b}</td><td></td><td>{$exit63_b}</td></tr>
    <tr><th>{$map_b_name32}</th><th></th><th>{$map_b_name22}</th><th></th><th>{$map_b_name12}</th><th></th><th>{$map_b_name1}</th><th></th><th>{$map_b_name42}</th><th></th><th>{$map_b_name52}</th><th></th><th>{$map_b_name62}</th></tr>
    <tr><td>{$exit32_b}</td><th></th><td>{$exit22_b}</td><th></th><td>{$exit12_b}</td><th></th><td>{$exit2_b}</td><td></td><td>{$exit42_b}</td><td></td><td>{$exit52_b}</td><td></td><td>{$exit62_b}</td></tr>
    <tr><th>{$map_b_name31}</th><th></th><th>{$map_b_name21}</th><th></th><th>{$map_b_name11}</th><th></th><th>{$map_b_name}</th><th></th><th>{$map_b_name41}</th><th></th><th>{$map_b_name51}</th><th></th><th>{$map_b_name61}</th></tr>
    <tr><td>{$exit31_b}</td><th></th><td>{$exit21_b}</td><th></th><td>{$exit11_b}</td><th></th><td>{$exit1_b}</td><td></td><td>{$exit41_b}</td><td></td><td>{$exit51_b}</td><td></td><td>{$exit61_b}</td></tr>
    <tr><th>{$map_x_name2}</th><th>{$exit3_x}</th><th>{$map_x_name1}</th><th>{$exit2_x}</th><th>{$map_x_name}</th><td>{$exit1_x}</td><th><b style='color:red'>{$map_name}</b></th><td>{$exit1_d}</td><th>{$map_d_name}</th><td>{$exit2_d}</td><th>{$map_d_name1}</th><td>{$exit3_d}</td><th>{$map_d_name2}</th></tr>
    <tr><td>{$exit31_n}</td><th></th><td>{$exit21_n}</td><th></th><td>{$exit11_n}</td><th></th><td>{$exit1_n}</td><td></td><td>{$exit41_n}</td><td></td><td>{$exit51_n}</td><td></td><td>{$exit61_n}</td></tr>
    <tr><th>{$map_n_name31}</th><th></th><th>{$map_n_name21}</th><th></th><th>{$map_n_name11}</th><th></th><th>{$map_n_name}</th><th></th><th>{$map_n_name41}</th><th></th><th>{$map_n_name51}</th><th></th><th>{$map_n_name61}</th></tr>
    <tr><td>{$exit32_n}</td><th></th><td>{$exit22_n}</td><th></th><td>{$exit12_n}</td><th></th><td>{$exit2_n}</td><td></td><td>{$exit42_n}</td><td></td><td>{$exit52_n}</td><td></td><td>{$exit62_n}</td></tr>
    <tr><th>{$map_n_name32}</th><th></th><th>{$map_n_name22}</th><th></th><th>{$map_n_name12}</th><th></th><th>{$map_n_name1}</th><th></th><th>{$map_n_name42}</th><th></th><th>{$map_n_name52}</th><th></th><th>{$map_n_name62}</th></tr>
    <tr><td>{$exit33_n}</td><th></th><td>{$exit23_n}</td><th></th><td>{$exit13_n}</td><th></th><td>{$exit3_n}</td><td></td><td>{$exit43_n}</td><td></td><td>{$exit53_n}</td><td></td><td>{$exit63_n}</td></tr>
    <tr><th>{$map_n_name33}</th><th></th><th>{$map_n_name23}</th><th></th><th>{$map_n_name13}</th><th></th><th>{$map_n_name2}</th><th></th><th>{$map_n_name43}</th><th></th><th>{$map_n_name53}</th><th></th><th>{$map_n_name63}</th></tr>
    <tr><td>{$exit34_n}</td><th></th><td>{$exit24_n}</td><th></th><td>{$exit14_n}</td><th></th><td>{$exit4_n}</td><td></td><td>{$exit44_n}</td><td></td><td>{$exit54_n}</td><td></td><td>{$exit64_n}</td></tr>
    <tr><th>{$map_n_name34}</th><th></th><th>{$map_n_name24}</th><th></th><th>{$map_n_name14}</th><th></th><th>{$map_n_name3}</th><th></th><th>{$map_n_name44}</th><th></th><th>{$map_n_name54}</th><th></th><th>{$map_n_name64}</th></tr>
    <tr><td>{$exit35_n}</td><th></th><td>{$exit25_n}</td><th></th><td>{$exit15_n}</td><th></th><td>{$exit5_n}</td><td></td><td>{$exit45_n}</td><td></td><td>{$exit55_n}</td><td></td><td>{$exit65_n}</td></tr>
    <tr><th>{$map_n_name35}</th><th></th><th>{$map_n_name25}</th><th></th><th>{$map_n_name15}</th><th></th><th>{$map_n_name4}</th><th></th><th>{$map_n_name45}</th><th></th><th>{$map_n_name55}</th><th></th><th>{$map_n_name65}</th></tr>
    
    </tbody></table>";

}

//传送地图
function dt1()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id2 = ($in_map_id == 2) ? "<button type= submit class= btn btn-success><b style='color:green'>村落小径</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>村落小径</b></button>";
    $map_id1 = ($in_map_id == 1) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏村口</b></button>" : "<button type= submit class= btn btn-success>银杏村口</button>";
    $map_id3 = ($in_map_id == 3) ? "<button type= submit class= btn btn-success><b style='color:green'>杏林</b></button>" : "<button type= submit class= btn btn-success>杏林</button>";
    $map_id22 = ($in_map_id == 22) ? "<button type= submit class= btn btn-success><b style='color:green'>肉店</b></button>" : "<button type= submit class= btn btn-success>肉店</button>";
    $map_id4 = ($in_map_id == 4) ? "<button type= submit class= btn btn-success><b style='color:green'>书店</b></button>" : "<button type= submit class= btn btn-success>书店</button>";
    $map_id23 = ($in_map_id == 23) ? "<button type= submit class= btn btn-success><b style='color:green'>寄售商</b></button>" : "<button type= submit class= btn btn-success>寄售商</button>";
    $map_id5 = ($in_map_id == 5) ? "<button type= submit class= btn btn-success><b style='color:green'>青石街</b></button>" : "<button type= submit class= btn btn-success>青石街</button>";
    $map_id6 = ($in_map_id == 6) ? "<button type= submit class= btn btn-success><b style='color:green'>碎石路</b></button>" : "<button type= submit class= btn btn-success>碎石路</button>";
    $map_id21 = ($in_map_id == 21) ? "<button type= submit class= btn btn-success><b style='color:green'>棉布店</b></button>" : "<button type= submit class= btn btn-success>棉布店</button>";
    $map_id7 = ($in_map_id == 7) ? "<button type= submit class= btn btn-success><b style='color:green'>武器店</b></button>" : "<button type= submit class= btn btn-success>武器店</button>";
    $map_id8 = ($in_map_id == 8) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏广场</b></button>" : "<button type= submit class= btn btn-success>银杏广场</button>";
    $map_id9 = ($in_map_id == 9) ? "<button type= submit class= btn btn-success><b style='color:green'>药店</b></button>" : "<button type= submit class= btn btn-success>药店</button>";
    $map_id10 = ($in_map_id == 10) ? "<button type= submit class= btn btn-success><b style='color:green'>药店厅堂</b></button>" : "<button type= submit class= btn btn-success>药店厅堂</button>";
    $map_id11 = ($in_map_id == 11) ? "<button type= submit class= btn btn-success><b style='color:green'>杂货铺</b></button>" : "<button type= submit class= btn btn-success>杂货铺</button>";
    $map_id20 = ($in_map_id == 20) ? "<button type= submit class= btn btn-success><b style='color:green'>仓库</b></button>" : "<button type= submit class= btn btn-success>仓库</button>";
    $map_id12 = ($in_map_id == 12) ? "<button type= submit class= btn btn-success><b style='color:green'>后院</b></button>" : "<button type= submit class= btn btn-success>后院</button>";
    $map_id13 = ($in_map_id == 13) ? "<button type= submit class= btn btn-success><b style='color:green'>石板桥</b></button>" : "<button type= submit class= btn btn-success>石板桥</button>";
    $map_id14 = ($in_map_id == 14) ? "<button type= submit class= btn btn-success><b style='color:green'>田间小路</b></button>" : "<button type= submit class= btn btn-success>田间小路</button>";
    $map_id15 = ($in_map_id == 15) ? "<button type= submit class= btn btn-success><b style='color:green'>饰品店</b></button>" : "<button type= submit class= btn btn-success>饰品店</button>";
    $map_id16 = ($in_map_id == 16) ? "<button type= submit class= btn btn-success><b style='color:green'>小厅</b></button>" : "<button type= submit class= btn btn-success>小厅</button>";
    $map_id19 = ($in_map_id == 19) ? "<button type= submit class= btn btn-success><b style='color:green'>租赁店</b></button>" : "<button type= submit class= btn btn-success>租赁店</button>";
    $map_id17 = ($in_map_id == 17) ? "<button type= submit class= btn btn-success><b style='color:green'>杂草小路</b></button>" : "<button type= submit class= btn btn-success>杂草小路</button>";
    $map_id18 = ($in_map_id == 18) ? "<button type= submit class= btn btn-success><b style='color:green'>材料商</b></button>" : "<button type= submit class= btn btn-success>材料商</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th><th></th><th>{$map_id4}</th><th></th><th>{$map_id2}</th>  </tr>
    <tr>  <td></td><td></td><td>|</td><td></td><td>|</td>  </tr>
    <tr>  <th>{$map_id22}</th><th>—</th><th>{$map_id3}</th><th>—</th><th>{$map_id1}</th><th></th><th>{$map_id7}</th>  </tr>
    <tr>  <td></td><td></td><td>|</td><td></td><td>|</td><td></td><td>|</td>   </tr>
    <tr>  <th></th><th></th><th>{$map_id23}</th><th></th><th>{$map_id5}</th><th>—</th><th>{$map_id6}</th><th>—</th><th>{$map_id21}</th>   </tr>
    <tr>  <td></td><td></td><td></td><td></td><td>|</td>   </tr>
    <tr>  <th>{$map_id10}</th><th>—</th><th>{$map_id9}</th><th>—</th><th>{$map_id8}</th><th>—</th><th>{$map_id11}</th><th>—</th><th>{$map_id20}</th><th>—</th><th>{$map_id12}</th>   </tr>
    <tr>  <td></td><td></td><td></td><td></td><td>|</td>   </tr>
    <tr>  <th></th><th></th><th>{$map_id16}</th><th></th><th>{$map_id13}</th>  </tr>
    <tr>  <td></td><td></td><td>|</td><td></td><td>|</td>   </tr>
    <tr>  <th></th><th></th><th>{$map_id15}</th><th>—</th><th>{$map_id14}</th><th>—</th><th>{$map_id19}</th>  </tr>
    <tr>  <td></td><td></td><td></td><td></td><td>|</td>   </tr>
    <tr>  <th></th><th></th><th></th><th></th><th>{$map_id17}</th><th>—</th><th>{$map_id18}</th>  </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置,<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

//传送地图
function dt2()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id31 = ($in_map_id == 31) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>银杏山谷野外</b></button>";
    $map_id30 = ($in_map_id == 30) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id29 = ($in_map_id == 29) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id28 = ($in_map_id == 28) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id27 = ($in_map_id == 27) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id26 = ($in_map_id == 26) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id25 = ($in_map_id == 25) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id24 = ($in_map_id == 24) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>银杏山谷野外</b></button>";
    $map_id32 = ($in_map_id == 32) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id33 = ($in_map_id == 33) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id34 = ($in_map_id == 34) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id35 = ($in_map_id == 35) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id36 = ($in_map_id == 36) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id37 = ($in_map_id == 37) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id38 = ($in_map_id == 38) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id39 = ($in_map_id == 39) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id40 = ($in_map_id == 40) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id41 = ($in_map_id == 41) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id42 = ($in_map_id == 42) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";
    $map_id43 = ($in_map_id == 43) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏山谷野外</b></button>" : "<button type= submit class= btn btn-success>银杏山谷野外</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id31}</th>  </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td>  </tr>
    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id30}</th>  </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td>   </tr>
    <tr>  <th>{$map_id36}</th> <th>—</th> <th>{$map_id37}</th> <th></th> <th>{$map_id29}</th> <th>—</th> <th>{$map_id38}</th> <th>—</th> <th>{$map_id39}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <th></th> <th></th> <th></th> <th>|</th>  </tr>
    <tr>  <th>{$map_id35}</th> <th></th> <th></th> <th></th> <th>{$map_id28}</th> <th></th> <th></th> <th></th> <th>{$map_id40}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <th></th> <th></th> <th></th> <th>|</th>  </tr>
    <tr>  <th>{$map_id34}</th> <th></th> <th></th> <th></th> <th>{$map_id27}</th> <th></th> <th></th> <th></th> <th>{$map_id41}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <th></th> <th></th> <th></th> <th>|</th>  </tr>
    <tr>  <th>{$map_id33}</th> <th>—</th> <th>{$map_id32}</th> <th>—</th> <th>{$map_id26}</th> <th>—</th> <th>{$map_id43}</th> <th>—</th> <th>{$map_id42}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td>   </tr>
    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id25}</th>  </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td>   </tr>
    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id24}</th>  </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置,<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

//传送地图
function dt3()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id104 = ($in_map_id == 104) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id44 = ($in_map_id == 44) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>银杏废矿</b></button>";
    $map_id94 = ($in_map_id == 94) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>银杏废矿</b></button>";
    $map_id45 = ($in_map_id == 45) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id46 = ($in_map_id == 46) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id47 = ($in_map_id == 47) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id48 = ($in_map_id == 48) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id49 = ($in_map_id == 49) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    
    $map_id50 = ($in_map_id == 50) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id51 = ($in_map_id == 51) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id52 = ($in_map_id == 52) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id53 = ($in_map_id == 53) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id54 = ($in_map_id == 54) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id55 = ($in_map_id == 55) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id56 = ($in_map_id == 56) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id57 = ($in_map_id == 57) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id58 = ($in_map_id == 58) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id59 = ($in_map_id == 59) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    
    $map_id60 = ($in_map_id == 60) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id61 = ($in_map_id == 61) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id62 = ($in_map_id == 62) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id63 = ($in_map_id == 63) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id64 = ($in_map_id == 64) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id65 = ($in_map_id == 65) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id66 = ($in_map_id == 66) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id67 = ($in_map_id == 67) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id68 = ($in_map_id == 68) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id69 = ($in_map_id == 69) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    
    $map_id70 = ($in_map_id == 70) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id71 = ($in_map_id == 71) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id72 = ($in_map_id == 72) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id73 = ($in_map_id == 73) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id74 = ($in_map_id == 74) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id75 = ($in_map_id == 75) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id76 = ($in_map_id == 76) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id77 = ($in_map_id == 77) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id78 = ($in_map_id == 78) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id79 = ($in_map_id == 79) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    
    $map_id80 = ($in_map_id == 80) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id81 = ($in_map_id == 81) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id82 = ($in_map_id == 82) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id83 = ($in_map_id == 83) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id84 = ($in_map_id == 84) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id85 = ($in_map_id == 85) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id86 = ($in_map_id == 86) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id87 = ($in_map_id == 87) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id88 = ($in_map_id == 88) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id89 = ($in_map_id == 89) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
   
    $map_id90 = ($in_map_id == 90) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id91 = ($in_map_id == 91) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id92 = ($in_map_id == 92) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id93 = ($in_map_id == 93) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id95 = ($in_map_id == 95) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id96 = ($in_map_id == 96) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id97 = ($in_map_id == 97) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id98 = ($in_map_id == 98) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id99 = ($in_map_id == 99) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id100 = ($in_map_id == 100) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id101 = ($in_map_id == 101) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id102 = ($in_map_id == 102) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";
    $map_id103 = ($in_map_id == 103) ? "<button type= submit class= btn btn-success><b style='color:green'>银杏废矿</b></button>" : "<button type= submit class= btn btn-success>银杏废矿</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id92}</th><th>—</th> <th>{$map_id93}</th> <th>—</th> <th>{$map_id94}</th> <th></th><th></th> <th></th> <th>{$map_id57}</th> <th>—</th> <th>{$map_id56}</th><th>—</th> <th>{$map_id55}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td>  </tr>
    
    <tr>  <th>{$map_id89}</th> <th>—</th> <th>{$map_id90}</th> <th>—</th> <th>{$map_id91}</th><th></th> <th></th> <th></th> <th>{$map_id95}</th> <th>—</th><th>{$map_id96}</th> <th>—</th> <th>{$map_id58}</th> <th></th> <th></th><th></th> <th>{$map_id54}</th> <th>—</th> <th>{$map_id53}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td>  </tr>
    
    <tr>  <th>{$map_id88}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id97}</th> <th></th><th></th> <th></th> <th>{$map_id59}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id52}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td>  </tr>
    
    <tr>  <th>{$map_id87}</th> <th></th> <th></th> <th></th> <th>{$map_id102}</th><th>—</th> <th>{$map_id101}</th> <th>—</th> <th>{$map_id98}</th> <th></th><th></th> <th></th> <th>{$map_id60}</th> <th></th> <th></th><th></th> <th>{$map_id50}</th> <th>—</th> <th>{$map_id51}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td>  </tr>
    
    <tr>  <th>{$map_id86}</th> <th></th> <th></th> <th></th> <th>{$map_id103}</th><th></th> <th></th> <th></th> <th>{$map_id99}</th> <th></th><th></th> <th></th> <th>{$map_id61}</th> <th></th> <th></th><th></th> <th>{$map_id49}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td>  </tr>
    
    <tr>  <th>{$map_id85}</th> <th>—</th> <th>{$map_id84}</th> <th>—</th> <th>{$map_id104}</th><th></th> <th></th> <th></th> <th>{$map_id100}</th> <th>—</th><th>{$map_id64}</th> <th>—</th> <th>{$map_id62}</th> <th>—</th> <th>{$map_id63}</th><th>—</th> <th>{$map_id48}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td>  </tr>
    
    <tr>  <th></th> <th></th> <th>{$map_id83}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id65}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id47}</th> <th>—</th> <th>{$map_id46}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td>  </tr>
    
    <tr>  <th>{$map_id77}</th> <th>—</th> <th>{$map_id76}</th> <th>—</th> <th>{$map_id75}</th><th>—</th> <th>{$map_id74}</th> <th>—</th> <th>{$map_id73}</th> <th>—</th><th>{$map_id66}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id45}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td>  </tr>
    
    <tr>  <th>{$map_id78}</th> <th></th> <th></th> <th></th> <th>{$map_id82}</th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id67}</th> <th></th> <th></th> <th></th> <th>{$map_id71}</th><th>—</th> <th>{$map_id72}</th> <th>—</th> <th>{$map_id44}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td>  </tr>
    <tr>  <th>{$map_id79}</th> <th>—</th> <th>{$map_id80}</th> <th>—</th> <th>{$map_id81}</th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id68}</th> <th>—</th> <th>{$map_id69}</th> <th>—</th> <th>{$map_id70}</th><th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:blue'>蓝色</b>:表示boss的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

//传送地图
function dt4()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id141 = ($in_map_id == 141) ? "<button type= submit class= btn btn-success><b style='color:green'>安定门</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>安定门</b></button>";
    $map_id105 = ($in_map_id == 105) ? "<button type= submit class= btn btn-success><b style='color:green'>镇淮门</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>镇淮门</b></button>";
    $map_id108 = ($in_map_id == 108) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇巨商小屋</b></button>" : "<button type= submit class= btn btn-success>比奇巨商小屋</button>";

    $map_id114 = ($in_map_id == 114) ? "<button type= submit class= btn btn-success><b style='color:green'>声望道具店</b></button>" : "<button type= submit class= btn btn-success>声望道具店</button>";
    $map_id107 = ($in_map_id == 107) ? "<button type= submit class= btn btn-success><b style='color:green'>琼花街</b></button>" : "<button type= submit class= btn btn-success>琼花街</button>";
    $map_id106 = ($in_map_id == 106) ? "<button type= submit class= btn btn-success><b style='color:green'>北门大街</b></button>" : "<button type= submit class= btn btn-success>北门大街</button>";
    $map_id109 = ($in_map_id == 109) ? "<button type= submit class= btn btn-success><b style='color:green'>东关街</b></button>" : "<button type= submit class= btn btn-success>东关街</button>";

    $map_id110 = ($in_map_id == 110) ? "<button type= submit class= btn btn-success><b style='color:green'>彩券店</b></button>" : "<button type= submit class= btn btn-success>彩券店</button>";
    $map_id111 = ($in_map_id == 111) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇长街6</b></button>" : "<button type= submit class= btn btn-success>比奇长街6</button>";
    $map_id112 = ($in_map_id == 112) ? "<button type= submit class= btn btn-success><b style='color:green'>虹桥</b></button>" : "<button type= submit class= btn btn-success>虹桥</button>";
    $map_id113 = ($in_map_id == 113) ? "<button type= submit class= btn btn-success><b style='color:green'>草河北街</b></button>" : "<button type= submit class= btn btn-success>草河北街</button>";

    $map_id116 = ($in_map_id == 116) ? "<button type= submit class= btn btn-success><b style='color:green'>棉布店</b></button>" : "<button type= submit class= btn btn-success>棉布店</button>";
    $map_id115 = ($in_map_id == 115) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇长街5</b></button>" : "<button type= submit class= btn btn-success>比奇长街5</button>";
    $map_id117 = ($in_map_id == 117) ? "<button type= submit class= btn btn-success><b style='color:green'>肉店</b></button>" : "<button type= submit class= btn btn-success>肉店</button>";

    $map_id146 = ($in_map_id == 146) ? "<button type= submit class= btn btn-success><b style='color:green'>饰品店</b></button>" : "<button type= submit class= btn btn-success>饰品店</button>";
    $map_id119 = ($in_map_id == 119) ? "<button type= submit class= btn btn-success><b style='color:green'>寄售店</b></button>" : "<button type= submit class= btn btn-success>寄售店</button>";
    $map_id118 = ($in_map_id == 118) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇长街4</b></button>" : "<button type= submit class= btn btn-success>比奇长街4</button>";
    $map_id120 = ($in_map_id == 120) ? "<button type= submit class= btn btn-success><b style='color:green'>客栈</b></button>" : "<button type= submit class= btn btn-success>客栈</button>";
    $map_id121 = ($in_map_id == 121) ? "<button type= submit class= btn btn-success><b style='color:green'>二楼仓库</b></button>" : "<button type= submit class= btn btn-success>二楼仓库</button>";

    $map_id124 = ($in_map_id == 124) ? "<button type= submit class= btn btn-success><b style='color:green'>通泗街</b></button>" : "<button type= submit class= btn btn-success>通泗街</button>";
    $map_id123 = ($in_map_id == 123) ? "<button type= submit class= btn btn-success><b style='color:green'>通泗桥</b></button>" : "<button type= submit class= btn btn-success>通泗桥</button>";
    $map_id122 = ($in_map_id == 122) ? "<button type= submit class= btn btn-success><b style='color:green'>中央广场</b></button>" : "<button type= submit class= btn btn-success>中央广场</button>";
    $map_id127 = ($in_map_id == 127) ? "<button type= submit class= btn btn-success><b style='color:green'>甘泉街</b></button>" : "<button type= submit class= btn btn-success>甘泉街</button>";

    $map_id125 = ($in_map_id == 125) ? "<button type= submit class= btn btn-success><b style='color:green'>芍药巷</b></button>" : "<button type= submit class= btn btn-success>芍药巷</button>";
    $map_id130 = ($in_map_id == 130) ? "<button type= submit class= btn btn-success><b style='color:green'>兑币所</b></button>" : "<button type= submit class= btn btn-success>兑币所</button>";
    $map_id129 = ($in_map_id == 129) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇长街1</b></button>" : "<button type= submit class= btn btn-success>比奇长街1</button>";
    $map_id128 = ($in_map_id == 128) ? "<button type= submit class= btn btn-success><b style='color:green'>书店</b></button>" : "<button type= submit class= btn btn-success>书店</button>";
    $map_id144 = ($in_map_id == 144) ? "<button type= submit class= btn btn-success><b style='color:green'>皇宫练武场</b></button>" : "<button type= submit class= btn btn-success>皇宫练武场</button>";

    $map_id126 = ($in_map_id == 126) ? "<button type= submit class= btn btn-success><b style='color:green'>药店</b></button>" : "<button type= submit class= btn btn-success>药店</button>";
    $map_id132 = ($in_map_id == 132) ? "<button type= submit class= btn btn-success><b style='color:green'>杂货店</b></button>" : "<button type= submit class= btn btn-success>杂货店</button>";
    $map_id131 = ($in_map_id == 131) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇长街2</b></button>" : "<button type= submit class= btn btn-success>比奇长街2</button>";
    $map_id142 = ($in_map_id == 142) ? "<button type= submit class= btn btn-success><b style='color:green'>皇宫大门</b></button>" : "<button type= submit class= btn btn-success>皇宫大门</button>";
    $map_id143 = ($in_map_id == 143) ? "<button type= submit class= btn btn-success><b style='color:green'>皇宫大院</b></button>" : "<button type= submit class= btn btn-success>皇宫大院</button>";

    $map_id139 = ($in_map_id == 139) ? "<button type= submit class= btn btn-success><b style='color:green'>租赁店</b></button>" : "<button type= submit class= btn btn-success>租赁店</button>";
    $map_id134 = ($in_map_id == 134) ? "<button type= submit class= btn btn-success><b style='color:green'>铁匠铺</b></button>" : "<button type= submit class= btn btn-success>铁匠铺</button>";
    $map_id133 = ($in_map_id == 133) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇长街3</b></button>" : "<button type= submit class= btn btn-success>比奇长街3</button>";
    $map_id135 = ($in_map_id == 135) ? "<button type= submit class= btn btn-success><b style='color:green'>美容店</b></button>" : "<button type= submit class= btn btn-success>美容店</button>";
    $map_id145 = ($in_map_id == 145) ? "<button type= submit class= btn btn-success><b style='color:green'>皇宫大厅</b></button>" : "<button type= submit class= btn btn-success>皇宫大厅</button>";

    $map_id138 = ($in_map_id == 138) ? "<button type= submit class= btn btn-success><b style='color:green'>草河南街</b></button>" : "<button type= submit class= btn btn-success>草河南街</button>";
    $map_id137 = ($in_map_id == 137) ? "<button type= submit class= btn btn-success><b style='color:green'>太平桥</b></button>" : "<button type= submit class= btn btn-success>太平桥</button>";
    $map_id136 = ($in_map_id == 136) ? "<button type= submit class= btn btn-success><b style='color:green'>南门大街</b></button>" : "<button type= submit class= btn btn-success>南门大街</button>";
    $map_id140 = ($in_map_id == 140) ? "<button type= submit class= btn btn-success><b style='color:green'>马匹店</b></button>" : "<button type= submit class= btn btn-success>马匹店</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id108}</th> <th></th> <th>{$map_id105}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id114}</th> <th></th> <th>{$map_id107}</th> <th>—</th> <th>{$map_id106}</th><th>—</th> <th>{$map_id109}</th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td>|</td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id113}</th> <th>—</th> <th>{$map_id112}</th> <th>—</th> <th>{$map_id111}</th><th></th> <th>{$map_id110}</th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th></th> <th></th> <th>{$map_id116}</th> <th>—</th> <th>{$map_id115}</th><th>—</th> <th>{$map_id117}</th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id146}</th> <th></th> <th>{$map_id119}</th> <th>—</th> <th>{$map_id118}</th><th>—</th> <th>{$map_id120}</th> <th>—</th> <th>{$map_id121}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id124}</th> <th></th> <th>{$map_id123}</th> <th>—</th> <th>{$map_id122}</th><th>—</th> <th>{$map_id127}</th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td>|</td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id125}</th> <th></th> <th>{$map_id130}</th> <th>—</th> <th>{$map_id129}</th><th></th> <th>{$map_id128}</th> <th></th> <th>{$map_id144}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id126}</th> <th></th> <th>{$map_id132}</th> <th>—</th> <th>{$map_id131}</th><th>—</th> <th>{$map_id142}</th> <th>—</th> <th>{$map_id143}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id139}</th> <th></th> <th>{$map_id134}</th> <th>—</th> <th>{$map_id133}</th><th>—</th> <th>{$map_id135}</th> <th></th> <th>{$map_id145}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th>{$map_id138}</th> <th>—</th> <th>{$map_id137}</th> <th>—</th> <th>{$map_id136}</th><th>—</th> <th>{$map_id140}</th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> <td></td> <td></td>  </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id141}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt5()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id148 = ($in_map_id == 148) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>比奇北郊外</b></button>";
    $map_id162 = ($in_map_id == 162) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>比奇北郊外</b></button>";
    $map_id165 = ($in_map_id == 165) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>比奇北郊外</b></button>";
    $map_id164 = ($in_map_id == 164) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id163 = ($in_map_id == 163) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id161 = ($in_map_id == 161) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id160 = ($in_map_id == 160) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id166 = ($in_map_id == 166) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id186 = ($in_map_id == 186) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id159 = ($in_map_id == 159) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id167 = ($in_map_id == 167) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id185 = ($in_map_id == 185) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id184 = ($in_map_id == 184) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id158 = ($in_map_id == 158) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id168 = ($in_map_id == 168) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id169 = ($in_map_id == 169) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id170 = ($in_map_id == 170) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id157 = ($in_map_id == 157) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id171 = ($in_map_id == 171) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id156 = ($in_map_id == 156) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id174 = ($in_map_id == 174) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id173 = ($in_map_id == 173) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id172 = ($in_map_id == 172) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id155 = ($in_map_id == 155) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id175 = ($in_map_id == 175) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id182 = ($in_map_id == 182) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id183 = ($in_map_id == 183) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id154 = ($in_map_id == 154) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id176 = ($in_map_id == 176) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id180 = ($in_map_id == 180) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id181 = ($in_map_id == 181) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id153 = ($in_map_id == 153) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id177 = ($in_map_id == 177) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id178 = ($in_map_id == 178) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id179 = ($in_map_id == 179) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id152 = ($in_map_id == 152) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    $map_id149 = ($in_map_id == 149) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id150 = ($in_map_id == 150) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";
    $map_id151 = ($in_map_id == 151) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇北郊外</b></button>" : "<button type= submit class= btn btn-success>比奇北郊外</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id165}</th> <th>—</th> <th>{$map_id164}</th> <th>—</th> <th>{$map_id163}</th><th>—</th> <th>{$map_id162}</th> <th>—</th> <th>{$map_id161}</th> <th>—</th><th>{$map_id160}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id166}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id186}</th> <th></th> <th></th> <th></th><th>{$map_id159}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id167}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id185}</th> <th>—</th> <th>{$map_id184}</th> <th>—</th><th>{$map_id158}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id168}</th> <th>—</th> <th>{$map_id169}</th> <th>—</th> <th>{$map_id170}</th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id157}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id171}</th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id156}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id174}</th> <th>—</th> <th>{$map_id173}</th> <th>—</th> <th>{$map_id172}</th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id155}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id175}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id182}</th> <th>—</th> <th>{$map_id183}</th> <th>—</th><th>{$map_id154}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id176}</th> <th></th> <th></th> <th></th> <th>{$map_id180}</th><th>—</th> <th>{$map_id181}</th> <th></th> <th></th> <th></th><th>{$map_id153}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id177}</th> <th>—</th> <th>{$map_id178}</th> <th>—</th> <th>{$map_id179}</th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id152}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>
    
    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id148}</th><th>—</th> <th>{$map_id149}</th> <th>—</th> <th>{$map_id150}</th> <th>—</th><th>{$map_id151}</th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt6()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id189 = ($in_map_id == 189) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>比奇南郊外</b></button>";
    $map_id203 = ($in_map_id == 203) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>比奇南郊外</b></button>";

    $map_id214 = ($in_map_id == 214) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id190 = ($in_map_id == 190) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id191 = ($in_map_id == 191) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id192 = ($in_map_id == 192) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id193 = ($in_map_id == 193) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";

    $map_id212 = ($in_map_id == 212) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id213 = ($in_map_id == 213) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id194 = ($in_map_id == 194) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";

    $map_id211 = ($in_map_id == 211) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id219 = ($in_map_id == 219) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id220 = ($in_map_id == 220) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id196 = ($in_map_id == 196) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id195 = ($in_map_id == 195) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";

    $map_id210 = ($in_map_id == 210) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id218 = ($in_map_id == 218) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id197 = ($in_map_id == 197) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";

    $map_id209 = ($in_map_id == 209) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id215 = ($in_map_id == 215) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id216 = ($in_map_id == 216) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id217 = ($in_map_id == 217) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id198 = ($in_map_id == 198) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id199 = ($in_map_id == 199) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";

    $map_id208 = ($in_map_id == 208) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id200 = ($in_map_id == 200) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";

    $map_id207 = ($in_map_id == 207) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id206 = ($in_map_id == 206) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id205 = ($in_map_id == 205) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id204 = ($in_map_id == 204) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id202 = ($in_map_id == 202) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";
    $map_id201 = ($in_map_id == 201) ? "<button type= submit class= btn btn-success><b style='color:green'>比奇南郊外</b></button>" : "<button type= submit class= btn btn-success>比奇南郊外</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id189}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id214}</th> <th>—</th> <th>{$map_id190}</th><th>—</th> <th>{$map_id191}</th> <th>—</th> <th>{$map_id192}</th> <th>—</th><th>{$map_id193}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id212}</th> <th>—</th> <th>{$map_id213}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id194}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id211}</th> <th></th> <th></th> <th></th> <th>{$map_id219}</th><th>—</th> <th>{$map_id220}</th> <th>—</th> <th>{$map_id196}</th> <th>—</th><th>{$map_id195}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id210}</th> <th></th> <th></th> <th></th> <th>{$map_id218}</th><th></th> <th></th> <th></th> <th>{$map_id197}</th> <th></th><th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id209}</th> <th>—</th> <th>{$map_id215}</th> <th>—</th> <th>{$map_id216}</th><th>—</th> <th>{$map_id217}</th> <th>—</th> <th>{$map_id198}</th> <th>—</th><th>{$map_id199}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id208}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id209}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id207}</th> <th>—</th> <th>{$map_id206}</th> <th>—</th> <th>{$map_id205}</th><th>—</th> <th>{$map_id204}</th> <th>—</th> <th>{$map_id202}</th> <th>—</th><th>{$map_id201}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> </tr>
    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id203}</th> <th></th><th></th> </tr>
  
    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt7()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id221 = ($in_map_id == 221) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>半兽洞穴</b></button>";
    $map_id238 = ($in_map_id == 238) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>半兽洞穴</b></button>";

    $map_id222 = ($in_map_id == 222) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id263 = ($in_map_id == 263) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id262 = ($in_map_id == 262) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id261 = ($in_map_id == 261) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id260 = ($in_map_id == 260) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id259 = ($in_map_id == 259) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id223 = ($in_map_id == 223) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id272 = ($in_map_id == 272) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id258 = ($in_map_id == 258) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id225 = ($in_map_id == 225) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id224 = ($in_map_id == 224) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id264 = ($in_map_id == 264) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id273 = ($in_map_id == 273) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id274 = ($in_map_id == 274) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id257 = ($in_map_id == 257) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id256 = ($in_map_id == 256) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id226 = ($in_map_id == 226) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id265 = ($in_map_id == 265) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id255 = ($in_map_id == 255) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id227 = ($in_map_id == 227) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id267 = ($in_map_id == 267) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id266 = ($in_map_id == 266) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id268 = ($in_map_id == 268) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id252 = ($in_map_id == 252) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id253 = ($in_map_id == 253) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id254 = ($in_map_id == 254) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id228 = ($in_map_id == 228) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id269 = ($in_map_id == 269) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id251 = ($in_map_id == 251) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id229 = ($in_map_id == 229) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id230 = ($in_map_id == 230) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id271 = ($in_map_id == 271) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id270 = ($in_map_id == 270) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id247 = ($in_map_id == 247) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id246 = ($in_map_id == 246) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id245 = ($in_map_id == 245) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id231 = ($in_map_id == 231) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id249 = ($in_map_id == 249) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id248 = ($in_map_id == 248) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id244 = ($in_map_id == 244) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id232 = ($in_map_id == 232) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id233 = ($in_map_id == 233) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id234 = ($in_map_id == 234) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id250 = ($in_map_id == 250) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id243 = ($in_map_id == 243) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id235 = ($in_map_id == 235) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id240 = ($in_map_id == 240) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id241 = ($in_map_id == 241) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id242 = ($in_map_id == 242) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    $map_id236 = ($in_map_id == 236) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id237 = ($in_map_id == 237) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";
    $map_id239 = ($in_map_id == 239) ? "<button type= submit class= btn btn-success><b style='color:green'>半兽洞穴</b></button>" : "<button type= submit class= btn btn-success>半兽洞穴</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id221}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id222}</th> <th>—</th> <th>{$map_id263}</th><th>—</th> <th>{$map_id262}</th> <th>—</th> <th>{$map_id261}</th> <th>—</th><th>{$map_id260}</th> <th>—</th><th>{$map_id259}</th>  <th></th><th></th></tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id223}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id272}</th> <th></th><th></th> <th></th><th>{$map_id258}</th>  <th></th><th></th></tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id225}</th> <th>—</th> <th>{$map_id224}</th> <th>—</th> <th>{$map_id264}</th><th></th> <th></th> <th></th> <th>{$map_id273}</th> <th>—</th><th>{$map_id274}</th> <th>—</th><th>{$map_id257}</th>  <th>—</th><th>{$map_id256}</th></tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id226}</th> <th></th> <th></th> <th></th> <th>{$map_id265}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id255}</th></tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id227}</th> <th>—</th> <th>{$map_id267}</th> <th>—</th> <th>{$map_id266}</th><th>—</th> <th>{$map_id268}</th> <th></th> <th></th> <th></th><th>{$map_id252}</th> <th>—</th><th>{$map_id253}</th>  <th>—</th><th>{$map_id254}</th></tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id228}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id269}</th> <th></th> <th></th> <th></th><th>{$map_id251}</th> <th></th><th></th>  <th></th><th></th></tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id229}</th> <th>—</th> <th>{$map_id230}</th> <th>—</th> <th>{$map_id271}</th><th>—</th> <th>{$map_id270}</th> <th></th> <th></th> <th></th><th>{$map_id247}</th> <th>—</th><th>{$map_id246}</th>  <th>—</th><th>{$map_id245}</th></tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id231}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id249}</th> <th>—</th><th>{$map_id248}</th> <th></th><th></th>  <th></th><th>{$map_id244}</th></tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id232}</th> <th>—</th> <th>{$map_id233}</th><th>—</th> <th>{$map_id234}</th> <th>—</th> <th>{$map_id250}</th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id243}</th></tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>
   
    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id235}</th> <th></th> <th></th> <th></th><th>{$map_id240}</th> <th>—</th><th>{$map_id241}</th>  <th>—</th><th>{$map_id242}</th></tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id236}</th> <th>—</th> <th>{$map_id237}</th> <th>—</th><th>{$map_id239}</th> <th></th><th></th>  <th></th><th></th></tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id238}</th> <th></th><th></th> <th></th><th></th>  <th></th><th></th></tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:blue'>蓝色</b>:表示当前的boss位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt8()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id282 = ($in_map_id == 282) ? "<button type= submit class= btn btn-success><b style='color:green'>半废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>废矿矿山入口</b></button>";
    $map_id295 = ($in_map_id == 295) ? "<button type= submit class= btn btn-success><b style='color:green'>半废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>废矿矿山入口</b></button>";
    $map_id304 = ($in_map_id == 304) ? "<button type= submit class= btn btn-success><b style='color:green'>半废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>废矿矿山入口</b></button>";
    

    $map_id297 = ($in_map_id == 297) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id300 = ($in_map_id == 300) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id301 = ($in_map_id == 301) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";

    $map_id280 = ($in_map_id == 280) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id281 = ($in_map_id == 281) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id294 = ($in_map_id == 294) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id299 = ($in_map_id == 299) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";

    $map_id279 = ($in_map_id == 279) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id296 = ($in_map_id == 296) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id293 = ($in_map_id == 293) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id298 = ($in_map_id == 298) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id302 = ($in_map_id == 302) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id303 = ($in_map_id == 303) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";

    $map_id278 = ($in_map_id == 278) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id277 = ($in_map_id == 277) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id292 = ($in_map_id == 292) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";

    $map_id276 = ($in_map_id == 276) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id283 = ($in_map_id == 283) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id284 = ($in_map_id == 284) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id285 = ($in_map_id == 285) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id286 = ($in_map_id == 286) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";

    $map_id275 = ($in_map_id == 275) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id291 = ($in_map_id == 291) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id287 = ($in_map_id == 287) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";

    $map_id290 = ($in_map_id == 290) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id289 = ($in_map_id == 289) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";
    $map_id288 = ($in_map_id == 288) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿矿山入口</b></button>" : "<button type= submit class= btn btn-success>废矿矿山入口</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id282}</th> <th></th> <th></th><th></th> <th>{$map_id297}</th> <th></th> <th></th> <th></th><th>{$map_id300}</th> <th>—</th><th>{$map_id301}</th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id280}</th> <th>—</th> <th>{$map_id281}</th> <th></th> <th></th><th></th> <th>{$map_id294}</th> <th></th> <th></th> <th></th><th>{$map_id299}</th> <th></th><th></th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id279}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id296}</th> <th>—</th> <th>{$map_id293}</th> <th>—</th><th>{$map_id298}</th> <th>—</th><th>{$map_id302}</th>  <th>—</th><th>{$map_id303}</th>  <th></th><th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id278}</th> <th>—</th> <th>{$map_id277}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id292}</th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id304}</th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id276}</th> <th>—</th> <th>{$map_id283}</th><th>—</th> <th>{$map_id284}</th> <th>—</th> <th>{$map_id285}</th> <th>—</th><th>{$map_id286}</th> <th></th><th></th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id275}</th> <th></th> <th></th><th></th> <th>{$map_id291}</th> <th></th> <th></th> <th></th><th>{$map_id287}</th> <th></th><th></th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id295}</th> <th></th> <th></th><th></th> <th>{$map_id290}</th> <th>—</th> <th>{$map_id289}</th> <th>—</th><th>{$map_id288}</th> <th></th><th></th>  <th></th><th></th>  <th></th><th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt9()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id311 = ($in_map_id == 311) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层第二间房</b></button>";
    $map_id305 = ($in_map_id == 305) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层第二间房</b></button>";
    
    $map_id315 = ($in_map_id == 315) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";
    $map_id314 = ($in_map_id == 314) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";
    $map_id313 = ($in_map_id == 313) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";

    $map_id306 = ($in_map_id == 306) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";
    $map_id312 = ($in_map_id == 312) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";

    $map_id307 = ($in_map_id == 307) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";
    $map_id309 = ($in_map_id == 309) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";
    $map_id310 = ($in_map_id == 310) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";

    $map_id308 = ($in_map_id == 308) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第二间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第二间房</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id315}</th> <th>—</th> <th>{$map_id314}</th><th>—</th> <th>{$map_id313}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id305}</th> <th>—</th> <th>{$map_id306}</th> <th></th> <th></th><th></th> <th>{$map_id312}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id307}</th> <th>—</th> <th>{$map_id309}</th><th>—</th> <th>{$map_id310}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id308}</th> <th></th> <th></th><th></th> <th>{$map_id311}</th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt10()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id316 = ($in_map_id == 316) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>废矿东部洞穴</b></button>";
    $map_id344 = ($in_map_id == 344) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>废矿东部洞穴</b></button>";

    $map_id319 = ($in_map_id == 319) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id320 = ($in_map_id == 320) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id335 = ($in_map_id == 335) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id336 = ($in_map_id == 336) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id337 = ($in_map_id == 337) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id338 = ($in_map_id == 338) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";

    $map_id318 = ($in_map_id == 318) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id332 = ($in_map_id == 332) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id331 = ($in_map_id == 331) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id330 = ($in_map_id == 330) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id339 = ($in_map_id == 339) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";

    $map_id317 = ($in_map_id == 317) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id334 = ($in_map_id == 334) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id333 = ($in_map_id == 333) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id329 = ($in_map_id == 329) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id340 = ($in_map_id == 340) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id341 = ($in_map_id == 341) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id342 = ($in_map_id == 342) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id343 = ($in_map_id == 343) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";

    $map_id321 = ($in_map_id == 321) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id327 = ($in_map_id == 327) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id328 = ($in_map_id == 328) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id345 = ($in_map_id == 345) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id350 = ($in_map_id == 350) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";

    $map_id322 = ($in_map_id == 322) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id323 = ($in_map_id == 323) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id325 = ($in_map_id == 325) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id326 = ($in_map_id == 326) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id346 = ($in_map_id == 346) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id347 = ($in_map_id == 347) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id349 = ($in_map_id == 349) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";

    $map_id324 = ($in_map_id == 324) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";
    $map_id348 = ($in_map_id == 348) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿东部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿东部洞穴</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id319}</th> <th>—</th> <th>{$map_id320}</th><th></th> <th></th> <th></th> <th></th> <th></th><th>{$map_id335}</th> <th>—</th><th>{$map_id336}</th>  <th>—</th><th>{$map_id337}</th>  <th>—</th><th>{$map_id338}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id318}</th> <th></th> <th></th><th></th> <th>{$map_id332}</th> <th>—</th> <th>{$map_id331}</th> <th>—</th><th>{$map_id330}</th> <th></th><th></th>  <th></th><th>{$map_id339}</th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id316}</th> <th>—</th> <th>{$map_id317}</th> <th>—</th> <th>{$map_id334}</th><th>—</th> <th>{$map_id333}</th> <th></th> <th></th> <th></th><th>{$map_id329}</th> <th></th><th></th>  <th></th><th>{$map_id340}</th>  <th>—</th><th>{$map_id341}</th><th>—</th><th>{$map_id342}</th>  <th>—</th><th>{$map_id343}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id321}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id327}</th> <th>—</th><th>{$map_id328}</th> <th>—</th><th>{$map_id345}</th>  <th></th><th></th>  <th></th><th>{$map_id350}</th><th></th><th></th>  <th></th><th>{$map_id344}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id322}</th> <th>—</th> <th>{$map_id323}</th><th>—</th> <th>{$map_id325}</th> <th>—</th> <th>{$map_id326}</th> <th></th><th></th> <th></th><th>{$map_id346}</th>  <th>—</th><th>{$map_id347}</th>  <th>—</th><th>{$map_id349}</th><th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id324}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id348}</th>  <th></th><th></th><th></th><th></th>  <th></th><th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt11()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id351 = ($in_map_id == 351) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层第三间房</b></button>";
    $map_id362 = ($in_map_id == 362) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层第三间房</b></button>";
    
    $map_id353 = ($in_map_id == 353) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";
    $map_id358 = ($in_map_id == 358) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";

    $map_id352 = ($in_map_id == 352) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";
    $map_id356 = ($in_map_id == 356) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";
    $map_id361 = ($in_map_id == 361) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";
    $map_id357 = ($in_map_id == 357) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";

    $map_id354 = ($in_map_id == 354) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";
    $map_id355 = ($in_map_id == 355) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";
    $map_id359 = ($in_map_id == 359) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";
    $map_id360 = ($in_map_id == 360) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第三间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第三间房</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id353}</th> <th></th> <th></th><th></th> <th>{$map_id358}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id351}</th> <th>—</th> <th>{$map_id352}</th> <th>—</th> <th>{$map_id356}</th><th>—</th> <th>{$map_id357}</th><th>—</th> <th>{$map_id361}</th><th>—</th> <th>{$map_id362}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id354}</th> <th></th> <th></th><th></th> <th>{$map_id359}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id355}</th> <th></th> <th></th><th></th> <th>{$map_id360}</th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt12()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id363 = ($in_map_id == 363) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层采矿所</b></button>";
    $map_id383 = ($in_map_id == 383) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层采矿所</b></button>";

    $map_id366 = ($in_map_id == 366) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id371 = ($in_map_id == 371) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id372 = ($in_map_id == 372) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id373 = ($in_map_id == 373) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";

    $map_id367 = ($in_map_id == 367) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id368 = ($in_map_id == 368) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id369 = ($in_map_id == 369) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id370 = ($in_map_id == 370) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";

    $map_id365 = ($in_map_id == 365) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id389 = ($in_map_id == 389) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id388 = ($in_map_id == 388) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id374 = ($in_map_id == 374) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id375 = ($in_map_id == 375) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";

    $map_id364 = ($in_map_id == 364) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id386 = ($in_map_id == 386) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id387 = ($in_map_id == 387) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id376 = ($in_map_id == 376) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";

    $map_id390 = ($in_map_id == 390) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id391 = ($in_map_id == 391) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id384 = ($in_map_id == 384) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id378 = ($in_map_id == 378) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id377 = ($in_map_id == 377) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";

    $map_id381 = ($in_map_id == 381) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id380 = ($in_map_id == 380) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id379 = ($in_map_id == 379) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";
    $map_id382 = ($in_map_id == 382) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下1层采矿所</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id367}</th> <th>—</th> <th>{$map_id368}</th><th>—</th> <th>{$map_id369}</th> <th>—</th> <th>{$map_id370}</th> <th></th><th></th> <th></th><th></th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id366}</th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id371}</th> <th>—</th><th>{$map_id372}</th> <th>—</th><th>{$map_id373}</th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id365}</th> <th>—</th> <th>{$map_id389}</th><th>—</th> <th>{$map_id388}</th> <th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id374}</th>  <th>—</th><th>{$map_id375}</th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id363}</th> <th>—</th> <th>{$map_id364}</th> <th></th> <th></th><th></th> <th>{$map_id386}</th> <th>—</th> <th>{$map_id387}</th> <th></th><th></th> <th></th><th>{$map_id376}</th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id390}</th> <th>—</th> <th>{$map_id391}</th><th>—</th> <th>{$map_id384}</th> <th></th> <th></th> <th></th><th>{$map_id378}</th> <th>—</th><th>{$map_id377}</th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id381}</th> <th>—</th> <th>{$map_id380}</th> <th>—</th><th>{$map_id379}</th> <th></th><th></th>  <th></th><th></th>  <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id383}</th><th>—</th> <th>{$map_id382}</th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th></th>  <th></th><th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt13()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id392 = ($in_map_id == 392) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>天桥2</b></button>";
    $map_id399 = ($in_map_id == 399) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>天桥2</b></button>";

    $map_id401 = ($in_map_id == 401) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";
    $map_id393 = ($in_map_id == 393) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";
    $map_id394 = ($in_map_id == 394) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";

    $map_id400 = ($in_map_id == 400) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";
    $map_id395 = ($in_map_id == 395) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";

    $map_id398 = ($in_map_id == 398) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";
    $map_id397 = ($in_map_id == 397) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";
    $map_id396 = ($in_map_id == 396) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥2</b></button>" : "<button type= submit class= btn btn-success>天桥2</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id392}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id401}</th> <th>—</th> <th>{$map_id393}</th><th>—</th> <th>{$map_id394}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id400}</th> <th></th> <th></th><th></th> <th>{$map_id395}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id399}</th> <th>—</th> <th>{$map_id398}</th> <th>—</th> <th>{$map_id397}</th><th>—</th> <th>{$map_id396}</th><th></th> <th></th><th></th> <th></th> </tr>
 
    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt14()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id402 = ($in_map_id == 402) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下2层采矿所</b></button>";
    $map_id421 = ($in_map_id == 421) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下2层采矿所</b></button>";

    $map_id429 = ($in_map_id == 429) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id430 = ($in_map_id == 430) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id431 = ($in_map_id == 431) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id403 = ($in_map_id == 403) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";

    $map_id428 = ($in_map_id == 428) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id432 = ($in_map_id == 432) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id404 = ($in_map_id == 404) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";

    $map_id423 = ($in_map_id == 423) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id424 = ($in_map_id == 424) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id425 = ($in_map_id == 425) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id427 = ($in_map_id == 427) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id434 = ($in_map_id == 434) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id433 = ($in_map_id == 433) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id406 = ($in_map_id == 406) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id405 = ($in_map_id == 405) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";

    $map_id422 = ($in_map_id == 422) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id426 = ($in_map_id == 426) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id408 = ($in_map_id == 408) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id407 = ($in_map_id == 407) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";

    $map_id419 = ($in_map_id == 419) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id418 = ($in_map_id == 418) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id417 = ($in_map_id == 417) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id409 = ($in_map_id == 409) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";

    $map_id420 = ($in_map_id == 420) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id416 = ($in_map_id == 416) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id415 = ($in_map_id == 415) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id411 = ($in_map_id == 411) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id410 = ($in_map_id == 410) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";

    $map_id414 = ($in_map_id == 414) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id413 = ($in_map_id == 413) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";
    $map_id412 = ($in_map_id == 412) ? "<button type= submit class= btn btn-success><b style='color:green'>地下2层采矿所</b></button>" : "<button type= submit class= btn btn-success>地下2层采矿所</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id429}</th> <th>—</th><th>{$map_id430}</th> <th>—</th><th>{$map_id431}</th>  <th></th><th></th>  <th></th><th>{$map_id402}</th> <th>—</th><th>{$map_id403}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id428}</th> <th></th><th></th> <th></th><th>{$map_id432}</th>  <th></th><th></th>  <th></th><th></th> <th></th><th>{$map_id404}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id423}</th> <th>—</th> <th>{$map_id424}</th><th>—</th> <th>{$map_id425}</th> <th>—</th> <th>{$map_id427}</th> <th>—</th><th>{$map_id434}</th> <th>—</th><th>{$map_id433}</th>  <th></th><th></th>  <th></th><th>{$map_id406}</th> <th>—</th><th>{$map_id405}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id422}</th> <th></th> <th></th><th></th> <th>{$map_id426}</th> <th>—</th> <th>{$map_id427}</th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id408}</th>  <th>—</th><th>{$map_id407}</th> <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id419}</th> <th>—</th> <th>{$map_id418}</th><th>—</th> <th>{$map_id417}</th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id409}</th>  <th></th><th></th> <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id421}</th> <th>—</th> <th>{$map_id420}</th> <th></th> <th></th><th></th> <th>{$map_id416}</th> <th>—</th> <th>{$map_id415}</th> <th></th><th></th> <th></th><th>{$map_id411}</th>  <th>—</th><th>{$map_id410}</th>  <th></th><th></th> <th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td>|</td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id414}</th> <th>—</th><th>{$map_id413}</th> <th>—</th><th>{$map_id412}</th>  <th></th><th></th>  <th></th><th></th> <th></th><th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt15()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id442 = ($in_map_id == 442) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>天桥3</b></button>";
    $map_id435 = ($in_map_id == 435) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>天桥3</b></button>";

    $map_id446 = ($in_map_id == 446) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";

    $map_id445 = ($in_map_id == 445) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";
    $map_id444 = ($in_map_id == 444) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";

    $map_id443 = ($in_map_id == 443) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";

    $map_id441 = ($in_map_id == 441) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";
    $map_id440 = ($in_map_id == 440) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";
    $map_id437 = ($in_map_id == 437) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";
    $map_id436 = ($in_map_id == 436) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";

    $map_id438 = ($in_map_id == 438) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";
    $map_id439 = ($in_map_id == 439) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥3</b></button>" : "<button type= submit class= btn btn-success>天桥3</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id446}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id445}</th> <th>—</th> <th>{$map_id444}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id443}</th><th></th> <th></th><th></th> <th>{$map_id435}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id442}</th> <th>—</th> <th>{$map_id441}</th> <th>—</th> <th>{$map_id440}</th><th>—</th> <th>{$map_id437}</th><th>—</th> <th>{$map_id436}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id438}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id439}</th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt16()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id490 = ($in_map_id == 490) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>矿石储藏所</b></button>";
    $map_id447 = ($in_map_id == 447) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>矿石储藏所</b></button>";

    $map_id488 = ($in_map_id == 488) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id487 = ($in_map_id == 487) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id486 = ($in_map_id == 486) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id497 = ($in_map_id == 497) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id496 = ($in_map_id == 496) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id495 = ($in_map_id == 495) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id460 = ($in_map_id == 460) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id459 = ($in_map_id == 459) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id458 = ($in_map_id == 458) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    $map_id489 = ($in_map_id == 489) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id485 = ($in_map_id == 485) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id498 = ($in_map_id == 498) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id494 = ($in_map_id == 494) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id461 = ($in_map_id == 461) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id457 = ($in_map_id == 457) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    $map_id491 = ($in_map_id == 491) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id484 = ($in_map_id == 484) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id499 = ($in_map_id == 499) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id500 = ($in_map_id == 500) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id493 = ($in_map_id == 493) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id462 = ($in_map_id == 462) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id455 = ($in_map_id == 455) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id456 = ($in_map_id == 456) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    $map_id479 = ($in_map_id == 479) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id480 = ($in_map_id == 480) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id481 = ($in_map_id == 481) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id483 = ($in_map_id == 483) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id492 = ($in_map_id == 492) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id454 = ($in_map_id == 454) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    $map_id478 = ($in_map_id == 478) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id482 = ($in_map_id == 482) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id464 = ($in_map_id == 464) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id463 = ($in_map_id == 463) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id452 = ($in_map_id == 452) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id453 = ($in_map_id == 453) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    $map_id477 = ($in_map_id == 477) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id471 = ($in_map_id == 471) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id470 = ($in_map_id == 470) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id469 = ($in_map_id == 469) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id468 = ($in_map_id == 468) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id467 = ($in_map_id == 467) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id465 = ($in_map_id == 465) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id451 = ($in_map_id == 451) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    $map_id476 = ($in_map_id == 476) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id472 = ($in_map_id == 472) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id466 = ($in_map_id == 466) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id449 = ($in_map_id == 449) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id450 = ($in_map_id == 450) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    $map_id475 = ($in_map_id == 475) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id474 = ($in_map_id == 474) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id473 = ($in_map_id == 473) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";
    $map_id448 = ($in_map_id == 448) ? "<button type= submit class= btn btn-success><b style='color:green'>矿石储藏所</b></button>" : "<button type= submit class= btn btn-success>矿石储藏所</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id488}</th> <th>—</th> <th>{$map_id487}</th><th>—</th> <th>{$map_id486}</th> <th></th> <th></th> <th></th><th>{$map_id497}</th> <th>—</th><th>{$map_id496}</th>  <th>—</th><th>{$map_id495}</th>  <th></th><th></th> <th></th><th>{$map_id460}</th> <th>—</th><th>{$map_id459}</th><th>—</th><th>{$map_id458}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id490}</th> <th>—</th> <th>{$map_id489}</th> <th></th> <th></th><th></th> <th>{$map_id485}</th> <th></th> <th></th> <th></th><th>{$map_id498}</th> <th></th><th></th>  <th></th><th>{$map_id494}</th>  <th></th><th></th> <th></th><th>{$map_id461}</th> <th></th><th></th><th></th><th>{$map_id457}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id491}</th> <th></th> <th></th><th></th> <th>{$map_id484}</th> <th></th> <th></th> <th></th><th>{$map_id499}</th> <th>—</th><th>{$map_id500}</th>  <th>—</th><th>{$map_id493}</th>  <th></th><th></th> <th></th><th>{$map_id462}</th> <th>—</th><th>{$map_id455}</th><th>—</th><th>{$map_id456}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id479}</th> <th>—</th> <th>{$map_id480}</th> <th>—</th> <th>{$map_id481}</th><th>—</th> <th>{$map_id483}</th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id492}</th>  <th></th><th></th> <th></th><th></th> <th></th><th>{$map_id454}</th><th></th><th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id478}</th> <th></th> <th></th> <th></th> <th>{$map_id482}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id464}</th>  <th>—</th><th>{$map_id463}</th> <th>—</th><th>{$map_id452}</th> <th>—</th><th>{$map_id453}</th><th></th><th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id477}</th> <th></th> <th></th> <th></th> <th>{$map_id471}</th><th>—</th> <th>{$map_id470}</th> <th>—</th> <th>{$map_id469}</th> <th>—</th><th>{$map_id468}</th> <th>—</th><th>{$map_id467}</th>  <th>—</th><th>{$map_id465}</th>  <th></th><th></th> <th></th><th>{$map_id451}</th> <th></th><th></th><th></th><th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id476}</th> <th></th> <th></th> <th></th> <th>{$map_id472}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id466}</th>  <th>—</th><th>{$map_id449}</th> <th>—</th><th>{$map_id450}</th> <th></th><th></th><th></th><th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id475}</th> <th>—</th> <th>{$map_id474}</th> <th>—</th> <th>{$map_id473}</th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th></th>  <th></th><th>{$map_id448}</th> <th></th><th></th> <th></th><th></th><th></th><th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th></th>  <th></th><th>{$map_id447}</th> <th></th><th></th> <th></th><th></th><th></th><th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt17()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id501 = ($in_map_id == 501) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>天桥1</b></button>";
    $map_id507 = ($in_map_id == 507) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>天桥1</b></button>";

    $map_id509 = ($in_map_id == 509) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";
    
    $map_id508 = ($in_map_id == 508) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";
    $map_id503 = ($in_map_id == 503) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";
    $map_id502 = ($in_map_id == 502) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";

    $map_id506 = ($in_map_id == 506) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";
    $map_id505 = ($in_map_id == 505) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";
    $map_id504 = ($in_map_id == 504) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";

    $map_id510 = ($in_map_id == 510) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";
    $map_id511 = ($in_map_id == 511) ? "<button type= submit class= btn btn-success><b style='color:green'>天桥1</b></button>" : "<button type= submit class= btn btn-success>天桥1</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th>{$map_id509}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id501}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id508}</th> <th></th> <th></th><th></th> <th>{$map_id503}</th><th>—</th> <th>{$map_id502}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id507}</th> <th>—</th> <th>{$map_id506}</th> <th>—</th> <th>{$map_id505}</th><th>—</th> <th>{$map_id504}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id510}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id511}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出���位置!";
}
function dt18()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id541 = ($in_map_id == 541) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>废矿南部洞穴</b></button>";
    $map_id512 = ($in_map_id == 512) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>废矿南部洞穴</b></button>";

    $map_id540 = ($in_map_id == 540) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id539 = ($in_map_id == 539) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id538 = ($in_map_id == 538) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id533 = ($in_map_id == 533) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id532 = ($in_map_id == 532) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id531 = ($in_map_id == 531) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id542 = ($in_map_id == 542) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id537 = ($in_map_id == 537) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id536 = ($in_map_id == 536) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id534 = ($in_map_id == 534) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id530 = ($in_map_id == 530) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id543 = ($in_map_id == 543) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id545 = ($in_map_id == 545) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id546 = ($in_map_id == 546) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id535 = ($in_map_id == 535) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id529 = ($in_map_id == 529) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id547 = ($in_map_id == 547) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id544 = ($in_map_id == 544) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id526 = ($in_map_id == 526) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id527 = ($in_map_id == 527) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id528 = ($in_map_id == 528) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id555 = ($in_map_id == 555) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id556 = ($in_map_id == 556) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id548 = ($in_map_id == 548) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id525 = ($in_map_id == 525) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id554 = ($in_map_id == 554) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id549 = ($in_map_id == 549) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id524 = ($in_map_id == 524) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id553 = ($in_map_id == 553) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id552 = ($in_map_id == 552) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id550 = ($in_map_id == 550) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id562 = ($in_map_id == 562) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id563 = ($in_map_id == 563) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id523 = ($in_map_id == 523) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id551 = ($in_map_id == 551) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id557 = ($in_map_id == 557) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id561 = ($in_map_id == 561) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id522 = ($in_map_id == 522) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id558 = ($in_map_id == 558) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id559 = ($in_map_id == 559) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id560 = ($in_map_id == 560) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id521 = ($in_map_id == 521) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id517 = ($in_map_id == 517) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id518 = ($in_map_id == 518) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id519 = ($in_map_id == 519) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
  
    $map_id516 = ($in_map_id == 516) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id520 = ($in_map_id == 520) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

    $map_id515 = ($in_map_id == 515) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id514 = ($in_map_id == 514) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";
    $map_id513 = ($in_map_id == 513) ? "<button type= submit class= btn btn-success><b style='color:green'>废矿南部洞穴</b></button>" : "<button type= submit class= btn btn-success>废矿南部洞穴</button>";

   echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr> <th></th> <th></th> <th></th><th></th> <th>{$map_id541}</th> <th>—</th> <th>{$map_id540}</th> <th>—</th><th>{$map_id539}</th> <th>—</th><th>{$map_id538}</th>  <th></th><th></th>  <th></th><th>{$map_id533}</th> <th>—</th><th>{$map_id532}</th> <th>—</th><th>{$map_id531}</th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id542}</th> <th></th><th></th> <th></th><th>{$map_id537}</th>  <th>—</th><th>{$map_id536}</th>  <th>—</th><th>{$map_id534}</th> <th></th><th></th> <th></th><th>{$map_id530}</th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id543}</th> <th>—</th><th>{$map_id545}</th> <th>—</th><th>{$map_id546}</th>  <th></th><th></th>  <th></th><th>{$map_id535}</th> <th></th><th></th> <th></th><th>{$map_id529}</th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th>{$map_id547}</th> <th>—</th> <th>{$map_id544}</th> <th></th><th></th> <th></th><th></th>  <th></th><th></th>  <th></th><th>{$map_id526}</th> <th>—</th><th>{$map_id527}</th> <th>—</th><th>{$map_id528}</th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th>{$map_id555}</th> <th>—</th> <th>{$map_id556}</th><th>—</th> <th>{$map_id548}</th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th></th>  <th></th><th>{$map_id525}</th> <th></th><th></th> <th></th><th></th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th>{$map_id554}</th> <th></th> <th></th><th></th> <th>{$map_id549}</th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th></th>  <th></th><th>{$map_id524}</th> <th></th><th></th> <th></th><th></th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th>{$map_id553}</th> <th>—</th> <th>{$map_id552}</th><th>—</th> <th>{$map_id550}</th> <th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id562}</th>  <th>—</th><th>{$map_id563}</th>  <th>—</th><th>{$map_id523}</th> <th></th><th></th> <th></th><th></th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th>{$map_id551}</th> <th>—</th> <th>{$map_id557}</th> <th></th><th></th> <th></th><th>{$map_id561}</th>  <th></th><th></th>  <th></th><th>{$map_id522}</th> <th></th><th></th> <th></th><th></th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td>  <td></td> <td></td><td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id558}</th> <th>—</th><th>{$map_id559}</th> <th>—</th><th>{$map_id560}</th>  <th></th><th></th>  <th></th><th>{$map_id521}</th> <th></th><th></th> <th></th><th></th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id517}</th>  <th>—</th><th>{$map_id518}</th> <th>—</th><th>{$map_id519}</th> <th></th><th></th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id516}</th>  <th></th><th></th> <th></th><th>{$map_id520}</th> <th></th><th></th><th></th><th></th> <th></th><th></th> </tr>
    <tr> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td>  <td></td> <td></td><td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr> <th></th> <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th>  <th></th><th>{$map_id515}</th>  <th>—</th><th>{$map_id514}</th> <th>—</th><th>{$map_id513}</th> <th>—</th><th>{$map_id512}</th><th></th><th></th> <th></th><th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}
function dt19()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id568 = ($in_map_id == 568) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层第一间房</b></button>";
    $map_id564 = ($in_map_id == 564) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>地下1层第一间房</b></button>";

    $map_id570 = ($in_map_id == 570) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";
    $map_id569 = ($in_map_id == 569) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";
    $map_id567 = ($in_map_id == 567) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";

    $map_id571 = ($in_map_id == 571) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";
    $map_id566 = ($in_map_id == 566) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";

    $map_id572 = ($in_map_id == 572) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";
    $map_id574 = ($in_map_id == 574) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";
    $map_id565 = ($in_map_id == 565) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";
    $map_id573 = ($in_map_id == 573) ? "<button type= submit class= btn btn-success><b style='color:green'>地下1层第一间房</b></button>" : "<button type= submit class= btn btn-success>地下1层第一间房</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id570}</th> <th>—</th> <th>{$map_id569}</th> <th>—</th> <th>{$map_id567}</th><th>—</th> <th>{$map_id568}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id571}</th> <th></th> <th></th> <th></th> <th>{$map_id566}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id572}</th> <th>—</th> <th>{$map_id574}</th> <th>—</th> <th>{$map_id565}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id573}</th> <th></th> <th></th> <th></th> <th>{$map_id564}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}
function dt21()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id601 = ($in_map_id == 601) ? "<button type= submit class= btn btn-success><b style='color:green'>山坳</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>山坳</b></button>";
    $map_id576 = ($in_map_id == 576) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重街口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重街口</b></button>";
    
    $map_id599 = ($in_map_id == 599) ? "<button type= submit class= btn btn-success><b style='color:green'>材料店</b></button>" : "<button type= submit class= btn btn-success>材料店</button>";
    $map_id598 = ($in_map_id == 598) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重街道</b></button>" : "<button type= submit class= btn btn-success>盟重街道</button>";
    $map_id600 = ($in_map_id == 600) ? "<button type= submit class= btn btn-success><b style='color:green'>饰品店</b></button>" : "<button type= submit class= btn btn-success>饰品店</button>";

    $map_id595 = ($in_map_id == 595) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重药铺</b></button>" : "<button type= submit class= btn btn-success>盟重药铺</button>";
    $map_id594 = ($in_map_id == 594) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重街道</b></button>" : "<button type= submit class= btn btn-success>盟重街道</button>";
    $map_id596 = ($in_map_id == 596) ? "<button type= submit class= btn btn-success><b style='color:green'>寄售铺</b></button>" : "<button type= submit class= btn btn-success>寄售铺</button>";
    $map_id597 = ($in_map_id == 597) ? "<button type= submit class= btn btn-success><b style='color:green'>储藏室</b></button>" : "<button type= submit class= btn btn-success>储藏室</button>";

    $map_id593 = ($in_map_id == 593) ? "<button type= submit class= btn btn-success><b style='color:green'>武器店</b></button>" : "<button type= submit class= btn btn-success>武器店</button>";
    $map_id592 = ($in_map_id == 592) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重街道</b></button>" : "<button type= submit class= btn btn-success>盟重街道</button>";
    $map_id590 = ($in_map_id == 590) ? "<button type= submit class= btn btn-success><b style='color:green'>兵器储藏室</b></button>" : "<button type= submit class= btn btn-success>兵器储藏室</button>";

    $map_id587 = ($in_map_id == 587) ? "<button type= submit class= btn btn-success><b style='color:green'>杂货店</b></button>" : "<button type= submit class= btn btn-success>杂货店</button>";
    $map_id586 = ($in_map_id == 586) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重街道</b></button>" : "<button type= submit class= btn btn-success>盟重街道</button>";
    $map_id588 = ($in_map_id == 588) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重道馆大门</b></button>" : "<button type= submit class= btn btn-success>盟重道馆大门</button>";
    $map_id589 = ($in_map_id == 589) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重道馆教练场</b></button>" : "<button type= submit class= btn btn-success>盟重道馆教练场</button>";
    $map_id591 = ($in_map_id == 591) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重道馆大厅</b></button>" : "<button type= submit class= btn btn-success>盟重道馆大厅</button>";

    $map_id584 = ($in_map_id == 584) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重仓库</b></button>" : "<button type= submit class= btn btn-success>盟重仓库</button>";
    $map_id583 = ($in_map_id == 583) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重广场</b></button>" : "<button type= submit class= btn btn-success>盟重广场</button>";
    $map_id585 = ($in_map_id == 585) ? "<button type= submit class= btn btn-success><b style='color:green'>棉布店</b></button>" : "<button type= submit class= btn btn-success>棉布店</button>";

    $map_id579 = ($in_map_id == 579) ? "<button type= submit class= btn btn-success><b style='color:green'>青石官道</b></button>" : "<button type= submit class= btn btn-success>青石官道</button>";
    $map_id577 = ($in_map_id == 577) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重街道</b></button>" : "<button type= submit class= btn btn-success>盟重街道</button>";
    $map_id578 = ($in_map_id == 578) ? "<button type= submit class= btn btn-success><b style='color:green'>租赁店</b></button>" : "<button type= submit class= btn btn-success>租赁店</button>";
    $map_id580 = ($in_map_id == 580) ? "<button type= submit class= btn btn-success><b style='color:green'>黄土小径</b></button>" : "<button type= submit class= btn btn-success>黄土小径</button>";
    $map_id581 = ($in_map_id == 581) ? "<button type= submit class= btn btn-success><b style='color:green'>黄土小径</b></button>" : "<button type= submit class= btn btn-success>黄土小径</button>";
    $map_id582 = ($in_map_id == 582) ? "<button type= submit class= btn btn-success><b style='color:green'>山路</b></button>" : "<button type= submit class= btn btn-success>山路</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id601}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id599}</th> <th>—</th> <th>{$map_id598}</th><th>—</th> <th>{$map_id600}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id595}</th> <th>—</th> <th>{$map_id594}</th><th>—</th> <th>{$map_id596}</th><th>—</th> <th>{$map_id597}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id593}</th> <th>—</th> <th>{$map_id592}</th><th></th> <th></th><th></th> <th>{$map_id590}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id587}</th> <th>—</th> <th>{$map_id586}</th><th>—</th> <th>{$map_id588}</th><th>—</th> <th>{$map_id589}</th><th>—</th> <th>{$map_id591}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id584}</th> <th>—</th> <th>{$map_id583}</th><th>—</th> <th>{$map_id585}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id579}</th> <th>—</th> <th>{$map_id577}</th> <th>—</th> <th>{$map_id576}</th><th>—</th> <th>{$map_id580}</th><th>—</th> <th>{$map_id581}</th><th>—</th> <th>{$map_id582}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id578}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt22()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id602 = ($in_map_id == 602) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重南郊外</b></button>";
    $map_id648 = ($in_map_id == 648) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重南郊外</b></button>";
    $map_id638 = ($in_map_id == 638) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重南郊外</b></button>";

    $map_id616 = ($in_map_id == 616) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id615 = ($in_map_id == 615) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id603 = ($in_map_id == 603) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id614 = ($in_map_id == 614) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id613 = ($in_map_id == 613) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id618 = ($in_map_id == 618) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id617 = ($in_map_id == 617) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id604 = ($in_map_id == 604) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id612 = ($in_map_id == 612) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id611 = ($in_map_id == 611) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id619 = ($in_map_id == 619) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id605 = ($in_map_id == 605) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id610 = ($in_map_id == 610) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id620 = ($in_map_id == 620) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id621 = ($in_map_id == 621) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id622 = ($in_map_id == 622) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id606 = ($in_map_id == 606) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id607 = ($in_map_id == 607) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id608 = ($in_map_id == 608) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id609 = ($in_map_id == 609) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id623 = ($in_map_id == 623) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id631 = ($in_map_id == 631) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id624 = ($in_map_id == 624) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id625 = ($in_map_id == 625) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id626 = ($in_map_id == 626) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id630 = ($in_map_id == 630) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id627 = ($in_map_id == 627) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id628 = ($in_map_id == 628) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id629 = ($in_map_id == 629) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id632 = ($in_map_id == 632) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id633 = ($in_map_id == 633) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id651 = ($in_map_id == 651) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id652 = ($in_map_id == 652) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id653 = ($in_map_id == 653) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id654 = ($in_map_id == 654) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id634 = ($in_map_id == 634) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id649 = ($in_map_id == 649) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id650 = ($in_map_id == 650) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id655 = ($in_map_id == 655) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id635 = ($in_map_id == 635) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id647 = ($in_map_id == 647) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id641 = ($in_map_id == 641) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id640 = ($in_map_id == 640) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id639 = ($in_map_id == 639) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id637 = ($in_map_id == 637) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id636 = ($in_map_id == 636) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    $map_id646 = ($in_map_id == 646) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id645 = ($in_map_id == 645) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id644 = ($in_map_id == 644) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id643 = ($in_map_id == 643) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";
    $map_id642 = ($in_map_id == 642) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重南郊外</b></button>" : "<button type= submit class= btn btn-success>盟重南郊外</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id602}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id616}</th> <th>—</th> <th>{$map_id615}</th> <th>—</th> <th>{$map_id603}</th><th>—</th> <th>{$map_id614}</th><th>—</th> <th>{$map_id613}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id618}</th> <th>—</th> <th>{$map_id617}</th> <th></th> <th></th> <th></th> <th>{$map_id604}</th><th></th> <th></th><th></th> <th>{$map_id612}</th><th>—</th> <th>{$map_id611}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id619}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id605}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id610}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id620}</th> <th>—</th> <th>{$map_id621}</th> <th>—</th> <th>{$map_id622}</th> <th>—</th> <th>{$map_id606}</th><th>—</th> <th>{$map_id607}</th><th>—</th> <th>{$map_id608}</th><th>—</th> <th>{$map_id609}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id623}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id631}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id624}</th> <th>—</th> <th>{$map_id625}</th> <th>—</th> <th>{$map_id626}</th><th></th> <th></th><th></th> <th>{$map_id630}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id627}</th><th>—</th> <th>{$map_id628}</th><th>—</th> <th>{$map_id629}</th><th>—</th> <th>{$map_id632}</th> <th>—</th> <th>{$map_id633}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id651}</th> <th>—</th> <th>{$map_id652}</th> <th>—</th> <th>{$map_id653}</th> <th>—</th> <th>{$map_id654}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id634}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id649}</th> <th>—</th> <th>{$map_id650}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id655}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th>{$map_id635}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id648}</th> <th>—</th> <th>{$map_id647}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id641}</th><th>—</th> <th>{$map_id640}</th><th>—</th> <th>{$map_id639}</th><th>—</th> <th>{$map_id637}</th> <th>—</th> <th>{$map_id636}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id646}</th> <th>—</th> <th>{$map_id645}</th> <th>—</th> <th>{$map_id644}</th> <th>—</th> <th>{$map_id643}</th> <th>—</th> <th>{$map_id642}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id638}</th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt23()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id692 = ($in_map_id == 692) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重北郊外</b></button>";
    $map_id713 = ($in_map_id == 713) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重北郊外</b></button>";
    $map_id656 = ($in_map_id == 656) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重北郊外</b></button>";
    $map_id684 = ($in_map_id == 684) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>盟重北郊外</b></button>";

    $map_id693 = ($in_map_id == 693) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id694 = ($in_map_id == 694) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id695 = ($in_map_id == 695) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id715 = ($in_map_id == 715) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id714 = ($in_map_id == 714) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id691 = ($in_map_id == 691) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id696 = ($in_map_id == 696) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id716 = ($in_map_id == 716) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id712 = ($in_map_id == 712) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id711 = ($in_map_id == 711) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id690 = ($in_map_id == 690) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id689 = ($in_map_id == 689) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id697 = ($in_map_id == 697) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id698 = ($in_map_id == 698) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id699 = ($in_map_id == 699) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id710 = ($in_map_id == 710) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id688 = ($in_map_id == 688) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id700 = ($in_map_id == 700) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id717 = ($in_map_id == 717) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id706 = ($in_map_id == 706) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id707 = ($in_map_id == 707) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id683 = ($in_map_id == 683) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id682 = ($in_map_id == 682) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id701 = ($in_map_id == 701) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id708 = ($in_map_id == 708) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id685 = ($in_map_id == 685) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id681 = ($in_map_id == 681) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id704 = ($in_map_id == 704) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id703 = ($in_map_id == 703) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id702 = ($in_map_id == 702) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id705 = ($in_map_id == 705) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id709 = ($in_map_id == 709) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id686 = ($in_map_id == 686) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id680 = ($in_map_id == 680) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id661 = ($in_map_id == 661) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id662 = ($in_map_id == 662) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id663 = ($in_map_id == 663) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id687 = ($in_map_id == 687) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id676 = ($in_map_id == 676) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id677 = ($in_map_id == 677) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id678 = ($in_map_id == 678) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id659 = ($in_map_id == 659) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id660 = ($in_map_id == 660) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id664 = ($in_map_id == 664) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id675 = ($in_map_id == 675) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id679 = ($in_map_id == 679) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id658 = ($in_map_id == 658) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id665 = ($in_map_id == 665) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id674 = ($in_map_id == 674) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id670 = ($in_map_id == 670) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id669 = ($in_map_id == 669) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id657 = ($in_map_id == 657) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id668 = ($in_map_id == 668) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id667 = ($in_map_id == 667) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id666 = ($in_map_id == 666) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    $map_id673 = ($in_map_id == 673) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id672 = ($in_map_id == 672) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";
    $map_id671 = ($in_map_id == 671) ? "<button type= submit class= btn btn-success><b style='color:green'>盟重北郊外</b></button>" : "<button type= submit class= btn btn-success>盟重北郊外</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id692}</th> <th>—</th> <th>{$map_id693}</th> <th>—</th> <th>{$map_id694}</th> <th>—</th> <th>{$map_id695}</th> <th></th> <th></th> <th></th> <th>{$map_id715}</th><th>—</th> <th>{$map_id714}</th><th>—</th> <th>{$map_id713}</th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id691}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id696}</th> <th></th> <th></th> <th></th> <th>{$map_id716}</th><th></th> <th></th><th></th> <th>{$map_id712}</th><th>—</th> <th>{$map_id711}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id690}</th> <th>—</th> <th>{$map_id689}</th> <th></th> <th></th> <th></th> <th>{$map_id697}</th> <th>—</th> <th>{$map_id698}</th> <th>—</th> <th>{$map_id699}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id710}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id688}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id700}</th><th>—</th> <th>{$map_id717}</th><th>—</th> <th>{$map_id706}</th><th>—</th> <th>{$map_id707}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id684}</th> <th>—</th> <th>{$map_id683}</th> <th>—</th> <th>{$map_id682}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id701}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id708}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id685}</th> <th></th> <th></th> <th></th> <th>{$map_id681}</th> <th>—</th> <th>{$map_id704}</th> <th>—</th> <th>{$map_id703}</th> <th>—</th> <th>{$map_id702}</th><th>—</th> <th>{$map_id705}</th><th></th> <th></th><th></th> <th>{$map_id709}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id686}</th> <th></th> <th></th> <th></th> <th>{$map_id680}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id661}</th><th>—</th> <th>{$map_id662}</th><th>—</th> <th>{$map_id663}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id687}</th> <th>—</th> <th>{$map_id676}</th> <th>—</th> <th>{$map_id677}</th> <th>—</th> <th>{$map_id678}</th> <th></th> <th></th> <th></th> <th>{$map_id659}</th><th>—</th> <th>{$map_id660}</th><th></th> <th></th><th></th> <th>{$map_id664}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id675}</th> <th></th> <th></th> <th></th> <th>{$map_id679}</th> <th></th> <th></th> <th></th> <th>{$map_id658}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id665}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id674}</th> <th></th> <th></th> <th></th> <th>{$map_id670}</th> <th>—</th> <th>{$map_id669}</th> <th>—</th> <th>{$map_id657}</th><th>—</th> <th>{$map_id668}</th><th>—</th> <th>{$map_id667}</th><th>—</th> <th>{$map_id666}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id673}</th> <th>—</th> <th>{$map_id672}</th> <th>—</th> <th>{$map_id671}</th> <th></th> <th></th> <th></th> <th>{$map_id656}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前���位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt24()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id729 = ($in_map_id == 729) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>石阁庙（野外）</b></button>";
    $map_id726 = ($in_map_id == 726) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁庙（野外）</b></button>";
    $map_id718 = ($in_map_id == 718) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁庙（野外）</b></button>";
 
    $map_id728 = ($in_map_id == 728) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id727 = ($in_map_id == 727) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id725 = ($in_map_id == 725) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";

    $map_id730 = ($in_map_id == 730) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id724 = ($in_map_id == 724) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id743 = ($in_map_id == 743) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id742 = ($in_map_id == 742) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";

    $map_id731 = ($in_map_id == 731) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id744 = ($in_map_id == 744) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id723 = ($in_map_id == 723) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id741 = ($in_map_id == 741) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id740 = ($in_map_id == 740) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";

    $map_id732 = ($in_map_id == 732) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id722 = ($in_map_id == 722) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id721 = ($in_map_id == 721) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id739 = ($in_map_id == 739) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";

    $map_id733 = ($in_map_id == 733) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id720 = ($in_map_id == 720) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id737 = ($in_map_id == 737) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id738 = ($in_map_id == 738) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";

    $map_id734 = ($in_map_id == 734) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id735 = ($in_map_id == 735) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id736 = ($in_map_id == 736) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";
    $map_id719 = ($in_map_id == 719) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁庙（野外）</b></button>" : "<button type= submit class= btn btn-success>石阁庙（野外）</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id729}</th> <th></th> <th></th> <th></th> <th>{$map_id726}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id728}</th> <th>—</th> <th>{$map_id727}</th> <th>—</th> <th>{$map_id725}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id730}</th> <th></th> <th></th> <th></th> <th>{$map_id724}</th><th>—</th> <th>{$map_id743}</th><th>—</th> <th>{$map_id742}</th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id731}</th> <th>—</th> <th>{$map_id744}</th> <th>—</th> <th>{$map_id723}</th><th></th> <th></th><th></th> <th>{$map_id741}</th><th>—</th> <th>{$map_id740}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id732}</th> <th></th> <th></th> <th></th> <th>{$map_id722}</th><th>—</th> <th>{$map_id721}</th><th></th> <th></th><th></th> <th>{$map_id739}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id733}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id720}</th><th>—</th> <th>{$map_id737}</th><th>—</th> <th>{$map_id738}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id734}</th> <th>—</th> <th>{$map_id735}</th> <th>—</th> <th>{$map_id736}</th><th>—</th> <th>{$map_id719}</th><th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id718}</th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:blue'>蓝色</b>:表示当前的boss位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt25()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id763 = ($in_map_id == 763) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁1层</b></button>";
    $map_id745 = ($in_map_id == 745) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁1层</b></button>";

    $map_id774 = ($in_map_id == 774) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id773 = ($in_map_id == 773) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id772 = ($in_map_id == 772) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id761 = ($in_map_id == 761) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id760 = ($in_map_id == 760) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id759 = ($in_map_id == 759) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id775 = ($in_map_id == 775) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id771 = ($in_map_id == 771) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id762 = ($in_map_id == 762) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id758 = ($in_map_id == 758) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id776 = ($in_map_id == 776) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id770 = ($in_map_id == 770) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id807 = ($in_map_id == 807) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id757 = ($in_map_id == 757) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id777 = ($in_map_id == 777) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id778 = ($in_map_id == 778) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id769 = ($in_map_id == 769) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id764 = ($in_map_id == 764) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id765 = ($in_map_id == 765) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id756 = ($in_map_id == 756) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id755 = ($in_map_id == 755) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id768 = ($in_map_id == 768) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id767 = ($in_map_id == 767) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id766 = ($in_map_id == 766) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id754 = ($in_map_id == 754) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id780 = ($in_map_id == 780) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id779 = ($in_map_id == 779) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id753 = ($in_map_id == 753) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id781 = ($in_map_id == 781) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id787 = ($in_map_id == 787) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id788 = ($in_map_id == 788) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id789 = ($in_map_id == 789) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id752 = ($in_map_id == 752) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id782 = ($in_map_id == 782) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id786 = ($in_map_id == 786) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id790 = ($in_map_id == 790) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id751 = ($in_map_id == 751) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id783 = ($in_map_id == 783) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id784 = ($in_map_id == 784) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id785 = ($in_map_id == 785) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id791 = ($in_map_id == 791) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id749 = ($in_map_id == 749) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id750 = ($in_map_id == 750) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id796 = ($in_map_id == 796) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id748 = ($in_map_id == 748) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id798 = ($in_map_id == 798) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id797 = ($in_map_id == 797) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id795 = ($in_map_id == 795) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id794 = ($in_map_id == 794) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id793 = ($in_map_id == 793) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id792 = ($in_map_id == 792) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id747 = ($in_map_id == 747) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id799 = ($in_map_id == 799) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id804 = ($in_map_id == 804) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id746 = ($in_map_id == 746) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    $map_id800 = ($in_map_id == 800) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id801 = ($in_map_id == 801) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id802 = ($in_map_id == 802) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id803 = ($in_map_id == 803) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id805 = ($in_map_id == 805) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";
    $map_id806 = ($in_map_id == 806) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁1层</b></button>" : "<button type= submit class= btn btn-success>石阁1层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id774}</th> <th>—</th> <th>{$map_id773}</th> <th>—</th> <th>{$map_id772}</th><th></th> <th></th><th></th> <th>{$map_id761}</th><th>—</th> <th>{$map_id760}</th> <th>—</th><th>{$map_id759}</th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id775}</th> <th></th> <th></th> <th></th> <th>{$map_id771}</th><th></th> <th></th><th></th> <th>{$map_id762}</th><th></th> <th></th> <th></th><th>{$map_id758}</th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id776}</th> <th></th> <th></th> <th></th> <th>{$map_id770}</th><th>—</th> <th>{$map_id807}</th><th>—</th> <th>{$map_id763}</th><th></th> <th></th> <th></th><th>{$map_id757}</th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id777}</th> <th>—</th> <th>{$map_id778}</th> <th>—</th> <th>{$map_id769}</th><th></th> <th></th><th></th> <th>{$map_id764}</th><th>—</th> <th>{$map_id765}</th> <th>—</th><th>{$map_id756}</th> <th>—</th><th>{$map_id755}</th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id768}</th><th>—</th> <th>{$map_id767}</th><th>—</th> <th>{$map_id766}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id754}</th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id780}</th> <th>—</th> <th>{$map_id779}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id753}</th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id781}</th> <th></th> <th></th><th></th> <th>{$map_id787}</th><th>—</th> <th>{$map_id788}</th><th>—</th> <th>{$map_id789}</th> <th></th><th></th> <th></th><th>{$map_id752}</th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id782}</th> <th></th> <th></th><th></th> <th>{$map_id786}</th><th></th> <th></th><th></th> <th>{$map_id790}</th> <th></th><th></th> <th></th><th>{$map_id751}</th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id783}</th> <th>—</th> <th>{$map_id784}</th><th>—</th> <th>{$map_id785}</th><th></th> <th></th><th></th> <th>{$map_id791}</th> <th>—</th><th>{$map_id749}</th> <th>—</th><th>{$map_id750}</th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id796}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id748}</th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id798}</th> <th>—</th> <th>{$map_id797}</th> <th>—</th> <th>{$map_id795}</th><th>—</th> <th>{$map_id794}</th><th>—</th> <th>{$map_id793}</th><th>—</th> <th>{$map_id792}</th> <th>—</th><th>{$map_id747}</th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id799}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id804}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id746}</th> <th></th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id800}</th> <th>—</th> <th>{$map_id801}</th> <th>—</th> <th>{$map_id802}</th><th>—</th> <th>{$map_id803}</th><th>—</th> <th>{$map_id805}</th><th>—</th> <th>{$map_id806}</th> <th>—</th><th>{$map_id745}</th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt26()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id808 = ($in_map_id == 808) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁2层</b></button>";
    $map_id825 = ($in_map_id == 825) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁2层</b></button>";

    $map_id833 = ($in_map_id == 833) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id809 = ($in_map_id == 809) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id839 = ($in_map_id == 839) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id838 = ($in_map_id == 838) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id837 = ($in_map_id == 837) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id836 = ($in_map_id == 836) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id835 = ($in_map_id == 835) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id834 = ($in_map_id == 834) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id832 = ($in_map_id == 832) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id810 = ($in_map_id == 810) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id840 = ($in_map_id == 840) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id856 = ($in_map_id == 856) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id831 = ($in_map_id == 831) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id811 = ($in_map_id == 811) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id842 = ($in_map_id == 842) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id841 = ($in_map_id == 841) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id843 = ($in_map_id == 843) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id855 = ($in_map_id == 855) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id857 = ($in_map_id == 857) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id830 = ($in_map_id == 830) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id812 = ($in_map_id == 812) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id844 = ($in_map_id == 844) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id854 = ($in_map_id == 854) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id829 = ($in_map_id == 829) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id813 = ($in_map_id == 813) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id847 = ($in_map_id == 847) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id846 = ($in_map_id == 846) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id845 = ($in_map_id == 845) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id850 = ($in_map_id == 850) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id851 = ($in_map_id == 851) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id828 = ($in_map_id == 828) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id814 = ($in_map_id == 814) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id848 = ($in_map_id == 848) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id852 = ($in_map_id == 852) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id853 = ($in_map_id == 853) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id827 = ($in_map_id == 827) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id815 = ($in_map_id == 815) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id849 = ($in_map_id == 849) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id826 = ($in_map_id == 826) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id816 = ($in_map_id == 816) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id818 = ($in_map_id == 818) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id819 = ($in_map_id == 819) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id820 = ($in_map_id == 820) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id821 = ($in_map_id == 821) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id822 = ($in_map_id == 822) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id823 = ($in_map_id == 823) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";
    $map_id824 = ($in_map_id == 824) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    $map_id817 = ($in_map_id == 817) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁2层</b></button>" : "<button type= submit class= btn btn-success>石阁2层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id808}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id833}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id809}</th> <th>—</th> <th>{$map_id839}</th> <th>—</th> <th>{$map_id838}</th><th>—</th> <th>{$map_id837}</th><th>—</th> <th>{$map_id836}</th><th>—</th> <th>{$map_id835}</th> <th>—</th><th>{$map_id834}</th> <th>—</th><th>{$map_id832}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id810}</th> <th></th> <th></th> <th></th> <th>{$map_id840}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id856}</th> <th></th><th></th> <th></th><th>{$map_id831}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id811}</th> <th>—</th> <th>{$map_id842}</th> <th>—</th> <th>{$map_id841}</th><th>—</th> <th>{$map_id843}</th><th></th> <th></th><th></th> <th>{$map_id855}</th> <th>—</th><th>{$map_id857}</th> <th>—</th><th>{$map_id830}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id812}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id844}</th><th></th> <th></th><th></th> <th>{$map_id854}</th> <th></th><th></th> <th></th><th>{$map_id829}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id813}</th> <th>—</th> <th>{$map_id847}</th> <th>—</th> <th>{$map_id846}</th><th>—</th> <th>{$map_id845}</th><th>—</th> <th>{$map_id850}</th><th>—</th> <th>{$map_id851}</th> <th></th><th></th> <th></th><th>{$map_id828}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id814}</th> <th></th> <th></th> <th></th> <th>{$map_id848}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id852}</th> <th>—</th><th>{$map_id853}</th> <th>—</th><th>{$map_id827}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id815}</th> <th></th> <th></th> <th></th> <th>{$map_id849}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id826}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>

    <tr>  <th>{$map_id816}</th> <th>—</th> <th>{$map_id818}</th> <th>—</th> <th>{$map_id819}</th><th>—</th> <th>{$map_id820}</th><th>—</th> <th>{$map_id821}</th><th>—</th> <th>{$map_id822}</th> <th>—</th><th>{$map_id823}</th> <th>—</th><th>{$map_id824}</th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> </tr>
    
    <tr>  <th>{$map_id817}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id825}</th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt27()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id858 = ($in_map_id == 858) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁3层</b></button>";
    $map_id879 = ($in_map_id == 879) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁3层</b></button>";

    $map_id895 = ($in_map_id == 895) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id894 = ($in_map_id == 894) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id893 = ($in_map_id == 893) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id892 = ($in_map_id == 892) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id891 = ($in_map_id == 891) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id889 = ($in_map_id == 889) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id888 = ($in_map_id == 888) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id887 = ($in_map_id == 887) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id859 = ($in_map_id == 859) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id896 = ($in_map_id == 896) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id897 = ($in_map_id == 897) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id890 = ($in_map_id == 890) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id886 = ($in_map_id == 886) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id860 = ($in_map_id == 860) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id861 = ($in_map_id == 861) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id898 = ($in_map_id == 898) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id913 = ($in_map_id == 913) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id885 = ($in_map_id == 885) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id862 = ($in_map_id == 862) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id900 = ($in_map_id == 900) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id899 = ($in_map_id == 899) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id909 = ($in_map_id == 909) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id884 = ($in_map_id == 884) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id863 = ($in_map_id == 863) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id868 = ($in_map_id == 868) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id902 = ($in_map_id == 902) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id901 = ($in_map_id == 901) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id908 = ($in_map_id == 908) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id910 = ($in_map_id == 910) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id911 = ($in_map_id == 911) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id883 = ($in_map_id == 883) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id864 = ($in_map_id == 864) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id903 = ($in_map_id == 903) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id904 = ($in_map_id == 904) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id907 = ($in_map_id == 907) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id882 = ($in_map_id == 882) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id865 = ($in_map_id == 865) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id869 = ($in_map_id == 869) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id905 = ($in_map_id == 905) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id912 = ($in_map_id == 912) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id881 = ($in_map_id == 881) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id866 = ($in_map_id == 866) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id872 = ($in_map_id == 872) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id906 = ($in_map_id == 906) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id877 = ($in_map_id == 877) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id880 = ($in_map_id == 880) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    $map_id867 = ($in_map_id == 867) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id870 = ($in_map_id == 870) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id871 = ($in_map_id == 871) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id873 = ($in_map_id == 873) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id874 = ($in_map_id == 874) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id875 = ($in_map_id == 875) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id876 = ($in_map_id == 876) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";
    $map_id878 = ($in_map_id == 878) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁3层</b></button>" : "<button type= submit class= btn btn-success>石阁3层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id858}</th> <th>—</th> <th>{$map_id895}</th> <th>—</th> <th>{$map_id894}</th><th>—</th> <th>{$map_id893}</th><th>—</th> <th>{$map_id892}</th><th>—</th> <th>{$map_id891}</th> <th>—</th><th>{$map_id889}</th> <th>—</th><th>{$map_id888}</th> <th>—</th> <th>{$map_id887}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id859}</th> <th></th> <th></th> <th></th> <th>{$map_id896}</th><th></th> <th></th><th></th> <th>{$map_id897}</th><th></th> <th></th> <th></th><th>{$map_id890}</th> <th></th><th></th> <th></th> <th>{$map_id886}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id860}</th> <th>—</th> <th>{$map_id861}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id898}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id913}</th> <th>—</th> <th>{$map_id885}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id862}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id900}</th><th>—</th> <th>{$map_id899}</th><th>—</th> <th>{$map_id909}</th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id884}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id863}</th> <th>—</th> <th>{$map_id868}</th> <th>—</th> <th>{$map_id902}</th><th>—</th> <th>{$map_id901}</th><th></th> <th></th><th></th> <th>{$map_id908}</th> <th>—</th><th>{$map_id910}</th> <th>—</th><th>{$map_id911}</th> <th>—</th> <th>{$map_id883}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id864}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id903}</th><th>—</th> <th>{$map_id904}</th><th>—</th> <th>{$map_id907}</th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id882}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id865}</th> <th>—</th> <th>{$map_id869}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id905}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id912}</th> <th>—</th> <th>{$map_id881}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id866}</th> <th></th> <th></th> <th></th> <th>{$map_id872}</th><th></th> <th></th><th></th> <th>{$map_id906}</th><th></th> <th></th> <th></th><th>{$map_id877}</th> <th></th><th></th> <th></th> <th>{$map_id880}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id867}</th> <th>—</th> <th>{$map_id870}</th> <th>—</th> <th>{$map_id871}</th><th>—</th> <th>{$map_id873}</th><th>—</th> <th>{$map_id874}</th><th>—</th> <th>{$map_id875}</th> <th>—</th><th>{$map_id876}</th> <th>—</th><th>{$map_id878}</th> <th>—</th> <th>{$map_id879}</th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt28()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id914 = ($in_map_id == 914) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁4层</b></button>";
    $map_id936 = ($in_map_id == 936) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁4层</b></button>";

    $map_id953 = ($in_map_id == 953) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id952 = ($in_map_id == 952) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id951 = ($in_map_id == 951) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id950 = ($in_map_id == 950) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id949 = ($in_map_id == 949) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id915 = ($in_map_id == 915) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id954 = ($in_map_id == 954) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id948 = ($in_map_id == 948) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id947 = ($in_map_id == 947) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id946 = ($in_map_id == 946) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id916 = ($in_map_id == 916) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id956 = ($in_map_id == 956) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id955 = ($in_map_id == 955) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id945 = ($in_map_id == 945) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id917 = ($in_map_id == 917) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id957 = ($in_map_id == 957) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id970 = ($in_map_id == 970) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id969 = ($in_map_id == 969) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id968 = ($in_map_id == 968) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id944 = ($in_map_id == 944) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id918 = ($in_map_id == 918) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id958 = ($in_map_id == 958) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id966 = ($in_map_id == 966) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id967 = ($in_map_id == 967) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id943 = ($in_map_id == 943) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id942 = ($in_map_id == 942) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id919 = ($in_map_id == 919) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id971 = ($in_map_id == 971) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id959 = ($in_map_id == 959) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id963 = ($in_map_id == 963) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id964 = ($in_map_id == 964) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id965 = ($in_map_id == 965) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id941 = ($in_map_id == 941) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id920 = ($in_map_id == 920) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id960 = ($in_map_id == 960) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id940 = ($in_map_id == 940) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id921 = ($in_map_id == 921) ? "<button type= submit class= btn btn-success><b style='color:green'>���阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id961 = ($in_map_id == 961) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id939 = ($in_map_id == 939) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id922 = ($in_map_id == 922) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id962 = ($in_map_id == 962) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id929 = ($in_map_id == 929) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id930 = ($in_map_id == 930) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id931 = ($in_map_id == 931) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id932 = ($in_map_id == 932) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id938 = ($in_map_id == 938) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id923 = ($in_map_id == 923) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id928 = ($in_map_id == 928) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id933 = ($in_map_id == 933) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id937 = ($in_map_id == 937) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    $map_id924 = ($in_map_id == 924) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id925 = ($in_map_id == 925) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id926 = ($in_map_id == 926) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id927 = ($in_map_id == 927) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id934 = ($in_map_id == 934) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";
    $map_id935 = ($in_map_id == 935) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁4层</b></button>" : "<button type= submit class= btn btn-success>石阁4层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id914}</th> <th>—</th> <th>{$map_id953}</th> <th>—</th> <th>{$map_id952}</th><th>—</th> <th>{$map_id951}</th><th>—</th> <th>{$map_id950}</th><th>—</th> <th>{$map_id949}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id915}</th> <th></th> <th></th> <th></th> <th>{$map_id954}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id948}</th> <th>—</th><th>{$map_id947}</th> <th>—</th><th>{$map_id946}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id916}</th> <th>—</th> <th>{$map_id956}</th> <th>—</th> <th>{$map_id955}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id945}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id917}</th> <th></th> <th></th> <th></th> <th>{$map_id957}</th><th>—</th> <th>{$map_id970}</th><th>—</th> <th>{$map_id969}</th><th>—</th> <th>{$map_id968}</th> <th></th><th></th> <th></th><th>{$map_id944}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id918}</th> <th></th> <th></th> <th></th> <th>{$map_id958}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id966}</th> <th>—</th><th>{$map_id967}</th> <th>—</th><th>{$map_id943}</th> <th>—</th> <th>{$map_id942}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id919}</th> <th>—</th> <th>{$map_id971}</th> <th>—</th> <th>{$map_id959}</th><th>—</th> <th>{$map_id963}</th><th>—</th> <th>{$map_id964}</th><th>—</th> <th>{$map_id965}</th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id941}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id920}</th> <th></th> <th></th> <th></th> <th>{$map_id960}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id940}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id921}</th> <th></th> <th></th> <th></th> <th>{$map_id961}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id939}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id922}</th> <th></th> <th></th> <th></th> <th>{$map_id962}</th><th>—</th> <th>{$map_id929}</th><th>—</th> <th>{$map_id930}</th><th>—</th> <th>{$map_id931}</th> <th>—</th><th>{$map_id932}</th> <th></th><th></th> <th></th> <th>{$map_id938}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id923}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id928}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id933}</th> <th></th><th></th> <th></th> <th>{$map_id937}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id924}</th> <th>—</th> <th>{$map_id925}</th> <th>—</th> <th>{$map_id926}</th><th>—</th> <th>{$map_id927}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id934}</th> <th>—</th><th>{$map_id935}</th> <th>—</th> <th>{$map_id936}</th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt29()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id972 = ($in_map_id == 972) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁5层</b></button>";
    $map_id993 = ($in_map_id == 993) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>石阁5层</b></button>";
    $map_id1017 = ($in_map_id == 1017) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>石阁5层</b></button>";

    $map_id979 = ($in_map_id == 979) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id978 = ($in_map_id == 978) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id991 = ($in_map_id == 991) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id992 = ($in_map_id == 992) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id973 = ($in_map_id == 973) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id977 = ($in_map_id == 977) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id988 = ($in_map_id == 988) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id989 = ($in_map_id == 989) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id990 = ($in_map_id == 990) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id994 = ($in_map_id == 994) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id974 = ($in_map_id == 974) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id975 = ($in_map_id == 975) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id976 = ($in_map_id == 976) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id980 = ($in_map_id == 980) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id981 = ($in_map_id == 981) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id987 = ($in_map_id == 987) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id997 = ($in_map_id == 997) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id996 = ($in_map_id == 996) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id995 = ($in_map_id == 995) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id982 = ($in_map_id == 982) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id986 = ($in_map_id == 986) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id1034 = ($in_map_id == 1034) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1033 = ($in_map_id == 1033) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1032 = ($in_map_id == 1032) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id983 = ($in_map_id == 983) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id984 = ($in_map_id == 984) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id985 = ($in_map_id == 985) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id998 = ($in_map_id == 998) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id999 = ($in_map_id == 999) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1000 = ($in_map_id == 1000) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1001 = ($in_map_id == 1001) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id1035 = ($in_map_id == 1035) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1031 = ($in_map_id == 1031) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1012 = ($in_map_id == 1012) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1002 = ($in_map_id == 1002) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id1036 = ($in_map_id == 1036) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1037 = ($in_map_id == 1037) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1030 = ($in_map_id == 1030) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1011 = ($in_map_id == 1011) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1010 = ($in_map_id == 1010) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1009 = ($in_map_id == 1009) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1003 = ($in_map_id == 1003) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id1025 = ($in_map_id == 1025) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1024 = ($in_map_id == 1024) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1023 = ($in_map_id == 1023) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1013 = ($in_map_id == 1013) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1008 = ($in_map_id == 1008) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1004 = ($in_map_id == 1004) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id1026 = ($in_map_id == 1026) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1022 = ($in_map_id == 1022) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1021 = ($in_map_id == 1021) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1014 = ($in_map_id == 1014) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1015 = ($in_map_id == 1015) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1007 = ($in_map_id == 1007) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1006 = ($in_map_id == 1006) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1005 = ($in_map_id == 1005) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id1027 = ($in_map_id == 1027) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1028 = ($in_map_id == 1028) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1029 = ($in_map_id == 1029) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1020 = ($in_map_id == 1020) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1016 = ($in_map_id == 1016) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    $map_id1019 = ($in_map_id == 1019) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";
    $map_id1018 = ($in_map_id == 1018) ? "<button type= submit class= btn btn-success><b style='color:green'>石阁5层</b></button>" : "<button type= submit class= btn btn-success>石阁5层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id972}</th> <th>—</th> <th>{$map_id979}</th> <th>—</th> <th>{$map_id978}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id991}</th> <th>—</th> <th>{$map_id992}</th> <th>—</th> <th>{$map_id993}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id973}</th> <th></th> <th></th> <th></th> <th>{$map_id977}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id988}</th> <th>—</th><th>{$map_id989}</th> <th>—</th> <th>{$map_id990}</th> <th></th> <th></th> <th></th> <th>{$map_id994}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id974}</th> <th>—</th> <th>{$map_id975}</th> <th>—</th> <th>{$map_id976}</th><th>—</th> <th>{$map_id980}</th><th>—</th> <th>{$map_id981}</th><th></th> <th></th> <th></th><th>{$map_id987}</th> <th></th><th></th> <th></th> <th>{$map_id997}</th> <th>—</th> <th>{$map_id996}</th> <th>—</th> <th>{$map_id995}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id982}</th><th></th> <th></th> <th></th><th>{$map_id986}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1034}</th> <th>—</th> <th>{$map_id1033}</th> <th>—</th> <th>{$map_id1032}</th><th></th> <th></th><th></th> <th>{$map_id983}</th><th>—</th> <th>{$map_id984}</th> <th>—</th><th>{$map_id985}</th> <th>—</th><th>{$map_id998}</th> <th>—</th> <th>{$map_id999}</th> <th>—</th> <th>{$map_id1000}</th> <th>—</th> <th>{$map_id1001}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id1035}</th> <th></th> <th></th> <th></th> <th>{$map_id1031}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1012}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1002}</th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id1036}</th> <th>—</th> <th>{$map_id1037}</th> <th>—</th> <th>{$map_id1030}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1011}</th> <th>—</th><th>{$map_id1010}</th> <th>—</th> <th>{$map_id1009}</th> <th></th> <th></th> <th></th> <th>{$map_id1003}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id1025}</th><th>—</th> <th>{$map_id1024}</th><th>—</th> <th>{$map_id1023}</th><th></th> <th></th> <th></th><th>{$map_id1013}</th> <th></th><th></th> <th></th> <th>{$map_id1008}</th> <th></th> <th></th> <th></th> <th>{$map_id1004}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id1026}</th><th></th> <th></th><th></th> <th>{$map_id1022}</th><th>—</th> <th>{$map_id1021}</th> <th>—</th><th>{$map_id1014}</th> <th>—</th><th>{$map_id1015}</th> <th>—</th> <th>{$map_id1007}</th> <th>—</th> <th>{$map_id1006}</th> <th>—</th> <th>{$map_id1005}</th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id1027}</th><th>—</th> <th>{$map_id1028}</th><th>—</th> <th>{$map_id1029}</th><th></th> <th></th> <th></th><th>{$map_id1020}</th> <th></th><th></th> <th></th> <th>{$map_id1016}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1019}</th> <th>—</th><th>{$map_id1018}</th> <th>—</th> <th>{$map_id1017}</th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:blue'>蓝色</b>:表示当前的boss位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt32()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1044 = ($in_map_id == 1044) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆馆口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>道馆馆口</b></button>";

    $map_id1047 = ($in_map_id == 1047) ? "<button type= submit class= btn btn-success><b style='color:green'>书店</b></button>" : "<button type= submit class= btn btn-success>书店</button>";
    $map_id1046 = ($in_map_id == 1046) ? "<button type= submit class= btn btn-success><b style='color:green'>药店</b></button>" : "<button type= submit class= btn btn-success>药店</button>";
    $map_id1052 = ($in_map_id == 1052) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆租赁店</b></button>" : "<button type= submit class= btn btn-success>道馆租赁店</button>";
    $map_id1056 = ($in_map_id == 1056) ? "<button type= submit class= btn btn-success><b style='color:green'>棉布店</b></button>" : "<button type= submit class= btn btn-success>棉布店</button>";
    $map_id1055 = ($in_map_id == 1055) ? "<button type= submit class= btn btn-success><b style='color:green'>饰品店</b></button>" : "<button type= submit class= btn btn-success>饰品店</button>";
    $map_id1058 = ($in_map_id == 1058) ? "<button type= submit class= btn btn-success><b style='color:green'>材料商</b></button>" : "<button type= submit class= btn btn-success>材料商</button>";

    $map_id1045 = ($in_map_id == 1045) ? "<button type= submit class= btn btn-success><b style='color:green'>青石街</b></button>" : "<button type= submit class= btn btn-success>青石街</button>";
    $map_id1050 = ($in_map_id == 1050) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆广场</b></button>" : "<button type= submit class= btn btn-success>道馆广场</button>";
    $map_id1053 = ($in_map_id == 1053) ? "<button type= submit class= btn btn-success><b style='color:green'>石板桥</b></button>" : "<button type= submit class= btn btn-success>石板桥</button>";
    $map_id1054 = ($in_map_id == 1054) ? "<button type= submit class= btn btn-success><b style='color:green'>田间小路</b></button>" : "<button type= submit class= btn btn-success>田间小路</button>";
    $map_id1057 = ($in_map_id == 1057) ? "<button type= submit class= btn btn-success><b style='color:green'>杂草小路</b></button>" : "<button type= submit class= btn btn-success>杂草小路</button>";

    $map_id1048 = ($in_map_id == 1048) ? "<button type= submit class= btn btn-success><b style='color:green'>碎石路</b></button>" : "<button type= submit class= btn btn-success>碎石路</button>";
    $map_id1051 = ($in_map_id == 1051) ? "<button type= submit class= btn btn-success><b style='color:green'>杂货铺</b></button>" : "<button type= submit class= btn btn-success>杂货铺</button>";
    $map_id1059 = ($in_map_id == 1059) ? "<button type= submit class= btn btn-success><b style='color:green'>仓库</b></button>" : "<button type= submit class= btn btn-success>仓库</button>";
    $map_id1060 = ($in_map_id == 1060) ? "<button type= submit class= btn btn-success><b style='color:green'>肉店</b></button>" : "<button type= submit class= btn btn-success>肉店</button>";
    $map_id1049 = ($in_map_id == 1049) ? "<button type= submit class= btn btn-success><b style='color:green'>打铁铺</b></button>" : "<button type= submit class= btn btn-success>打铁铺</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1047}</th> <th>—</th> <th>{$map_id1046}</th> <th></th> <th>{$map_id1052}</th><th></th> <th>{$map_id1056}</th><th>—</th> <th>{$map_id1055}</th><th></th> <th>{$map_id1058}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id1044}</th> <th>—</th> <th>{$map_id1045}</th> <th>—</th> <th>{$map_id1050}</th><th>—</th> <th>{$map_id1053}</th><th>—</th> <th>{$map_id1054}</th><th>—</th> <th>{$map_id1057}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id1048}</th> <th></th> <th>{$map_id1051}</th><th></th> <th></th><th></th> <th>{$map_id1059}</th><th></th> <th>{$map_id1060}</th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id1049}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt33()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1105 = ($in_map_id == 1105) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>道馆郊外</b></button>";
    $map_id1121 = ($in_map_id == 1121) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>道馆郊外</b></button>";
    $map_id1092 = ($in_map_id == 1092) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>道馆郊外</b></button>";
    $map_id1061 = ($in_map_id == 1061) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>道馆郊外</b></button>";
    $map_id1071 = ($in_map_id == 1071) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>道馆郊外</b></button>";
    
    $map_id1070 = ($in_map_id == 1070) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1069 = ($in_map_id == 1069) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1106 = ($in_map_id == 1106) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1104 = ($in_map_id == 1104) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1103 = ($in_map_id == 1103) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1073 = ($in_map_id == 1073) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1072 = ($in_map_id == 1072) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1068 = ($in_map_id == 1068) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1131 = ($in_map_id == 1131) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1132 = ($in_map_id == 1132) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1107 = ($in_map_id == 1107) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1102 = ($in_map_id == 1102) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1074 = ($in_map_id == 1074) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1066 = ($in_map_id == 1066) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1067 = ($in_map_id == 1067) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1130 = ($in_map_id == 1130) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1108 = ($in_map_id == 1108) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1101 = ($in_map_id == 1101) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1075 = ($in_map_id == 1075) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1065 = ($in_map_id == 1065) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1129 = ($in_map_id == 1129) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1109 = ($in_map_id == 1109) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1136 = ($in_map_id == 1136) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1100 = ($in_map_id == 1100) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1076 = ($in_map_id == 1076) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1077 = ($in_map_id == 1077) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1064 = ($in_map_id == 1064) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1128 = ($in_map_id == 1128) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1098 = ($in_map_id == 1098) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1099 = ($in_map_id == 1099) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1078 = ($in_map_id == 1078) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1063 = ($in_map_id == 1063) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1127 = ($in_map_id == 1127) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1112 = ($in_map_id == 1112) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1111 = ($in_map_id == 1111) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1097 = ($in_map_id == 1097) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1079 = ($in_map_id == 1079) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1080 = ($in_map_id == 1080) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1062 = ($in_map_id == 1062) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1126 = ($in_map_id == 1126) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1113 = ($in_map_id == 1113) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1096 = ($in_map_id == 1096) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1081 = ($in_map_id == 1081) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1085 = ($in_map_id == 1085) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1124 = ($in_map_id == 1124) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1125 = ($in_map_id == 1125) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1114 = ($in_map_id == 1114) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1095 = ($in_map_id == 1095) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1094 = ($in_map_id == 1094) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1082 = ($in_map_id == 1082) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1083 = ($in_map_id == 1083) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1084 = ($in_map_id == 1084) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1086 = ($in_map_id == 1086) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1123 = ($in_map_id == 1123) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1115 = ($in_map_id == 1115) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1116 = ($in_map_id == 1116) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1117 = ($in_map_id == 1117) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1093 = ($in_map_id == 1093) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1087 = ($in_map_id == 1087) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1122 = ($in_map_id == 1122) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1118 = ($in_map_id == 1118) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1091 = ($in_map_id == 1091) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1090 = ($in_map_id == 1090) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1089 = ($in_map_id == 1089) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1088 = ($in_map_id == 1088) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    $map_id1120 = ($in_map_id == 1120) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";
    $map_id1119 = ($in_map_id == 1119) ? "<button type= submit class= btn btn-success><b style='color:green'>道馆郊外</b></button>" : "<button type= submit class= btn btn-success>道馆郊外</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id1105}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1071}</th> <th>—</th> <th>{$map_id1070}</th> <th>—</th> <th>{$map_id1069}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th>{$map_id1106}</th><th>—</th> <th>{$map_id1104}</th><th>—</th> <th>{$map_id1103}</th><th></th> <th></th> <th></th><th>{$map_id1073}</th> <th>—</th><th>{$map_id1072}</th> <th></th> <th></th> <th></th> <th>{$map_id1068}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1131}</th> <th>—</th> <th>{$map_id1132}</th> <th>—</th> <th>{$map_id1107}</th><th></th> <th></th><th></th> <th>{$map_id1102}</th><th></th> <th></th> <th></th><th>{$map_id1074}</th> <th></th><th></th> <th></th> <th>{$map_id1066}</th> <th>—</th> <th>{$map_id1067}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1130}</th> <th></th> <th></th> <th></th> <th>{$map_id1108}</th><th></th> <th></th><th></th> <th>{$map_id1101}</th><th></th> <th></th> <th></th><th>{$map_id1075}</th> <th></th><th></th> <th></th> <th>{$map_id1065}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1129}</th> <th></th> <th></th> <th></th> <th>{$map_id1109}</th><th>—</th> <th>{$map_id1136}</th><th></th> <th>{$map_id1100}</th><th></th> <th></th> <th></th><th>{$map_id1076}</th> <th>—</th><th>{$map_id1077}</th> <th>—</th> <th>{$map_id1064}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1128}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1098}</th><th>—</th> <th>{$map_id1099}</th> <th>—</th><th>{$map_id1078}</th> <th></th><th></th> <th></th> <th>{$map_id1063}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1127}</th> <th></th> <th></th> <th></th> <th>{$map_id1112}</th><th>—</th> <th>{$map_id1111}</th><th>—</th> <th>{$map_id1097}</th><th></th> <th></th> <th></th><th>{$map_id1079}</th> <th>—</th><th>{$map_id1080}</th> <th>—</th> <th>{$map_id1062}</th> <th>—</th> <th>{$map_id1061}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1126}</th> <th></th> <th></th> <th></th> <th>{$map_id1113}</th><th></th> <th></th><th></th> <th>{$map_id1096}</th><th></th> <th></th> <th></th><th>{$map_id1081}</th> <th></th><th></th> <th></th> <th>{$map_id1085}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1124}</th> <th>—</th> <th>{$map_id1125}</th> <th>—</th> <th>{$map_id1114}</th><th></th> <th></th><th></th> <th>{$map_id1095}</th><th>—</th> <th>{$map_id1094}</th> <th>—</th><th>{$map_id1082}</th> <th>—</th><th>{$map_id1083}</th> <th>—</th> <th>{$map_id1084}</th> <th>—</th> <th>{$map_id1086}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1123}</th> <th></th> <th></th> <th></th> <th>{$map_id1115}</th><th>—</th> <th>{$map_id1116}</th><th>—</th> <th>{$map_id1117}</th><th></th> <th></th> <th></th><th>{$map_id1093}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1087}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1122}</th> <th></th> <th></th> <th></th> <th>{$map_id1118}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1091}</th> <th>—</th><th>{$map_id1090}</th> <th>—</th> <th>{$map_id1089}</th> <th>—</th> <th>{$map_id1088}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1121}</th> <th>—</th> <th>{$map_id1120}</th> <th></th> <th>{$map_id1119}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1092}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt34()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1145 = ($in_map_id == 1145) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿入口</b></button>";
    $map_id1149 = ($in_map_id == 1149) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿入口</b></button>";
    $map_id1137 = ($in_map_id == 1137) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿入口</b></button>";
    $map_id1141 = ($in_map_id == 1141) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿入口</b></button>";

    $map_id1147 = ($in_map_id == 1147) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1146 = ($in_map_id == 1146) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1144 = ($in_map_id == 1144) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1143 = ($in_map_id == 1143) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";

    $map_id1148 = ($in_map_id == 1148) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1155 = ($in_map_id == 1155) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1142 = ($in_map_id == 1142) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";

    $map_id1156 = ($in_map_id == 1156) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1154 = ($in_map_id == 1154) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1157 = ($in_map_id == 1157) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";

    $map_id1150 = ($in_map_id == 1150) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1153 = ($in_map_id == 1153) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1140 = ($in_map_id == 1140) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";

    $map_id1151 = ($in_map_id == 1151) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1152 = ($in_map_id == 1152) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1138 = ($in_map_id == 1138) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";
    $map_id1139 = ($in_map_id == 1139) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿入口</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿入口</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1147}</th> <th>—</th> <th>{$map_id1146}</th> <th>—</th> <th>{$map_id1145}</th><th>—</th> <th>{$map_id1144}</th><th>—</th> <th>{$map_id1143}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1148}</th> <th></th> <th></th> <th></th> <th>{$map_id1155}</th><th></th> <th></th><th></th> <th>{$map_id1142}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1149}</th> <th>—</th> <th>{$map_id1156}</th> <th>—</th> <th>{$map_id1154}</th><th>—</th> <th>{$map_id1157}</th><th>—</th> <th>{$map_id1141}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1150}</th> <th></th> <th></th> <th></th> <th>{$map_id1153}</th><th></th> <th></th><th></th> <th>{$map_id1140}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1151}</th> <th>—</th> <th>{$map_id1152}</th> <th>—</th> <th>{$map_id1137}</th><th>—</th> <th>{$map_id1138}</th><th>—</th> <th>{$map_id1139}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt35()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1182 = ($in_map_id == 1182) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿1层</b></button>";
    $map_id1216 = ($in_map_id == 1216) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿1层</b></button>";

    $map_id1158 = ($in_map_id == 1158) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1161 = ($in_map_id == 1161) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1162 = ($in_map_id == 1162) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1163 = ($in_map_id == 1163) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1189 = ($in_map_id == 1189) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1190 = ($in_map_id == 1190) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1191 = ($in_map_id == 1191) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1192 = ($in_map_id == 1192) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1193 = ($in_map_id == 1193) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1159 = ($in_map_id == 1159) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1164 = ($in_map_id == 1164) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1���</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1188 = ($in_map_id == 1188) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1194 = ($in_map_id == 1194) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1160 = ($in_map_id == 1160) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1165 = ($in_map_id == 1165) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1186 = ($in_map_id == 1186) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1187 = ($in_map_id == 1187) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1195 = ($in_map_id == 1195) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1170 = ($in_map_id == 1170) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1166 = ($in_map_id == 1166) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1199 = ($in_map_id == 1199) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1197 = ($in_map_id == 1197) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1196 = ($in_map_id == 1196) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1200 = ($in_map_id == 1200) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1169 = ($in_map_id == 1169) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1168 = ($in_map_id == 1168) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1167 = ($in_map_id == 1167) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1171 = ($in_map_id == 1171) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1172 = ($in_map_id == 1172) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1198 = ($in_map_id == 1198) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1201 = ($in_map_id == 1201) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1231 = ($in_map_id == 1231) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1173 = ($in_map_id == 1173) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1202 = ($in_map_id == 1202) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1230 = ($in_map_id == 1230) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1232 = ($in_map_id == 1232) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1184 = ($in_map_id == 1184) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1185 = ($in_map_id == 1185) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1174 = ($in_map_id == 1174) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1175 = ($in_map_id == 1175) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1176 = ($in_map_id == 1176) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1203 = ($in_map_id == 1203) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1229 = ($in_map_id == 1229) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1183 = ($in_map_id == 1183) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1178 = ($in_map_id == 1178) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1177 = ($in_map_id == 1177) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1204 = ($in_map_id == 1204) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1228 = ($in_map_id == 1228) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1181 = ($in_map_id == 1181) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1180 = ($in_map_id == 1180) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1179 = ($in_map_id == 1179) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1205 = ($in_map_id == 1205) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1227 = ($in_map_id == 1227) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1211 = ($in_map_id == 1211) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1206 = ($in_map_id == 1206) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1226 = ($in_map_id == 1226) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1225 = ($in_map_id == 1225) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1224 = ($in_map_id == 1224) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1222 = ($in_map_id == 1222) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1223 = ($in_map_id == 1223) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1212 = ($in_map_id == 1212) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1210 = ($in_map_id == 1210) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1209 = ($in_map_id == 1209) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1207 = ($in_map_id == 1207) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1233 = ($in_map_id == 1233) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1221 = ($in_map_id == 1221) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1213 = ($in_map_id == 1213) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1208 = ($in_map_id == 1208) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1234 = ($in_map_id == 1234) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1235 = ($in_map_id == 1235) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1236 = ($in_map_id == 1236) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1220 = ($in_map_id == 1220) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1219 = ($in_map_id == 1219) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1218 = ($in_map_id == 1218) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1217 = ($in_map_id == 1217) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";
    $map_id1214 = ($in_map_id == 1214) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    $map_id1215 = ($in_map_id == 1215) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿1层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1158}</th> <th>—</th> <th>{$map_id1161}</th> <th>—</th> <th>{$map_id1162}</th><th>—</th> <th>{$map_id1163}</th><th></th> <th></th><th></th> <th>{$map_id1189}</th> <th>—</th><th>{$map_id1190}</th> <th>—</th><th>{$map_id1191}</th> <th>—</th> <th>{$map_id1192}</th> <th>—</th> <th>{$map_id1193}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1159}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id1164}</th><th></th> <th></th><th></th> <th>{$map_id1188}</th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id1194}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1160}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id1165}</th><th>—</th> <th>{$map_id1186}</th><th>—</th> <th>{$map_id1187}</th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id1195}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id1170}</th> <th></th> <th></th><th></th> <th>{$map_id1166}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1199}</th> <th>—</th><th>{$map_id1197}</th> <th>—</th> <th>{$map_id1196}</th> <th>—</th> <th>{$map_id1200}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th>{$map_id1169}</th> <th>—</th> <th>{$map_id1168}</th><th>—</th> <th>{$map_id1167}</th><th>—</th> <th>{$map_id1171}</th><th>—</th> <th>{$map_id1172}</th> <th></th><th></th> <th></th><th>{$map_id1198}</th> <th></th> <th></th> <th></th> <th>{$map_id1201}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1231}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1173}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1202}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1230}</th> <th>—</th> <th>{$map_id1232}</th> <th></th> <th></th><th></th> <th>{$map_id1184}</th><th>—</th> <th>{$map_id1185}</th><th>—</th> <th>{$map_id1174}</th> <th>—</th><th>{$map_id1175}</th> <th>—</th><th>{$map_id1176}</th> <th></th> <th></th> <th></th> <th>{$map_id1203}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1229}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id1183}</th><th></th> <th></th><th></th> <th>{$map_id1178}</th> <th></th><th></th> <th></th><th>{$map_id1177}</th> <th></th> <th></th> <th></th> <th>{$map_id1204}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1228}</th> <th></th> <th></th> <th></th> <th>{$map_id1182}</th><th>—</th> <th>{$map_id1181}</th><th>—</th> <th>{$map_id1180}</th><th>—</th> <th>{$map_id1179}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1205}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1227}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1211}</th> <th></th> <th></th> <th></th> <th>{$map_id1206}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1226}</th> <th>—</th> <th>{$map_id1225}</th> <th>—</th> <th>{$map_id1224}</th><th>—</th> <th>{$map_id1222}</th><th>—</th> <th>{$map_id1223}</th><th></th> <th></th> <th></th><th>{$map_id1212}</th> <th>—</th><th>{$map_id1210}</th> <th>—</th> <th>{$map_id1209}</th> <th>—</th> <th>{$map_id1207}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1233}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id1221}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1213}</th> <th></th> <th></th> <th></th> <th>{$map_id1208}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1234}</th> <th>—</th> <th>{$map_id1235}</th> <th>—</th> <th>{$map_id1236}</th><th>—</th> <th>{$map_id1220}</th><th>—</th> <th>{$map_id1219}</th><th>—</th> <th>{$map_id1218}</th> <th>—</th><th>{$map_id1217}</th> <th>—</th><th>{$map_id1214}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1215}</th> <th>—</th> <th>{$map_id1216}</th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt36()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1279 = ($in_map_id == 1279) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿2层</b></button>";
    $map_id1330 = ($in_map_id == 1330) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿2层</b></button>";

    $map_id1237 = ($in_map_id == 1237) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1242 = ($in_map_id == 1242) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1243 = ($in_map_id == 1243) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1244 = ($in_map_id == 1244) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1245 = ($in_map_id == 1245) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1251 = ($in_map_id == 1251) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1252 = ($in_map_id == 1252) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1253 = ($in_map_id == 1253) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1254 = ($in_map_id == 1254) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1255 = ($in_map_id == 1255) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    
    $map_id1238 = ($in_map_id == 1238) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1240 = ($in_map_id == 1240) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1241 = ($in_map_id == 1241) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1246 = ($in_map_id == 1246) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1250 = ($in_map_id == 1250) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1256 = ($in_map_id == 1256) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1313 = ($in_map_id == 1313) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1247 = ($in_map_id == 1247) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1248 = ($in_map_id == 1248) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1249 = ($in_map_id == 1249) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1257 = ($in_map_id == 1257) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1257 = ($in_map_id == 1257) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1239 = ($in_map_id == 1239) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1312 = ($in_map_id == 1312) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1311 = ($in_map_id == 1311) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1310 = ($in_map_id == 1310) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1268 = ($in_map_id == 1268) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1267 = ($in_map_id == 1267) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1258 = ($in_map_id == 1258) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1259 = ($in_map_id == 1259) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1314 = ($in_map_id == 1314) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1309 = ($in_map_id == 1309) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1270 = ($in_map_id == 1270) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1269 = ($in_map_id == 1269) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1260 = ($in_map_id == 1260) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1315 = ($in_map_id == 1315) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1307 = ($in_map_id == 1307) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1308 = ($in_map_id == 1308) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1272 = ($in_map_id == 1272) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1271 = ($in_map_id == 1271) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1262 = ($in_map_id == 1262) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1261 = ($in_map_id == 1261) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1316 = ($in_map_id == 1316) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1306 = ($in_map_id == 1306) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1273 = ($in_map_id == 1273) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1264 = ($in_map_id == 1264) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1263 = ($in_map_id == 1263) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1318 = ($in_map_id == 1318) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1317 = ($in_map_id == 1317) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1319 = ($in_map_id == 1319) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1305 = ($in_map_id == 1305) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1304 = ($in_map_id == 1304) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1274 = ($in_map_id == 1274) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1281 = ($in_map_id == 1281) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1280 = ($in_map_id == 1280) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1265 = ($in_map_id == 1265) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1266 = ($in_map_id == 1266) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1320 = ($in_map_id == 1320) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1321 = ($in_map_id == 1321) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1303 = ($in_map_id == 1303) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1275 = ($in_map_id == 1275) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
  
    $map_id1322 = ($in_map_id == 1322) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1323 = ($in_map_id == 1323) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1302 = ($in_map_id == 1302) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1276 = ($in_map_id == 1276) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1277 = ($in_map_id == 1277) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1278 = ($in_map_id == 1278) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1288 = ($in_map_id == 1288) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1289 = ($in_map_id == 1289) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1324 = ($in_map_id == 1324) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1301 = ($in_map_id == 1301) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1282 = ($in_map_id == 1282) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1287 = ($in_map_id == 1287) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1331 = ($in_map_id == 1331) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1332 = ($in_map_id == 1332) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1325 = ($in_map_id == 1325) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1299 = ($in_map_id == 1299) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1300 = ($in_map_id == 1300) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1283 = ($in_map_id == 1283) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1284 = ($in_map_id == 1284) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1285 = ($in_map_id == 1285) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1286 = ($in_map_id == 1286) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1326 = ($in_map_id == 1326) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1298 = ($in_map_id == 1298) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1293 = ($in_map_id == 1293) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1290 = ($in_map_id == 1290) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    $map_id1329 = ($in_map_id == 1329) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1328 = ($in_map_id == 1328) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1327 = ($in_map_id == 1327) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1297 = ($in_map_id == 1297) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1296 = ($in_map_id == 1296) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1295 = ($in_map_id == 1295) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1294 = ($in_map_id == 1294) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1291 = ($in_map_id == 1291) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";
    $map_id1292 = ($in_map_id == 1292) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿2层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>   <th>{$map_id1237}</th><th></th> <th></th><th></th><th>{$map_id1242}</th><th>—</th> <th>{$map_id1243}</th><th>—</th> <th>{$map_id1244}</th><th>—</th> <th>{$map_id1245}</th> <th></th><th></th> <th></th><th>{$map_id1251}</th> <th>—</th> <th>{$map_id1252}</th> <th>—</th> <th>{$map_id1253}</th> <th>—</th> <th>{$map_id1254}</th> <th>—</th> <th>{$map_id1255}</th> </tr>
    <tr>   <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td><td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1238}</th><th>—</th><th>{$map_id1240}</th><th>—</th><th>{$map_id1241}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1246}</th> <th></th><th></th> <th></th><th>{$map_id1250}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1256}</th> <th></th> <th></th> </tr>
    <tr>   <td>|</td><td></td><td></td><td></td><td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1239}</th><th></th><th></th><th></th><th>{$map_id1313}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1247}</th> <th>—</th><th>{$map_id1248}</th> <th>—</th><th>{$map_id1249}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1257}</th> <th></th> <th></th> </tr>
    <tr>   <td></td><td></td><td></td><td></td><td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th></th><th></th><th></th><th></th><th>{$map_id1312}</th><th>—</th> <th>{$map_id1311}</th><th>—</th> <th>{$map_id1310}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id1268}</th> <th>—</th> <th>{$map_id1267}</th> <th>—</th> <th>{$map_id1258}</th> <th>—</th> <th>{$map_id1259}</th> </tr>
    <tr>   <td></td> <td></td><td></td> <td></td><td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>    <th></th><th></th><th>{$map_id1315}</th><th>—</th><th>{$map_id1314}</th><th></th> <th></th><th></th> <th>{$map_id1309}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1270}</th> <th>—</th> <th>{$map_id1269}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1260}</th> </tr>
    <tr>   <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>   <th></th><th></th><th>{$map_id1316}</th><th></th><th></th><th></th> <th>{$map_id1307}</th><th>—</th> <th>{$map_id1308}</th><th></th> <th></th> <th></th><th>{$map_id1272}</th> <th>—</th><th>{$map_id1271}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1262}</th> <th>—</th> <th>{$map_id1261}</th> </tr>
    <tr>   <td></td><td></td> <td>|</td><td></td>  <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1318}</th><th>—</th> <th>{$map_id1317}</th><th></th><th></th><th></th> <th>{$map_id1306}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1273}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1264}</th> <th>—</th> <th>{$map_id1263}</th> <th></th> <th></th> </tr>
    <tr>   <td>|</td><td></td> <td></td><td></td><td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1319}</th><th></th> <th></th><th></th> <th></th><th></th><th>{$map_id1305}</th><th>—</th> <th>{$map_id1304}</th><th></th> <th></th> <th></th><th>{$map_id1274}</th> <th>—</th><th>{$map_id1281}</th> <th>—</th> <th>{$map_id1280}</th> <th></th> <th></th> <th></th> <th>{$map_id1265}</th> <th>—</th> <th>{$map_id1266}</th> </tr>
    <tr>   <td>|</td><td></td> <td></td><td></td><td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1320}</th><th>—</th> <th>{$map_id1321}</th><th></th> <th></th><th></th><th></th><th></th> <th>{$map_id1303}</th><th></th> <th></th> <th></th><th>{$map_id1275}</th> <th></th><th></th> <th></th> <th>{$map_id1279}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>   <td></td><td></td> <td>|</td><td></td><td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>   <th></th><th></th> <th>{$map_id1322}</th><th>—</th> <th>{$map_id1323}</th><th></th><th></th><th></th> <th>{$map_id1302}</th><th></th> <th></th> <th></th><th>{$map_id1276}</th> <th>—</th><th>{$map_id1277}</th> <th>—</th> <th>{$map_id1278}</th> <th></th> <th></th> <th></th> <th>{$map_id1288}</th> <th>—</th> <th>{$map_id1289}</th> </tr>
    <tr>   <td></td><td></td> <td></td><td></td><td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th></th><th></th> <th></th><th></th> <th>{$map_id1324}</th><th></th><th></th><th></th> <th>{$map_id1301}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1282}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1287}</th> <th></th> <th></th> </tr>
    <tr>   <td></td><td></td> <td></td><td></td><td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1331}</th><th>—</th> <th>{$map_id1332}</th><th>—</th> <th>{$map_id1325}</th><th></th><th></th><th></th> <th>{$map_id1299}</th><th>—</th> <th>{$map_id1300}</th> <th></th><th></th> <th></th><th>{$map_id1283}</th> <th>—</th> <th>{$map_id1284}</th> <th>—</th> <th>{$map_id1285}</th> <th>—</th> <th>{$map_id1286}</th> <th></th> <th></th> </tr>
    <tr>   <td>|</td><td></td> <td></td><td></td><td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1330}</th><th></th> <th></th><th></th> <th>{$map_id1326}</th><th></th><th></th><th></th> <th>{$map_id1298}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1293}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1290}</th> <th></th> <th></th> </tr>
    <tr>   <td>|</td><td></td> <td></td><td></td><td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>   <th>{$map_id1329}</th><th>—</th> <th>{$map_id1328}</th><th>—</th> <th>{$map_id1327}</th><th></th><th></th><th></th> <th>{$map_id1297}</th><th>—</th> <th>{$map_id1296}</th> <th>—</th><th>{$map_id1295}</th> <th>—</th><th>{$map_id1294}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id1291}</th> <th>—</th> <th>{$map_id1292}</th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!";
}

function dt37()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1333 = ($in_map_id == 1333) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>沃玛神殿</b></button>";
    $map_id1342 = ($in_map_id == 1342) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>沃玛神殿</b></button>";
    $map_id1338 = ($in_map_id == 1338) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>沃玛神殿</b></button>";

    $map_id1344 = ($in_map_id == 1344) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1343 = ($in_map_id == 1343) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";

    $map_id1345 = ($in_map_id == 1345) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1341 = ($in_map_id == 1341) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1339 = ($in_map_id == 1339) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";

    $map_id1334 = ($in_map_id == 1334) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1335 = ($in_map_id == 1335) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1336 = ($in_map_id == 1336) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1337 = ($in_map_id == 1337) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";

    $map_id1346 = ($in_map_id == 1346) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1350 = ($in_map_id == 1350) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1340 = ($in_map_id == 1340) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";

    $map_id1347 = ($in_map_id == 1347) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1348 = ($in_map_id == 1348) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";
    $map_id1349 = ($in_map_id == 1349) ? "<button type= submit class= btn btn-success><b style='color:green'>沃玛神殿</b></button>" : "<button type= submit class= btn btn-success>沃玛神殿</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th><th>{$map_id1344}</th> <th>—</th> <th>{$map_id1343}</th> <th>—</th> <th>{$map_id1342}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1345}</th> <th></th> <th></th> <th></th> <th>{$map_id1341}</th><th></th> <th></th><th></th> <th>{$map_id1339}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
  
    <tr>  <th>{$map_id1333}</th> <th>—</th><th>{$map_id1334}</th> <th>—</th> <th>{$map_id1335}</th> <th>—</th> <th>{$map_id1336}</th><th>—</th> <th>{$map_id1337}</th><th>—</th> <th>{$map_id1338}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
    
    <tr>  <th></th> <th></th><th>{$map_id1346}</th> <th></th> <th></th> <th></th> <th>{$map_id1350}</th><th></th> <th></th><th></th> <th>{$map_id1340}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
    
    <tr>  <th></th> <th></th><th>{$map_id1347}</th> <th>—</th> <th>{$map_id1348}</th> <th>—</th> <th>{$map_id1349}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
    echo "<b style='color:blue'>蓝色</b>:表示当前BOSS的位置!";
}

function dt38()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1431 = ($in_map_id == 1431) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿（野外）</b></button>";
    $map_id1417 = ($in_map_id == 1417) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿（野外）</b></button>";
    $map_id1386 = ($in_map_id == 1386) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿（野外）</b></button>";

    $map_id1376 = ($in_map_id == 1376) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1375 = ($in_map_id == 1375) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1373 = ($in_map_id == 1373) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1368 = ($in_map_id == 1368) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1430 = ($in_map_id == 1430) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1377 = ($in_map_id == 1377) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1372 = ($in_map_id == 1372) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1371 = ($in_map_id == 1371) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1370 = ($in_map_id == 1370) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1369 = ($in_map_id == 1369) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1432 = ($in_map_id == 1432) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1429 = ($in_map_id == 1429) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1428 = ($in_map_id == 1428) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1378 = ($in_map_id == 1378) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1379 = ($in_map_id == 1379) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1380 = ($in_map_id == 1380) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1381 = ($in_map_id == 1381) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1433 = ($in_map_id == 1433) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1427 = ($in_map_id == 1427) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1382 = ($in_map_id == 1382) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1434 = ($in_map_id == 1434) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1425 = ($in_map_id == 1425) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1426 = ($in_map_id == 1426) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1408 = ($in_map_id == 1408) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1407 = ($in_map_id == 1407) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1406 = ($in_map_id == 1406) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1383 = ($in_map_id == 1383) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1384 = ($in_map_id == 1384) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1385 = ($in_map_id == 1385) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1424 = ($in_map_id == 1424) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛���殿（野外）</button>";
    $map_id1409 = ($in_map_id == 1409) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1404 = ($in_map_id == 1404) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1405 = ($in_map_id == 1405) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1390 = ($in_map_id == 1390) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1422 = ($in_map_id == 1422) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1423 = ($in_map_id == 1423) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1410 = ($in_map_id == 1410) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1403 = ($in_map_id == 1403) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1389 = ($in_map_id == 1389) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1388 = ($in_map_id == 1388) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1387 = ($in_map_id == 1387) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1421 = ($in_map_id == 1421) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1411 = ($in_map_id == 1411) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1402 = ($in_map_id == 1402) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1391 = ($in_map_id == 1391) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1420 = ($in_map_id == 1420) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1414 = ($in_map_id == 1414) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1413 = ($in_map_id == 1413) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1412 = ($in_map_id == 1412) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1399 = ($in_map_id == 1399) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1400 = ($in_map_id == 1400) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1401 = ($in_map_id == 1401) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1392 = ($in_map_id == 1392) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1415 = ($in_map_id == 1415) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1398 = ($in_map_id == 1398) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1393 = ($in_map_id == 1393) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    $map_id1416 = ($in_map_id == 1416) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1418 = ($in_map_id == 1418) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1419 = ($in_map_id == 1419) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1397 = ($in_map_id == 1397) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1396 = ($in_map_id == 1396) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1395 = ($in_map_id == 1401) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";
    $map_id1394 = ($in_map_id == 1394) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿（野外）</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿（野外）</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th><th>{$map_id1431}</th> <th></th> <th></th> <th></th> <th>{$map_id1376}</th><th>—</th> <th>{$map_id1375}</th><th>—</th> <th>{$map_id1373}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1368}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1430}</th> <th></th> <th></th> <th></th> <th>{$map_id1377}</th><th></th> <th></th><th></th> <th>{$map_id1372}</th><th>—</th> <th>{$map_id1371}</th> <th>—</th><th>{$map_id1370}</th> <th>—</th><th>{$map_id1369}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1432}</th> <th>—</th><th>{$map_id1429}</th> <th>—</th> <th>{$map_id1428}</th> <th>—</th> <th>{$map_id1378}</th><th>—</th> <th>{$map_id1379}</th><th>—</th> <th>{$map_id1380}</th><th></th> <th></th> <th></th><th>{$map_id1381}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1433}</th> <th></th><th></th> <th></th> <th>{$map_id1427}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1382}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1434}</th> <th>—</th><th>{$map_id1425}</th> <th>—</th> <th>{$map_id1426}</th> <th>—</th> <th>{$map_id1408}</th><th>—</th> <th>{$map_id1407}</th><th>—</th> <th>{$map_id1406}</th><th></th> <th></th> <th></th><th>{$map_id1383}</th> <th>—</th><th>{$map_id1384}</th> <th>—</th> <th>{$map_id1385}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1424}</th> <th></th> <th></th> <th></th> <th>{$map_id1409}</th><th></th> <th></th><th></th> <th>{$map_id1404}</th><th>—</th> <th>{$map_id1405}</th> <th>—</th><th>{$map_id1390}</th> <th></th><th></th> <th></th> <th>{$map_id1386}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1422}</th> <th>—</th><th>{$map_id1423}</th> <th></th> <th></th> <th></th> <th>{$map_id1410}</th><th></th> <th></th><th></th> <th>{$map_id1403}</th><th></th> <th></th> <th></th><th>{$map_id1389}</th> <th>—</th><th>{$map_id1388}</th> <th>—</th> <th>{$map_id1387}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1421}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1411}</th><th></th> <th></th><th></th> <th>{$map_id1402}</th><th></th> <th></th> <th></th><th>{$map_id1391}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1420}</th> <th>—</th><th>{$map_id1414}</th> <th>—</th> <th>{$map_id1413}</th> <th>—</th> <th>{$map_id1412}</th><th>—</th> <th>{$map_id1399}</th><th>—</th> <th>{$map_id1400}</th><th>—</th> <th>{$map_id1401}</th> <th>—</th><th>{$map_id1392}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1415}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id1398}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1393}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1417}</th> <th>—</th><th>{$map_id1416}</th> <th>—</th> <th>{$map_id1418}</th> <th>—</th> <th>{$map_id1419}</th><th>—</th> <th>{$map_id1397}</th><th>—</th> <th>{$map_id1396}</th><th>—</th> <th>{$map_id1395}</th> <th>—</th><th>{$map_id1394}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt39()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1440 = ($in_map_id == 1440) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿1层</b></button>";
    $map_id1504 = ($in_map_id == 1504) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿1层</b></button>";

    $map_id1435 = ($in_map_id == 1435) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1460 = ($in_map_id == 1460) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1461 = ($in_map_id == 1461) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1467 = ($in_map_id == 1467) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1466 = ($in_map_id == 1466) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1496 = ($in_map_id == 1496) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1495 = ($in_map_id == 1495) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1436 = ($in_map_id == 1436) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1462 = ($in_map_id == 1462) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1465 = ($in_map_id == 1465) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1494 = ($in_map_id == 1494) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1497 = ($in_map_id == 1497) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1498 = ($in_map_id == 1498) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1437 = ($in_map_id == 1437) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1459 = ($in_map_id == 1459) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1458 = ($in_map_id == 1458) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1463 = ($in_map_id == 1463) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1464 = ($in_map_id == 1464) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1493 = ($in_map_id == 1493) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1492 = ($in_map_id == 1492) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1499 = ($in_map_id == 1499) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1438 = ($in_map_id == 1438) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1457 = ($in_map_id == 1457) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1468 = ($in_map_id == 1468) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1491 = ($in_map_id == 1491) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1501 = ($in_map_id == 1501) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1500 = ($in_map_id == 1500) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1439 = ($in_map_id == 1439) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1456 = ($in_map_id == 1456) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1455 = ($in_map_id == 1455) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1470 = ($in_map_id == 1470) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1469 = ($in_map_id == 1469) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1490 = ($in_map_id == 1490) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1489 = ($in_map_id == 1489) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1502 = ($in_map_id == 1502) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1454 = ($in_map_id == 1454) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1471 = ($in_map_id == 1471) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1488 = ($in_map_id == 1488) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1503 = ($in_map_id == 1503) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1441 = ($in_map_id == 1441) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1452 = ($in_map_id == 1452) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1453 = ($in_map_id == 1453) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1473 = ($in_map_id == 1473) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1472 = ($in_map_id == 1472) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1487 = ($in_map_id == 1487) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1486 = ($in_map_id == 1486) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1505 = ($in_map_id == 1505) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1442 = ($in_map_id == 1442) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1450 = ($in_map_id == 1450) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1474 = ($in_map_id == 1474) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1485 = ($in_map_id == 1485) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1507 = ($in_map_id == 1507) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1506 = ($in_map_id == 1506) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1443 = ($in_map_id == 1443) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1451 = ($in_map_id == 1451) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1449 = ($in_map_id == 1449) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1476 = ($in_map_id == 1476) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1475 = ($in_map_id == 1475) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1484 = ($in_map_id == 1484) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1483 = ($in_map_id == 1483) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1508 = ($in_map_id == 1508) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1444 = ($in_map_id == 1444) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1448 = ($in_map_id == 1448) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1477 = ($in_map_id == 1477) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1482 = ($in_map_id == 1482) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1510 = ($in_map_id == 1510) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1509 = ($in_map_id == 1509) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    $map_id1445 = ($in_map_id == 1445) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1446 = ($in_map_id == 1446) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1447 = ($in_map_id == 1447) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1479 = ($in_map_id == 1479) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1478 = ($in_map_id == 1478) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1480 = ($in_map_id == 1480) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";
    $map_id1481 = ($in_map_id == 1481) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿1层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿1层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1435}</th> <th>—</th><th>{$map_id1460}</th> <th>—</th> <th>{$map_id1461}</th> <th>—</th> <th>{$map_id1467}</th><th>—</th> <th>{$map_id1466}</th><th>—</th> <th>{$map_id1496}</th><th>—</th> <th>{$map_id1495}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1436}</th> <th></th><th></th> <th></th> <th>{$map_id1462}</th> <th></th> <th></th><th></th> <th>{$map_id1465}</th><th></th> <th></th><th></th> <th>{$map_id1494}</th> <th>—</th><th>{$map_id1497}</th> <th>—</th><th>{$map_id1498}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1437}</th> <th>—</th><th>{$map_id1459}</th> <th>—</th> <th>{$map_id1458}</th> <th>—</th> <th>{$map_id1463}</th><th>—</th> <th>{$map_id1464}</th><th>—</th> <th>{$map_id1493}</th><th>—</th> <th>{$map_id1492}</th> <th></th><th></th> <th></th><th>{$map_id1499}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1438}</th> <th></th><th></th> <th></th> <th>{$map_id1457}</th> <th></th> <th></th><th></th> <th>{$map_id1468}</th><th></th> <th></th><th></th> <th>{$map_id1491}</th> <th>—</th><th>{$map_id1501}</th> <th>—</th><th>{$map_id1500}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1439}</th> <th>—</th><th>{$map_id1456}</th> <th>—</th> <th>{$map_id1455}</th> <th>—</th> <th>{$map_id1470}</th><th>—</th> <th>{$map_id1469}</th><th>—</th> <th>{$map_id1490}</th><th>—</th> <th>{$map_id1489}</th> <th></th><th></th> <th></th><th>{$map_id1502}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1440}</th> <th></th><th></th> <th></th> <th>{$map_id1454}</th> <th></th> <th></th><th></th> <th>{$map_id1471}</th><th></th> <th></th><th></th> <th>{$map_id1488}</th> <th></th><th></th> <th></th><th>{$map_id1503}</th> <th>—</th> <th>{$map_id1504}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1441}</th> <th>—</th><th>{$map_id1452}</th> <th>—</th> <th>{$map_id1453}</th> <th>—</th> <th>{$map_id1473}</th><th>—</th> <th>{$map_id1472}</th><th>—</th> <th>{$map_id1487}</th><th>—</th> <th>{$map_id1486}</th> <th></th><th></th> <th></th><th>{$map_id1505}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1442}</th> <th></th><th></th> <th></th> <th>{$map_id1450}</th> <th></th> <th></th><th></th> <th>{$map_id1474}</th><th></th> <th></th><th></th> <th>{$map_id1485}</th> <th>—</th><th>{$map_id1507}</th> <th>—</th><th>{$map_id1506}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1443}</th> <th>—</th><th>{$map_id1451}</th> <th>—</th> <th>{$map_id1449}</th> <th>—</th> <th>{$map_id1476}</th><th>—</th> <th>{$map_id1472}</th><th>—</th> <th>{$map_id1475}</th><th>—</th> <th>{$map_id1484}</th> <th></th><th></th> <th></th><th>{$map_id1508}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1444}</th> <th></th><th></th> <th></th> <th>{$map_id1448}</th> <th></th> <th></th><th></th> <th>{$map_id1477}</th><th></th> <th></th><th></th> <th>{$map_id1482}</th> <th>—</th><th>{$map_id1510}</th> <th>—</th><th>{$map_id1509}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1445}</th> <th>—</th><th>{$map_id1446}</th> <th>—</th> <th>{$map_id1447}</th> <th>—</th> <th>{$map_id1479}</th><th>—</th> <th>{$map_id1478}</th><th>—</th> <th>{$map_id1480}</th><th>—</th> <th>{$map_id1481}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt40()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1516 = ($in_map_id == 1516) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿2层</b></button>";
    $map_id1562 = ($in_map_id == 1562) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿2层</b></button>";

    $map_id1511 = ($in_map_id == 1511) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1550 = ($in_map_id == 1550) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1549 = ($in_map_id == 1549) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1548 = ($in_map_id == 1548) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1547 = ($in_map_id == 1547) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1546 = ($in_map_id == 1546) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1545 = ($in_map_id == 1545) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1544 = ($in_map_id == 1544) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1543 = ($in_map_id == 1543) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1542 = ($in_map_id == 1542) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1512 = ($in_map_id == 1512) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1541 = ($in_map_id == 1541) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1540 = ($in_map_id == 1540) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1513 = ($in_map_id == 1513) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1559 = ($in_map_id == 1559) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1558 = ($in_map_id == 1558) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1557 = ($in_map_id == 1557) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1556 = ($in_map_id == 1556) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1555 = ($in_map_id == 1555) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1554 = ($in_map_id == 1554) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1553 = ($in_map_id == 1553) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1539 = ($in_map_id == 1539) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1514 = ($in_map_id == 1514) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1560 = ($in_map_id == 1560) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1592 = ($in_map_id == 1592) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1552 = ($in_map_id == 1552) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1551 = ($in_map_id == 1551) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1538 = ($in_map_id == 1538) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1515 = ($in_map_id == 1515) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1561 = ($in_map_id == 1561) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1565 = ($in_map_id == 1565) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1581 = ($in_map_id == 1581) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1580 = ($in_map_id == 1580) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1579 = ($in_map_id == 1579) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1537 = ($in_map_id == 1537) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1586 = ($in_map_id == 1586) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1563 = ($in_map_id == 1563) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1564 = ($in_map_id == 1564) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1582 = ($in_map_id == 1582) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1578 = ($in_map_id == 1578) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1583 = ($in_map_id == 1583) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1536 = ($in_map_id == 1536) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1584 = ($in_map_id == 1584) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1585 = ($in_map_id == 1585) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1517 = ($in_map_id == 1517) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1567 = ($in_map_id == 1567) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1566 = ($in_map_id == 1566) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1575 = ($in_map_id == 1575) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1576 = ($in_map_id == 1576) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1577 = ($in_map_id == 1577) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1535 = ($in_map_id == 1535) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1587 = ($in_map_id == 1587) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1518 = ($in_map_id == 1518) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1568 = ($in_map_id == 1568) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1574 = ($in_map_id == 1574) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1589 = ($in_map_id == 1589) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1588 = ($in_map_id == 1588) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1534 = ($in_map_id == 1534) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1519 = ($in_map_id == 1519) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1569 = ($in_map_id == 1569) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1570 = ($in_map_id == 1570) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1571 = ($in_map_id == 1571) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1572 = ($in_map_id == 1572) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1573 = ($in_map_id == 1573) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1591 = ($in_map_id == 1591) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1590 = ($in_map_id == 1590) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1533 = ($in_map_id == 1533) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1520 = ($in_map_id == 1520) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1531 = ($in_map_id == 1531) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1532 = ($in_map_id == 1532) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    $map_id1521 = ($in_map_id == 1521) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1522 = ($in_map_id == 1522) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1523 = ($in_map_id == 1523) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1524 = ($in_map_id == 1524) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1525 = ($in_map_id == 1525) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1526 = ($in_map_id == 1526) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1527 = ($in_map_id == 1527) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1528 = ($in_map_id == 1528) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1529 = ($in_map_id == 1529) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";
    $map_id1530 = ($in_map_id == 1530) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿2层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿2层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1511}</th> <th>—</th><th>{$map_id1550}</th> <th>—</th> <th>{$map_id1549}</th> <th>—</th> <th>{$map_id1548}</th><th>—</th> <th>{$map_id1547}</th><th>—</th> <th>{$map_id1546}</th><th>—</th> <th>{$map_id1545}</th> <th>—</th><th>{$map_id1544}</th> <th>—</th><th>{$map_id1543}</th> <th>—</th> <th>{$map_id1542}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1512}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id1541}</th> <th>—</th> <th>{$map_id1540}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1513}</th> <th></th><th></th> <th></th> <th>{$map_id1559}</th> <th>—</th> <th>{$map_id1558}</th><th>—</th> <th>{$map_id1557}</th><th>—</th> <th>{$map_id1556}</th><th>—</th> <th>{$map_id1555}</th> <th>—</th><th>{$map_id1554}</th> <th>—</th><th>{$map_id1553}</th> <th></th> <th></th> <th></th> <th>{$map_id1539}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1514}</th> <th></th><th></th> <th></th> <th>{$map_id1560}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1592}</th> <th></th><th></th> <th></th><th>{$map_id1552}</th> <th>—</th> <th>{$map_id1551}</th> <th>—</th> <th>{$map_id1538}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1515}</th> <th></th><th></th> <th></th> <th>{$map_id1561}</th> <th></th> <th></th><th></th> <th>{$map_id1565}</th><th></th> <th></th><th></th> <th>{$map_id1581}</th> <th>—</th><th>{$map_id1580}</th> <th>—</th><th>{$map_id1579}</th> <th></th> <th></th> <th></th> <th>{$map_id1537}</th> <th></th> <th></th> <th></th> <th>{$map_id1586}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id1516}</th> <th></th><th></th> <th></th> <th>{$map_id1562}</th> <th>—</th> <th>{$map_id1563}</th><th>—</th> <th>{$map_id1564}</th><th></th> <th></th><th></th> <th>{$map_id1582}</th> <th></th><th></th> <th></th><th>{$map_id1578}</th> <th>—</th> <th>{$map_id1583}</th> <th>—</th> <th>{$map_id1536}</th> <th>—</th> <th>{$map_id1584}</th> <th>—</th> <th>{$map_id1585}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id1517}</th> <th></th><th></th> <th></th> <th>{$map_id1567}</th> <th></th> <th></th><th></th> <th>{$map_id1566}</th><th></th> <th></th><th></th> <th>{$map_id1575}</th> <th>—</th><th>{$map_id1576}</th> <th>—</th><th>{$map_id1577}</th> <th></th> <th></th> <th></th> <th>{$map_id1535}</th> <th></th> <th></th> <th></th> <th>{$map_id1587}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1518}</th> <th></th><th></th> <th></th> <th>{$map_id1568}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1574}</th> <th></th><th></th> <th></th><th>{$map_id1589}</th> <th>—</th> <th>{$map_id1588}</th> <th>—</th> <th>{$map_id1534}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1519}</th> <th></th><th></th> <th></th> <th>{$map_id1569}</th> <th>—</th> <th>{$map_id1570}</th><th>—</th> <th>{$map_id1571}</th><th>—</th> <th>{$map_id1572}</th><th>—</th> <th>{$map_id1573}</th> <th>—</th><th>{$map_id1591}</th> <th>—</th><th>{$map_id1590}</th> <th></th> <th></th> <th></th> <th>{$map_id1533}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1520}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id1531}</th> <th>—</th> <th>{$map_id1532}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1521}</th> <th>—</th><th>{$map_id1522}</th> <th>—</th> <th>{$map_id1523}</th> <th>—</th> <th>{$map_id1524}</th><th>—</th> <th>{$map_id1525}</th><th>—</th> <th>{$map_id1526}</th><th>—</th> <th>{$map_id1527}</th> <th>—</th><th>{$map_id1544}</th> <th>—</th><th>{$map_id1528}</th> <th>—</th> <th>{$map_id1529}</th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt41()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1611 = ($in_map_id == 1611) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿3层</b></button>";
    $map_id1640 = ($in_map_id == 1640) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿3层</b></button>";

    $map_id1593 = ($in_map_id == 1593) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1595 = ($in_map_id == 1595) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1596 = ($in_map_id == 1596) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1598 = ($in_map_id == 1598) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1599 = ($in_map_id == 1599) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1665 = ($in_map_id == 1665) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1666 = ($in_map_id == 1666) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1668 = ($in_map_id == 1668) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1669 = ($in_map_id == 1669) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1671 = ($in_map_id == 1671) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1672 = ($in_map_id == 1672) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1594 = ($in_map_id == 1594) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1597 = ($in_map_id == 1597) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1600 = ($in_map_id == 1600) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1667 = ($in_map_id == 1667) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1670 = ($in_map_id == 1670) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1673 = ($in_map_id == 1673) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1674 = ($in_map_id == 1674) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1601 = ($in_map_id == 1601) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1675 = ($in_map_id == 1675) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1607 = ($in_map_id == 1607) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1602 = ($in_map_id == 1602) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1662 = ($in_map_id == 1662) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1658 = ($in_map_id == 1658) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1676 = ($in_map_id == 1676) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1677 = ($in_map_id == 1677) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1610 = ($in_map_id == 1610) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1609 = ($in_map_id == 1609) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1606 = ($in_map_id == 1606) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1605 = ($in_map_id == 1605) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1603 = ($in_map_id == 1603) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1664 = ($in_map_id == 1664) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1661 = ($in_map_id == 1661) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1660 = ($in_map_id == 1660) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1657 = ($in_map_id == 1657) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1656 = ($in_map_id == 1656) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1655 = ($in_map_id == 1655) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1612 = ($in_map_id == 1612) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1608 = ($in_map_id == 1608) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1604 = ($in_map_id == 1604) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1663 = ($in_map_id == 1663) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1659 = ($in_map_id == 1659) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1653 = ($in_map_id == 1653) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1654 = ($in_map_id == 1654) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1613 = ($in_map_id == 1613) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1652 = ($in_map_id == 1652) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1614 = ($in_map_id == 1614) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1641 = ($in_map_id == 1641) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1642 = ($in_map_id == 1642) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1643 = ($in_map_id == 1643) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1644 = ($in_map_id == 1644) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1645 = ($in_map_id == 1645) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1646 = ($in_map_id == 1646) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1647 = ($in_map_id == 1647) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1648 = ($in_map_id == 1648) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1649 = ($in_map_id == 1649) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1650 = ($in_map_id == 1650) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1615 = ($in_map_id == 1615) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1651 = ($in_map_id == 1651) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1616 = ($in_map_id == 1616) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1639 = ($in_map_id == 1639) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1638 = ($in_map_id == 1638) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1637 = ($in_map_id == 1637) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1636 = ($in_map_id == 1636) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1635 = ($in_map_id == 1635) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1634 = ($in_map_id == 1634) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1633 = ($in_map_id == 1633) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1632 = ($in_map_id == 1632) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1630 = ($in_map_id == 1630) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1631 = ($in_map_id == 1631) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1617 = ($in_map_id == 1617) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1629 = ($in_map_id == 1629) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    $map_id1618 = ($in_map_id == 1618) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1619 = ($in_map_id == 1619) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1620 = ($in_map_id == 1620) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1621 = ($in_map_id == 1621) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1622 = ($in_map_id == 1622) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1623 = ($in_map_id == 1623) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1624 = ($in_map_id == 1624) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1625 = ($in_map_id == 1625) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1626 = ($in_map_id == 1626) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1627 = ($in_map_id == 1627) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";
    $map_id1628 = ($in_map_id == 1628) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿3层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿3层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1593}</th> <th>—</th><th>{$map_id1595}</th> <th>—</th> <th>{$map_id1596}</th> <th>—</th> <th>{$map_id1598}</th><th>—</th> <th>{$map_id1599}</th><th>—</th> <th>{$map_id1665}</th><th>—</th> <th>{$map_id1666}</th> <th>—</th><th>{$map_id1668}</th> <th>—</th><th>{$map_id1669}</th> <th>—</th> <th>{$map_id1671}</th> <th>—</th> <th>{$map_id1672}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1594}</th> <th></th><th></th> <th></th> <th>{$map_id1597}</th> <th></th> <th></th><th></th> <th>{$map_id1600}</th><th></th> <th></th><th></th> <th>{$map_id1667}</th> <th></th><th></th> <th></th><th>{$map_id1670}</th> <th></th> <th></th> <th></th> <th>{$map_id1673}</th> <th>—</th> <th>{$map_id1674}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id1601}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1675}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1611}</th> <th></th><th></th> <th></th> <th>{$map_id1607}</th> <th></th> <th></th><th></th> <th>{$map_id1602}</th><th></th> <th></th><th></th> <th>{$map_id1662}</th> <th></th><th></th> <th></th><th>{$map_id1658}</th> <th></th> <th></th> <th></th> <th>{$map_id1676}</th> <th>—</th> <th>{$map_id1677}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1610}</th> <th>—</th><th>{$map_id1609}</th> <th>—</th> <th>{$map_id1606}</th> <th>—</th> <th>{$map_id1605}</th><th>—</th> <th>{$map_id1603}</th><th>—</th> <th>{$map_id1664}</th><th>—</th> <th>{$map_id1661}</th> <th>—</th><th>{$map_id1660}</th> <th>—</th><th>{$map_id1657}</th> <th>—</th> <th>{$map_id1656}</th> <th>—</th> <th>{$map_id1655}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1612}</th> <th></th><th></th> <th></th> <th>{$map_id1608}</th> <th></th> <th></th><th></th> <th>{$map_id1604}</th><th></th> <th></th><th></th> <th>{$map_id1663}</th> <th></th><th></th> <th></th><th>{$map_id1659}</th> <th></th> <th></th> <th></th> <th>{$map_id1653}</th> <th>—</th> <th>{$map_id1654}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1613}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1672}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1614}</th> <th></th><th></th> <th></th> <th>{$map_id1641}</th> <th>—</th> <th>{$map_id1642}</th><th>—</th> <th>{$map_id1643}</th><th>—</th> <th>{$map_id1644}</th><th>—</th> <th>{$map_id1645}</th> <th>—</th><th>{$map_id1646}</th> <th>—</th><th>{$map_id1647}</th> <th>—</th> <th>{$map_id1648}</th> <th>—</th> <th>{$map_id1649}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1615}</th> <th></th><th></th> <th></th> <th>{$map_id1640}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1651}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1616}</th> <th></th><th></th> <th></th> <th>{$map_id1639}</th> <th>—</th> <th>{$map_id1638}</th><th>—</th> <th>{$map_id1637}</th><th>—</th> <th>{$map_id1636}</th><th>—</th> <th>{$map_id1635}</th> <th>—</th><th>{$map_id1634}</th> <th>—</th><th>{$map_id1633}</th> <th>—</th> <th>{$map_id1632}</th> <th>—</th> <th>{$map_id1630}</th> <th>—</th> <th>{$map_id1631}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1617}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1629}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1618}</th> <th>—</th><th>{$map_id1619}</th> <th>—</th> <th>{$map_id1620}</th> <th>—</th> <th>{$map_id1621}</th><th>—</th> <th>{$map_id1622}</th><th>—</th> <th>{$map_id1623}</th><th>—</th> <th>{$map_id1624}</th> <th>—</th><th>{$map_id1625}</th> <th>—</th><th>{$map_id1626}</th> <th>—</th> <th>{$map_id1627}</th> <th>—</th> <th>{$map_id1628}</th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt42()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1678 = ($in_map_id == 1678) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿4层</b></button>";
    $map_id1745 = ($in_map_id == 1745) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿4层</b></button>";

    $map_id1709 = ($in_map_id == 1709) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1708 = ($in_map_id == 1708) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1707 = ($in_map_id == 1707) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1706 = ($in_map_id == 1706) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1705 = ($in_map_id == 1705) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1704 = ($in_map_id == 1704) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1730 = ($in_map_id == 1730) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1731 = ($in_map_id == 1731) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1679 = ($in_map_id == 1679) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1703 = ($in_map_id == 1703) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1728 = ($in_map_id == 1728) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1729 = ($in_map_id == 1729) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1680 = ($in_map_id == 1680) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1712 = ($in_map_id == 1712) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1716 = ($in_map_id == 1716) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1702 = ($in_map_id == 1702) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1732 = ($in_map_id == 1732) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1733 = ($in_map_id == 1733) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1681 = ($in_map_id == 1681) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1710 = ($in_map_id == 1710) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1711 = ($in_map_id == 1711) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1714 = ($in_map_id == 1714) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1715 = ($in_map_id == 1715) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1718 = ($in_map_id == 1718) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1701 = ($in_map_id == 1701) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1735 = ($in_map_id == 1735) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1734 = ($in_map_id == 1734) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1682 = ($in_map_id == 1682) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1713 = ($in_map_id == 1713) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1717 = ($in_map_id == 1717) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1700 = ($in_map_id == 1700) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1738 = ($in_map_id == 1738) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1739 = ($in_map_id == 1739) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1683 = ($in_map_id == 1683) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1699 = ($in_map_id == 1699) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1736 = ($in_map_id == 1736) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1737 = ($in_map_id == 1737) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1684 = ($in_map_id == 1684) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1725 = ($in_map_id == 1725) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1721 = ($in_map_id == 1721) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1698 = ($in_map_id == 1698) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1740 = ($in_map_id == 1740) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1741 = ($in_map_id == 1741) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1685 = ($in_map_id == 1685) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1727 = ($in_map_id == 1727) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1723 = ($in_map_id == 1723) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1720 = ($in_map_id == 1720) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1719 = ($in_map_id == 1719) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1697 = ($in_map_id == 1697) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1724 = ($in_map_id == 1724) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1749 = ($in_map_id == 1749) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1742 = ($in_map_id == 1742) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1686 = ($in_map_id == 1686) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1726 = ($in_map_id == 1726) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1722 = ($in_map_id == 1722) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1696 = ($in_map_id == 1696) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1743 = ($in_map_id == 1743) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1744 = ($in_map_id == 1744) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1687 = ($in_map_id == 1687) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1695 = ($in_map_id == 1695) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1748 = ($in_map_id == 1748) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    $map_id1688 = ($in_map_id == 1688) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1689 = ($in_map_id == 1689) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1690 = ($in_map_id == 1690) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1691 = ($in_map_id == 1691) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1692 = ($in_map_id == 1692) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1693 = ($in_map_id == 1693) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1694 = ($in_map_id == 1694) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1746 = ($in_map_id == 1746) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";
    $map_id1747 = ($in_map_id == 1747) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿4层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿4层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1678}</th> <th>—</th><th>{$map_id1709}</th> <th>—</th> <th>{$map_id1708}</th> <th>—</th> <th>{$map_id1707}</th><th>—</th> <th>{$map_id1706}</th><th>—</th> <th>{$map_id1705}</th><th>—</th> <th>{$map_id1704}</th> <th></th><th></th> <th></th><th>{$map_id1730}</th> <th>—</th> <th>{$map_id1731}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1679}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1703}</th> <th>—</th><th>{$map_id1728}</th> <th>—</th><th>{$map_id1729}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1680}</th> <th></th><th></th> <th></th> <th>{$map_id1712}</th> <th></th> <th></th><th></th> <th>{$map_id1716}</th><th></th> <th></th><th></th> <th>{$map_id1702}</th> <th></th><th></th> <th></th><th>{$map_id1732}</th> <th>—</th> <th>{$map_id1733}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1681}</th> <th>—</th><th>{$map_id1710}</th> <th>—</th> <th>{$map_id1711}</th> <th>—</th> <th>{$map_id1714}</th><th>—</th> <th>{$map_id1715}</th><th>—</th> <th>{$map_id1718}</th><th>—</th> <th>{$map_id1701}</th> <th></th><th></th> <th></th><th>{$map_id1735}</th> <th>—</th> <th>{$map_id1734}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1682}</th> <th></th><th></th> <th></th> <th>{$map_id1713}</th> <th></th> <th></th><th></th> <th>{$map_id1717}</th><th></th> <th></th><th></th> <th>{$map_id1700}</th> <th></th><th></th> <th></th><th>{$map_id1738}</th> <th>—</th> <th>{$map_id1739}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1683}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1699}</th> <th>—</th><th>{$map_id1736}</th> <th>—</th><th>{$map_id1737}</th> <th>—</th> <th>{$map_id1739}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1684}</th> <th></th><th></th> <th></th> <th>{$map_id1725}</th> <th></th> <th></th><th></th> <th>{$map_id1721}</th><th></th> <th></th><th></th> <th>{$map_id1698}</th> <th></th><th></th> <th></th><th>{$map_id1740}</th> <th>—</th> <th>{$map_id1741}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1685}</th> <th>—</th><th>{$map_id1727}</th> <th>—</th> <th>{$map_id1724}</th> <th>—</th> <th>{$map_id1723}</th><th>—</th> <th>{$map_id1720}</th><th>—</th> <th>{$map_id1719}</th><th>—</th> <th>{$map_id1697}</th> <th>—</th><th>{$map_id1749}</th> <th>—</th><th>{$map_id1742}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1686}</th> <th></th><th></th> <th></th> <th>{$map_id1726}</th> <th></th> <th></th><th></th> <th>{$map_id1722}</th><th></th> <th></th><th></th> <th>{$map_id1696}</th> <th></th><th></th> <th></th><th>{$map_id1743}</th> <th>—</th> <th>{$map_id1744}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1687}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1695}</th> <th>—</th><th>{$map_id1748}</th> <th>—</th><th>{$map_id1745}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1688}</th> <th>—</th><th>{$map_id1689}</th> <th>—</th> <th>{$map_id1690}</th> <th>—</th> <th>{$map_id1691}</th><th>—</th> <th>{$map_id1692}</th><th>—</th> <th>{$map_id1693}</th><th>—</th> <th>{$map_id1694}</th> <th></th><th></th> <th></th><th>{$map_id1746}</th> <th>—</th> <th>{$map_id1747}</th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt43()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1824 = ($in_map_id == 1824) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿5层</b></button>";
    $map_id1762 = ($in_map_id == 1762) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿5层</b></button>";

    $map_id1782 = ($in_map_id == 1782) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>祖玛神殿5层</b></button>";

    $map_id1750 = ($in_map_id == 1750) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1751 = ($in_map_id == 1751) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1752 = ($in_map_id == 1752) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1753 = ($in_map_id == 1753) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1754 = ($in_map_id == 1754) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1755 = ($in_map_id == 1755) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1756 = ($in_map_id == 1756) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1757 = ($in_map_id == 1757) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1758 = ($in_map_id == 1758) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1759 = ($in_map_id == 1759) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1760 = ($in_map_id == 1760) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1792 = ($in_map_id == 1792) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1793 = ($in_map_id == 1793) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1761 = ($in_map_id == 1761) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1791 = ($in_map_id == 1791) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1795 = ($in_map_id == 1795) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1794 = ($in_map_id == 1794) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1818 = ($in_map_id == 1818) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1817 = ($in_map_id == 1817) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1816 = ($in_map_id == 1816) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1815 = ($in_map_id == 1815) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1763 = ($in_map_id == 1763) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1790 = ($in_map_id == 1790) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1796 = ($in_map_id == 1796) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1814 = ($in_map_id == 1814) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1764 = ($in_map_id == 1764) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1789 = ($in_map_id == 1789) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1797 = ($in_map_id == 1797) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1823 = ($in_map_id == 1823) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1822 = ($in_map_id == 1822) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1821 = ($in_map_id == 1821) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1813 = ($in_map_id == 1813) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1765 = ($in_map_id == 1765) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1788 = ($in_map_id == 1788) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1798 = ($in_map_id == 1798) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1820 = ($in_map_id == 1820) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1819 = ($in_map_id == 1819) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1812 = ($in_map_id == 1812) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1766 = ($in_map_id == 1766) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1787 = ($in_map_id == 1787) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1799 = ($in_map_id == 1799) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1825 = ($in_map_id == 1825) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1829 = ($in_map_id == 1829) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1811 = ($in_map_id == 1811) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1767 = ($in_map_id == 1767) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1786 = ($in_map_id == 1786) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1800 = ($in_map_id == 1800) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1826 = ($in_map_id == 1826) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1827 = ($in_map_id == 1827) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1828 = ($in_map_id == 1828) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1810 = ($in_map_id == 1810) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1768 = ($in_map_id == 1768) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1785 = ($in_map_id == 1785) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1801 = ($in_map_id == 1801) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1809 = ($in_map_id == 1809) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1769 = ($in_map_id == 1769) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1784 = ($in_map_id == 1784) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1802 = ($in_map_id == 1802) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1803 = ($in_map_id == 1803) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1804 = ($in_map_id == 1804) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1805 = ($in_map_id == 1805) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1806 = ($in_map_id == 1806) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1807 = ($in_map_id == 1807) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1808 = ($in_map_id == 1808) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1770 = ($in_map_id == 1770) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1783 = ($in_map_id == 1783) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1771 = ($in_map_id == 1771) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    $map_id1781 = ($in_map_id == 1781) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1780 = ($in_map_id == 1780) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1779 = ($in_map_id == 1779) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1778 = ($in_map_id == 1778) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1777 = ($in_map_id == 1777) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1776 = ($in_map_id == 1776) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1775 = ($in_map_id == 1775) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1774 = ($in_map_id == 1774) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1773 = ($in_map_id == 1773) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";
    $map_id1772 = ($in_map_id == 1772) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿5层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿5层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1750}</th> <th>—</th><th>{$map_id1751}</th> <th>—</th> <th>{$map_id1752}</th> <th>—</th> <th>{$map_id1753}</th><th>—</th> <th>{$map_id1754}</th><th>—</th> <th>{$map_id1755}</th><th>—</th> <th>{$map_id1756}</th> <th>—</th><th>{$map_id1757}</th> <th></th><th>{$map_id1758}</th> <th>—</th> <th>{$map_id1759}</th> <th>—</th> <th>{$map_id1760}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1792}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1793}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1761}</th> <th>—</th> <th>{$map_id1762}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1791}</th> <th></th><th></th> <th></th> <th>{$map_id1795}</th> <th>—</th> <th>{$map_id1794}</th><th></th> <th></th><th></th> <th>{$map_id1818}</th><th>—</th> <th>{$map_id1817}</th> <th>—</th><th>{$map_id1816}</th> <th></th><th>{$map_id1815}</th> <th></th> <th></th> <th></th> <th>{$map_id1763}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1790}</th> <th></th><th></th> <th></th> <th>{$map_id1796}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1814}</th> <th></th> <th></th> <th></th> <th>{$map_id1764}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1789}</th> <th></th><th></th> <th></th> <th>{$map_id1797}</th> <th></th> <th></th><th></th> <th>{$map_id1823}</th><th>—</th> <th>{$map_id1822}</th><th>—</th> <th>{$map_id1821}</th> <th></th><th></th> <th></th><th>{$map_id1813}</th> <th></th> <th></th> <th></th> <th>{$map_id1765}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1788}</th> <th></th><th></th> <th></th> <th>{$map_id1798}</th> <th></th> <th></th><th></th> <th>{$map_id1824}</th><th></th> <th></th><th></th> <th>{$map_id1820}</th> <th>—</th><th>{$map_id1819}</th> <th>—</th><th>{$map_id1812}</th> <th></th> <th></th> <th></th> <th>{$map_id1766}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1787}</th> <th></th><th></th> <th></th> <th>{$map_id1799}</th> <th></th> <th></th><th></th> <th>{$map_id1825}</th><th></th> <th></th><th></th> <th>{$map_id1829}</th> <th></th><th></th> <th></th><th>{$map_id1811}</th> <th></th> <th></th> <th></th> <th>{$map_id1767}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1786}</th> <th></th><th></th> <th></th> <th>{$map_id1800}</th> <th></th> <th></th><th></th> <th>{$map_id1826}</th><th>—</th> <th>{$map_id1827}</th><th>—</th> <th>{$map_id1828}</th> <th></th><th></th> <th></th><th>{$map_id1810}</th> <th></th> <th></th> <th></th> <th>{$map_id1768}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1785}</th> <th></th><th></th> <th></th> <th>{$map_id1801}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1809}</th> <th></th> <th></th> <th></th> <th>{$map_id1769}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1784}</th> <th></th><th></th> <th></th> <th>{$map_id1802}</th> <th>—</th> <th>{$map_id1803}</th><th>—</th> <th>{$map_id1804}</th><th>—</th> <th>{$map_id1805}</th><th>—</th> <th>{$map_id1806}</th> <th>—</th><th>{$map_id1807}</th> <th></th><th>{$map_id1808}</th> <th></th> <th></th> <th></th> <th>{$map_id1770}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1783}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1771}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1782}</th> <th>—</th><th>{$map_id1781}</th> <th>—</th> <th>{$map_id1780}</th> <th>—</th> <th>{$map_id1779}</th><th>—</th> <th>{$map_id1778}</th><th>—</th> <th>{$map_id1777}</th><th>—</th> <th>{$map_id1776}</th> <th>—</th><th>{$map_id1775}</th> <th></th><th>{$map_id1774}</th> <th>—</th> <th>{$map_id1773}</th> <th>—</th> <th>{$map_id1772}</th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
    echo "<b style='color:blue'>蓝色</b>:表示boss的位置<br>";
}

function dt45()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1835 = ($in_map_id == 1835) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿层</b></button>";
    $map_id1855 = ($in_map_id == 1855) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿层</b></button>";

    $map_id1847 = ($in_map_id == 1847) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1846 = ($in_map_id == 1846) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1848 = ($in_map_id == 1848) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1849 = ($in_map_id == 1849) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1845 = ($in_map_id == 1845) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1850 = ($in_map_id == 1850) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1851 = ($in_map_id == 1851) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1836 = ($in_map_id == 1836) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1844 = ($in_map_id == 1844) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1852 = ($in_map_id == 1852) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1837 = ($in_map_id == 1837) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1843 = ($in_map_id == 1843) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1853 = ($in_map_id == 1853) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1838 = ($in_map_id == 1838) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1842 = ($in_map_id == 1842) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1854 = ($in_map_id == 1854) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1839 = ($in_map_id == 1839) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1840 = ($in_map_id == 1840) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1841 = ($in_map_id == 1841) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th><th>{$map_id1847}</th> <th>—</th> <th>{$map_id1846}</th> <th>—</th> <th>{$map_id1848}</th><th>—</th> <th>{$map_id1849}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1835}</th> <th></th><th></th> <th></th> <th>{$map_id1845}</th> <th></th> <th></th><th></th> <th>{$map_id1850}</th><th>—</th> <th>{$map_id1851}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1836}</th> <th></th><th></th> <th></th> <th>{$map_id1844}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1852}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1837}</th> <th></th><th></th> <th></th> <th>{$map_id1843}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1853}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1838}</th> <th></th><th></th> <th></th> <th>{$map_id1842}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1854}</th><th>—</th> <th>{$map_id1855}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1839}</th> <th>—</th><th>{$map_id1840}</th> <th>—</th> <th>{$map_id1841}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
 
    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt46()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1882 = ($in_map_id == 1882) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿层</b></button>";
    $map_id1856 = ($in_map_id == 1856) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿层</b></button>";

    $map_id1861 = ($in_map_id == 1861) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1862 = ($in_map_id == 1862) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1863 = ($in_map_id == 1863) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1864 = ($in_map_id == 1864) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1865 = ($in_map_id == 1865) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1860 = ($in_map_id == 1860) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1870 = ($in_map_id == 1870) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1866 = ($in_map_id == 1866) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1881 = ($in_map_id == 1881) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1859 = ($in_map_id == 1859) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1869 = ($in_map_id == 1869) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1868 = ($in_map_id == 1868) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1867 = ($in_map_id == 1867) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1880 = ($in_map_id == 1880) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1858 = ($in_map_id == 1858) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1871 = ($in_map_id == 1871) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1878 = ($in_map_id == 1878) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1879 = ($in_map_id == 1879) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1857 = ($in_map_id == 1857) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1872 = ($in_map_id == 1872) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1876 = ($in_map_id == 1876) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1877 = ($in_map_id == 1877) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1873 = ($in_map_id == 1873) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1874 = ($in_map_id == 1874) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1875 = ($in_map_id == 1875) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id1861}</th> <th>—</th><th>{$map_id1862}</th> <th>—</th> <th>{$map_id1863}</th> <th>—</th> <th>{$map_id1864}</th><th>—</th> <th>{$map_id1865}</th><th></th> <th></th><th></th> <th>{$map_id1882}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1860}</th> <th></th><th></th> <th></th> <th>{$map_id1870}</th> <th></th> <th></th><th></th> <th>{$map_id1866}</th><th></th> <th></th><th></th> <th>{$map_id1881}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1859}</th> <th></th><th></th> <th></th> <th>{$map_id1869}</th> <th>—</th> <th>{$map_id1868}</th><th>—</th> <th>{$map_id1867}</th><th></th> <th></th><th></th> <th>{$map_id1880}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1858}</th> <th></th><th></th> <th></th> <th>{$map_id1871}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1878}</th><th>—</th> <th>{$map_id1879}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1857}</th> <th></th><th></th> <th></th> <th>{$map_id1872}</th> <th></th> <th></th><th></th> <th>{$map_id1876}</th><th>—</th> <th>{$map_id1877}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1856}</th> <th></th><th></th> <th></th> <th>{$map_id1873}</th> <th>—</th> <th>{$map_id1874}</th><th>—</th> <th>{$map_id1875}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt47()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1897 = ($in_map_id == 1897) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿层</b></button>";
    $map_id1925 = ($in_map_id == 1925) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>祖玛神殿层</b></button>";

    $map_id1896 = ($in_map_id == 1896) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1906 = ($in_map_id == 1906) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1907 = ($in_map_id == 1907) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1895 = ($in_map_id == 1895) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1905 = ($in_map_id == 1905) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1910 = ($in_map_id == 1910) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1894 = ($in_map_id == 1894) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1893 = ($in_map_id == 1893) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1904 = ($in_map_id == 1904) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1908 = ($in_map_id == 1908) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1909 = ($in_map_id == 1909) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1911 = ($in_map_id == 1911) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1912 = ($in_map_id == 1912) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1914 = ($in_map_id == 1914) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1883 = ($in_map_id == 1883) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1892 = ($in_map_id == 1892) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1903 = ($in_map_id == 1903) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1913 = ($in_map_id == 1913) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1886 = ($in_map_id == 1886) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1884 = ($in_map_id == 1884) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1891 = ($in_map_id == 1891) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1902 = ($in_map_id == 1902) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1923 = ($in_map_id == 1923) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1924 = ($in_map_id == 1924) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1885 = ($in_map_id == 1885) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1890 = ($in_map_id == 1890) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1901 = ($in_map_id == 1901) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1922 = ($in_map_id == 1922) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1887 = ($in_map_id == 1887) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1888 = ($in_map_id == 1888) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1889 = ($in_map_id == 1889) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1898 = ($in_map_id == 1898) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1899 = ($in_map_id == 1899) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1915 = ($in_map_id == 1915) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1916 = ($in_map_id == 1916) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1918 = ($in_map_id == 1918) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1919 = ($in_map_id == 1919) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1921 = ($in_map_id == 1921) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    $map_id1900 = ($in_map_id == 1900) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1917 = ($in_map_id == 1917) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";
    $map_id1920 = ($in_map_id == 1920) ? "<button type= submit class= btn btn-success><b style='color:green'>祖玛神殿7层</b></button>" : "<button type= submit class= btn btn-success>祖玛神殿7层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1897}</th> <th>—</th> <th>{$map_id1896}</th><th></th> <th></th><th></th> <th>{$map_id1906}</th><th></th> <th></th> <th></th><th>{$map_id1907}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1895}</th><th></th> <th></th><th></th> <th>{$map_id1905}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id1910}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1894}</th> <th>—</th> <th>{$map_id1893}</th><th></th> <th></th><th></th> <th>{$map_id1904}</th><th>—</th> <th>{$map_id1908}</th> <th>—</th><th>{$map_id1909}</th> <th>—</th><th>{$map_id1911}</th> <th>—</th> <th>{$map_id1912}</th> <th>—</th> <th>{$map_id1914}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1883}</th> <th></th> <th></th> <th></th> <th>{$map_id1892}</th><th></th> <th></th><th></th> <th>{$map_id1903}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id1913}</th> <th></th> <th></th> <th></th> <th>{$map_id1925}</th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id1886}</th> <th>—</th><th>{$map_id1884}</th> <th></th> <th></th> <th></th> <th>{$map_id1891}</th><th></th> <th></th><th></th> <th>{$map_id1902}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1923}</th> <th>—</th> <th>{$map_id1924}</th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1885}</th> <th></th> <th></th> <th></th> <th>{$map_id1890}</th><th></th> <th></th><th></th> <th>{$map_id1901}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id1922}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1887}</th> <th>—</th> <th>{$map_id1888}</th> <th>—</th> <th>{$map_id1889}</th><th>—</th> <th>{$map_id1898}</th><th>—</th> <th>{$map_id1899}</th><th>—</th> <th>{$map_id1915}</th> <th>—</th><th>{$map_id1916}</th> <th>—</th><th>{$map_id1918}</th> <th>—</th> <th>{$map_id1919}</th> <th>—</th> <th>{$map_id1921}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1900}</th><th></th> <th></th> <th></th><th>{$map_id1917}</th> <th></th><th></th> <th></th> <th>{$map_id1920}</th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt49()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1927 = ($in_map_id == 1927) ? "<button type= submit class= btn btn-success><b style='color:green'>南郊小路</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>南郊小路</b></button>";

    $map_id1959 = ($in_map_id == 1959) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克内庭</b></button>" : "<button type= submit class= btn btn-success>沙巴克内庭</button>";

    $map_id1958 = ($in_map_id == 1958) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克城门</b></button>" : "<button type= submit class= btn btn-success>沙巴克城门</button>";

    $map_id1957 = ($in_map_id == 1957) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克瓮城</b></button>" : "<button type= submit class= btn btn-success>沙巴克瓮城</button>";

    $map_id1955 = ($in_map_id == 1955) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克城楼</b></button>" : "<button type= submit class= btn btn-success>沙巴克城楼</button>";
    $map_id1954 = ($in_map_id == 1954) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克内城门</b></button>" : "<button type= submit class= btn btn-success>沙巴克内城门</button>";
    $map_id1956 = ($in_map_id == 1956) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克城楼</b></button>" : "<button type= submit class= btn btn-success>沙巴克城楼</button>";

    $map_id1953 = ($in_map_id == 1953) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克北大街</b></button>" : "<button type= submit class= btn btn-success>沙巴克北大街</button>";
    $map_id1950 = ($in_map_id == 1950) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克棉布店</b></button>" : "<button type= submit class= btn btn-success>沙巴克棉布店</button>";
    $map_id1952 = ($in_map_id == 1952) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克寄售商</b></button>" : "<button type= submit class= btn btn-success>沙巴克寄售商</button>";

    $map_id1946 = ($in_map_id == 1946) ? "<button type= submit class= btn btn-success><b style='color:green'>马厩</b></button>" : "<button type= submit class= btn btn-success>马厩</button>";
    $map_id1948 = ($in_map_id == 1948) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克中州街</b></button>" : "<button type= submit class= btn btn-success>沙巴克中州街</button>";
    $map_id1949 = ($in_map_id == 1949) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克仓库</b></button>" : "<button type= submit class= btn btn-success>沙巴克仓库</button>";
    $map_id1951 = ($in_map_id == 1951) ? "<button type= submit class= btn btn-success><b style='color:green'>青石街</b></button>" : "<button type= submit class= btn btn-success>青石街</button>";

    $map_id1944 = ($in_map_id == 1944) ? "<button type= submit class= btn btn-success><b style='color:green'>赌坊大厅</b></button>" : "<button type= submit class= btn btn-success>赌坊大厅</button>";
    $map_id1945 = ($in_map_id == 1945) ? "<button type= submit class= btn btn-success><b style='color:green'>客栈大门</b></button>" : "<button type= submit class= btn btn-success>客栈大门</button>";
    $map_id1947 = ($in_map_id == 1947) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克中州街</b></button>" : "<button type= submit class= btn btn-success>沙巴克中州街</button>";
    $map_id1941 = ($in_map_id == 1941) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克制炼所</b></button>" : "<button type= submit class= btn btn-success>沙巴克制炼所</button>";

    $map_id1943 = ($in_map_id == 1943) ? "<button type= submit class= btn btn-success><b style='color:green'>赌坊大门</b></button>" : "<button type= submit class= btn btn-success>赌坊大门</button>";
    $map_id1942 = ($in_map_id == 1942) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克问鼎街</b></button>" : "<button type= submit class= btn btn-success>沙巴克问鼎街</button>";
    $map_id1938 = ($in_map_id == 1938) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克中心鼓楼</b></button>" : "<button type= submit class= btn btn-success>沙巴克中心鼓楼</button>";
    $map_id1939 = ($in_map_id == 1939) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克材料商</b></button>" : "<button type= submit class= btn btn-success>沙巴克材料商</button>";
    $map_id1940 = ($in_map_id == 1940) ? "<button type= submit class= btn btn-success><b style='color:green'>石拱桥</b></button>" : "<button type= submit class= btn btn-success>石拱桥</button>";

    $map_id1935 = ($in_map_id == 1935) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克杂货店</b></button>" : "<button type= submit class= btn btn-success>沙巴克杂货店</button>";
    $map_id1934 = ($in_map_id == 1934) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克青石街</b></button>" : "<button type= submit class= btn btn-success>沙巴克青石街</button>";
    $map_id1936 = ($in_map_id == 1936) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克集市</b></button>" : "<button type= submit class= btn btn-success>沙巴克集市</button>";
    $map_id1937 = ($in_map_id == 1937) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克饰品店</b></button>" : "<button type= submit class= btn btn-success>沙巴克饰品店</button>";

    $map_id1932 = ($in_map_id == 1932) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克武器店</b></button>" : "<button type= submit class= btn btn-success>沙巴克武器店</button>";
    $map_id1931 = ($in_map_id == 1931) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克南大街</b></button>" : "<button type= submit class= btn btn-success>沙巴克南大街</button>";
    $map_id1933 = ($in_map_id == 1933) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克药店</b></button>" : "<button type= submit class= btn btn-success>沙巴克药店</button>";

    $map_id1928 = ($in_map_id == 1928) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克南门</b></button>" : "<button type= submit class= btn btn-success>沙巴克南门</button>";
    $map_id1922 = ($in_map_id == 1922) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克南市</b></button>" : "<button type= submit class= btn btn-success>沙巴克南市</button>";

    $map_id1930 = ($in_map_id == 1930) ? "<button type= submit class= btn btn-success><b style='color:green'>沙巴克租赁店</b></button>" : "<button type= submit class= btn btn-success>沙巴克租赁店</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1959}</th> <th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1958}</th> <th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1957}</th> <th></th> <th></th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1955}</th> <th>—</th> <th>{$map_id1954}</th> <th>—</th> <th>{$map_id1956}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1953}</th> <th></th> <th>{$map_id1950}</th><th></th> <th>{$map_id1952}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td>|</td><td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1946}</th> <th></th> <th>{$map_id1948}</th> <th>—</th> <th>{$map_id1949}</th><th>—</th> <th>{$map_id1951}</th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td>|</td> <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id1944}</th> <th></th><th>{$map_id1945}</th> <th></th> <th>{$map_id1947}</th> <th></th> <th>{$map_id1941}</th><th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td>|</td> <td></td> <td>|</td> <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th>{$map_id1943}</th> <th>—</th><th>{$map_id1942}</th> <th>—</th> <th>{$map_id1938}</th> <th>—</th> <th>{$map_id1939}</th><th>—</th> <th>{$map_id1940}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1935}</th> <th>—</th> <th>{$map_id1934}</th> <th>—</th> <th>{$map_id1936}</th><th>—</th> <th>{$map_id1937}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1932}</th> <th>—</th> <th>{$map_id1931}</th> <th>—</th> <th>{$map_id1933}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1928}</th> <th>—</th> <th>{$map_id1922}</th><th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td>|</td><td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1927}</th> <th></th> <th>{$map_id1930}</th><th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt50()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id1988 = ($in_map_id == 1988) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>灌木林</b></button>";
    $map_id1970 = ($in_map_id == 1970) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>灌木林</b></button>";
    $map_id1963 = ($in_map_id == 1963) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>灌木林</b></button>";

    $map_id1966 = ($in_map_id == 1966) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1969 = ($in_map_id == 1969) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id1960 = ($in_map_id == 1960) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1961 = ($in_map_id == 1961) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1962 = ($in_map_id == 1962) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1964 = ($in_map_id == 1964) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1965 = ($in_map_id == 1965) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1967 = ($in_map_id == 1967) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1968 = ($in_map_id == 1968) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2019 = ($in_map_id == 2019) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2012 = ($in_map_id == 2012) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1971 = ($in_map_id == 1971) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2017 = ($in_map_id == 2017) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2016 = ($in_map_id == 2016) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2018 = ($in_map_id == 2018) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2011 = ($in_map_id == 2011) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2010 = ($in_map_id == 2010) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1972 = ($in_map_id == 1972) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2015 = ($in_map_id == 2015) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2013 = ($in_map_id == 2013) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1973 = ($in_map_id == 1973) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1974 = ($in_map_id == 1974) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1975 = ($in_map_id == 1975) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2014 = ($in_map_id == 2014) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2005 = ($in_map_id == 2005) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2006 = ($in_map_id == 2006) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2007 = ($in_map_id == 2007) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2009 = ($in_map_id == 2009) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1976 = ($in_map_id == 1976) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2004 = ($in_map_id == 2004) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2008 = ($in_map_id == 2008) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1977 = ($in_map_id == 1977) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2002 = ($in_map_id == 2002) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id2003 = ($in_map_id == 2003) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1998 = ($in_map_id == 1998) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1997 = ($in_map_id == 1997) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1995 = ($in_map_id == 1995) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1996 = ($in_map_id == 1996) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1979 = ($in_map_id == 1979) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1978 = ($in_map_id == 1978) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2001 = ($in_map_id == 2001) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1999 = ($in_map_id == 1999) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1994 = ($in_map_id == 1994) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1980 = ($in_map_id == 1980) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id2000 = ($in_map_id == 2000) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1990 = ($in_map_id == 1990) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1991 = ($in_map_id == 1991) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1992 = ($in_map_id == 1992) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1993 = ($in_map_id == 1993) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1982 = ($in_map_id == 1982) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1981 = ($in_map_id == 1981) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id1989 = ($in_map_id == 1989) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1983 = ($in_map_id == 1983) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    $map_id1987 = ($in_map_id == 1987) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1986 = ($in_map_id == 1986) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1985 = ($in_map_id == 1985) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";
    $map_id1984 = ($in_map_id == 1984) ? "<button type= submit class= btn btn-success><b style='color:green'>灌木林</b></button>" : "<button type= submit class= btn btn-success>灌木林</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id1963}</th> <th></th> <th></th><th></th> <th>{$map_id1966}</th><th></th> <th></th><th></th> <th>{$map_id1969}</th> <th>—</th><th>{$map_id1970}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id1960}</th> <th>—</th><th>{$map_id1961}</th> <th>—</th> <th>{$map_id1962}</th> <th>—</th> <th>{$map_id1964}</th><th>—</th> <th>{$map_id1965}</th><th>—</th> <th>{$map_id1967}</th><th>—</th> <th>{$map_id1968}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2019}</th> <th></th> <th></th> <th></th> <th>{$map_id2012}</th><th></th> <th></th><th></th> <th>{$map_id1971}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2017}</th> <th>—</th><th>{$map_id2016}</th> <th>—</th> <th>{$map_id2018}</th> <th>—</th> <th>{$map_id2011}</th><th>—</th> <th>{$map_id2010}</th><th>—</th> <th>{$map_id1972}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2015}</th> <th></th> <th></th> <th></th> <th>{$map_id2013}</th><th></th> <th></th><th></th> <th>{$map_id1973}</th><th>—</th> <th>{$map_id1974}</th> <th>—</th><th>{$map_id1975}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2014}</th> <th>—</th> <th>{$map_id2005}</th> <th>—</th> <th>{$map_id2006}</th><th>—</th> <th>{$map_id2007}</th><th>—</th> <th>{$map_id2009}</th><th></th> <th></th> <th></th><th>{$map_id1976}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id2004}</th> <th></th> <th></th><th></th> <th>{$map_id2008}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id1977}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2002}</th> <th>—</th><th>{$map_id2003}</th> <th>—</th> <th>{$map_id1998}</th> <th>—</th> <th>{$map_id1997}</th><th>—</th> <th>{$map_id1995}</th><th>—</th> <th>{$map_id1996}</th><th>—</th> <th>{$map_id1979}</th> <th>—</th><th>{$map_id1978}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2001}</th> <th></th><th></th> <th></th> <th>{$map_id1999}</th> <th></th> <th></th><th></th> <th>{$map_id1994}</th><th></th> <th></th><th></th> <th>{$map_id1980}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2000}</th> <th>—</th><th>{$map_id1990}</th> <th>—</th> <th>{$map_id1991}</th> <th>—</th> <th>{$map_id1992}</th><th>—</th> <th>{$map_id1993}</th><th>—</th> <th>{$map_id1982}</th><th>—</th> <th>{$map_id1981}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1989}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id1983}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id1988}</th> <th>—</th> <th>{$map_id1987}</th> <th>—</th> <th>{$map_id1986}</th><th>—</th> <th>{$map_id1985}</th><th>—</th> <th>{$map_id1984}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
    echo "<b style='color:blue'>蓝色</b>:表示boss的位置<br>";
}

function dt51()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id2058 = ($in_map_id == 2058) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷1层</b></button>";
    $map_id2085 = ($in_map_id == 2085) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷1层</b></button>";

    $map_id2020 = ($in_map_id == 2020) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2057 = ($in_map_id == 2057) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2066 = ($in_map_id == 2066) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2067 = ($in_map_id == 2067) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2068 = ($in_map_id == 2068) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2021 = ($in_map_id == 2021) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2059 = ($in_map_id == 2059) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2060 = ($in_map_id == 2060) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2061 = ($in_map_id == 2061) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2064 = ($in_map_id == 2064) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2065 = ($in_map_id == 2065) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2069 = ($in_map_id == 2069) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2022 = ($in_map_id == 2022) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2023 = ($in_map_id == 2023) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2024 = ($in_map_id == 2024) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2062 = ($in_map_id == 2062) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2070 = ($in_map_id == 2070) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2101 = ($in_map_id == 2101) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2100 = ($in_map_id == 2100) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2025 = ($in_map_id == 2025) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2063 = ($in_map_id == 2063) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2071 = ($in_map_id == 2071) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2099 = ($in_map_id == 2099) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2098 = ($in_map_id == 2098) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2027 = ($in_map_id == 2027) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2026 = ($in_map_id == 2026) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2054 = ($in_map_id == 2054) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2053 = ($in_map_id == 2053) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2052 = ($in_map_id == 2052) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2051 = ($in_map_id == 2051) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2073 = ($in_map_id == 2073) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2072 = ($in_map_id == 2072) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2097 = ($in_map_id == 2097) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2028 = ($in_map_id == 2028) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2055 = ($in_map_id == 2055) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2050 = ($in_map_id == 2050) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2096 = ($in_map_id == 2096) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2029 = ($in_map_id == 2029) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2030 = ($in_map_id == 2030) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2056 = ($in_map_id == 2056) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2049 = ($in_map_id == 2049) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2074 = ($in_map_id == 2074) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2075 = ($in_map_id == 2075) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2094 = ($in_map_id == 2094) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2095 = ($in_map_id == 2095) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2031 = ($in_map_id == 2031) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2048 = ($in_map_id == 2048) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2076 = ($in_map_id == 2076) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2093 = ($in_map_id == 2093) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2034 = ($in_map_id == 2034) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2033 = ($in_map_id == 2033) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2032 = ($in_map_id == 2032) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2045 = ($in_map_id == 2045) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2044 = ($in_map_id == 2044) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2046 = ($in_map_id == 2046) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2047 = ($in_map_id == 2047) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2077 = ($in_map_id == 2077) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2092 = ($in_map_id == 2092) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2091 = ($in_map_id == 2091) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2090 = ($in_map_id == 2090) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2035 = ($in_map_id == 2035) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2043 = ($in_map_id == 2043) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2078 = ($in_map_id == 2078) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2089 = ($in_map_id == 2089) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2036 = ($in_map_id == 2036) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2042 = ($in_map_id == 2042) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2081 = ($in_map_id == 2081) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2080 = ($in_map_id == 2080) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2079 = ($in_map_id == 2079) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2084 = ($in_map_id == 2084) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2088 = ($in_map_id == 2088) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    $map_id2037 = ($in_map_id == 2037) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2038 = ($in_map_id == 2038) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2039 = ($in_map_id == 2039) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2040 = ($in_map_id == 2040) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2041 = ($in_map_id == 2041) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2083 = ($in_map_id == 2083) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2082 = ($in_map_id == 2082) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2086 = ($in_map_id == 2086) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";
    $map_id2087 = ($in_map_id == 2087) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷1层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷1层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id2020}</th> <th>—</th><th>{$map_id2057}</th> <th>—</th> <th>{$map_id2058}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2066}</th> <th>—</th><th>{$map_id2067}</th> <th>—</th><th>{$map_id2068}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2021}</th> <th></th><th></th> <th></th> <th>{$map_id2059}</th> <th>—</th> <th>{$map_id2060}</th><th>—</th> <th>{$map_id2061}</th><th>—</th> <th>{$map_id2064}</th><th>—</th> <th>{$map_id2065}</th> <th></th><th></th> <th></th><th>{$map_id2069}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2022}</th> <th>—</th><th>{$map_id2023}</th> <th>—</th> <th>{$map_id2024}</th> <th></th> <th></th><th></th> <th>{$map_id2062}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2070}</th> <th>—</th> <th>{$map_id2101}</th> <th>—</th> <th>{$map_id2100}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id2025}</th> <th></th> <th></th><th></th> <th>{$map_id2063}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2071}</th> <th></th> <th></th> <th></th> <th>{$map_id2099}</th> <th>—</th> <th>{$map_id2098}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2027}</th> <th>—</th> <th>{$map_id2026}</th> <th>—</th> <th>{$map_id2054}</th><th>—</th> <th>{$map_id2053}</th><th>—</th> <th>{$map_id2052}</th><th>—</th> <th>{$map_id2051}</th> <th>—</th><th>{$map_id2073}</th> <th>—</th><th>{$map_id2072}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2097}</th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2028}</th> <th></th> <th></th> <th></th> <th>{$map_id2055}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2050}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2096}</th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2029}</th> <th>—</th> <th>{$map_id2030}</th> <th>—</th> <th>{$map_id2056}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2049}</th> <th>—</th><th>{$map_id2074}</th> <th>—</th><th>{$map_id2075}</th> <th></th> <th></th> <th></th> <th>{$map_id2094}</th> <th>—</th> <th>{$map_id2095}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id2031}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2048}</th> <th></th><th></th> <th></th><th>{$map_id2076}</th> <th></th> <th></th> <th></th> <th>{$map_id2093}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>
   
    <tr>  <th>{$map_id2034}</th> <th>—</th><th>{$map_id2033}</th> <th>—</th> <th>{$map_id2032}</th> <th>—</th> <th>{$map_id2045}</th><th>—</th> <th>{$map_id2044}</th><th>—</th> <th>{$map_id2046}</th><th>—</th> <th>{$map_id2047}</th> <th></th><th></th> <th></th><th>{$map_id2077}</th> <th>—</th> <th>{$map_id2092}</th> <th>—</th> <th>{$map_id2091}</th> <th>—</th> <th>{$map_id2090}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>
 
    <tr>  <th>{$map_id2035}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2043}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2078}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2089}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>
   
    <tr>  <th>{$map_id2036}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2042}</th><th></th> <th></th><th></th> <th>{$map_id2081}</th> <th>—</th><th>{$map_id2080}</th> <th>—</th><th>{$map_id2079}</th> <th>—</th> <th>{$map_id2084}</th> <th></th> <th></th> <th></th> <th>{$map_id2088}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td>|</td> </tr>
   
    <tr>  <th>{$map_id2037}</th> <th>—</th><th>{$map_id2038}</th> <th>—</th> <th>{$map_id2039}</th> <th>—</th> <th>{$map_id2040}</th><th>—</th> <th>{$map_id2041}</th><th>—</th> <th>{$map_id2083}</th><th>—</th> <th>{$map_id2082}</th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id2085}</th> <th>—</th> <th>{$map_id2086}</th> <th>—</th> <th>{$map_id2087}</th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt52()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id2102 = ($in_map_id == 2102) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷2层</b></button>";
    $map_id2145 = ($in_map_id == 2145) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷2层</b></button>";

    $map_id2103 = ($in_map_id == 2103) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2114 = ($in_map_id == 2114) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2115 = ($in_map_id == 2115) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2116 = ($in_map_id == 2116) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2127 = ($in_map_id == 2127) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2126 = ($in_map_id == 2126) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2125 = ($in_map_id == 2125) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";

    $map_id2104 = ($in_map_id == 2104) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2111 = ($in_map_id == 2111) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2110 = ($in_map_id == 2110) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2112 = ($in_map_id == 2112) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2113 = ($in_map_id == 2113) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2117 = ($in_map_id == 2117) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2124 = ($in_map_id == 2124) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";

    $map_id2105 = ($in_map_id == 2105) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2109 = ($in_map_id == 2109) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2118 = ($in_map_id == 2118) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2123 = ($in_map_id == 2123) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";

    $map_id2106 = ($in_map_id == 2106) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2107 = ($in_map_id == 2107) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2108 = ($in_map_id == 2108) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2119 = ($in_map_id == 2119) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2120 = ($in_map_id == 2120) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2121 = ($in_map_id == 2121) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2122 = ($in_map_id == 2122) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2143 = ($in_map_id == 2143) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";

    $map_id2175 = ($in_map_id == 2175) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2181 = ($in_map_id == 2181) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2182 = ($in_map_id == 2182) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2128 = ($in_map_id == 2128) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2142 = ($in_map_id == 2142) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";

    $map_id2171 = ($in_map_id == 2171) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2172 = ($in_map_id == 2172) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2173 = ($in_map_id == 2173) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2176 = ($in_map_id == 2176) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2177 = ($in_map_id == 2177) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2180 = ($in_map_id == 2180) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2129 = ($in_map_id == 2129) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2130 = ($in_map_id == 2130) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2141 = ($in_map_id == 2141) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
 
    $map_id2170 = ($in_map_id == 2170) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2174 = ($in_map_id == 2174) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2178 = ($in_map_id == 2178) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2131 = ($in_map_id == 2131) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2140 = ($in_map_id == 2140) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
 
    $map_id2169 = ($in_map_id == 2169) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2168 = ($in_map_id == 2168) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2167 = ($in_map_id == 2167) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2179 = ($in_map_id == 2179) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2132 = ($in_map_id == 2132) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2139 = ($in_map_id == 2139) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
 
    $map_id2166 = ($in_map_id == 2166) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2153 = ($in_map_id == 2153) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2154 = ($in_map_id == 2154) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2155 = ($in_map_id == 2155) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2156 = ($in_map_id == 2156) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2133 = ($in_map_id == 2133) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2134 = ($in_map_id == 2134) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2138 = ($in_map_id == 2138) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
 
    $map_id2164 = ($in_map_id == 2164) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2165 = ($in_map_id == 2165) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2158 = ($in_map_id == 2158) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2157 = ($in_map_id == 2157) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2152 = ($in_map_id == 2152) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2135 = ($in_map_id == 2135) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2136 = ($in_map_id == 2136) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2137 = ($in_map_id == 2137) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
 
    $map_id2163 = ($in_map_id == 2163) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2159 = ($in_map_id == 2159) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2151 = ($in_map_id == 2151) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2150 = ($in_map_id == 2150) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2149 = ($in_map_id == 2149) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2148 = ($in_map_id == 2148) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2144 = ($in_map_id == 2144) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
 
    $map_id2162 = ($in_map_id == 2162) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2161 = ($in_map_id == 2161) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2160 = ($in_map_id == 2160) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2147 = ($in_map_id == 2147) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
    $map_id2146 = ($in_map_id == 2146) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷2层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷2层</button>";
 
    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id2102}</th> <th>—</th><th>{$map_id2103}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2114}</th><th>—</th> <th>{$map_id2115}</th> <th>—</th><th>{$map_id2116}</th> <th>—</th><th>{$map_id2127}</th> <th>—</th> <th>{$map_id2126}</th> <th>—</th> <th>{$map_id2125}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2104}</th> <th>—</th> <th>{$map_id2111}</th> <th>—</th> <th>{$map_id2110}</th><th>—</th> <th>{$map_id2112}</th><th>—</th> <th>{$map_id2113}</th><th></th> <th></th> <th></th><th>{$map_id2117}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id2124}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2105}</th> <th></th> <th></th> <th></th> <th>{$map_id2109}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id2118}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id2123}</th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2106}</th> <th>—</th> <th>{$map_id2107}</th> <th>—</th> <th>{$map_id2108}</th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id2119}</th> <th>—</th><th>{$map_id2120}</th> <th>—</th> <th>{$map_id2121}</th> <th>—</th> <th>{$map_id2122}</th> <th>—</th> <th>{$map_id2143}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id2175}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2181}</th><th>—</th> <th>{$map_id2182}</th> <th>—</th><th>{$map_id2128}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2142}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id2171}</th> <th>—</th><th>{$map_id2172}</th> <th>—</th> <th>{$map_id2173}</th> <th>—</th> <th>{$map_id2176}</th><th>—</th> <th>{$map_id2177}</th><th>—</th> <th>{$map_id2180}</th><th></th> <th></th> <th></th><th>{$map_id2129}</th> <th>—</th><th>{$map_id2130}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2141}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id2170}</th> <th></th><th></th> <th></th> <th>{$map_id2174}</th> <th></th> <th></th><th></th> <th>{$map_id2178}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2131}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2140}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id2169}</th> <th>—</th><th>{$map_id2168}</th> <th>—</th> <th>{$map_id2167}</th> <th></th> <th></th><th></th> <th>{$map_id2179}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2132}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2139}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id2166}</th> <th></th> <th></th><th></th> <th>{$map_id2153}</th><th>—</th> <th>{$map_id2154}</th><th>—</th> <th>{$map_id2155}</th> <th>—</th><th>{$map_id2156}</th> <th>—</th><th>{$map_id2133}</th> <th>—</th> <th>{$map_id2134}</th> <th></th> <th></th> <th></th> <th>{$map_id2138}</th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id2164}</th> <th>—</th><th>{$map_id2165}</th> <th>—</th> <th>{$map_id2158}</th> <th>—</th> <th>{$map_id2157}</th><th></th> <th>{$map_id2152}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id2135}</th> <th>—</th> <th>{$map_id2136}</th> <th>—</th> <th>{$map_id2137}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2163}</th> <th></th><th></th> <th></th> <th>{$map_id2159}</th> <th></th> <th></th><th></th> <th>{$map_id2151}</th><th>—</th> <th>{$map_id2150}</th><th>—</th> <th>{$map_id2149}</th> <th>—</th><th>{$map_id2148}</th> <th></th><th></th> <th></th> <th>{$map_id2144}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2162}</th> <th>—</th><th>{$map_id2161}</th> <th>—</th> <th>{$map_id2160}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id2147}</th> <th>—</th><th>{$map_id2146}</th> <th>—</th> <th>{$map_id2145}</th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt53()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id2191 = ($in_map_id == 2191) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷3层</b></button>";
    $map_id2235 = ($in_map_id == 2235) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷3层</b></button>";

    $map_id2183 = ($in_map_id == 2183) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2184 = ($in_map_id == 2184) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2185 = ($in_map_id == 2185) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2221 = ($in_map_id == 2221) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2220 = ($in_map_id == 2220) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2219 = ($in_map_id == 2219) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2190 = ($in_map_id == 2190) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2186 = ($in_map_id == 2186) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2222 = ($in_map_id == 2222) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2218 = ($in_map_id == 2218) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2189 = ($in_map_id == 2189) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2188 = ($in_map_id == 2188) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2187 = ($in_map_id == 2187) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2226 = ($in_map_id == 2226) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2225 = ($in_map_id == 2225) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2223 = ($in_map_id == 2223) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2217 = ($in_map_id == 2217) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2192 = ($in_map_id == 2192) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2227 = ($in_map_id == 2227) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2224 = ($in_map_id == 2224) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2215 = ($in_map_id == 2215) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2216 = ($in_map_id == 2216) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2193 = ($in_map_id == 2193) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2228 = ($in_map_id == 2228) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2214 = ($in_map_id == 2214) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2195 = ($in_map_id == 2195) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2194 = ($in_map_id == 2194) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2201 = ($in_map_id == 2201) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2229 = ($in_map_id == 2229) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2212 = ($in_map_id == 2212) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2211 = ($in_map_id == 2211) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2210 = ($in_map_id == 2210) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2196 = ($in_map_id == 2196) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2200 = ($in_map_id == 2200) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2202 = ($in_map_id == 2202) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2203 = ($in_map_id == 2203) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2213 = ($in_map_id == 2213) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2209 = ($in_map_id == 2209) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2197 = ($in_map_id == 2197) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2198 = ($in_map_id == 2198) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2199 = ($in_map_id == 2199) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2204 = ($in_map_id == 2204) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2205 = ($in_map_id == 2205) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2206 = ($in_map_id == 2206) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2207 = ($in_map_id == 2207) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2208 = ($in_map_id == 2208) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2249 = ($in_map_id == 2249) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2230 = ($in_map_id == 2230) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2238 = ($in_map_id == 2238) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2247 = ($in_map_id == 2247) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2248 = ($in_map_id == 2248) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2250 = ($in_map_id == 2250) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2251 = ($in_map_id == 2251) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2231 = ($in_map_id == 2231) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2237 = ($in_map_id == 2237) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2246 = ($in_map_id == 2246) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2241 = ($in_map_id == 2241) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2240 = ($in_map_id == 2240) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2239 = ($in_map_id == 2239) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2232 = ($in_map_id == 2232) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2236 = ($in_map_id == 2236) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    $map_id2245 = ($in_map_id == 2245) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2244 = ($in_map_id == 2244) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2243 = ($in_map_id == 2243) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2242 = ($in_map_id == 2242) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2233 = ($in_map_id == 2233) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";
    $map_id2234 = ($in_map_id == 2234) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷3层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷3层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id2183}</th> <th>—</th><th>{$map_id2184}</th> <th>—</th> <th>{$map_id2185}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2221}</th> <th>—</th><th>{$map_id2220}</th> <th>—</th><th>{$map_id2219}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2190}</th> <th></th><th></th> <th></th> <th>{$map_id2186}</th> <th>—</th> <th>{$map_id2191}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2222}</th> <th></th><th></th> <th></th><th>{$map_id2218}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2189}</th> <th>—</th><th>{$map_id2188}</th> <th>—</th> <th>{$map_id2187}</th> <th></th> <th></th><th></th> <th>{$map_id2226}</th><th>—</th> <th>{$map_id2225}</th><th>—</th> <th>{$map_id2223}</th> <th></th><th></th> <th></th><th>{$map_id2217}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2192}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2227}</th><th></th> <th></th><th></th> <th>{$map_id2224}</th> <th>—</th><th>{$map_id2215}</th> <th>—</th><th>{$map_id2216}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2193}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2228}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id2214}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2195}</th> <th>—</th><th>{$map_id2194}</th> <th>—</th> <th>{$map_id2201}</th> <th></th> <th></th><th></th> <th>{$map_id2229}</th><th></th> <th></th><th></th> <th>{$map_id2212}</th> <th>—</th><th>{$map_id2211}</th> <th>—</th><th>{$map_id2210}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2196}</th> <th></th><th></th> <th></th> <th>{$map_id2200}</th> <th>—</th> <th>{$map_id2202}</th><th>—</th> <th>{$map_id2203}</th><th></th> <th></th><th></th> <th>{$map_id2213}</th> <th></th><th></th> <th></th><th>{$map_id2209}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2197}</th> <th>—</th><th>{$map_id2198}</th> <th>—</th> <th>{$map_id2199}</th> <th></th> <th></th><th></th> <th>{$map_id2204}</th><th>—</th> <th>{$map_id2205}</th><th>—</th> <th>{$map_id2206}</th> <th>—</th><th>{$map_id2207}</th> <th>—</th><th>{$map_id2208}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2249}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2230}</th> <th></th><th></th> <th></th><th>{$map_id2238}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2247}</th> <th>—</th><th>{$map_id2248}</th> <th>—</th> <th>{$map_id2250}</th> <th>—</th> <th>{$map_id2251}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2231}</th> <th></th><th></th> <th></th><th>{$map_id2237}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2246}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th>{$map_id2241}</th><th>—</th> <th>{$map_id2240}</th><th>—</th> <th>{$map_id2239}</th><th>—</th> <th>{$map_id2232}</th> <th></th><th></th> <th></th><th>{$map_id2236}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td>|</td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2245}</th> <th>—</th><th>{$map_id2244}</th> <th>—</th> <th>{$map_id2243}</th> <th>—</th> <th>{$map_id2242}</th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2233}</th> <th>—</th><th>{$map_id2234}</th> <th>—</th><th>{$map_id2235}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt54()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id2300 = ($in_map_id == 2300) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷4层</b></button>";
    $map_id2324 = ($in_map_id == 2324) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷4层</b></button>";

    $map_id2253 = ($in_map_id == 2253) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2252 = ($in_map_id == 2252) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2267 = ($in_map_id == 2267) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2303 = ($in_map_id == 2303) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2302 = ($in_map_id == 2302) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2301 = ($in_map_id == 2301) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2254 = ($in_map_id == 2254) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2266 = ($in_map_id == 2266) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2268 = ($in_map_id == 2268) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2269 = ($in_map_id == 2269) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2304 = ($in_map_id == 2304) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2299 = ($in_map_id == 2299) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2255 = ($in_map_id == 2255) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2262 = ($in_map_id == 2262) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2261 = ($in_map_id == 2261) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2265 = ($in_map_id == 2265) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2270 = ($in_map_id == 2270) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2307 = ($in_map_id == 2307) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2305 = ($in_map_id == 2305) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2298 = ($in_map_id == 2298) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2256 = ($in_map_id == 2256) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2260 = ($in_map_id == 2260) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2263 = ($in_map_id == 2263) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2264 = ($in_map_id == 2264) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2272 = ($in_map_id == 2272) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2271 = ($in_map_id == 2271) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2306 = ($in_map_id == 2306) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2296 = ($in_map_id == 2296) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2297 = ($in_map_id == 2297) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2257 = ($in_map_id == 2257) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2258 = ($in_map_id == 2258) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2259 = ($in_map_id == 2259) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2273 = ($in_map_id == 2273) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2295 = ($in_map_id == 2295) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2320 = ($in_map_id == 2320) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2274 = ($in_map_id == 2274) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2281 = ($in_map_id == 2281) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2280 = ($in_map_id == 2280) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2294 = ($in_map_id == 2294) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2293 = ($in_map_id == 2293) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2292 = ($in_map_id == 2292) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2291 = ($in_map_id == 2291) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2321 = ($in_map_id == 2321) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2319 = ($in_map_id == 2319) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2318 = ($in_map_id == 2318) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2275 = ($in_map_id == 2275) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2279 = ($in_map_id == 2279) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2282 = ($in_map_id == 2282) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2283 = ($in_map_id == 2283) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2290 = ($in_map_id == 2290) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2322 = ($in_map_id == 2322) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2316 = ($in_map_id == 2316) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2317 = ($in_map_id == 2317) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2276 = ($in_map_id == 2276) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2277 = ($in_map_id == 2277) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2278 = ($in_map_id == 2278) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2284 = ($in_map_id == 2284) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2289 = ($in_map_id == 2289) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2323 = ($in_map_id == 2323) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2325 = ($in_map_id == 2325) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2315 = ($in_map_id == 2315) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2308 = ($in_map_id == 2308) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2285 = ($in_map_id == 2285) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2286 = ($in_map_id == 2286) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2287 = ($in_map_id == 2287) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2288 = ($in_map_id == 2288) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2314 = ($in_map_id == 2314) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2310 = ($in_map_id == 2310) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2309 = ($in_map_id == 2309) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    $map_id2313 = ($in_map_id == 2313) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2312 = ($in_map_id == 2312) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";
    $map_id2311 = ($in_map_id == 2311) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷4层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷4层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id2253}</th> <th>—</th><th>{$map_id2252}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2267}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2303}</th> <th>—</th> <th>{$map_id2302}</th> <th>—</th> <th>{$map_id2301}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2254}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2266}</th><th>—</th> <th>{$map_id2268}</th><th>—</th> <th>{$map_id2269}</th> <th></th><th></th> <th></th><th>{$map_id2304}</th> <th></th> <th></th> <th></th> <th>{$map_id2299}</th> <th>—</th> <th>{$map_id2300}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2255}</th> <th>—</th><th>{$map_id2262}</th> <th>—</th> <th>{$map_id2261}</th> <th></th> <th></th><th></th> <th>{$map_id2265}</th><th></th> <th></th><th></th> <th>{$map_id2270}</th> <th>—</th><th>{$map_id2307}</th> <th>—</th><th>{$map_id2305}</th> <th></th> <th></th> <th></th> <th>{$map_id2298}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td>|</td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2256}</th> <th></th><th></th> <th></th> <th>{$map_id2260}</th> <th>—</th> <th>{$map_id2263}</th><th>—</th> <th>{$map_id2264}</th><th>—</th> <th>{$map_id2272}</th><th>—</th> <th>{$map_id2271}</th> <th></th><th></th> <th></th><th>{$map_id2306}</th> <th>—</th> <th>{$map_id2296}</th> <th>—</th> <th>{$map_id2297}</th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2257}</th> <th>—</th><th>{$map_id2258}</th> <th>—</th> <th>{$map_id2259}</th> <th></th> <th></th><th></th> <th>{$map_id2273}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th>{$map_id2295}</th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2320}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2274}</th><th>—</th> <th>{$map_id2281}</th><th>—</th> <th>{$map_id2280}</th> <th></th><th></th> <th></th><th>{$map_id2294}</th> <th>—</th> <th>{$map_id2293}</th> <th>—</th> <th>{$map_id2292}</th> <th>—</th> <th>{$map_id2291}</th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id2321}</th> <th>—</th><th>{$map_id2319}</th> <th>—</th> <th>{$map_id2318}</th> <th></th> <th></th><th></th> <th>{$map_id2275}</th><th></th> <th></th><th></th> <th>{$map_id2279}</th> <th>—</th><th>{$map_id2282}</th> <th>—</th><th>{$map_id2283}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2290}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id2322}</th> <th></th><th></th> <th></th> <th>{$map_id2316}</th> <th>—</th> <th>{$map_id2317}</th><th>—</th> <th>{$map_id2276}</th><th>—</th> <th>{$map_id2277}</th><th>—</th> <th>{$map_id2278}</th> <th></th><th></th> <th></th><th>{$map_id2284}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th>{$map_id2289}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>|</td> </tr>

    <tr>  <th>{$map_id2323}</th> <th>—</th><th>{$map_id2325}</th> <th>—</th> <th>{$map_id2315}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2308}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2285}</th> <th>—</th> <th>{$map_id2286}</th> <th>—</th> <th>{$map_id2287}</th> <th>—</th> <th>{$map_id2288}</th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2324}</th> <th></th><th></th> <th></th> <th>{$map_id2314}</th> <th></th> <th></th><th></th> <th>{$map_id2310}</th><th>—</th> <th>{$map_id2309}</th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th></th> <th></th> <th>{$map_id2313}</th> <th>—</th> <th>{$map_id2312}</th><th>—</th> <th>{$map_id2310}</th><th></th> <th></th><th></th> <th></th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
}

function dt55()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_id2337 = ($in_map_id == 2337) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:red'>赤月山谷5层</b></button>";
    $map_id2364 = ($in_map_id == 2364) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>赤月山谷5层</b></button>";
    $map_id2373 = ($in_map_id == 2373) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success><b style='color:blue'>赤月山谷5层</b></button>";

    $map_id2326 = ($in_map_id == 2326) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2379 = ($in_map_id == 2379) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2378 = ($in_map_id == 2378) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2367 = ($in_map_id == 2367) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2366 = ($in_map_id == 2366) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2365 = ($in_map_id == 2365) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2327 = ($in_map_id == 2327) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2377 = ($in_map_id == 2377) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2368 = ($in_map_id == 2368) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2363 = ($in_map_id == 2363) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2328 = ($in_map_id == 2328) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2376 = ($in_map_id == 2376) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2375 = ($in_map_id == 2375) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2370 = ($in_map_id == 2370) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2369 = ($in_map_id == 2369) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2361 = ($in_map_id == 2361) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2362 = ($in_map_id == 2362) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2329 = ($in_map_id == 2329) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2371 = ($in_map_id == 2371) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2360 = ($in_map_id == 2360) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2330 = ($in_map_id == 2330) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2331 = ($in_map_id == 2331) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2372 = ($in_map_id == 2372) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2359 = ($in_map_id == 2359) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2332 = ($in_map_id == 2332) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2374 = ($in_map_id == 2374) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2358 = ($in_map_id == 2358) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2357 = ($in_map_id == 2357) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2334 = ($in_map_id == 2334) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2333 = ($in_map_id == 2333) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2341 = ($in_map_id == 2341) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2342 = ($in_map_id == 2342) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2343 = ($in_map_id == 2343) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2344 = ($in_map_id == 2344) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2356 = ($in_map_id == 2356) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2335 = ($in_map_id == 2335) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2340 = ($in_map_id == 2340) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2345 = ($in_map_id == 2345) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2346 = ($in_map_id == 2346) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2355 = ($in_map_id == 2355) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2336 = ($in_map_id == 2336) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2338 = ($in_map_id == 2338) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2339 = ($in_map_id == 2339) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2347 = ($in_map_id == 2347) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2353 = ($in_map_id == 2353) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2354 = ($in_map_id == 2354) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    $map_id2352 = ($in_map_id == 2352) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2351 = ($in_map_id == 2351) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2350 = ($in_map_id == 2350) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2349 = ($in_map_id == 2349) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";
    $map_id2348 = ($in_map_id == 2348) ? "<button type= submit class= btn btn-success><b style='color:green'>赤月山谷5层</b></button>" : "<button type= submit class= btn btn-success>赤月山谷5层</button>";

    echo "<style>td,th{text-align:center;font-size:12px;}</style><table  border='0'><tbody>

    <tr>  <th>{$map_id2326}</th> <th>—</th><th>{$map_id2379}</th> <th>—</th> <th>{$map_id2378}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2367}</th><th>—</th> <th>{$map_id2366}</th> <th>—</th><th>{$map_id2365}</th> <th>—</th><th>{$map_id2364}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2327}</th> <th></th><th></th> <th></th> <th>{$map_id2377}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2368}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2363}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2328}</th> <th></th><th></th> <th></th> <th>{$map_id2376}</th> <th>—</th> <th>{$map_id2375}</th><th>—</th> <th>{$map_id2370}</th><th>—</th> <th>{$map_id2369}</th><th></th> <th></th> <th></th><th>{$map_id2361}</th> <th>—</th><th>{$map_id2362}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2329}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2371}</th><th></th> <th></th><th></th> <th></th> <th></th><th>{$map_id2360}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td><td></td> <td>|</td><td></td> <td></td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2330}</th> <th>—</th><th>{$map_id2331}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th>{$map_id2372}</th><th>—</th> <th>{$map_id2373}</th><th></th> <th></th> <th></th><th>{$map_id2359}</th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td>|</td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th></th> <th></th><th>{$map_id2332}</th> <th></th> <th></th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2374}</th><th></th> <th></th> <th></th><th>{$map_id2358}</th> <th>—</th><th>{$map_id2357}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2334}</th> <th>—</th><th>{$map_id2333}</th> <th>—</th> <th>{$map_id2341}</th> <th>—</th> <th>{$map_id2342}</th><th>—</th> <th>{$map_id2343}</th><th>—</th> <th>{$map_id2344}</th><th></th> <th></th> <th></th><th></th> <th></th><th>{$map_id2356}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td>|</td><td></td> <td></td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2335}</th> <th></th><th></th> <th></th> <th>{$map_id2340}</th> <th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2345}</th><th>—</th> <th>{$map_id2346}</th> <th></th><th></th> <th></th><th>{$map_id2355}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td>|</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2336}</th> <th>—</th><th>{$map_id2338}</th> <th>—</th> <th>{$map_id2339}</th> <th></th> <th></th><th></th> <th></th><th></th> <th></th><th></th> <th>{$map_id2347}</th> <th>—</th><th>{$map_id2353}</th> <th>—</th><th>{$map_id2354}</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>
    <tr>  <td>|</td> <td></td><td></td> <td></td> <td>|</td> <td></td> <td></td><td></td> <td></td><td></td> <td></td><td></td> <td>|</td> <td></td><td></td> <td></td><td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr>

    <tr>  <th>{$map_id2337}</th> <th></th><th></th> <th></th> <th>{$map_id2352}</th> <th>—</th> <th>{$map_id2351}</th><th>—</th> <th>{$map_id2350}</th><th>—</th> <th>{$map_id2349}</th><th>—</th> <th>{$map_id2348}</th> <th></th><th></th> <th></th><th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr>

    </tbody></table>";

    echo "<b style='color:green'>绿色</b>:表示你当前的位置<br>";
    echo "<b style='color:red'>红色</b>:表示当前地图的出口位置!<br>";
    echo "<b style='color:blue'>蓝色</b>:表示boss的位置<br>";
}

//传送地图
function e300()
{
    value::set_game_user_value('in_map_id', 1);
    e0();
}

//地图传送操作
function dt_cs_cz($m_area_id, $in_map_id)
{
    //比奇矿区地图挖矿操作
    if ($m_area_id > 7 && $m_area_id < 20) {
        cmd::addcmd('bq_wk', "<img src='bq_ks.png' style='width: 20px;height: 20px;'>挖矿");
        br();
    }
    //地图传送入口显示
    if ($in_map_id == 1) {
        cmd::addcmd('map_csz', "<img src='cs.gif' style='width: 25px;height: 25px;'>传送阵");
        br();
    }
    if ($in_map_id == 122) {
        cmd::addcmd('map_csz', "<img src='cs.gif' style='width: 25px;height: 25px;'>传送阵");
        br();
    }
    if ($in_map_id == 583) {
        cmd::addcmd('map_csz', "<img src='cs.gif' style='width: 25px;height: 25px;'>传送阵");
        br();
    }
    if ($in_map_id == 1044) {
        cmd::addcmd('map_csz', "<img src='cs.gif' style='width: 25px;height: 25px;'>传送阵");
        br();
    }
    if ($in_map_id == 203) {
        cmd::addcmd("map_cs_id,221", "<img src='cs.gif' style='width: 25px;height: 25px;'>半兽洞穴");
        br();
    }
    if ($in_map_id == 221) {
        cmd::addcmd("map_cs_id,203", "<img src='cs.gif' style='width: 25px;height: 25px;'>比奇南郊外");
        br();
    }
    if ($in_map_id == 31) {
        cmd::addcmd("map_cs_id,44", "<img src='cs.gif' style='width: 25px;height: 25px;'>银杏废矿");
        br();
    }
    if ($in_map_id == 44) {
        cmd::addcmd("map_cs_id,31", "<img src='cs.gif' style='width: 25px;height: 25px;'>银杏山谷野外");
        br();
    }
    if ($in_map_id == 162) {
        cmd::addcmd("map_cs_id,295", "<img src='cs.gif' style='width: 25px;height: 25px;'>废矿矿山入口");
        br();
    }
    if ($in_map_id == 295) {
        cmd::addcmd("map_cs_id,162", "<img src='cs.gif' style='width: 25px;height: 25px;'>比奇北郊外");
        br();
    }
    if ($in_map_id == 304) {
        cmd::addcmd("map_cs_id,305", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层第二间房");
        br();
    }
    if ($in_map_id == 305) {
        cmd::addcmd("map_cs_id,304", "<img src='cs.gif' style='width: 25px;height: 25px;'>废矿矿山入口");
        br();
    }
    if ($in_map_id == 311) {
        cmd::addcmd("map_cs_id,316", "<img src='cs.gif' style='width: 25px;height: 25px;'>废矿东部洞穴");
        br();
    }
    if ($in_map_id == 316) {
        cmd::addcmd("map_cs_id,311", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层第二间房");
        br();
    }
    if ($in_map_id == 344) {
        cmd::addcmd("map_cs_id,351", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层第三间房");
        br();
    }
    if ($in_map_id == 351) {
        cmd::addcmd("map_cs_id,344", "<img src='cs.gif' style='width: 25px;height: 25px;'>废矿东部洞穴");
        br();
    }
    if ($in_map_id == 362) {
        cmd::addcmd("map_cs_id,363", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层采矿所");
        br();
    }
    if ($in_map_id == 363) {
        cmd::addcmd("map_cs_id,362", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层第三间房");
        br();
    }
    if ($in_map_id == 383) {
        cmd::addcmd("map_cs_id,392", "<img src='cs.gif' style='width: 25px;height: 25px;'>天桥2");
        br();
    }
    if ($in_map_id == 392) {
        cmd::addcmd("map_cs_id,383", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层采矿所");
        br();
    }
    if ($in_map_id == 402) {
        cmd::addcmd("map_cs_id,399", "<img src='cs.gif' style='width: 25px;height: 25px;'>天桥2");
        br();
    }
    if ($in_map_id == 399) {
        cmd::addcmd("map_cs_id,402", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下2层采矿所");
        br();
    }
    if ($in_map_id == 421) {
        cmd::addcmd("map_cs_id,435", "<img src='cs.gif' style='width: 25px;height: 25px;'>天桥3");
        br();
    }
    if ($in_map_id == 435) {
        cmd::addcmd("map_cs_id,421", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下2层采矿所");
        br();
    }
    if ($in_map_id == 447) {
        cmd::addcmd("map_cs_id,442", "<img src='cs.gif' style='width: 25px;height: 25px;'>天桥3");
        br();
    }
    if ($in_map_id == 442) {
        cmd::addcmd("map_cs_id,447", "<img src='cs.gif' style='width: 25px;height: 25px;'>矿石储藏所");
        br();
    }
    if ($in_map_id == 490) {
        cmd::addcmd("map_cs_id,501", "<img src='cs.gif' style='width: 25px;height: 25px;'>天桥1");
        br();
    }
    if ($in_map_id == 501) {
        cmd::addcmd("map_cs_id,490", "<img src='cs.gif' style='width: 25px;height: 25px;'>矿石储藏所");
        br();
    }
    if ($in_map_id == 507) {
        cmd::addcmd("map_cs_id,512", "<img src='cs.gif' style='width: 25px;height: 25px;'>废矿南部洞穴");
        br();
    }
    if ($in_map_id == 512) {
        cmd::addcmd("map_cs_id,507", "<img src='cs.gif' style='width: 25px;height: 25px;'>天桥1");
        br();
    }
    if ($in_map_id == 541) {
        cmd::addcmd("map_cs_id,564", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层第一间房");
        br();
    }
    if ($in_map_id == 564) {
        cmd::addcmd("map_cs_id,541", "<img src='cs.gif' style='width: 25px;height: 25px;'>废矿南部洞穴");
        br();
    }
    if ($in_map_id == 282) {
        cmd::addcmd("map_cs_id,568", "<img src='cs.gif' style='width: 25px;height: 25px;'>地下1层第一间房");
        br();
    }
    if ($in_map_id == 568) {
        cmd::addcmd("map_cs_id,282", "<img src='cs.gif' style='width: 25px;height: 25px;'>废矿矿山入口");
        br();
    }
    if ($in_map_id == 692) {
        cmd::addcmd("map_cs_id,718", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁庙（野外)");
        br();
    }
    if ($in_map_id == 718) {
        cmd::addcmd("map_cs_id,692", "<img src='cs.gif' style='width: 25px;height: 25px;'>盟重北郊外");
        br();
    }
    if ($in_map_id == 726) {
        cmd::addcmd("map_cs_id,763", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁1层");
        br();
    }
    if ($in_map_id == 763) {
        cmd::addcmd("map_cs_id,726", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁庙（野外)");
        br();
    }
    if ($in_map_id == 825) {
        cmd::addcmd("map_cs_id,745", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁1层");
        br();
    }
    if ($in_map_id == 745) {
        cmd::addcmd("map_cs_id,825", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁2层");
        br();
    }
    if ($in_map_id == 808) {
        cmd::addcmd("map_cs_id,858", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁3层");
        br();
    }
    if ($in_map_id == 858) {
        cmd::addcmd("map_cs_id,808", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁2层");
        br();
    }
    
    if ($in_map_id == 936) {
        cmd::addcmd("map_cs_id,879", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁3层");
        br();
    }
    if ($in_map_id == 879) {
        cmd::addcmd("map_cs_id,936", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁4层");
        br();
    }
    if ($in_map_id == 914) {
        cmd::addcmd("map_cs_id,972", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁5层");
        br();
    }
    if ($in_map_id == 972) {
        cmd::addcmd("map_cs_id,914", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁4层");
        br();
    }
    if ($in_map_id == 993) {
        cmd::addcmd("map_cs_id,1038", "<img src='cs.gif' style='width: 25px;height: 25px;'>石阁6层");
        br();
    }
    if ($in_map_id == 165) {
        cmd::addcmd("map_cs_id,1092", "<img src='cs.gif' style='width: 25px;height: 25px;'>道馆郊外");
        br();
    }
    if ($in_map_id == 1092) {
        cmd::addcmd("map_cs_id,165", "<img src='cs.gif' style='width: 25px;height: 25px;'>比奇北郊外");
        br();
    }
    if ($in_map_id == 1105) {
        cmd::addcmd("map_cs_id,1137", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿入口");
        br();
    }
    if ($in_map_id == 1137) {
        cmd::addcmd("map_cs_id,1105", "<img src='cs.gif' style='width: 25px;height: 25px;'>道馆郊外");
        br();
    }

    if ($in_map_id == 1149) {
        cmd::addcmd("map_cs_id,1216", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿1层");
        br();
    }
    if ($in_map_id == 1141) {
        cmd::addcmd("map_cs_id,1216", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿1层");
        br();
    }
    if ($in_map_id == 1145) {
        cmd::addcmd("map_cs_id,1216", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿1层");
        br();
    }
    if ($in_map_id == 1216) {
        cmd::addcmd("map_cs_id,1145", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿入口");
        br();
    }
    if ($in_map_id == 1182) {
        cmd::addcmd("map_cs_id,1279", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿2层");
        br();
    }   
    if ($in_map_id == 1279) {
        cmd::addcmd("map_cs_id,1182", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿1层");
        br();
    }
    if ($in_map_id == 1333) {
        cmd::addcmd("map_cs_id,1330", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿2层");
        br();
    }  
    if ($in_map_id == 1330) {
        cmd::addcmd("map_cs_id,1333", "<img src='cs.gif' style='width: 25px;height: 25px;'>沃玛神殿");
        br();
    }  

    if ($in_map_id == 1386) {
        cmd::addcmd("map_cs_id,1440", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿1层");
        br();
    }  
    if ($in_map_id == 1440) {
        cmd::addcmd("map_cs_id,1386", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿（野外）");
        br();
    } 
    if ($in_map_id == 1504) {
        cmd::addcmd("map_cs_id,1562", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿2层");
        br();
    } 
    if ($in_map_id == 1562) {
        cmd::addcmd("map_cs_id,1504", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿1层");
        br();
    }  
    if ($in_map_id == 1516) {
        cmd::addcmd("map_cs_id,1640", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿3层");
        br();
    } 
    if ($in_map_id == 1640) {
        cmd::addcmd("map_cs_id,1516", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿2层");
        br();
    } 
    if ($in_map_id == 1611) {
        cmd::addcmd("map_cs_id,1745", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿4层");
        br();
    }     
    if ($in_map_id == 1745) {
        cmd::addcmd("map_cs_id,1611", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿3层");
        br();
    } 
    if ($in_map_id == 1678) {
        cmd::addcmd("map_cs_id,1824", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿5层");
        br();
    }    
    if ($in_map_id == 1824) {
        cmd::addcmd("map_cs_id,1678", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿4层");
        br();
    }
    if ($in_map_id == 1762) {
        cmd::addcmd("map_cs_id,1830", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿6层");
        br();
    } 
    if ($in_map_id == 1855) {
        cmd::addcmd("map_cs_id,1856", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿7层");
        br();
    } 
    if ($in_map_id == 1856) {
        cmd::addcmd("map_cs_id,1855", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿7层");
        br();
    } 
    if ($in_map_id == 1882) {
        cmd::addcmd("map_cs_id,1897", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿7层");
        br();
    } 
    if ($in_map_id == 1897) {
        cmd::addcmd("map_cs_id,1882", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛神殿7层");
        br();
    } 
    if ($in_map_id == 1925) {
        cmd::addcmd("map_cs_id,1926", "<img src='cs.gif' style='width: 25px;height: 25px;'>祖玛教主之家");
        br();
    } 
    if ($in_map_id == 1071) {
        cmd::addcmd("map_cs_id,1988", "<img src='cs.gif' style='width: 25px;height: 25px;'>灌木林");
        br();
    } 
    if ($in_map_id == 1988) {
        cmd::addcmd("map_cs_id,1071", "<img src='cs.gif' style='width: 25px;height: 25px;'>道馆郊外");
        br();
    } 
    if ($in_map_id == 1970) {
        cmd::addcmd("map_cs_id,2085", "<img src='cs.gif' style='width: 25px;height: 25px;'>赤月山谷1层");
        br();
    } 
    if ($in_map_id == 2085) {
        cmd::addcmd("map_cs_id,1970", "<img src='cs.gif' style='width: 25px;height: 25px;'>灌木林");
        br();
    } 
    if ($in_map_id == 2145) {
        cmd::addcmd("map_cs_id,2058", "<img src='cs.gif' style='width: 25px;height: 25px;'>赤月山谷1层");
        br();
    }     
    if ($in_map_id == 2058) {
        cmd::addcmd("map_cs_id,2145", "<img src='cs.gif' style='width: 25px;height: 25px;'>赤月山谷2层");
        br();
    } 
}

//传送地图
function e454()
{
    value::set_game_user_value('in_map_id', 1544);
    e0();
}

//传送地图
function e450()
{
    $user_id = uid();
    $sj = mt_rand(10, 100);
    $sj1 = mt_rand(100, 10000);
    item::add_item(199, $sj);
    item::add_money($sj1, $user_id);
    $xs_bx_map = value::get_system_value('xs_bx_map');
    $bx_map_name = value::get_map_value($xs_bx_map, 'name');
    $bx_map_lvl = value::get_map_value($xs_bx_map, 'lvl') * 10000;
    if ($bx_map_lvl > 0) {
        user::get_exp($user_id, $bx_map_lvl);
        $bx_map_exp = $bx_map_lvl;
    } else {
        user::get_exp($user_id, 10000);
        $bx_map_exp = 10000;
    }
    user::get_exp($user_id, 5000);
    $name = value::get_game_user_value('name');
    c_add_guangbo("恭喜玩家{$name}在{$bx_map_name}获得【幸运宝箱】了，获得了{$sj}<span style=color:purple>元宝卷</span>，{$sj1}金币，{$bx_map_exp}经验!");
    value::get_system_value('xs_bx_wj_id', $user_id);
    value::set_system_value('xs_bx_map', 0);
}

function e450_kt()
{
    $user_id = uid();
    $wp_name = "";
    $sj = mt_rand(10, 100);
    $sj1 = mt_rand(100, 10000);
    item::add_item(199, $sj);
    $sj_174 = mt_rand(1, 100);
    if ($sj_174 > 90) {
        item::add_item(174, 1);
    }
    $sj_175 = mt_rand(1, 100);
    if ($sj_175 > 90) {
        $sj23 = mt_rand(0, 3);
        prop::user_get_prop(prop::new_prop(257, 0, $sj23), 0, 1, false, true);
        $wp_name .= "," . value::getvalue('item', 'name', 'id', 257);
    }
    $sj_174 = mt_rand(252, 256);
    $sj22 = mt_rand(0, 3);
    prop::user_get_prop(prop::new_prop($sj_174, 0, $sj22), 0, 1, false, true);
    $wp_name .= "," . value::get_prop_value($sj_174, 'name');
    $sj32 = mt_rand(0, 3);
    prop::user_get_prop(prop::new_prop(258, 0, $sj32), 0, 1, false, true);
    $wp_name .= "," . value::get_prop_value(258, 'name');
    $sj33 = mt_rand(0, 3);
    prop::user_get_prop(prop::new_prop(259, 0, $sj33), 0, 1, false, true);
    $wp_name .= "," . value::get_prop_value(259, 'name');
    $sj34 = mt_rand(0, 3);
    prop::user_get_prop(prop::new_prop(260, 0, $sj34), 0, 1, false, true);
    $wp_name .= "," . value::get_prop_value(260, 'name');
    item::add_money($sj1, $user_id);
    $xs_bx_map = value::get_system_value('xs_kt_map');
    $bx_map_name = value::get_map_value($xs_bx_map, 'name');
    $bx_map_lvl = value::get_map_value($xs_bx_map, 'lvl') * 10000;
    if ($bx_map_lvl > 0) {
        user::get_exp($user_id, $bx_map_lvl);
        $bx_map_exp = $bx_map_lvl;
    } else {
        user::get_exp($user_id, 10000);
        $bx_map_exp = 10000;
    }
    user::get_exp($user_id, 5000);
    $name = value::get_game_user_value('name');
    c_add_guangbo("恭喜玩家{$name}在{$bx_map_name}获得<img src='kt.png' >【空投】了，获得了{$wp_name},{$sj}<span style=color:purple>元宝卷</span>，{$sj1}金币，{$bx_map_exp}经验!");
    value::get_system_value('xs_kt_wj_id', $user_id);
    value::set_system_value('xs_kt_map', 0);
}

//传送地图
function e451()
{
    $xs_bx_jy = mt_rand(10000, 50000);
    $xs_bx_jq = mt_rand(100, 1000);
    item::add_item(216, $xs_bx_jy);
    item::add_item(222, -1);
    value::add_user_value('money', $xs_bx_jq);
}

//传送地图
function e452()
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 【幸运宝箱】";
    br();
    echo "-";
    br();
    $xs_bx_map = value::get_system_value('xs_bx_map');
    $xs_bx_wj_id = value::get_system_value('xs_bx_wj_id');
    $bx_map_name = value::get_map_value($xs_bx_map, 'name');
    $name = value::get_game_user_value('name');
    $b_name = value::get_game_user_value('name', $xs_bx_wj_id);
    echo "刷新时间：60分";
    br();
    echo "  ";
    echo "位置：";
    echo "  ";
    if ($xs_bx_map > 0) {
        echo "{$bx_map_name}";
    } else {
        echo "被{$b_name}抢了";
    }
    br();
    echo "-";
    br();
    echo "说明：每小时重新刷新幸运宝箱地图位置，寻找可以获得大量元宝卷,金币,经验奖励！";
    br();
    echo "-";
}

function e452_kt()
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 【吃鸡空投物资】";
    br();
    echo "-";
    br();
    $xs_bx_map = value::get_system_value('xs_kt_map');
    $xs_bx_wj_id = value::get_system_value('xs_kt_wj_id');
    $bx_map_name = value::get_map_value($xs_bx_map, 'name');
    $name = value::get_game_user_value('name');
    $b_name = value::get_game_user_value('name', $xs_bx_wj_id);
    echo "刷新时间：10分";
    br();
    echo "  ";
    echo "位置：";
    echo "  ";
    if ($xs_bx_map > 0) {
        echo "{$bx_map_name}";
    } else {
        echo "被{$b_name}抢了";
    }
    br();
    echo "-";
    br();
    echo "说明：每10分钟重新刷新空投物资地图位置，空投物资的东西也是很丰富的，武器，防具，药品都会产出！";
    br();
    echo "-";
}

//传送地图
function lz_e452()
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 寻找七龙珠";
    br();
    echo "-";
    br();
    $map_lz_wz_id1 = value::get_system_value('map_lz_wz_id1');
    echo "刷新时间：60分";
    br();
    echo "介绍：“英雄守护神”降临世界，帮你实现你最想实现的愿望！";
    br();
    echo "-";
    br();
    echo "召魂使：一星珠地下2层采矿所";
    echo "  ";
    if ($map_lz_wz_id1 > 0) {
        echo "已出现";
    } else {
        echo "未刷新";
    }
    br();
    echo "利爪魔：二星珠石阁5层";
    echo "  ";
    $map_lz_wz_id2 = value::get_system_value('map_lz_wz_id2');
    if ($map_lz_wz_id2 > 0) {
        echo "已出现";
    } else {
        echo "未刷新";
    }
    br();
    echo "烈火鸡：三星珠沃玛神殿2层";
    echo "  ";
    $map_lz_wz_id3 = value::get_system_value('map_lz_wz_id3');
    if ($map_lz_wz_id3 > 0) {
        echo "已出现";
    } else {
        echo "未刷新";
    }
    br();
    echo "炼金魔：四星珠祖玛神殿5层";
    echo "  ";
    $map_lz_wz_id4 = value::get_system_value('map_lz_wz_id4');
    if ($map_lz_wz_id4 > 0) {
        echo "已出现";
    } else {
        echo "未刷新";
    }
    br();
    echo "铁刺魔：五星珠赤月山谷2层";
    echo "  ";
    $map_lz_wz_id5 = value::get_system_value('map_lz_wz_id5');
    if ($map_lz_wz_id5 > 0) {
        echo "已出现";
    } else {
        echo "未刷新";
    }
    br();
    echo "妖力士：六星珠魔龙林间胜地";
    echo "  ";
    $map_lz_wz_id6 = value::get_system_value('map_lz_wz_id6');
    if ($map_lz_wz_id6 > 0) {
        echo "已出现";
    } else {
        echo "未刷新";
    }
    br();
    echo "烈焰使：七星珠万年谷四层";
    echo "  ";
    $map_lz_wz_id7 = value::get_system_value('map_lz_wz_id7');
    if ($map_lz_wz_id7 > 0) {
        echo "已出现";
    } else {
        echo "未刷新";
    }
    br();
    echo "-";
    br();
    cmd::addcmd('lz_zhsl', '(集齐七龙珠)召唤神龙');
    br();
    echo "-";
    br();
    echo "说明：每天每一小时左右地图中会在一定范围内地图随机刷新携带龙珠的怪物，那些怪物都是必暴龙珠哦！";
    br();
    echo "-";
}

function lz_zhsl($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 寻找七龙珠";
    br();
    echo "-";
    br();
    if ($lb > 0) {
        $sx_244 = item::get_item(244);
        $sx_245 = item::get_item(245);
        $sx_246 = item::get_item(246);
        $sx_247 = item::get_item(247);
        $sx_248 = item::get_item(248);
        $sx_249 = item::get_item(249);
        $sx_250 = item::get_item(250);
        if ($sx_244 > 0 && $sx_245 > 0 && $sx_246 > 0 && $sx_247 > 0 && $sx_248 > 0 && $sx_249 > 0 && $sx_250 > 0) {
            item::add_item(244, -1);
            item::add_item(245, -1);
            item::add_item(246, -1);
            item::add_item(247, -1);
            item::add_item(248, -1);
            item::add_item(249, -1);
            item::add_item(250, -1);
            if ($lb == 1) {
                item::add_money(1000000, $user_id);
                $name = value::get_game_user_value('name', $user_id);
                echo "恭喜玩家" . $name . "在七龙珠活动成功许愿财富1000000金币!";
                c_add_guangbo('恭喜玩家' . $name . '在七龙珠活动成功许愿财富1000000金币!');
            }
            if ($lb == 2) {
                item::add_item(1, 100);
                $name = value::get_game_user_value('name', $user_id);
                echo "恭喜玩家" . $name . "在七龙珠活动成功许愿100元宝!";
                c_add_guangbo('恭喜玩家' . $name . '在七龙珠活动成功许愿100元宝!');
            }
            if ($lb == 3) {
                $add_sql = "AND star>1 AND equip_use_lvl<61";
                //装备id
                $sql = "SELECT `id`,`liangci`,`name` FROM `prop` WHERE `leixing`=2 {$add_sql} ORDER BY RAND() LIMIT 1";
                $result = sql($sql);
                list($prop_id, $prop_liangci, $prop_name) = $result->fetch_row();
                //装备星级
                $sj = mt_rand(1, 3);
                $equip_id = prop::new_prop($prop_id, 0, $sj);
                prop::user_get_prop($equip_id, 0, 1, false, true);
                $name = value::get_game_user_value('name', $user_id);
                echo "恭喜你在七龙珠活动成功许愿神兵!";
                $ts_name = "恭喜玩家" . $name . "在七龙珠活动成功许愿神兵获得了";
                c_add_guangbo($ts_name, $equip_id, 4);
            }
            if ($lb == 4) {
                $user_id = uid();
                $sql = "SELECT `id`,`star` FROM `pet` WHERE `star`>1 AND `star`<6 ORDER BY RAND() DESC LIMIT 1";
                $result = sql($sql);
                list($pet_id, $star) = $result->fetch_row();
                //开始生成
                $new_pet_id = pet::new_pet($pet_id, 1, 0, $user_id, 0, 0, 0, 0, 0, 0);
                cj_cw($new_pet_id);
                $name = value::get_game_user_value('name', $user_id);
                echo "恭喜你在七龙珠活动成功许愿神宠!";
                $ts_name1 = "恭喜玩家" . $name . "在七龙珠活动成功许愿获得了";
                c_add_guangbo($ts_name1, $new_pet_id, 5);
            }
            if ($lb == 5) {
                user::get_exp($user_id, 1000000);
                $name = value::get_game_user_value('name', $user_id);
                echo "恭喜玩家" . $name . "在七龙珠活动成功许愿1000000经验!";
                c_add_guangbo("恭喜玩家" . $name . "在七龙珠活动成功许愿1000000经验!");
            }
        } else {
            echo "你的七龙珠没有收集齐！";
        }
    } else {
        cmd::addcmd('lz_zhsl,1', '许愿财富');
        br();
        cmd::addcmd('lz_zhsl,2', '许愿元宝');
        br();
        cmd::addcmd('lz_zhsl,3', '许愿神兵');
        br();
        cmd::addcmd('lz_zhsl,4', '许愿神宠');
        br();
        cmd::addcmd('lz_zhsl,5', '许愿经验');
    }
    br();
    echo "-";
}

function cj_cw($pet_id)
{
    $user_id = uid();
    value::set_pet_value($pet_id, 'master_mode', 1);
    value::set_pet_value($pet_id, 'hp', 100);
    value::set_pet_value($pet_id, 'max_hp', 100);
    value::set_pet_value($pet_id, 'max_exp', 100);
    value::set_pet_value($pet_id, 'chujing', 100);
    value::set_pet_value($pet_id, 'll', 1);
    value::set_pet_value($pet_id, 'nl', 1);
    value::set_pet_value($pet_id, 'tz', 1);
    $pet_id1 = value::get_pet_value($pet_id, 'pet_id');
    $sj = mt_rand(1, 10);
    if ($pet_id1 == 215) {
        value::set_pet_value($pet_id, 'star', $sj);
    }
}

function hd_sx_dh_jl($xy_wp, $jl_wp)
{
    $user_id = uid();
    $sx_wp = item::get_item($xy_wp);
    $item_name = value::get_item_value($xy_wp, 'name');
    $hd_sx_dh = value::get_user_value('hd_sx_dh' . $jl_wp, $user_id);
    $hd_sx_dh1 = value::get_user_value('hd_sx_dh1', $user_id);
    $hd_sx_dh2 = value::get_user_value('hd_sx_dh2', $user_id);
    $hd_sx_dh3 = value::get_user_value('hd_sx_dh3', $user_id);
    $hd_sx_dh4 = value::get_user_value('hd_sx_dh4', $user_id);
    $hd_sx_dh5 = value::get_user_value('hd_sx_dh5', $user_id);
    $hd_sx_dh6 = value::get_user_value('hd_sx_dh6', $user_id);
    $hd_sx_dh7 = value::get_user_value('hd_sx_dh7', $user_id);
    $hd_sx_dh8 = value::get_user_value('hd_sx_dh8', $user_id);
    $hd_sx_dh9 = value::get_user_value('hd_sx_dh9', $user_id);
    $hd_sx_dh10 = value::get_user_value('hd_sx_dh10', $user_id);
    $hd_sx_dh11 = value::get_user_value('hd_sx_dh11', $user_id);
    $hd_sx_dh12 = value::get_user_value('hd_sx_dh12', $user_id);
    if ($hd_sx_dh < 1) {
        if ($jl_wp == 13) {
            if ($hd_sx_dh1 && $hd_sx_dh2 && $hd_sx_dh3 && $hd_sx_dh4 && $hd_sx_dh5 && $hd_sx_dh6 && $hd_sx_dh7 && $hd_sx_dh8 && $hd_sx_dh9 && $hd_sx_dh10 && $hd_sx_dh11 && $hd_sx_dh12) {
                $pet_id = pet::new_pet(215, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                cj_cw($pet_id);
                $name = value::get_pet_value($pet_id, 'name');
                c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name);
                echo '恭喜你获得了' . $name;
                br();
                value::set_user_value('hd_sx_dh' . $jl_wp, 1, $user_id);
            } else {
                echo "需要收齐十二生肖称号才能兑换！";
                br();
            }
        } else {
            if ($sx_wp > 9) {
                item::add_item($xy_wp, -10);
                $map_id = value::get_game_user_value('in_map_id', $user_id);
                $user_name = value::get_game_user_value('name', $user_id);
                switch ($jl_wp) {
                    case 1:
                        $pet_id = pet::new_pet(85, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break;
                    case 2:
                        $pet_id = pet::new_pet(86, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break; 
                    case 3:
                        $pet_id = pet::new_pet(87, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break; 
                    case 4:
                        $pet_id = pet::new_pet(88, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break; 
                    case 5:
                        $pet_id = pet::new_pet(89, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break; 
                    case 6:
                        $pet_id = pet::new_pet(90, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break; 
                    case 7:
                        $pet_id = pet::new_pet(91, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break;
                    case 8:
                        $pet_id = pet::new_pet(92, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break;
                    case 9:
                        $pet_id = pet::new_pet(93, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break;
                    case 10:
                        $pet_id = pet::new_pet(94, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break;
                    case 11:
                        $pet_id = pet::new_pet(95, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break;
                    case 12:
                        $pet_id = pet::new_pet(96, 0, 0, $user_id, 0, 0, 0, 0, 0, 0);
                        cj_cw($pet_id);
                        $name = value::get_pet_value($pet_id, 'name');
                        c_add_guangbo('恭喜' . $user_name . '在十二生肖活动中获得了' . $name . '的称号!');
                        echo '恭喜你获得了' . $name . '称号。';
                        br();
                        value::insert_user_value('nick_name', $name);
                        if (!value::get_user_value('using_nick_name')) {
                            value::set_user_value('using_nick_name', $name);
                        }
                        echo "恭喜你在十二生肖活动兑换了{$name}宠物!";
                        br();
                        c_add_guangbo("恭喜玩家{$user_name}在十二生肖活动兑换了{$name}宠物!");
                        break;         
                    default:
                        break;
                }
                value::set_user_value('hd_sx_dh' . $jl_wp, 1, $user_id);
            } else {
                echo "兑换需要10个{$item_name}碎片！";
                br();
            }
        }
    } else {
        echo "你已经兑换过，不能重复兑换！";
        br();
    }
}

function hd_sx_e452()
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 寻找十二生肖";
    br();
    echo "-";
    br();
    echo "刷新时间：60分";
    br();
    echo "介绍：“十二金生肖守护神”降临世界，寻找获得大量金钱和经验,必掉落碎片！";
    br();
    echo "-";
    br();
    echo "<span style=color:orange>【金鼠】</span>：";
    $map_sesx_id5 = value::get_system_value('map_sesx_id5');
    $map_name5 = value::get_map_value($map_sesx_id5, 'name');
    if (value::get_map_value($map_sesx_id5, 'sxts_boss') > 0) {
        echo $map_name5;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_251 = item::get_item(251);
    echo "碎片(<span style=color:green>{$sx_251}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,251,1', '兑换');
    br();
    echo "<span style=color:orange>【金牛】</span>：";
    echo "  ";
    $map_sesx_id10 = value::get_system_value('map_sesx_id10');
    $map_name10 = value::get_map_value($map_sesx_id10, 'name');
    if (value::get_map_value($map_sesx_id10, 'sxts_boss') > 0) {
        echo $map_name10;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_252 = item::get_item(252);
    echo "碎片(<span style=color:green>{$sx_252}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,252,2', '兑换');
    br();
    echo "<span style=color:orange>【金虎】</span>：";
    echo "  ";
    $map_sesx_id15 = value::get_system_value('map_sesx_id15');
    $map_name15 = value::get_map_value($map_sesx_id15, 'name');
    if (value::get_map_value($map_sesx_id15, 'sxts_boss') > 0) {
        echo $map_name15;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_253 = item::get_item(253);
    echo "碎片(<span style=color:green>{$sx_253}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,253,3', '兑换');
    br();
    echo "<span style=color:orange>【金兔】</span>：";
    echo "  ";
    $map_sesx_id20 = value::get_system_value('map_sesx_id20');
    $map_name20 = value::get_map_value($map_sesx_id20, 'name');
    if (value::get_map_value($map_sesx_id20, 'sxts_boss') > 0) {
        echo $map_name20;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_254 = item::get_item(254);
    echo "碎片(<span style=color:green>{$sx_254}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,254,4', '兑换');
    br();
    echo "<span style=color:orange>【金龙】</span>：";
    echo "  ";
    $map_sesx_id25 = value::get_system_value('map_sesx_id25');
    $map_name25 = value::get_map_value($map_sesx_id25, 'name');
    if (value::get_map_value($map_sesx_id25, 'sxts_boss') > 0) {
        echo $map_name25;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_255 = item::get_item(255);
    echo "碎片(<span style=color:green>{$sx_255}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,255,5', '兑换');
    br();
    echo "<span style=color:orange>【金蛇】</span>：";
    echo "  ";
    $map_sesx_id30 = value::get_system_value('map_sesx_id30');
    $map_name30 = value::get_map_value($map_sesx_id30, 'name');
    if (value::get_map_value($map_sesx_id30, 'sxts_boss') > 0) {
        echo $map_name30;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_256 = item::get_item(256);
    echo "碎片(<span style=color:green>{$sx_256}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,256,6', '兑换');
    br();
    echo "<span style=color:orange>【金马】</span>：";
    echo "  ";
    $map_sesx_id35 = value::get_system_value('map_sesx_id35');
    $map_name35 = value::get_map_value($map_sesx_id35, 'name');
    if (value::get_map_value($map_sesx_id35, 'sxts_boss') > 0) {
        echo $map_name35;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_257 = item::get_item(257);
    echo "碎片(<span style=color:green>{$sx_257}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,257,7', '兑换');
    br();
    echo "<span style=color:orange>【金羊】</span>：";
    echo "  ";
    $map_sesx_id40 = value::get_system_value('map_sesx_id40');
    $map_name40 = value::get_map_value($map_sesx_id40, 'name');
    if (value::get_map_value($map_sesx_id40, 'sxts_boss') > 0) {
        echo $map_name40;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_258 = item::get_item(258);
    echo "碎片(<span style=color:green>{$sx_258}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,258,8', '兑换');
    br();
    echo "<span style=color:orange>【金猴】</span>：";
    echo "  ";
    $map_sesx_id45 = value::get_system_value('map_sesx_id45');
    $map_name45 = value::get_map_value($map_sesx_id45, 'name');
    if (value::get_map_value($map_sesx_id45, 'sxts_boss') > 0) {
        echo $map_name45;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_259 = item::get_item(259);
    echo "碎片(<span style=color:green>{$sx_259}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,259,9', '兑换');
    br();
    echo "<span style=color:orange>【金鸡】</span>：";
    echo "  ";
    $map_sesx_id50 = value::get_system_value('map_sesx_id50');
    $map_name50 = value::get_map_value($map_sesx_id50, 'name');
    if (value::get_map_value($map_sesx_id50, 'sxts_boss') > 0) {
        echo $map_name50;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_260 = item::get_item(260);
    echo "碎片(<span style=color:green>{$sx_260}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,260,10', '兑换');
    br();
    echo "<span style=color:orange>【金狗】</span>：";
    echo "  ";
    $map_sesx_id55 = value::get_system_value('map_sesx_id55');
    $map_name55 = value::get_map_value($map_sesx_id55, 'name');
    if (value::get_map_value($map_sesx_id55, 'sxts_boss') > 0) {
        echo $map_name55;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_261 = item::get_item(261);
    echo "碎片(<span style=color:green>{$sx_261}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,261,11', '兑换');
    br();
    echo "<span style=color:orange>【金猪】</span>：";
    echo "  ";
    $map_sesx_id59 = value::get_system_value('map_sesx_id59');
    $map_name59 = value::get_map_value($map_sesx_id59, 'name');
    if (value::get_map_value($map_sesx_id59, 'sxts_boss') > 0) {
        echo $map_name59;
    } else {
        echo "未刷新";
    }
    echo "   ";
    $sx_262 = item::get_item(262);
    echo "碎片(<span style=color:green>{$sx_262}</span> / 10）";
    cmd::addcmd('hd_sx_dh_jl,262,12', '兑换');
    br();
    echo "-";
    br();
    echo "终极：<span style=color:red>收齐十二生肖称号</span>兑换<span style=color:purple>【五彩神牛】</span>";
    cmd::addcmd('hd_sx_dh_jl,0,13', '兑换');
    br();
    echo "-";
    br();
    echo "说明：<span style=color:purple>【五彩神牛】</span>品级随机生成1星到10星，全看人品哦！每小时左右地图中会随机刷新携带大量金币的生肖怪物，生肖碎片可以兑换生肖称号和生肖宠物！";
    br();
    echo "-";
}

function hd_xy_e452()
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 成为幸运玩家";
    br();
    echo "-";
    br();
    echo "刷新时间：60分";
    br();
    echo "介绍：“系统幸运神”降临世界，每小时系统随机抽取五名在线玩家奖励大量金钱，经验，元宝卷！";
    br();
    echo "-";
    br();
    $xs_yb_sz_id1 = value::get_system_value('xs_xy_yb_sz_id1');
    $xs_yb_sz_name1 = value::get_game_user_value('name', $xs_yb_sz_id1);
    $xs_yb_sz_id2 = value::get_system_value('xs_xy_yb_sz_id2');
    $xs_yb_sz_name2 = value::get_game_user_value('name', $xs_yb_sz_id2);
    $xs_yb_sz_id3 = value::get_system_value('xs_xy_yb_sz_id3');
    $xs_yb_sz_name3 = value::get_game_user_value('name', $xs_yb_sz_id3);
    $xs_yb_sz_id4 = value::get_system_value('xs_xy_yb_sz_id4');
    $xs_yb_sz_name4 = value::get_game_user_value('name', $xs_yb_sz_id4);
    $xs_yb_sz_id5 = value::get_system_value('xs_xy_yb_sz_id5');
    $xs_yb_sz_name5 = value::get_game_user_value('name', $xs_yb_sz_id5);
    echo "系统幸运神随机抽取的玩家：";
    br();
    echo "幸运玩家一：" . $xs_yb_sz_name1;
    br();
    echo "幸运玩家二：" . $xs_yb_sz_name2;
    br();
    echo "幸运玩家三：" . $xs_yb_sz_name3;
    br();
    echo "幸运玩家四：" . $xs_yb_sz_name4;
    br();
    echo "幸运玩家五：" . $xs_yb_sz_name5;
    br();
    echo "-";
    br();
    echo "说明：每天每小时整点抽取五名在线玩家成为幸运玩家哦！";
    br();
    echo "-";
}

//传送地图
function e453()
{
    echo "车夫王富偷偷告诉你:桃花谷在杏林南面树林里面,穿过树林就到了!";
}

//任务传送地图
function e400()
{    
    $user_id = uid();
    $i45 = item::get_item(45, $user_id);
    if ($i45) {
        item::add_item(45, -1);
        $to_map = value::get_user_value('to_map');
        value::set_game_user_value('in_map_id', $to_map);
        e0();
    } else {
        echo "你没有【任务传送卷】无法传送，商场有售!";
    }
}

//任务传送地图
function e444()
{
    $user_id = uid();
    $i45 = item::get_item(45, $user_id);
    if ($i45) {
        item::add_item(45, -1);
        $to_map = value::get_user_value('to_map');
        value::set_game_user_value('in_map_id', $to_map);
        e0();
    } else {
        echo "你没有【任务传送卷】无法传送，商场有售!";
    }
}

//任务传送地图
function e445()
{
    $user_id = uid();
    $i45 = item::get_item(45, $user_id);
    if ($i45) {
        item::add_item(45, -1);
        $to_map2 = value::get_user_value('to_map2');
        value::set_game_user_value('in_map_id', $to_map2);
        e0();
    } else {
        echo "你没有【任务传送卷】无法传送，商场有售!";
    }
}

//任务传送地图
function e446()
{
    $user_id = uid();
    $i45 = item::get_item(45, $user_id);
    if ($i45) {
        item::add_item(45, -1);
        $to_map3 = value::get_user_value('to_map3');
        value::set_game_user_value('in_map_id', $to_map3);
        e0();
    } else {
        echo "你没有【任务传送卷】无法传送，商场有售!";
    }
}

//任务传送地图
function e447()
{
    $user_id = uid();
    $i45 = item::get_item(45, $user_id);
    if ($i45) {
        item::add_item(45, -1);
        $to_map4 = value::get_user_value('to_map4');
        value::set_game_user_value('in_map_id', $to_map4);
        e0();
    } else {
        echo "你没有【任务传送卷】无法传送，商场有售!";
    }
}

//传送副本10级地图
function e311()
{
    if (user::get_max_pet_lvl() >= 10) {
        echo "你已传送进入八角寨副本!";
        br();
        value::set_game_user_value('in_map_id', 1318);
    } else {
        echo "你的宠物等级没有10级无法进入八角寨副本!";
    }
}

//传送副本10级地图
function e340()
{
    item::add_item(215, -1);
    $mj_time = date("Y-m-d H:i:s");
    $mj_sy_time = date("Y-m-d H:i:s");
    value::set_user_value('mj_sy_time', $mj_sy_time);
    $mj_shengyu_time = strtotime($mj_sy_time) - strtotime($mj_time);
    $mj_shengyu_minute = 60 + (int)($mj_shengyu_time % 3600 / 60);
    value::set_game_user_value('in_map_id', 1331);
    $wj_name = value::get_game_user_value('name');
    c_add_guangbo("玩家{$wj_name}进入废矿东部洞穴,里面掉落大量经验,金钱,技能,装备!");
    echo "你传送进入废矿东部洞穴地图!<br>
    你还剩{$mj_shengyu_minute}分钟将传送出去!";
    br();
}

//【黄金宝箱（10级）】
function e341()
{
    $wp_sl = item::get_item(219);
    if ($wp_sl > 0) {
        //随机装备
        $zb = mt_rand(85, 96);
        $sj = mt_rand(1, 1000);
        if ($sj <= 5) {
            //圣凶 1-5
            $sji = 7;
        } elseif ($sj <= 20) {
            //五神 6-10
            $sji = 6;
        } elseif ($sj <= 50) {
            //山海经 11-50
            $sji = 5;
        } elseif ($sj <= 100) {
            //合成宠物 51-300
            $sji = 4;
        } elseif ($sj <= 200) {
            //新将 301-500
            $sji = 3;
        } elseif ($sj <= 400) {
            //新将 301-500
            $sji = 2;
        } elseif ($sj <= 600) {
            //新将 301-500
            $sji = 1;
        } else {
            //普通 501-1000
            $sji = 0;
        }
        item::add_item(212, -1);
        item::add_item(219, -1);
        $bx_name = value::get_prop_value($zb, 'name');
        prop::user_get_prop(prop::new_prop($zb, 0, $sji), 0, 1, false, true);
        echo "开启宝箱获得{$bx_name}!";
        br();
    } else {
        echo "你背包没有黄金钥匙无法开启宝箱!";
        br();
    }
}

//传送副本10级地图
function e320()
{
    $fb10_time = 60 - date("i");
    echo "副本名称:八角寨副本<br>
    副本等级:10级<br>
    入口:银杏村村口<br>
    BOSS数量:4<br>
    Boss名称:<br>
    1.【刘寨主】<br>
    2.【萧独眼】<br>
    3.【刘龟仙】<br>
    4.【玉牡丹】<br>";
    cmd::addcmd('e311', '进入八角寨副本(10级)');
    br();
    echo " 副本重置还剩余:<span style='color:red'>{$fb10_time}</span>分钟!<br>10级<span style='color:green'>绿色套装</span>:";
    cmd::addcmd('e334', '兑换');
    br();
    echo "10级解封丹:";
    cmd::addcmd('e336', '兑换');
    br();
    echo "【出村令】:";
    cmd::addcmd('e361', '兑换');
    br();
}

//传送魏郡地图
function e350()
{
    $cs_fb10_money = value::get_user_value("cs_fb10_money");
    if ($cs_fb10_money > 0) {
        echo "你已传送到魏郡!";
        br();
        value::set_game_user_value('in_map_id', 1344);
    } else {
        echo "你没有完成八角寨副本获得【出村令】无法传送到魏郡!";
    }
}

//传送魏郡地图
function e355()
{
    echo "你已传送到银杏村!";
    br();
    value::set_game_user_value('in_map_id', 1);
}

//【出村令】
function e366()
{
    item::add_item(220, -1);
    value::set_user_value("cs_fb10_money", 1);
    echo "你使用【出村令】可以出村传送到魏郡!";
    br();
}

//入群礼包获得物品
function rq_e310()
{
    $user_id = uid();
    echo "你领取了推广拉人礼包!";
    br();
    item::add_item(1, 800);
    item::add_item(290, 1);
    item::add_item(185, 1);
    item::add_item(186, 1);
    item::add_item(187, 1);
    item::add_item(188, 1);
    item::add_item(189, 1);
    item::add_item(222, 1);
    item::add_item(287, 1000);
    $name = value::get_game_user_value('name', $user_id);
    c_add_guangbo("玩家{$name}领取了推广拉人礼包！");
}

//宣传礼包获得物品
function xc_e310()
{
    $user_id = uid();
    echo "你领取了空间宣传礼包!";
    br();
    item::add_item(1, 800);
    item::add_item(290, 1);
    item::add_item(172, 1);
    item::add_item(296, 1);
    item::add_item(287, 1000);
    $name = value::get_game_user_value('name', $user_id);
    c_add_guangbo("玩家{$name}领取了空间宣传礼包！");
}

function xc_e310_1()
{
    $user_id = uid();
    echo "你领取了7天空间连续推广礼包!";
    br();
    item::add_item(133, 1);
    item::add_item(285, 1);
    item::add_item(290, 1);
    item::add_item(195, 3);
    $name = value::get_game_user_value('name', $user_id);
    c_add_guangbo("玩家{$name}领取了7天空间连续推广礼包！");
}

function xc_e310_2()
{
    $user_id = uid();
    echo "你领取了连续推广满7日超级礼包!";
    br();
    item::add_item(137, 1);
    item::add_item(367, 1);
    item::add_item(401, 1);
    item::add_item(333, 1);
    item::add_item(300, 1);
    item::add_item(292, 1);
    $name = value::get_game_user_value('name', $user_id);
    c_add_guangbo("玩家{$name}领取了连续推广满7日超级礼包！");
}

function xc_e3101()
{
    $user_id = uid();
    prop::user_get_prop(prop::new_prop(242, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(243, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(244, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(245, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(246, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(247, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(248, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(249, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(250, 0, 3), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(251, 0, 3), 0, 1, false, true);
}

function game_xs_tz()
{
    $user_id = uid();
    echo "你领取了GM新手套装!";
    br();
    value::set_user_value('game_xs_tz', 1, $user_id);
    prop::user_get_prop(prop::new_prop(313, 0, 0), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(314, 0, 0), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(315, 0, 0), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(317, 0, 0), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(318, 0, 0), 0, 1, false, true);
    prop::user_get_prop(prop::new_prop(319, 0, 0), 0, 1, false, true);
}

//【10级副本点卷】
function e335()
{
    item::add_item(213, -1);
    value::add_user_value('fb10_money', 1);
    echo "你获得1点10级副本值!";
    br();
}

//【10级副本点卷兑换宠物解封丹】
function e336()
{
    $fb10_money = value::get_user_value("fb10_money");
    if ($fb10_money >= 2) {
        echo "你已成功兑换【10级解封丹】!";
        br();
        item::add_item(214, 1);
        value::add_user_value('fb10_money', -2);
    } else {
        echo "你的10级副本点不足2点无法兑换!";
    }
}

//【10级副本点卷兑换出村令】
function e361()
{
    $fb10_money = value::get_user_value("fb10_money");
    if ($fb10_money >= 2) {
        echo "你已成功兑换【出村令】!";
        br();
        item::add_item(220, 1);
        value::add_user_value('fb10_money', -2);
    } else {
        echo "你的10级副本点不足2点无法兑换!";
    }
}

//【经验宝箱（10级）】
function e342()
{
    $jy_sj = mt_rand(1, 10000);
    item::add_item(217, -1);
    item::add_item(216, $jy_sj);
}

//【金钱袋（10级）】
function e343()
{
    $jy_sj = mt_rand(1, 1000);
    item::add_item(218, -1);
    value::add_user_value('money', $jy_sj);
}

//角色移动事件
function e7($in_map_id = 0, $direction = 0, $yizhan = 0, $tmp_value = 0)
{
    $user_id = uid();
    $shentizhuangtai = value::get_user_value('shentizhuangtai');
    $old_map_id = value::get_game_user_value('in_map_id');
    if (!$in_map_id) {
        switch ($direction) {
            case 1:
                $in_map_id = value::get_map_value($old_map_id, 'exit_b');
                break;
            case 2:
                $in_map_id = value::get_map_value($old_map_id, 'exit_x');
                break;
            case 3:
                $in_map_id = value::get_map_value($old_map_id, 'exit_d');
                break;
            case 4:
                $in_map_id = value::get_map_value($old_map_id, 'exit_n');
                break;
            default:
                $in_map_id = $old_map_id;
                break;
        }
    }


    //驿站事件
    if ($yizhan && $old_map_id != $in_map_id) {
        if (!item::add_money(-100)) {
            cmd::set_return_game_br(false);
            return;
        }
    }
    //离开事件
    //竞技事件
    if (user::get('pkjjzt', $user_id)) {
        echo "竞技比赛即将开始,你无法离开竞技场!";
        br();
        e5();
        return;
    }
    //任意进入
    if (!value::get_user_value("in_map_any")) {
        //拦路事件
        if (e88($in_map_id, $old_map_id, $direction)) {
            return;
        }
        //地形事件
        if ($old_map_id == 6706 && $direction == 4) {
            if ($shentizhuangtai == 5) {
                echo '你全身聚力,用力向前冲锋,成功的从碎石堆中冲了出来。';
                br();
            } else {
                echo '你看着眼前的碎石堆,毫无办法,看来必须让什么动物冲锋才能过去。';
                br();
                cmd::addcmd('e5', '继续');
                return;
            }
        }
        if ($old_map_id == 11740 && $direction == 4) {
            if ($shentizhuangtai == 6) {
                echo '你铆足力气,用力一跃,转眼间就落在天生桥上。';
                br();
            } else {
                echo '你抬头望了一眼天生桥,却在空中,看来必须让什么动物跳跃才能上去。';
                br();
                cmd::addcmd('e5', '继续');
                return;
            }
        }
        //离开副本
        if (value::get_map_value($old_map_id, 'is_danrenfuben') && !value::get_map_value($in_map_id, 'is_danrenfuben') || value::get_map_value($old_map_id, 'is_duorenfuben') && !value::get_map_value($in_map_id, 'is_duorenfuben')) {
            if (!$tmp_value) {
                echo "你确定要退出副本吗?";
                br();
                cmd::addcmd("e7,$in_map_id,$direction,$yizhan,1", '确定退出');
                return;
            } else {
                echo "你退出了副本!";
                br();
            }
        }
        //进入事件
        //帮派领地进入事件
        $is_gonghui = value::get_map_value($in_map_id, 'is_gonghuilingdi');
        $gonghui_id = value::get_game_user_value('gonghui.id');
        if ($is_gonghui && !$gonghui_id) {
            value::set_game_user_value("in_map_id", 35);
            echo "帮派的大门紧闭,似乎不欢迎你这个外来者。";
            br();
            cmd::addcmd('e5', '继续');
            cmd::set_show_return_game(false);
            return;
        }
        //特殊地域进入事件
        $shuxing = value::get_map_value($in_map_id, 'shuxing');
        $is_yizhan = value::get_map_value($in_map_id, 'is_yizhan');
        if ($shentizhuangtai != $shuxing && $shuxing && !$is_yizhan) {
            if ($shuxing == 1) {
                $i1 = value::get_system_value('map_gcgw_npc_sl');
                if ($i1) {
                    $in_map_id = value::get_game_user_value('in_map_id', $user_id);
                    if ($in_map_id == 5039) {
                        $gc_id = 184;
                    } else if ($in_map_id == 5040) {
                        $gc_id = 187;
                    } else if ($in_map_id == 5044) {
                        $gc_id = 188;
                    } else if ($in_map_id == 5045) {
                        $gc_id = 189;
                    } else if ($in_map_id == 5046) {
                        $gc_id = 190;
                    } else if ($in_map_id == 5048) {
                        $gc_id = 191;
                    } else if ($in_map_id == 5050) {
                        $gc_id = 192;
                    } else if ($in_map_id == 5051) {
                        $gc_id = 193;
                    } else if ($in_map_id == 5052) {
                        $gc_id = 194;
                    } else if ($in_map_id == 5054) {
                        $gc_id = 195;
                    } else if ($in_map_id == 5055) {
                        $gc_id = 196;
                    } else if ($in_map_id == 5059) {
                        $gc_id = 197;
                    } else if ($in_map_id == 5041) {
                        $gc_id = 198;
                        $in_map_id1 = 5041;
                    } else if ($in_map_id == 5058) {
                        $gc_id = 200;
                    } else if ($in_map_id == 5053) {
                        $gc_id = 201;
                    } else if ($in_map_id == 5049) {
                        $gc_id = 202;
                    }
                    $npc_name = value::getvalue('pet', 'name', 'id', $gc_id);
                    $exit_b = value::get_map_value($in_map_id, 'exit_b');
                    $exit_b_name = value::get_map_value($exit_b, 'name');
                    $i1 = value::get_system_value('map_gcgw_npc_sl');
                    echo "你正朝{$exit_b_name}走去,{$i1}个{$npc_name}走过来拦住了你的去路!";
                    br();
                } else {
                    $gcgw_time = value::get_system_value('gcgw_time');
                    $start_jj_time = $gcgw_time + 62;
                    $sy_jj_time = $start_jj_time - time();
                    if ($sy_jj_time > 0) {
                        echo "<span style=color:green>即将进入地图还剩{$sy_jj_time}秒,请做好准备!</span>";
                        br();
                    }
                }
            }
            if ($shuxing == 2) {
                echo '你想要进入地府,怎奈肉体凡胎,可你没有出窍,差点魂飞魄散,只得作罢。';
                br();
            }
            if ($shuxing == 3) {
                echo '你用力屏住呼吸,跃入水中,可你不会潜水,差点窒息,赶紧挣扎上岸。';
                br();
            }
            if ($shuxing == 4) {
                echo '你用力向前一跃,却没有腾云驾雾,空中的云越来越远,难以一步登天。';
                br();
            }
            cmd::addcmd('e5', '继续');
            cmd::set_show_return_game(false);
            return;
        }
        if (!$shuxing && $shentizhuangtai) {
            value::set_user_value('shentizhuangtai', 0);
            echo "你深吸了一口气,身体恢复正常。";
            br();
        }
        //单人副本进入事件
        if (value::get_map_value($in_map_id, 'is_danrenfuben')) {
            //是否组队
            if (value::get_game_user_value('team_id')) {
                echo "组队状态下无法进入单人副本!";
                br();
                e0();
                return;
            }
            //镜花水月
            if (value::get_map_value($in_map_id, 'area_id') == 20) {
                if ($old_map_id == 125 && $in_map_id == 126) {
                    e134();
                    return;
                } else {
                    if (mt_rand(1, 100) == 1) {
                        $sql = "SELECT `id`,`name` FROM `map` WHERE `area_id`=20 ORDER BY RAND() LIMIT 1";
                        $result = sql($sql);
                        list($jhsy_id, $jhsy_name) = $result->fetch_row();
                        value::set_game_user_value('in_map_id', $jhsy_id);
                        echo "水中月,镜中花,不知不觉你迷失在了镜花水月中。睁开眼睛,自己竟然到了{$jhsy_name}。";
                        br();
                        e0();
                        return;
                    }
                }
                $in_map_lvl = value::get_map_value($in_map_id, 'lvl');
                if ($in_map_lvl) {
                    $sql = "SELECT `id` FROM `game_pet` WHERE `enemy_user`={$user_id} AND `master_mode`=8 LIMIT 4";
                    $rs = sql($sql);
                    while (list($d_pet_id) = $rs->fetch_row()) {
                        pet::del_pet($d_pet_id);
                    }
                    for ($i = 0; $i < 4; $i++) {
                        $sql = "SELECT `id` FROM `pet` WHERE `star`<4 ORDER BY RAND() LIMIT 1";
                        $result = sql($sql);
                        list($rand_pet_id) = $result->fetch_row();
                        $new_pet_id = pet::new_pet($rand_pet_id, $in_map_lvl, $in_map_id);
                        value::set_pet_value($new_pet_id, 'enemy_user', $user_id);
                        value::set_pet_value($new_pet_id, 'master_mode', '8');
                    }
                }
            }
        }
        //组队副本进入事件
        if (value::get_map_value($in_map_id, 'is_duorenfuben')) {
            //是否组队
            if (!value::get_game_user_value('team_id')) {
                echo "组队状态下方可进入组队副本!";
                br();
                e0();
                return;
            }
            //山间小路
            if (value::get_map_value($in_map_id, 'area_id') == 9) {
                if ($old_map_id == 1318 && $in_map_id == 1329) {
                    e168();
                    return;
                } else {
                    //迷失树林
                    if (value::get_map_value($in_map_id, 'name') == '柿子林' && mt_rand(1, 5) == 1) {
                        $sql = "SELECT `id` FROM `map` WHERE `area_id`=9 AND `name`='柿子林' ORDER BY RAND() LIMIT 1";
                        $result = sql($sql);
                        list($jhsy_id) = $result->fetch_row();
                        value::set_game_user_value('in_map_id', $jhsy_id);
                        echo "八角寨突然浓雾重重,不知不觉你迷失在了柿子林中。";
                        br();
                        e0();
                        return;
                    }
                }
            }
            //天枢幻境
            if (value::get_map_value($in_map_id, 'area_id') == 22) {
                if ($old_map_id == 679 && $in_map_id == 1096) {
                    e214();
                    return;
                }
            }
            //被动挑战
            if (value::get_map_value($old_map_id, 'is_duorenfuben')) {
                if (mt_rand(1, 20) == 1 && value::get_user_value("last_beitouxi_time", $user_id) + 1200 < time()) {
                    e169($in_map_id);
                    return;
                }
            }
        }
    }
    //设置所在地图
    value::set_game_user_value('in_map_id', $in_map_id);
    ctm::show_ctm('ctm_map');
    if (!value::getvalue('map', 'is_danrenfuben', 'id', $in_map_id) && !value::get_map_value($in_map_id, 'is_gonghuilingdi')) {
        if ($direction) {
            c_add_xiaoxi($direction, 8, uid(), 0, $old_map_id);
        }
    }
}

//npc 查看事件
function e8($npc_id, $from_list = 0)
{
    //获取资料
    echo value::getvalue('npc', 'name', 'id', $npc_id);
    br();
    $pet_tp = value::get_npc_value($npc_id, 'tp');
    $is_cunzhangjia = value::get_npc_value($npc_id, 'is_cunzhangjia');
    $is_fengyaoguan = value::get_npc_value($npc_id, 'is_fengyaoguan');
    $is_yizhan = value::get_npc_value($npc_id, 'is_yizhan');
    $is_zahuopu = value::get_npc_value($npc_id, 'is_zahuopu');
    $is_xiuxingchang = value::get_npc_value($npc_id, 'is_xiuxingchang');
    $is_jianyu = value::get_npc_value($npc_id, 'is_jianyu');
    $is_gonghuilingdi = value::get_npc_value($npc_id, 'is_gonghuilingdi');
    $is_chalou = value::get_npc_value($npc_id, 'is_chalou');
    $is_jingjichang = value::get_npc_value($npc_id, 'is_jingjichang');
    $is_xs2 = value::get_npc_value($npc_id, 'is_xs2');
    $is_xs3 = value::get_npc_value($npc_id, 'is_xs3');
    $is_xs4 = value::get_npc_value($npc_id, 'is_xs4');
    $is_xs5 = value::get_npc_value($npc_id, 'is_xs5');
    $is_xs6 = value::get_npc_value($npc_id, 'is_xs6');
    $is_xs7 = value::get_npc_value($npc_id, 'is_xs7');
    $is_xs8 = value::get_npc_value($npc_id, 'is_xs8');
    $is_xs9 = value::get_npc_value($npc_id, 'is_xs9');
    $is_xs10 = value::get_npc_value($npc_id, 'is_xs10');
    $is_xs11 = value::get_npc_value($npc_id, 'is_xs11');
    $is_xs12 = value::get_npc_value($npc_id, 'is_xs12');
    $is_xs13 = value::get_npc_value($npc_id, 'is_xs13');
    if ($pet_tp) {
        echo "<img src='res/img/npc/{$pet_tp}' style='width: 80px;height: 80px;'>";
        br();
    }
    echo "性别:";
    echo value::getvalue('npc', 'sex', 'id', $npc_id) == '男' ? '男' : '女';
    br();
    echo value::getvalue('npc', 'desc', 'id', $npc_id);
    br();
    $pet_id_str = value::get_npc_value($npc_id, 'pet_id');
    if ($pet_id_str) {
        $pet_str = "";
        $pet_lvl_str = value::get_npc_value($npc_id, 'pet_lvl');
        $pet_id_arr = explode(',', $pet_id_str);
        $pet_lvl_arr = explode(',', $pet_lvl_str);
        $id_count = count($pet_id_arr);
        for ($i = 0; $i < $id_count; $i++) {
            $pet_name = value::getvalue('pet', 'name', 'id', $pet_id_arr[$i]);
            if ($pet_id_arr[$i] == 138 || $pet_id_arr[$i] == 139) {
                $pet_name .= " ";
            }
            if ($i) {
                $pet_str .= "," . $pet_lvl_arr[$i] . '级' . $pet_name;
            } else {
                $pet_str .= $pet_lvl_arr[$i] . '级' . $pet_name;
            }
        }
        echo '身上带有' . $pet_str;
        br();
    }
    //书店
    if ($is_xs10) {
        cmd::addcmd('sd_e24', '买书籍');
        br();
        cmd::addcmd('e25', '卖东西');
        br();
    }
    //铁匠铺
    if ($is_xs8) {
        cmd::addcmd('tjp_e24', '购武器');
        br();
        cmd::addcmd("e200", "强装备");
        br();
        cmd::addcmd("e199", "修装备");
        br();
    }
    //衣服铺
    if ($is_xs12) {
        cmd::addcmd('yf_e24', '购服饰');
        br();
        cmd::addcmd('tjp_e25', '卖服饰');
        br();
    }
    //首饰铺
    if ($is_xs13) {
        cmd::addcmd('ss_e24', '购首饰');
        br();
        cmd::addcmd('tjp_e25', '卖服饰');
        br();
    }
    //卖装备
    if ($is_xs9) {
        cmd::addcmd('tjp_e25', '卖装备');
        br();
    }
    if ($npc_id == 190) {
        cmd::addcmd('e452', '打探幸运宝箱');
        br();
    }
    if ($npc_id == 189) {
        cmd::addcmd('e453', '打探桃花谷');
        br();
    }
    //副本地图传送
    if ($npc_id == 1344) {
        cmd::addcmd('e355', '去银杏村');
        br();
    }
    //副本地图传送
    if ($npc_id == 1000) {
        cmd::addcmd('e320', '八角寨副本(10级)');
        br();
    }
    //地图操作
    //结婚
    if ($is_cunzhangjia) {
        cmd::addcmd('e18', '结婚');
        br();
        cmd::addcmd('e19', '离婚');
        br();
    }
    //驿站
    if ($is_yizhan) {
        cmd::addcmd('e20', '旅行');
        br();
        cmd::addcmd('e21', '驿站');
        br();
    }
    //购药
    if ($npc_id == 4  || $npc_id == 64 || $npc_id == 60 || $npc_id == 69) {
        cmd::addcmd('yd_e24', '购药品');
        br();
    }
    if ($npc_id == 93) {
        $yy_yp_yc_lq = value::get_user_value('yy_yp_yc_lq', $user_id);
        $time_d = date("d");
        if ($yy_yp_yc_lq != $time_d) {
            cmd::addcmd('map_yy1', "领取种子");
            br();
        }
        cmd::addcmd('map_yy', "种植等级");
        br();
    }
    if ($npc_id == 94) {
        cmd::addcmd('hd_hyd', '获得活跃度');
        br();
    }
    if ($npc_id == 95) {
        cmd::addcmd('map_ld', "查看练丹熟练度");
        br();
    }
    if ($npc_id == 11) {
        cmd::addcmd('map_gc_hb3', '公测活动一');
        echo "(元宝红包天天送)";
        br();
        cmd::addcmd('map_gc_hb4', '公测活动二');
        echo "(双倍经验助你快速升级)";
        br();
        cmd::addcmd('map_lb,2', '公测活动三');
        echo "(每天领礼包停不下来)";
        br();
        cmd::addcmd('hd_tg3', '公测活动四');
        echo "(推广好礼送不停)";
        br();
        cmd::addcmd('map_gc_hb_boss', '公测活动五');
        echo "(公测超级福利boss来袭)";
        br();
        cmd::addcmd('map_gc_hb_hd6', '公测活动六');
        echo "(王府/皇城)";
        br();
        cmd::addcmd('map_gc_hb_hd7', '公测活动七');
        echo "(累充送好礼)";
        br();
        cmd::addcmd('map_gc_hb_hd8', '公测活动八');
        echo "(战力排行榜)";
        br();
    }
    //杂货铺
    if ($is_zahuopu) {
        cmd::addcmd('yd_e24', '购药品');
        br();
        cmd::addcmd('e24', '买东西');
        br();
        cmd::addcmd('e25', '卖东西');
        br();
    }
    //存钱
    if ($is_xs7) {
        cmd::addcmd('e26', '存钱');
        br();
        cmd::addcmd('e27', '取钱');
        br();
    }
    //仓库
    if ($is_fengyaoguan) {
        cmd::addcmd('e29', '存取宠');
        br();
        cmd::addcmd('e30', '存取装');
        br();
    }
    //修行场
    if ($is_xiuxingchang) {
        cmd::addcmd('e43', '悬赏');
        br();
    }
    //监狱
    if ($is_jianyu) {
        cmd::addcmd('e141', '出狱');
        br();
        cmd::addcmd('e142', '挖矿');
        br();
    }
    //卖东西
    if ($is_xs11) {
        cmd::addcmd('yd_e24', '购药品');
        br();
        cmd::addcmd('e25', '卖东西');
        br();
    }
    //玩家竞技场
    if ($is_jingjichang) {
        cmd::addcmd('hd_wlzb_1', '竞技擂台');
        br();
    }
    //论坛
    if ($is_chalou) {
        cmd::addcmd('e44', '论坛');
        br();
    }
    //强化
    if ($is_xs2) {
        cmd::addcmd("e200", "强装备");
        br();
    }
    //修补
    if ($is_xs3) {
        cmd::addcmd("e199", "修装备");
        br();
    }
    //合成池
    if ($is_xs4) {
        cmd::addcmd("e201", "合宠物");
        br();
    }
    //强妖台
    if ($is_xs5) {
        cmd::addcmd("union::up_lvl", "强等级");
        br();
    }
    //拍卖
    if ($is_xs6) {
        cmd::addcmd('e22', '宠黑市');
        br();
        cmd::addcmd('e23,1', '装黑市');
        br();
    }
    cmd::addcmd('e9,' . $npc_id . ',' . $from_list, '对话');
    br();
    cmd::addcmd('e10,' . $npc_id . ',' . $from_list, '挑战');
    //返回操作
    if ($from_list == 1) {
        br();
        cmd::addcmd('e11', '返回上级');
    }
}

//npc 对话事件
function e9($npc_id, $from_list = 0)
{
    echo value::getvalue('npc', 'name', 'id', $npc_id) . "对你说:" . value::getvalue('npc', 'talk', 'id', $npc_id);
    br();
    cmd::addcmd('e8,' . $npc_id . ',' . $from_list, '返回上级');
}

//npc 挑战事件
function e10($npc_id, $from_list = 0)
{
    $user_id = uid();
    $team_id = 0;
    $in_map_id = value::get_game_user_value('in_map_id', $user_id);
    $npc_name = value::get_npc_value($npc_id, 'name');
    $pet_id_str = value::get_npc_value($npc_id, 'pet_id');
    $is_lanlu = value::get_npc_value($npc_id, 'is_lanlu');
    $can_pk = false;
    $pet_ok = false;
    $map_lanlu = false;
    $team_is_pk_npc = false;
    $is_yzf_ms = false;
    $shengcheng = true;
    if ($pet_id_str) {
        //己方出战宠物设置
        $pet_id = 0;
        $pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($pet_arr as $pet_id) {
            $is_dead = value::get_pet_value($pet_id, 'is_dead');
            if (!$is_dead) {
                $pet_ok = true;
                break;
            }
        }
        if (!user::get_game_user('is_dead', $user_id)) {
            $pet_ok = true;
        }
        //己方出战宠物OK
        if ($pet_ok) {
            //是否拦路
            if ($is_lanlu) {
                $map_lanlu = value::get_user_value('map.lanlu.' . $npc_id, $user_id);
            }
            //是否任务NPC
            $task_can_pk_npc = task_can_pk_npc($npc_id);
            //是否有引战幡
            $is_yzf = value::get_user_value('yinzhancishu', $user_id) ? true : false;
            //多人副本首次挑战该npc
            $first_drfb_npc = false;
            if (value::get_map_value($in_map_id, "is_duorenfuben") && $team_id) {
                $first_drfb_npc = user::get("first.drfb.npc.{$npc_id}.{$in_map_id}") ? false : true;
            }
            //是否组队
            if ($team_id) {
                //开始事务
                sql("BEGIN");
                //获取队友是否正在战斗
                $sql = "SELECT 1 FROM `game_user` WHERE `team_id`={$team_id} AND `pk.npc.id`={$npc_id} AND `id` != {$user_id} LIMIT 1 FOR UPDATE";
                $result = sql($sql);
                list($team_is_pk_npc) = $result->fetch_row();
                if ($team_is_pk_npc) {
                    $shengcheng = false;
                } else {
                    //删除NPC残留宠物
                    $sql = "SELECT `id` FROM `game_pet` WHERE `team_id` = {$team_id} AND `npc_id` = {$npc_id}";
                    $rs = sql($sql);
                    while (list($d_pet_id) = $rs->fetch_row()) {
                        pet::del_pet($d_pet_id);
                    }
                }
            } else {
                //删除NPC残留宠物
                $sql = "SELECT `id` FROM `game_pet` WHERE `enemy_user`={$user_id} AND `npc_id` = {$npc_id}";
                $rs = sql($sql);
                while (list($d_pet_id) = $rs->fetch_row()) {
                    pet::del_pet($d_pet_id);
                }
            }
            $can_pk = true;
            //任务NPC 拦路NPC 队友正在挑战NPC 第一次多人副本npc
            if ($task_can_pk_npc || ($is_lanlu && !$map_lanlu)) {
                $can_pk = true;
            } else if ($is_yzf) {
                value::add_user_value('yinzhancishu', -1, $user_id);
                $is_yzf_ms = true;
                $can_pk = true;
            }
            //玩家状态
            //开始事务
            sql("BEGIN");
            $sql = "SELECT `is_pk` FROM `game_user` WHERE `id` = $user_id  LIMIT 1 FOR UPDATE";
            $rs = sql($sql);
            list($u_is_pk) = $rs->fetch_row();
            //提交事务
            sql("COMMIT");
            //对方正在PK
            if ($u_is_pk) {
                e0();
                return;
            }
            //可以挑战
            if ($can_pk) {
                //设置挑战NPC的ID
                value::set_game_user_value('pk.npc.id', $npc_id, $user_id);
                //设置PK状态
                value::set_game_user_value('is_pk', '1', $user_id);
                //设置全宠物未PK
                sql("UPDATE `game_pet` SET `is_pk`=0 WHERE  `master_id`={$user_id} AND `master_mode`=1 LIMIT 5");
                //设置角色属性 出战宠物 回合数 对战宠物
                value::set_game_user_value('pk.now_pet.id', $pet_id, $user_id);
                value::set_user_value('pk.huihe', '0', $user_id);
                value::set_user_value("pk_win_money", 0, $user_id);
                value::set_user_value("pk_win_exp", 0, $user_id);
                //清除战斗信息
                $obj = new game_user_object($user_id);
                $obj->del("pk_chats");
                //生成NPC宠物
                if ($shengcheng) {
                    $pet_lvl_str = value::get_npc_value($npc_id, 'pet_lvl');
                    $pet_id_arr = explode(',', $pet_id_str);
                    $pet_lvl_arr = explode(',', $pet_lvl_str);
                    $id_count = count($pet_id_arr);
                    for ($i = 0; $i < $id_count; $i++) {
                        pet::new_pet($pet_id_arr[$i], $pet_lvl_arr[$i], $in_map_id, 0, $npc_id, $team_id ? 0 : $user_id, $team_id);
                    }
                }
                //组队挑战保存金钱经验
                if ($team_id) {
                    //初始化等级经验
                    $o_pet_lvl = 0;
                    $o_pet_exp = 0;
                    //获取剩余宠物
                    $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$npc_id} AND `team_id`={$team_id} AND `is_dead`=0 ORDER BY `id` ASC LIMIT 5";
                    $result = sql($sql);
                    while (list($oid) = $result->fetch_row()) {
                        //等级经验累加
                        $o_pet_money = value::get_pet_value($oid, 'money');
                        $o_pet_exp = value::get_pet_value($oid, 'exp');
                    }
                    //计算获得金币 经验
                    $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
                    $u_in_map_is_duorenfuben = value::get_map_value($u_in_map_id, 'is_duorenfuben');
                    $win_money = $o_pet_money;
                    $win_exp = $o_pet_exp;
                    $win_money = (int)$win_money;
                    $win_exp = (int)$win_exp;
                    //队伍成员数量
                    $team_user_count = team::get_team_user_count($team_id);
                    //队伍最高三倍奖励
                    $win_exp *= $team_user_count > 3 ? 3 : $team_user_count;
                    //设置金钱经验
                    value::set_user_value("pk_win_money", $win_money, $user_id);
                    value::set_user_value("pk_win_exp", $win_exp, $user_id);
                }
                //是否引战幡
                if ($is_yzf_ms) {
                    echo "你摇起了一面引战幡。<br>{$npc_name}怒不可遏的向你走来。";
                    br();
                }
                //开始战斗
                if (!$team_id) {
                    ctm::show_ctm('ctm_pk_npc');
                } else {
                    //进入战斗
                    value::set_user_value('pk.huihe.time', time(), $user_id);
                    ctm::show_ctm('ctm_pk_npc');
                    //组队播报
                    if ($shengcheng) {
                        $user_name = value::get_game_user_value('name', $user_id);
                        $map_name = value::get_map_value($in_map_id, 'name');
                        $team_user_arr = team::get_team_user($team_id);
                        foreach ($team_user_arr as $team_user_id) {
                            if ($team_user_id != $user_id) {
                                c_add_xiaoxi("{$user_name}在{$map_name}开始挑战{$npc_name}!", 0, $user_id, $team_user_id);
                            }
                        }
                    }
                }
                if ($team_id) {
                    //提交事务
                    sql("COMMIT");
                }
                return;
            }
        } else {
            echo '你已死亡且身上没有可以战斗的宠物了。';
            return;
        }
    }
    //无法PK
    if (!$can_pk) {
        echo "这里不能打架或现在无法挑战该NPC!";
    }
    br();
    cmd::addcmd('e8,' . $npc_id . ',' . $from_list, '返回上级');
}

//npc 玩家一起挑战事件
function e1001($pet_id, $pet_lvl, $map_id)
{
    $user_id = uid();
    $map_id = 0;
    //获取队友是否正在战斗
    $sql = "SELECT `id` FROM `game_pet` WHERE `pet_id` = {$pet_id} AND `map_id` = {$map_id}";
    $rs = sql($sql);
    list($pet_id1) = $rs->fetch_row();
    if ($pet_id1) {
        e48($pet_id1);
        return;
    } else {
        pet::new_pet($pet_id, $pet_lvl, $map_id);
    }
    $sql = "SELECT `id` FROM `game_pet` WHERE `pet_id` = {$pet_id} AND `map_id` = {$map_id}";
    $rs = sql($sql);
    list($pet_id1) = $rs->fetch_row();
    e48($pet_id1);
    return;
}

//npc 挑战事件
function e1000($npc_id, $from_list = 0)
{
    $user_id = uid();
    $team_id = 0;
    $in_map_id = value::get_game_user_value('in_map_id', $user_id);
    $npc_name = value::get_npc_value($npc_id, 'name');
    $pet_id_str = value::get_npc_value($npc_id, 'pet_id');
    $is_lanlu = value::get_npc_value($npc_id, 'is_lanlu');
    $can_pk = true;
    $pet_ok = false;
    $map_lanlu = false;
    $team_is_pk_npc = false;
    $is_yzf_ms = false;
    $shengcheng = true;
    if ($pet_id_str) {
        //己方出战宠物设置
        $pet_id = 0;
        $pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($pet_arr as $pet_id) {
            $is_dead = value::get_pet_value($pet_id, 'is_dead');
            if (!$is_dead) {
                $pet_ok = true;
                break;
            }
        }
        //己方出战宠物OK
        if ($pet_ok) {
            //是否拦路
            if ($is_lanlu) {
                $map_lanlu = value::get_user_value('map.lanlu.' . $npc_id, $user_id);
            }
            //是否任务NPC
            $task_can_pk_npc = task_can_pk_npc($npc_id);
            //是否有引战幡
            $is_yzf = value::get_user_value('yinzhancishu', $user_id) ? true : false;
            //多人副本首次挑战该npc
            $first_drfb_npc = false;
            if (value::get_map_value($in_map_id, "is_duorenfuben") && $team_id) {
                $first_drfb_npc = user::get("first.drfb.npc.{$npc_id}.{$in_map_id}") ? false : true;
            }
            //是否组队
            if ($team_id) {
                //开始事务
                sql("BEGIN");
                //获取队友是否正在战斗
                $sql = "SELECT 1 FROM `game_user` WHERE `team_id`={$team_id} AND `pk.npc.id`={$npc_id} AND `id` != {$user_id} LIMIT 1 FOR UPDATE";
                $result = sql($sql);
                list($team_is_pk_npc) = $result->fetch_row();
                if ($team_is_pk_npc) {
                    $shengcheng = false;
                } else {
                    //删除NPC残留宠物
                    $sql = "SELECT `id` FROM `game_pet` WHERE `team_id` = {$team_id} AND `npc_id` = {$npc_id}";
                    $rs = sql($sql);
                    while (list($d_pet_id) = $rs->fetch_row()) {
                        pet::del_pet($d_pet_id);
                    }
                }
            } else {
                //删除NPC残留宠物
                $sql = "SELECT `id` FROM `game_pet` WHERE `enemy_user`={$user_id} AND `npc_id` = {$npc_id}";
                $rs = sql($sql);
                while (list($d_pet_id) = $rs->fetch_row()) {
                    pet::del_pet($d_pet_id);
                }
            }
            //任务NPC 拦路NPC 队友正在挑战NPC 第一次多人副本npc
            if ($task_can_pk_npc || ($is_lanlu && !$map_lanlu) || $team_is_pk_npc || $first_drfb_npc) {
                $can_pk = true;
            } else if ($is_yzf) {
                value::add_user_value('yinzhancishu', -1, $user_id);
                $is_yzf_ms = true;
                $can_pk = true;
            }
            //玩家状态
            //开始事务
            sql("BEGIN");
            $sql = "SELECT `is_pk` FROM `game_user` WHERE `id` = $user_id  LIMIT 1 FOR UPDATE";
            $rs = sql($sql);
            list($u_is_pk) = $rs->fetch_row();
            //提交事务
            sql("COMMIT");
            //对方正在PK
            if ($u_is_pk) {
                e0();
                return;
            }
            //可以挑战
            if ($can_pk) {
                //设置挑战NPC的ID
                value::set_game_user_value('pk.npc.id', $npc_id, $user_id);
                //设置PK状态
                value::set_game_user_value('is_pk', '1', $user_id);
                //设置全宠物未PK
                sql("UPDATE `game_pet` SET `is_pk`=0 WHERE  `master_id`={$user_id} AND `master_mode`=1 LIMIT 5");
                //设置角色属性 出战宠物 回合数 对战宠物
                value::set_game_user_value('pk.now_pet.id', $pet_id, $user_id);
                value::set_user_value('pk.huihe', '0', $user_id);
                value::set_user_value("pk_win_money", 0, $user_id);
                value::set_user_value("pk_win_exp", 0, $user_id);
                //清除战斗信息
                $obj = new game_user_object($user_id);
                $obj->del("pk_chats");
                //生成NPC宠物
                if ($shengcheng) {
                    $pet_lvl_str = value::get_npc_value($npc_id, 'pet_lvl');
                    $pet_id_arr = explode(',', $pet_id_str);
                    $pet_lvl_arr = explode(',', $pet_lvl_str);
                    $id_count = count($pet_id_arr);
                    for ($i = 0; $i < $id_count; $i++) {
                        pet::new_pet($pet_id_arr[$i], $pet_lvl_arr[$i], $in_map_id, 0, $npc_id, $team_id ? 0 : $user_id, $team_id);
                    }
                }
                //组队挑战保存金钱经验
                if ($team_id) {
                    //初始化等级经验
                    $o_pet_lvl = 0;
                    $o_pet_exp = 0;
                    //获取剩余宠物
                    $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$npc_id} AND `team_id`={$team_id} AND `is_dead`=0 ORDER BY `id` ASC LIMIT 5";
                    $result = sql($sql);
                    while (list($oid) = $result->fetch_row()) {
                        //等级经验累加
                        $o_pet_money = value::get_pet_value($oid, 'money');
                        $o_pet_exp = value::get_pet_value($oid, 'exp');
                    }
                    //计算获得金币 经验
                    $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
                    $u_in_map_is_duorenfuben = value::get_map_value($u_in_map_id, 'is_duorenfuben');
                    $win_money = $o_pet_money;
                    $win_exp = $o_pet_exp;
                    $win_money = (int)$win_money;
                    $win_exp = (int)$win_exp;
                    //队伍成员数量
                    $team_user_count = team::get_team_user_count($team_id);
                    //队伍最高三倍奖励
                    $win_exp *= $team_user_count > 3 ? 3 : $team_user_count;
                    //设置金钱经验
                    value::set_user_value("pk_win_money", $win_money, $user_id);
                    value::set_user_value("pk_win_exp", $win_exp, $user_id);
                }
                //是否引战幡
                if ($is_yzf_ms) {
                    echo "你摇起了一面引战幡。<br>{$npc_name}怒不可遏的向你走来。";
                    br();
                }
                //开始战斗
                if (!$team_id) {
                    ctm::show_ctm('ctm_pk_npc');
                } else {
                    //进入战斗
                    value::set_user_value('pk.huihe.time', time(), $user_id);
                    ctm::show_ctm('ctm_pk_npc');
                    //���队播报
                    if ($shengcheng) {
                        $user_name = value::get_game_user_value('name', $user_id);
                        $map_name = value::get_map_value($in_map_id, 'name');
                        $team_user_arr = team::get_team_user($team_id);
                        foreach ($team_user_arr as $team_user_id) {
                            if ($team_user_id != $user_id) {
                                c_add_xiaoxi("{$user_name}在{$map_name}开始挑战{$npc_name}!", 0, $user_id, $team_user_id);
                            }
                        }
                    }
                }
                if ($team_id) {
                    //提交事务
                    sql("COMMIT");
                }
                return;
            }
        } else {
            echo '你身上没有可以战斗的宠物了。';
            return;
        }
    }
    //无法PK
    if (!$can_pk) {
        echo "这里不能打架或现在无法挑战该NPC!";
    }
    br();
    cmd::addcmd('e8,' . $npc_id . ',' . $from_list, '返回上级');
}

//地图 玩家列表 npc列表
function e11($yeshu = 0)
{
    //用户ID
    $user_id = uid();
    //队伍ID
    $user_team_id = team::get_user_team($user_id);
    //帮派ID
    $union_id = user::get_union($user_id);
    //获取玩家所在地图ID
    $in_map_id = value::get_game_user_value('in_map_id');
    $m_name = value::get_map_value($in_map_id, 'name');
    echo "{$m_name}附近玩家:";
    br();
    $is_fuben = value::get_map_value($in_map_id, 'is_danrenfuben') || value::get_map_value($in_map_id, 'is_duorenfuben') ? true : false;
    $is_gonghuilingdi = value::get_map_value($in_map_id, 'is_gonghuilingdi');
    //翻页系统
    $ncount = 0;
    $danye_count = 15;
    if ($is_fuben || $is_gonghuilingdi) {
        $danye_count = 100;
    }
    $start_count = $yeshu * $danye_count;
    //获取玩家数量
    $sql = "SELECT COUNT(*) FROM `game_user` WHERE `id`!='{$user_id}' AND `name`!='' AND `in_map_id`={$in_map_id} AND `is_online` =1";
    $result = sql($sql);
    list($user_count) = $result->fetch_row();
    //获取地图在线玩家语句
    //普通方式
    $sql = "SELECT `id`,`name` FROM `game_user` WHERE `id`!='{$user_id}' AND `name`!='' AND `in_map_id`={$in_map_id} AND `is_online` =1 LIMIT {$start_count},{$danye_count}";
    $ucount = 0;
    //开始获取在线玩家
    if ($sql) {
        $result = sql($sql);
        while (list($oid, $oname) = $result->fetch_row()) {
            $ucount++;
            $union_id = user::get_union($oid);
            if ($union_id) {
                $oname = "[" . union::get_name($union_id) . "]" . $oname;
            }
            user::showVipLogo($oid, true);
            cmd::addcmd('e12,' . $oid . ',1', $oname);
            $using_nick_name = value::get_user_value('using_nick_name', $oid);
            if ($using_nick_name) {
                echo $using_nick_name;
            }
            br();
        }
    }
    if (value::getvalue('map', 'is_pk', 'id', $in_map_id) < 1) {
        $user_id = uid();
        $user_count1 = value::get_user_value('user_count1', $user_id);
        $sj = value::get_user_value('sj10', $user_id);
        $sj1 = value::get_user_value('sj11', $user_id);
        $sql = "SELECT `id`,`name` FROM `game_user` WHERE `id`!='{$user_id}' AND `name`!=''AND `is_online` !=1 LIMIT {$sj},{$sj1}";
        if ($sql) {
            $result = sql($sql);
            while (list($oid, $oname) = $result->fetch_row()) {
                $ucount++;
                $union_id = user::get_union($oid);
                if ($union_id) {
                    $oname = "[" . union::get_name($union_id) . "]" . $oname;
                }
                user::showVipLogo($oid, true);
                cmd::addcmd('e12,' . $oid . ',1', $oname);
                $using_nick_name = value::get_user_value('using_nick_name', $oid);
                if ($using_nick_name) {
                    echo $using_nick_name;
                }
                br();
            }
        }
    }
    if (!$ncount && !$ucount) {
        echo "你在找什么东西?";
        br();
    }
    //上下页操作
    if (!$is_fuben && !$is_gonghuilingdi) {
        $fanye = false;
        $max_page_num = (int)(($user_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            if ($yeshu > 1) {
                cmd::addcmd('e11', '首页');
                echo "|";
            }
            cmd::addcmd('e11,' . ($yeshu - 1), '上—页');
            $fanye = true;
        }
        if ($user_count > ($yeshu + 1) * $danye_count) {
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('e11,' . ($yeshu + 1), '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e11,' . ($max_page_num - 1), '末页');
            }
            $fanye = true;
        }
        //是否翻页换行
        if ($fanye) {
            br();
        }
    }
    cmd::set_return_game_br(false);
}

//显示玩家模板
function e12($oid = 0, $from_list = 0, $ck_lb = 0)
{
    //获取自身id
    $uid = uid();
    //设置其它玩家id
    if ($oid) {
        value::set_user_value('look_user.id', $oid);
    } else {
        $oid = value::get_user_value('look_user.id');
    }
    //是否查看自身
    if ($oid == uid()) {
        if ($from_list == 1) {
            e13(3);
        } else if ($from_list == 2) {
            e13(4);
        } else if ($from_list == 3) {
            e13(5);
        } else if ($from_list == 6) {
            e13(6);
        } else if ($from_list == 7) {
            e13(7);
        } else if ($from_list == 8) {
            e13(8);
        } else if ($from_list == 9) {
            e13(9);
        } else if ($from_list == 10) {
            e13(10);
        } else if ($from_list == 11) {
            e13(11);
        } else if ($from_list == 12) {
            e13(12);
        } else if ($from_list == 13) {
            e13(13);
        } else if ($from_list == 14) {
            e13(14);
        } else if ($from_list == 15) {
            e13(15);
        } else {
            e13();
        }
        return;
    }
    //角色功能
    cmd::addcmd('e53,' . $oid, '私聊');
    echo '. ';
    cmd::addcmd('e81,' . $oid, '交易');
    echo '. ';
    cmd::addcmd('e70,' . $oid, '拉黑');
    echo '. ';
    cmd::addcmd('e50,' . $oid, '加友');
    echo '. ';
    if (team::get_user_team($oid)) {
        cmd::addcmd('e144,' . $oid . ',1', '加队');
    } else {
        cmd::addcmd('e144,' . $oid, '组队');
    }
    echo '. ';
    cmd::addcmd('e136,' . $oid, '攻击');
    br();
    //输出性别
    if (value::get_game_user_value('sex', $oid) == '男') {
        $img_name = 'boy';
        $sex = "帅哥";
    } else {
        $img_name = 'girl';
        $sex = "美女";
    }
    if (value::get_game_user_value('sex', $oid) == '男') {
        if (value::get_game_user_value('zhiye', $oid) == '战士') {
            $img_name = 'zy1';
        }
        if (value::get_game_user_value('zhiye', $oid) == '法师') {
            $img_name = 'zy3';
        }
        if (value::get_game_user_value('zhiye', $oid) == '道士') {
            $img_name = 'zy5';
        }
    } else {
        if (value::get_game_user_value('sex', $oid) == '女') {
            if (value::get_game_user_value('zhiye', $oid) == '战士') {
                $img_name = 'zy2';
            }
            if (value::get_game_user_value('zhiye', $oid) == '法师') {
                $img_name = 'zy4';
            }
            if (value::get_game_user_value('zhiye', $oid) == '道士') {
                $img_name = 'zy6';
            }
        }
    }
    echo "<img src='res/img/zy/{$img_name}.gif' style='width: 60px;height: 80px;'>";
    br();
    //获取玩家数据
    if (value::get_game_user_value('name', $oid)) {
        //输出悬赏
        $xuanshang = value::get_game_user_value('xuanshang', $oid);
        if ($xuanshang) {
            echo "悬赏:{$xuanshang}个金币";
            br();
        }
        //输出玩家名字
        $user_name = value::get_game_user_value('name', $oid);
        if ($user_name) {
            user::showVipLogo($oid, true);
            echo $user_name;
            echo " . <span style=color:blue>ID：{$oid}</span>";
        } else {
            user::showVipLogo($oid, true);
            echo "无名氏";
        }
        br();
        //输出玩家会员
        $hy_name = value::get_game_user_value('hy_name', $oid);
        if ($hy_name) {
            cmd::addcmd('map_hy', '会员：');
            echo $hy_name;
        } else {
            cmd::addcmd('map_hy', '会员：');
            echo "无";
        }
        br();
        //输出称号
        $using_nick_name = value::get_user_value('using_nick_name', $oid);
        cmd::addcmd('e109,' . $oid, '称号：');
        if ($using_nick_name) {
            cmd::addcmd('e54,' . $using_nick_name . ',0,1', $using_nick_name);
            echo '';
        } else {
            echo "无";
        }
        br();
        $osex = value::get_game_user_value('sex', $oid);
        $olvl = value::get_game_user_value('lvl', $oid);
        echo "等级：" . $olvl . "级 . <span style=color:blue>" . $osex;
        echo value::get_game_user_value('zhiye', $oid);
        echo "</span>";
        br();
        //输出签名
        $desc = value::get_game_user_value('desc', $oid);
        if ($desc != 0) {
            echo "签名：" . $desc;
        } else {
            echo "签名：这个人很懒,没有签名！";
        }
        br();
        //输出帮派
        $gonghui_id = user::get_union($oid);
        echo "帮派：";
        if ($gonghui_id) {
            cmd::addcmd("e176,0,$gonghui_id", union::get_name($gonghui_id));
            echo "";
            echo "(" . user::get_union_lvl_name($oid) . ")";
        } else {
            echo "无";
        }
        br();
        //输出师父
        $shifu_id = value::get_game_user_value('shifu.id', $oid);
        cmd::addcmd('e105', '师父：');
        if ($shifu_id) {
            $shifu_name = value::get_game_user_value('name', $shifu_id);
            $shifu_online = value::get_game_user_value('is_online', $shifu_id);
            if ($shifu_online) {
                cmd::addcmd('e12,' . $shifu_id, $shifu_name);
            } else {
                echo $shifu_name;
            }
        } else {
            cmd::addcmd('e118,' . $oid, '拜师');
        }
        br();
        //输出伴侣
        $bl_mode = 0;
        $bl_id = value::get_user_value('bl.id', $oid);
        if ($bl_id) {
            $bl_mode = value::get_user_value('bl.mode', $oid);
            $bl_qinmidu = user::get_qinmidu($oid);
            $bl_nick_name = "";
            switch ($bl_mode) {
                case 1:
                    if ($sex == "帅哥") {
                        $bl_nick_name = "未婚妻";
                    } else {
                        $bl_nick_name = "未婚夫";
                    }
                    break;
                case 2:
                    if ($sex == "帅哥") {
                        $bl_nick_name = "老婆";
                    } else {
                        $bl_nick_name = "老公";
                    }
                    break;
            }
            echo $bl_nick_name . ":";
            $bl_name = value::get_game_user_value('name', $bl_id);
            if (value::get_game_user_value('is_online', $bl_id)) {
                cmd::addcmd('e12,' . $bl_id, $bl_name);
            } else {
                echo $bl_name;
            }
            if ($oid == value::get_user_value('bl.id') && $bl_mode == 1) {
                echo "(亲密度:{$bl_qinmidu})";
            }
            if ($bl_mode == 2) {
                $bl_hun = user::get_bl_hun($oid);
                $bl_hour = user::get_bl_hun($oid, 1);
                echo "[{$bl_hun}婚{$bl_hour}小时]";
            }
        } else {
            echo "伴侣：";
            $osex = value::get_game_user_value('sex', $oid);
            $usex = value::get_game_user_value('sex', $uid);
            if ($osex != $usex) {
                cmd::addcmd('e18,1,' . $oid, '求婚');
            } else {
                echo "无";
            }
        }
        br();
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
            $in_equip_id = equip::get_user_in_equip($equip_num, $oid);
            $prop_name = equip::get($in_equip_id, 'name');
            $leixing = equip::get($in_equip_id, 'leixing');
            if ($in_equip_id && $prop_name && $leixing == 2) {
                echo $equip_subtype, ':';
                $star1 = equip::get($in_equip_id, 'star1');
                $prop_name = equip::get($in_equip_id, 'name');
                $sx_lvl = equip::get($in_equip_id, 'sx_lvl');
                if ($sx_lvl) {
                    echo "{$sx_lvl}星.";
                }
                cmd::addcmd("e10003,$in_equip_id,1", $prop_name);
                br();
            }
        }
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
            $in_equip_id = equip::get_user_in_equip_sz($equip_num, $oid);
            $prop_name = equip::get($in_equip_id, 'name');
            $leixing = equip::get($in_equip_id, 'leixing');
            if ($in_equip_id && $prop_name && $leixing == 3) {
                echo $equip_subtype, '时装:';
                $star1 = equip::get($in_equip_id, 'star1');
                $prop_name = equip::get($in_equip_id, 'name');
                $sx_lvl = equip::get($in_equip_id, 'sx_lvl');
                if ($sx_lvl) {
                    echo "{$sx_lvl}星.";
                }
                cmd::addcmd("e10003,$in_equip_id,1", $prop_name);
                br();
            }
        }
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        $i = 0;
        foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
            $i++;
            $in_equip_id = equip::get_user_in_equip_cb($equip_num, $oid);
            $prop_name = equip::get($in_equip_id, 'name');
            $leixing = equip::get($in_equip_id, 'leixing');
            if ($in_equip_id && $prop_name && $leixing == 4) {
                echo "翅膀{$i}:";
                $star1 = equip::get($in_equip_id, 'star1');
                $prop_name = equip::get($in_equip_id, 'name');
                $sx_lvl = equip::get($in_equip_id, 'sx_lvl');
                if ($sx_lvl) {
                    echo "{$sx_lvl}星.";
                }
                cmd::addcmd("e10003,$in_equip_id,1", $prop_name);
                br();
            }
        }
        map_tz_xg1($oid);
        //身上宠物
        $pet_str = "";
        $o_pet_arr = user::get_pet_arr($oid, 1);
        foreach ($o_pet_arr as $o_pet_id) {
            $star = value::get_pet_value($o_pet_id, 'star');
            $pet_name = value::get_pet_value($o_pet_id, 'name');
            if (!$pet_str) {
                $pet_str = value::get_pet_value($o_pet_id, 'lvl') . '级' . $pet_name;
            } else {
                $pet_str .= ',' . value::get_pet_value($o_pet_id, 'lvl') . '级' . $pet_name;
            }
        }
        if ($pet_str) {
            echo '宠物：';
            cmd::addcmd("e351", $pet_str);
        } else {
            echo "宠物：无";
        }
        br();
        $u = new game_user_object($oid);
        $i = 0;
        $uSkillArr = $u->jget('skill.arr');
        echo "技能：";
        foreach ($uSkillArr as $skill_id) {
            $jn_lvl = value::get_user_value('skill.' . $skill_id . '.lvl', $oid);
            if (!$jn_lvl) {
                $jn_lvl_name = "初级";
            } else if ($jn_lvl == 1) {
                $jn_lvl_name = "中级";
            } else if ($jn_lvl == 2) {
                $jn_lvl_name = "高级";
            } else if ($jn_lvl == 3) {
                $jn_lvl_name = "专家";
            }
            $jn_name = value::getvalue('skill', 'name', 'id', $skill_id);
            echo $jn_name . "({$jn_lvl_name})<span style=color:blue>、</span>";
            $i++;
        }
        $o_map_id = value::get_game_user_value('in_map_id', $oid);
        $o_map_name = value::get_map_value($o_map_id, 'name');
        br();
        echo '胜利：' . value::get_user_value('shenglishu', $oid) . '次';
        echo " <span style=color:blue>|</span> ";
        echo '失败：' . value::get_user_value('shibaishu', $oid) . '次';
        br();
        echo '红名：' . value::get_user_value('hongming', $oid) . '点';
        echo " <span style=color:blue>|</span> ";
        $mianzhan_time = value::get_user_value('mianzhan.time', $oid);
        $now_time = date("Y-m-d H:i:s");
        echo "PK：";
        if ($mianzhan_time > $now_time) {
            echo "关";
        } else {
            echo "开";
        }
        br();
        echo "位置：";
        cmd::addcmd('map_wj_id,' . $o_map_id, $o_map_name);
        br();
        $team_id = team::get_user_team($oid);
        if ($team_id) {
            echo "-";
            br();
            $captain_user_id = team::get_team_captain_user_id($team_id);
            $team_user_name = value::get_game_user_value('name', $captain_user_id);
            echo "{$team_user_name}的小队：";
            cmd::addcmd('e144,' . $oid . ',1', '加队');
            br();
            $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
            $result = sql($sql);
            while (list($oid) = $result->fetch_row()) {
                $item_count ++;
                echo $item_count . ". ";
                $o_name = value::get_game_user_value('name', $oid);
                $o_map_id = value::get_game_user_value('in_map_id', $oid);
                $o_map_name = value::get_map_value($o_map_id, 'name');
                cmd::addcmd('e12,' . $oid . ',11', $o_name);
                echo "({$o_map_name})";
                br();
            }
        }
        echo "-";
        br();
        if ($uid == $bl_id && value::get_game_user_value('in_map_id') == value::get_game_user_value('in_map_id', $oid) && $bl_mode == 2) {
            cmd::addcmd('e117', '赠宠');
            br();
        }
        if (value::get_game_user_value("is_bbs_banzhu", $uid) && !value::get_game_user_value("is_bbs_banzhu", $oid)) {
            if (value::get_user_value('jinyan', $oid) < time()) {
                cmd::addcmd('e161,' . $oid, '禁言');
            } else {
                cmd::addcmd('e161,' . $oid . ',2', '解禁');
            }
            br();
        }
    } else {
        echo "玩家正在pk中";
        br();
    }
    //返回
    if ($from_list) {
        if ($from_list == 1) {
            //地图玩家进入
            cmd::addcmd('e11', '返回上级');
        } else if ($from_list == 2) {
            //地区聊天频道进入
            cmd::addcmd('e36', '返回上级');
        } else if ($from_list == 3) {
            //在线玩家进入
            cmd::addcmd('e49,-1', '返回上级');
        } else if ($from_list == 4) {
            //好友列表进入
            cmd::addcmd('e51', '返回上级');
        } else if ($from_list == 5) {
            //私人聊天频道进入
            cmd::addcmd('e36,2', '返回上级');
        } else if ($from_list == 6) {
            //排行榜
            cmd::addcmd('e47', '返回上级');
        } else if ($from_list == 7) {
            //我的师门 我的徒弟
            $is_chushi = value::get_game_user_value('is_chushi');
            if ($is_chushi) {
                cmd::addcmd('e105,5', '返回上级');
            } else {
                cmd::addcmd('e105,1', '返回上级');
            }
        } else if ($from_list == 8) {
            //返回黑市查看道具
            cmd::addcmd('e23,5,0,' . value::get_user_value('hs_look_prop_id'), '返回上级');
        } else if ($from_list == 9) {
            //返回黑市查看宠物
            cmd::addcmd('e124,' . value::get_user_value('hs_look_pet_id'), '返回上级');
        } else if ($from_list == 10) {
            //返回我要悬赏
            cmd::addcmd('e43', '返回上级');
        } else if ($from_list == 11) {
            //返回组队相关
            cmd::addcmd('e107', '返回上级');
        } else if ($from_list == 12) {
            //返回查看帖子
            $look_bbs_id = value::get_user_value('look_bbs_id');
            cmd::addcmd('e157,' . $look_bbs_id, '返回上级');
        } else if ($from_list == 13) {
            //返回论坛
            cmd::addcmd('e44', '返回上级');
        } else if ($from_list == 14) {
            //返回名人榜
            cmd::addcmd('e162', '返回上级');
        } else if ($from_list == 15) {
            //返回明月榜
            cmd::addcmd('e164', '返回上级');
        } else if ($from_list == 16) {
            //返回帮派
            cmd::addcmd('e106', '返回上级');
        } else if ($from_list == 17) {
            //返回竞技
            cmd::addcmd('e32', '返回上级');
        }
    } else {
        cmd::set_return_game_br(false);
    }
}

//宠物 背包列表
function e351($oid = 0)
{
    if ($oid) {
        value::set_user_value('look_user.id', $oid);
    } else {
        $oid = value::get_user_value('look_user.id');
    }
    $oname = value::get_game_user_value('name', $oid);
    echo "玩家" . $oname . "身上的宠物:";
    $pet_str = "";
    $o_pet_arr = user::get_pet_arr($oid, 1);
    $o_pet_id = value::get_pet_value($oid, 'pet_id');
    $o_pet_count = 0;
    foreach ($o_pet_arr as $o_pet_id) {
        br();
        $is_dead = value::get_pet_value($o_pet_id, 'is_dead');
        $pet_nick_name = value::getvalue('game_pet', 'nick_name', 'id', $o_pet_id);
        $pet_name = value::getvalue('game_pet', 'name', 'id', $o_pet_id);
        $pet_lvl = value::getvalue('game_pet', 'lvl', 'id', $o_pet_id);
        $star = value::get_pet_value($o_pet_id, 'star');
        cmd::addcmd('e621,' . $o_pet_id . ',' . $oid, ($pet_nick_name ? "({$pet_nick_name})" : "") . $pet_name . '(' . $pet_lvl . '级)');
        echo $is_dead ? "(已死亡)" : "";
        $o_pet_count++;
    }
    if (!$o_pet_count) {
        br();
        echo "身上没有宠物。";
    } else {
        if ($o_pet_count > 1) {
            br();
        }
    }
}

//显示状态模板
function e413()
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    cmd::addcmd('e13', '状态');
    echo ">> 祝福";
    br();
    echo "-";
    br();
    //输出玩家名字
    $tp = value::get_game_user_value('tp');
    $sex = value::get_game_user_value('sex');
    $zhiye = value::get_game_user_value('zhiye');
    //输出性别
    if (value::get_game_user_value('sex') == '男') {
        $img_name = 'boy';
        $sex = "男";
    } else {
        $img_name = 'girl';
        $sex = "女";
    }
    if (value::get_game_user_value('sex') == '男') {
        if (value::get_game_user_value('zhiye') == '战士') {
            $img_name = 'zy1';
        }
        if (value::get_game_user_value('zhiye') == '法师') {
            $img_name = 'zy3';
        }
        if (value::get_game_user_value('zhiye') == '道士') {
            $img_name = 'zy5';
        }
    } else {
        if (value::get_game_user_value('sex') == '女') {
            if (value::get_game_user_value('zhiye') == '战士') {
                $img_name = 'zy2';
            }
            if (value::get_game_user_value('zhiye') == '法师') {
                $img_name = 'zy4';
            }
            if (value::get_game_user_value('zhiye') == '道士') {
                $img_name = 'zy6';
            }
        }
    }
    $user_id = uid();
    echo "生命：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_tls.time');
    $wj_tls = value::get_user_value('wj_tls');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "提升{$wj_tls}效果还剩{$mz_min}分钟";
    }
    br();
    echo "魔法：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_mls.time');
    $wj_mls = value::get_user_value('wj_mls');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "提升{$wj_mls}效果还剩{$mz_min}分钟";
    }
    br();
    echo "攻击：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_gjs.time');
    $wj_gjs = value::get_user_value('wj_gjs');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "提升{$wj_gjs}效果还剩{$mz_min}分钟";
    }
    br();
    echo "防御：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_fys.time');
    $wj_fys = value::get_user_value('wj_fys');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "提升{$wj_fys}效果还剩{$mz_min}分钟";
    }
    br();
    echo "魔攻：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_mgs.time');
    $wj_mgs = value::get_user_value('wj_mgs');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "提升{$wj_mgs}效果还剩{$mz_min}分钟";
    }
    br();
    echo "魔防：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_mfs.time');
    $wj_mfs = value::get_user_value('wj_mfs');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "提升{$wj_mfs}效果还剩{$mz_min}分钟";
    }
    br();
    echo "掉宝：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_db.time');
    $wj_db = value::get_user_value('wj_db');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_hour = (int)($mzsysj / 3600);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "{$wj_db}倍掉宝效果还剩{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    echo "捡装：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('sy_yjqdx_time');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_hour = (int)($mzsysj / 3600);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "一键捡装备效果还剩{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    echo "经验：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_jy.time');
    $wj_jy = value::get_user_value('wj_jy');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_hour = (int)($mzsysj / 3600);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "{$wj_jy}倍经验效果还剩余{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    echo "暴击：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_bj.time');
    $wj_bj = value::get_user_value('wj_bj');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_hour = (int)($mzsysj / 3600);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "{$wj_bj}倍暴击效果还剩余{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    //补金灵气
    echo "补金：";
    $bujinlingqi = value::get_user_value('bujinlingqi');
    if ($bujinlingqi) {
        echo "还剩{$bujinlingqi}缕";
    }
    br();
    //免战时间
    echo "免战：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('mianzhan.time');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_hour = (int)($mzsysj / 3600);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "还剩余{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    //避怪时间
    echo "避怪：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_bg.time');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_hour = (int)($mzsysj / 3600);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "还剩余{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    //会员时间
    echo "补天：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_bt.time');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_hour = (int)($mzsysj / 3600);
        $mz_min = (int)($mzsysj % 3600 / 60);
        echo "还剩{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    //会员时间
    echo "会员：";
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_hy.time');
    if ($mianzhan_time > $now_time) {
        $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
        $mz_day = (int)($mzsysj / 3600 / 24);
        $mz_hour = (int)($mzsysj / 3600 - ($mz_day * 24));
        $mz_min = (int)($mzsysj % 3600 / 60);
        $hy_name = value::get_game_user_value('hy_name', $user_id);
        echo $hy_name;
        echo "还剩{$mz_day}天{$mz_hour}小时{$mz_min}分钟";
    }
    br();
    echo "-";
}

//显示状态模板
function e414()
{
    echo "[所获称号]";
    $user_id = uid();
    br();
    echo "-";
    br();
    //所获称号
    if (value::get_user_value('nick_name', 0, false)) {
        $sql = "SELECT `value`  FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.nick_name' ORDER BY LENGTH(`value`),`time`";
        $result = sql($sql);
        while (list($nick_name) = $result->fetch_row()) {
            cmd::addcmd('e54,' . $nick_name, $nick_name);
            br();
        }
        $wlmz_id = value::get_system_value('wlmz_id', $user_id);
        if ($wlmz_id == $user_id) {
            $gczz_ch ="<img src=res/img/ch/lzbz.png>";
            cmd::addcmd('e54,' . $gczz_ch, $gczz_ch);
            br();
        }
        $gczz_id3 = value::get_system_value('gczz_id3', $user_id);
        if ($gczz_id == $user_id) {
            $gczz_ch ="<img src=res/img/ch/gc2.gif>";
            cmd::addcmd('e54,' . $gczz_ch, $gczz_ch);
            br();
        }
        $gczz_id2 = value::get_system_value('gczz_id2', $user_id);
        if ($gczz_id == $user_id) {
            $gczz_ch ="<img src=res/img/ch/gc2.gif>";
            cmd::addcmd('e54,' . $gczz_ch, $gczz_ch);
            br();
        }
        $gczz_id = value::get_system_value('gczz_id', $user_id);
        if ($gczz_id == $user_id) {
            $gczz_ch ="<img src=res/img/ch/gc1.gif>";
            cmd::addcmd('e54,' . $gczz_ch, $gczz_ch);
            br();
        }

        $txdy_id1 = value::get_system_value('txdy_id1');
        if ($txdy_id1 == $user_id) {
            $gczz_ch ="<img src=res/img/ch/txdy1.gif>";
            cmd::addcmd('e54,' . $gczz_ch, $gczz_ch);
            br();
        }
        $txdy_id2 = value::get_system_value('txdy_id2');
        if ($txdy_id2 == $user_id) {
            $gczz_ch ="<img src=res/img/ch/txdy2.gif>";
            cmd::addcmd('e54,' . $gczz_ch, $gczz_ch);
            br();
        }
        $txdy_id3 = value::get_system_value('txdy_id3');
        if ($txdy_id3 == $user_id) {
            $gczz_ch ="<img src=res/img/ch/txdy3.gif>";
            cmd::addcmd('e54,' . $gczz_ch, $gczz_ch);
            br();
        }
    }
    $huizhang_str = "";
    for ($i = 30; $i < 42; $i++) {
        if (item::get_item($i)) {
            $huizhang_str .= value::get_item_value($i, 'name') . '<br>';
        }
    }
    if ($huizhang_str) {
        $huizhang_str = '[所获徽章]<br>' . $huizhang_str;
        echo $huizhang_str;
    }
    ch_chsx();
    $ch_sx_gj = value::get_user_value('ch_sx_gj', $user_id);
    $ch_sx_fy = value::get_user_value('ch_sx_fy', $user_id);
    $ch_sx_hp = value::get_user_value('ch_sx_hp', $user_id);
    echo "-";
    br();
    echo "生效称号属性：";
    br();
    echo "攻击：" . $ch_sx_gj;
    br();
    echo "防御：" . $ch_sx_fy;
    br();
    echo "生命：" . $ch_sx_hp;
    br();
    echo "-";
    br();
    cmd::addcmd('e13', '返回状态');
}

//显示状态模板
function e13($from_list = 0)
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    //输出悬赏
    $xuanshang = value::get_game_user_value('xuanshang', $user_id);
    if ($xuanshang) {
        echo "悬赏：你被悬赏{$xuanshang}个金币";
        br();
    }
    //输出玩家名字
    $tp = value::get_game_user_value('tp');
    $sex = value::get_game_user_value('sex');
    $zhiye = value::get_game_user_value('zhiye');
    //输出性别
    if (value::get_game_user_value('sex') == '男') {
        $img_name = 'boy';
        $sex = "男";
    } else {
        $img_name = 'girl';
        $sex = "女";
    }
    if (value::get_game_user_value('sex') == '男') {
        if (value::get_game_user_value('zhiye') == '战士') {
            $img_name = 'zy1';
        }
        if (value::get_game_user_value('zhiye') == '法师') {
            $img_name = 'zy3';
        }
        if (value::get_game_user_value('zhiye') == '道士') {
            $img_name = 'zy5';
        }
    } else {
        if (value::get_game_user_value('sex') == '女') {
            if (value::get_game_user_value('zhiye') == '战士') {
                $img_name = 'zy2';
            }
            if (value::get_game_user_value('zhiye') == '法师') {
                $img_name = 'zy4';
            }
            if (value::get_game_user_value('zhiye') == '道士') {
                $img_name = 'zy6';
            }
        }
    }
    echo "<img src='res/img/zy/{$img_name}.gif' style='width: 60px;height: 80px;'>";
    br();
    echo value::get_game_user_value('name');
    $uid = value::get_game_user_value('id');
    echo " . <span style=color:blue>ID:{$uid}</span>";
    br();
    $zhiye = value::get_game_user_value('zhiye');
    $lvl = value::get_game_user_value('lvl');
    //输出会员
    $hy_name = value::get_game_user_value('hy_name');
    if ($hy_name) {
        cmd::addcmd('map_hy', '会员:');
        echo $hy_name;
    } else {
        cmd::addcmd('map_hy', '会员:');
        echo "无";
    }
    br();
    //输出称号
    echo "称号：";
    $using_nick_name = value::get_user_value('using_nick_name');
    if ($using_nick_name) {
        cmd::addcmd('e54,' . $using_nick_name, $using_nick_name);
        echo " ";
        cmd::addcmd('e414', '更换');
    } else {
        cmd::addcmd('e414', '选择');
    }
    br();
    cmd::addcmd('e162', 'VIP：');
    user::showVipLogo(0, true);
    br();
    //输出签名
    $desc = value::get_game_user_value('desc');
    if ($desc) {
        echo "签名：" . $desc;
    } else {
        echo "签名：";
        cmd::addcmd('e16,' . $from_list, '设置');
    }
    br();
    $zhiye = value::get_game_user_value('zhiye');
    $exp = value::get_game_user_value('exp');
    $max_exp = value::get_game_user_value('max_exp');
    echo "等级：" . $lvl . "级";
    br();
    echo "职业：" . $sex . " . " . $zhiye;
    br();
    echo "经验：" . $exp . "/" . $max_exp;
    br();
    cmd::addcmd('zt_sx', '属性');
    echo " / ";
    cmd::addcmd('zt_sx_jc', '加成');
    echo " / ";
    cmd::addcmd('zt_sw', '声望');
    echo " / ";
    cmd::addcmd('e413', '祝福');
    br();
    if (value::get_game_user_value('shuxingdian') > 0) {
        cmd::addcmd('rw_e78', value::get_game_user_value('shuxingdian') . "点属性分配");
        br();
    }
    //输出帮派
    $gonghui_id = user::get_union($user_id);
    cmd::addcmd('e106', '帮派:');
    if ($gonghui_id) {
        cmd::addcmd("e177", union::get_name($gonghui_id));
        echo "(";
        echo user::get_union_lvl_name($user_id);
        echo ")";
    } else {
        echo "无";
    }
    br();

  //输出师父
  $shifu_id = value::get_game_user_value('shifu.id');
  cmd::addcmd('e105', '师徒:');
  if ($shifu_id) {
      $shifu_name = value::get_game_user_value('name', $shifu_id);
      $shifu_online = value::get_game_user_value('is_online', $shifu_id);
      if ($shifu_online) {
          cmd::addcmd('e12,' . $shifu_id, $shifu_name);
      } else {
          echo $shifu_name;
      }
    } else {
        echo "无";
    }
    br();
    //输出伴侣
    $bl_id = value::get_user_value('bl.id');
    if ($bl_id) {
        $bl_mode = value::get_user_value('bl.mode');
        $bl_nick_name = "";
        switch ($bl_mode) {
            case 1:
                if ($sex == "帅哥") {
                    $bl_nick_name = "未婚妻";
                } else {
                    $bl_nick_name = "未婚夫";
                }
                break;
            case 2:
                if ($sex == "帅哥") {
                    $bl_nick_name = "老婆";
                } else {
                    $bl_nick_name = "老公";
                }
                break;
        }
        echo $bl_nick_name . ":";
        $bl_name = value::get_game_user_value('name', $bl_id);
        if (value::get_game_user_value('is_online', $bl_id)) {
            cmd::addcmd('e12,' . $bl_id, $bl_name);
        } else {
            echo $bl_name;
        }
        $bl_qinmidu = user::get_qinmidu();
        switch ($bl_mode) {
            case 1:
                echo "(亲密度:{$bl_qinmidu})";
                break;
            case 2:
                $bl_hun = user::get_bl_hun();
                $bl_hour = user::get_bl_hun(0, 1);
                echo "[{$bl_hun}婚{$bl_hour}小时]";
                break;
        }
    } else {
        echo "伴侣:无";
    }
    br();
    //身上宠物
    $pet_str = "";
    $u_pet_arr = user::get_pet_arr($user_id, 1);
    foreach ($u_pet_arr as $u_pet_id) {
        $star = value::get_pet_value($u_pet_id, 'star');
        $pet_name = value::get_pet_value($u_pet_id, 'name');
        if (!$pet_str) {
            $pet_str = value::get_pet_value($u_pet_id, 'lvl') . '级' . $pet_name;
        } else {
            $pet_str .= ',' . value::get_pet_value($u_pet_id, 'lvl') . '级' . $pet_name;
        }
    }
    if ($pet_str) {
        echo "宠物:";
        cmd::addcmd("e35", $pet_str);
    } else {
        echo "宠物:无";
    }
    br();
    echo '胜利：' . value::get_user_value('shenglishu') . '次';
    echo " <span style=color:blue>|</span> ";
    echo '失败：' . value::get_user_value('shibaishu') . '次';
    br();
    echo '红名：' . value::get_user_value('hongming') . '点';
    echo " <span style=color:blue>|</span> ";
    $mianzhan_time = value::get_user_value('mianzhan.time', $user_id);
    $now_time = date("Y-m-d H:i:s");
    echo "PK：";
    if ($mianzhan_time > $now_time) {
        echo "关";
    } else {
        echo "开";
    }
    br();
    echo "-";
    br();
    cmd::addcmd("map_zb1", "时装");
    echo " . ";
    cmd::addcmd("map_cb", "翅膀");
    echo " . ";
    cmd::addcmd("map_qz", "权者");
    echo " . ";
    cmd::addcmd('map_cs_id1,5729', '种植');
    echo " . ";
    cmd::addcmd('map_cs_id1,5730', "炼丹");
    br();
    echo "-";
    br();
    if ($from_list > 1) {
        //返回操作
        if ($from_list == 2) {
            //地区频道
            cmd::addcmd('e37', '返回上级');
        } else if ($from_list == 3) {
            //地图玩家
            cmd::addcmd('e11', '返回上级');
        } else if ($from_list == 4) {
            //私人频道
            cmd::addcmd('e36', '返回上级');
        } else if ($from_list == 5) {
            //在线玩家
            cmd::addcmd('e49,-1', '返回上级');
        } else if ($from_list == 6) {
            //排行榜
            cmd::addcmd('e47', '返回上级');
        } else if ($from_list == 7) {
            //师门关系
            $is_chushi = value::get_game_user_value('is_chushi');
            if ($is_chushi) {
                cmd::addcmd('e105,5', '返回上级');
            } else {
                cmd::addcmd('e105,1', '返回上级');
            }
        } else if ($from_list == 8) {
            //返回黑市查看道具
            cmd::addcmd('e23,5,0,' . value::get_user_value('hs_look_prop_id'), '返回上级');
        } else if ($from_list == 9) {
            //返回黑市查看宠物
            cmd::addcmd('e124,' . value::get_user_value('hs_look_pet_id'), '返回上级');
        } else if ($from_list == 10) {
            //返回我要悬赏
            cmd::addcmd('e43', '返回上级');
        } else if ($from_list == 11) {
            //返回组队相关
            cmd::addcmd('e107', '返回上级');
        } else if ($from_list == 12) {
            //返回查看帖子
            $look_bbs_id = value::get_user_value('look_bbs_id');
            cmd::addcmd('e157,' . $look_bbs_id, '返回上级');
        } else if ($from_list == 13) {
            //返回论坛
            cmd::addcmd('e44', '返回上级');
        } else if ($from_list == 14) {
            //返回名人榜
            cmd::addcmd('e162', '返回上级');
        } else if ($from_list == 15) {
            //返回明月榜
            cmd::addcmd('e164', '返回上级');
        } else if ($from_list == 16) {
            //返回帮派
            cmd::addcmd('e106', '返回上级');
        }
    } else {
        cmd::set_return_game_br(false);
    }
}

//显示状态声望模板
function zt_sw($from_list = 0)
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    cmd::addcmd('e13', '状态');
    echo ">> 声望";
    br();
    echo "-";
    br();
    //输出玩家名字
    $tp = value::get_game_user_value('tp');
    $sex = value::get_game_user_value('sex');
    $zhiye = value::get_game_user_value('zhiye');
    //输出性别
    if (value::get_game_user_value('sex') == '男') {
        $img_name = 'boy';
        $sex = "男";
    } else {
        $img_name = 'girl';
        $sex = "女";
    }
    if (value::get_game_user_value('sex') == '男') {
        if (value::get_game_user_value('zhiye') == '战士') {
            $img_name = 'zy1';
        }
        if (value::get_game_user_value('zhiye') == '法师') {
            $img_name = 'zy3';
        }
        if (value::get_game_user_value('zhiye') == '道士') {
            $img_name = 'zy5';
        }
    } else {
        if (value::get_game_user_value('sex') == '女') {
            if (value::get_game_user_value('zhiye') == '战士') {
                $img_name = 'zy2';
            }
            if (value::get_game_user_value('zhiye') == '法师') {
                $img_name = 'zy4';
            }
            if (value::get_game_user_value('zhiye') == '道士') {
                $img_name = 'zy6';
            }
        }
    }
    //个人属性
    echo '在线:' . (int)(value::get_user_value('onlinetime') / 60) . '时';
    br();
    if ($sex == '美女') {
        echo '魅力:' . value::get_user_value('meilizhi');
        br();
    }
    echo '重生:' . value::get_user_value('chongshengdian');
    br();
    echo '声望:' . value::get_user_value('shengwangzhi');
    br();
    echo '帮派:' . value::get_game_user_value('gonghui.gongxian');
    br();
    $jjjf = value::get_game_user_value('jingji.jifen');
    echo '竞技:' . $jjjf . '点';
    br();
    echo '练宠:' . value::get_user_value('lianyaoms');
    br();
    echo '封怪:' . value::get_user_value('fengyaoms');
    br();
    echo '胜利:' . value::get_user_value('shenglishu');
    br();
    echo '失败:' . value::get_user_value('shibaishu');
    br();
    echo 'PK:' . value::get_user_value('hongming');
    br();
    echo "-";
}

//显示状态套装模板
function zt_tz()
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    cmd::addcmd('e13', '状态');
    echo "/";
    cmd::addcmd('zt_sx', '属性');
    echo "/";
    cmd::addcmd('zt_sw', '声望');
    echo "/";
    cmd::addcmd('e413', '祝福');
    echo "/";
    echo "套装";
    echo "/";
    cmd::addcmd('e162', 'VIP');
    br();
    map_tz_xg($user_id);
}

//显示状态属性模板
function zt_sx()
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    cmd::addcmd('e13', '状态');
    echo ">> 属性";
    br();
    echo "-";
    br();
    //输出玩家名字
    $tp = value::get_game_user_value('tp');
    $sex = value::get_game_user_value('sex');
    $zhiye = value::get_game_user_value('zhiye');
    //输出性别
    if (value::get_game_user_value('sex') == '男') {
        $img_name = 'boy';
        $sex = "男";
    } else {
        $img_name = 'girl';
        $sex = "女";
    }
    if (value::get_game_user_value('sex') == '男') {
        if (value::get_game_user_value('zhiye') == '战士') {
            $img_name = 'zy1';
        }
        if (value::get_game_user_value('zhiye') == '法师') {
            $img_name = 'zy3';
        }
        if (value::get_game_user_value('zhiye') == '道士') {
            $img_name = 'zy5';
        }
    } else {
        if (value::get_game_user_value('sex') == '女') {
            if (value::get_game_user_value('zhiye') == '战士') {
                $img_name = 'zy2';
            }
            if (value::get_game_user_value('zhiye') == '法师') {
                $img_name = 'zy4';
            }
            if (value::get_game_user_value('zhiye') == '道士') {
                $img_name = 'zy6';
            }
        }
    }
    $sql = "SELECT `jd_hp`,`hp`,`mp`,`max_hp`,`max_mp`,`jd_mp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`shuxingdian`,`is_dead` FROM `game_user` WHERE `id`={$user_id} LIMIT 1";
    $result = sql($sql);
    list($jd_hp, $hp, $mp, $max_hp, $max_mp, $jd_mp, $pugong, $pufang, $tegong, $tefang, $minjie, $shuxingdian, $is_dead) = $result->fetch_row();
    $u = new game_user_object($user_id);
    $mb_jc = equip::get_user_equip_jc('mb', $user_id);
    $km_jc = equip::get_user_equip_jc('km', $user_id);
    $minjie_jc = equip::get_user_equip_jc('minjie', $user_id);
    $mz_jc = equip::get_user_equip_jc('mz', $user_id);
    $xx_jc = equip::get_user_equip_jc('xx', $user_id);
    $zd_jc = equip::get_user_equip_jc('zd', $user_id);
    $kd_jc = equip::get_user_equip_jc('kd', $user_id);
    $bj_jc = equip::get_user_equip_jc('bj', $user_id);
    $exp = equip::get_user_equip_jc('exp', $user_id);
    echo '生命值:' . $hp . '/' . $max_hp;
    br();
    echo '魔法值:' . $mp . '/' . $max_mp;
    br();
    //玩家使用祝福神水效果
    $u_wj_mgs = value::get_user_value('wj_mgs', $user_id);
    $u_wj_mfs = value::get_user_value('wj_mfs', $user_id);
    $u_wj_gjs = value::get_user_value('wj_gjs', $user_id);
    $u_wj_fys = value::get_user_value('wj_fys', $user_id);
    //称号加成效果
    $ch_sx_gj = value::get_user_value('ch_sx_gj', $user_id);
    $ch_sx_fy = value::get_user_value('ch_sx_fy', $user_id);
    //玩家组队加成效果
    $team_id = team::get_user_team($user_id);
    $team_count = 0;
    if ($team_id) {
        $captain_user_id = team::get_team_captain_user_id($team_id);
        $team_user_name = value::get_game_user_value('name', $captain_user_id);
        $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
        $result = sql($sql);
        while (list($team_oid) = $result->fetch_row()) {
            $team_count += 3;
        }
    }
    //玩家权者为帝加成效果
    $wj_sx_qzwd_jc = value::get_user_value('wj_sx_qzwd_jc', $user_id);
    if ($wj_sx_qzwd_jc) {
        $team_count += $wj_sx_qzwd_jc;
    }
    //玩家会员加成效果
    $u_hy_lvl = value::get_user_value('hy_lvl', $user_id);
    $u_tz_gj = value::get_user_value('tz_gj', $user_id);
    $pugong += (equip::get_user_equip_jc('pugong', $user_id) + $u_wj_gjs + $u_tz_gj + $ch_sx_gj);
    if ($u_hy_lvl > 0) {
        $pugong += ($pugong / 10 * $u_hy_lvl);
    }
    if ($team_count > 0) {
        $pugong += ($pugong / 100 * $team_count);
    }
    echo '攻击：' . (int)$pugong;
    br();
    $u_tz_gj = value::get_user_value('tz_gj', $user_id);
    $tegong += (equip::get_user_equip_jc('tegong', $user_id) + $u_wj_mgs + $u_tz_gj + $ch_sx_gj);
    if ($u_hy_lvl > 0) {
        $tegong += ($tegong / 10 * $u_hy_lvl);
    }
    if ($team_count > 0) {
        $tegong += ($tegong / 100 * $team_count);
    }
    echo '魔攻：' . (int)$tegong;
    br();
    $u_tz_fy = value::get_user_value('tz_fy', $user_id);
    $pufang += (equip::get_user_equip_jc('pufang', $user_id) + $u_wj_fys + $u_tz_fy + $ch_sx_fy);
    if ($u_hy_lvl > 0) {
        $pufang += ($pufang / 10 * $u_hy_lvl);
    }
    if ($team_count > 0) {
        $pufang += ($pufang / 100 * $team_count);
    }
    echo '防御：' . (int)$pufang;
    br();
    $u_tz_fy = value::get_user_value('tz_fy', $user_id);
    $tefang += (equip::get_user_equip_jc('tefang', $user_id) + $u_wj_mfs + $u_tz_fy + $ch_sx_fy);
    if ($u_hy_lvl > 0) {
        $tefang += ($tefang / 10 * $u_hy_lvl);
    }
    if ($team_count > 0) {
        $tefang += ($tefang / 100 * $team_count);
    }
    echo '魔防：' . (int)$tefang;
    br();
    echo '命中：' . $mz_jc . '%';
    br();
    echo '闪避：' . $minjie_jc . '%';
    br();
    echo '暴击：' . $bj_jc . '%';
    br();
    echo '抗暴：' . $kb_jc . '%';
    br();
    echo '麻痹：' . $mb_jc . '%';
    br();
    echo '抗麻：' . $km_jc . '%';
    br();
    echo '吸血：' . $xx_jc . '%';
    br();
    echo '中毒：' . $zd_jc . '%';
    br();
    echo '免毒：' . $kd_jc . '%';
    br();
    echo '经验：' . $exp . '%';
    br();
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    $hy_lvl_hp = $hy_lvl * 10;
    echo "会员生命：{$hy_lvl_hp} %";
    br();
    echo "会员魔法：{$hy_lvl_hp} %";
    br();
    echo "会员攻击：{$hy_lvl_hp} %";
    br();
    echo "会员防御：{$hy_lvl_hp} %";
    br();
    echo "-";
}

//显示状态属性模板
function zt_sx_jc()
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    cmd::addcmd('e13', '状态');
    echo ">> 加成:";
    br();
    echo "-";
    br();
    echo "我的属性加成：";
    br();
    $u_hy_lvl = value::get_user_value('hy_lvl', $user_id) * 10;
    echo "会员加成：全属性 {$u_hy_lvl}%";
    br();
    $team_id = team::get_user_team($user_id);
    $dy_exp = 0;
    if ($team_id) {
        $captain_user_id = team::get_team_captain_user_id($team_id);
        $team_user_name = value::get_game_user_value('name', $captain_user_id);
        $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
        $result = sql($sql);
        while (list($team_oid) = $result->fetch_row()) {
            $dy_exp += 3;
        }
    }
    echo "组队加成：全属性 {$dy_exp}%";
    br();
    $wj_sx_qzwd_jc = value::get_user_value('wj_sx_qzwd_jc', $user_id);
    echo "权者为帝：全属性 {$wj_sx_qzwd_jc}%";
    br();
    echo "-";
}

function xs_gj_fy()
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    $sql = "SELECT `jd_hp`,`hp`,`mp`,`max_hp`,`max_mp`,`jd_mp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`shuxingdian`,`is_dead` FROM `game_user` WHERE `id`={$user_id} LIMIT 1";
    $result = sql($sql);
    list($jd_hp, $hp, $mp, $max_hp, $max_mp, $jd_mp, $pugong, $pufang, $tegong, $tefang, $minjie, $shuxingdian, $is_dead) = $result->fetch_row();
    $u = new game_user_object($user_id);
    $mb_jc = equip::get_user_equip_jc('mb', $user_id);
    $km_jc = equip::get_user_equip_jc('km', $user_id);
    $minjie_jc = equip::get_user_equip_jc('minjie', $user_id);
    $mz_jc = equip::get_user_equip_jc('mz', $user_id);
    $xx_jc = equip::get_user_equip_jc('xx', $user_id);
    $zd_jc = equip::get_user_equip_jc('zd', $user_id);
    $kd_jc = equip::get_user_equip_jc('kd', $user_id);
    $bj_jc = equip::get_user_equip_jc('bj', $user_id);
    if (value::get_game_user_value('zhiye') == '战士') {
        value::set_game_user_value('xs_zhiye', 1, $user_id);
    }
    if (value::get_game_user_value('zhiye') == '法师') {
        value::set_game_user_value('xs_zhiye', 2, $user_id);
    }
    if (value::get_game_user_value('zhiye') == '道士') {
        value::set_game_user_value('xs_zhiye', 3, $user_id);
    }
    //玩家使用祝福神水效果
    $u_wj_mgs = value::get_user_value('wj_mgs', $user_id);
    $u_wj_mfs = value::get_user_value('wj_mfs', $user_id);
    $u_wj_gjs = value::get_user_value('wj_gjs', $user_id);
    $u_wj_fys = value::get_user_value('wj_fys', $user_id);
    //玩家组队加成效果
    $team_id = team::get_user_team($user_id);
    $team_count1 = 0;
    if ($team_id) {
        $captain_user_id = team::get_team_captain_user_id($team_id);
        $team_user_name = value::get_game_user_value('name', $captain_user_id);
        $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
        $result = sql($sql);
        while (list($team_oid) = $result->fetch_row()) {
            $team_count1 += 3;
        }
    }
    //玩家会员加成效果
    $u_hy_lvl = value::get_user_value('hy_lvl', $user_id);
    $u_tz_gj = value::get_user_value('tz_gj', $user_id);
    $pugong += (equip::get_user_equip_jc('pugong', $user_id) + $u_wj_gjs + $u_tz_gj);
    if ($u_hy_lvl > 0) {
        $pugong += ($pugong / 10 * $u_hy_lvl);
    }
    if ($team_count1 > 0) {
        $pugong += ($pugong / 100 * $team_count1);
    }
    value::set_game_user_value('xs_gj', $pugong, $user_id);
    $u_tz_gj = value::get_user_value('tz_gj', $user_id);
    $tegong += (equip::get_user_equip_jc('tegong', $user_id) + $u_wj_mgs + $u_tz_gj);
    if ($u_hy_lvl > 0) {
        $tegong += ($tegong / 10 * $u_hy_lvl);
    }
    if ($team_count1 > 0) {
        $tegong += ($tegong / 100 * $team_count1);
    }
    value::set_game_user_value('xs_fg', $tegong, $user_id);
    $u_tz_fy = value::get_user_value('tz_fy', $user_id);
    $pufang += (equip::get_user_equip_jc('pufang', $user_id) + $u_wj_fys + $u_tz_fy);
    if ($u_hy_lvl > 0) {
        $pufang += ($pufang / 10 * $u_hy_lvl);
    }
    if ($team_count1 > 0) {
        $pufang += ($pufang / 100 * $team_count1);
    }
    value::set_game_user_value('xs_fy', $pufang, $user_id);
    $u_tz_fy = value::get_user_value('tz_fy', $user_id);
    $tefang += (equip::get_user_equip_jc('tefang', $user_id) + $u_wj_mfs + $u_tz_fy);
    if ($u_hy_lvl > 0) {
        $tefang += ($tefang / 10 * $u_hy_lvl);
    }
    if ($team_count1 > 0) {
        $tefang += ($tefang / 100 * $team_count1);
    }
    value::set_game_user_value('xs_fg', $tefang, $user_id);
}

//地图 宠物列表
function e14()
{
    //获取玩家所在地图ID
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $gw_map_name = value::get_map_value($in_map_id, 'name');
    echo $gw_map_name . "怪物:";
    br();
    //任务地图宠物
    $ok_task = false;
    $sql = "SELECT `value` FROM `game_user_value` WHERE `userid`={$user_id} AND `valuename` LIKE '{$user_id}.task' LIMIT 0,6";
    $result = sql($sql);
    while (list($task_id) = $result->fetch_row()) {
        if (!call_task($task_id, 5, 0, 0, true)) {
            if (call_task($task_id, 8)) {
                $ok_task = true;
                break;
            }
        }
    }
    if ($ok_task) {
        cmd::addcmd('find_task_pet', '任务宠物');
        br();
    }
    //查询地图宠物
    $sql = "SELECT `id`,`name`,`lvl` FROM `game_pet` WHERE `map_id`={$in_map_id} AND `master_id`=0 AND `npc_id`=0 AND `master_mode`!=8 ORDER BY `id` DESC LIMIT 12";
    $i = 0;
    $result = sql($sql);
    while (list($oid, $oname, $olvl) = $result->fetch_row()) {
        if ($i) {
            br();
        }
        $i++;
        echo "*";
        cmd::addcmd('e15,' . $oid, $oname . '(' . $olvl . '级)');
        if (value::get_pet_value($oid, 'is_pk')) {
            $pk_user_id = value::get_pet_value($oid, 'enemy_user');
            if ($pk_user_id) {
                if (value::get_game_user_value('is_online', $pk_user_id) && value::get_game_user_value('in_map_id', $pk_user_id) == $in_map_id && $pk_user_id != $user_id) {
                    echo "(" . value::get_game_user_value('name', $pk_user_id) . "攻击中)";
                } else {
                    value::set_pet_value($oid, 'is_pk', '0');
                    $obj = new game_pet_object($oid);
                    $obj->adel();
                }
            } else {
                value::set_pet_value($oid, 'is_pk', '0');
                $obj = new game_pet_object($oid);
                $obj->adel();
            }
        }
    }
}

//地图 查看宠物事件
function e15($oid = 0)
{
    if ($oid) {
        value::set_user_value('look_pet_id', $oid);
    } else {
        $oid = value::get_user_value('look_pet_id');
    }
    //获取宠物属性
    $sql = "SELECT `pet_id`,`name`,`sex`,`nick_name`,`lvl`,`max_lvl`,`hp`,`max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`exp`,`max_exp`,`shuxingdian`,`zhongcheng`,`zhuangtai`,`xingge`,`texing`,`zhuansheng`,`is_pk`,`hechongcishu` FROM `game_pet` WHERE `id`={$oid} LIMIT 1";
    $result = sql($sql);
    list($ozzid, $oname, $osex, $nick_name, $lvl, $max_lvl, $hp, $max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $exp, $max_exp, $shuxingdian, $zhongcheng, $zhuangtai, $xingge, $texing, $zhuansheng, $is_pk, $hechongcishu) = $result->fetch_row();
    //获取失败返回地图
    if (!$hp) {
        pet::del_pet($oid);
        echo '这只宠物已经被杀了。';
        br();
        e14();
        return;
    }
    if (!$ozzid) {
        echo '这只宠物已经不在这里了。';
        br();
        e14();
        return;
    }
    $hp = (int)$hp;
    $max_hp = (int)$max_hp;
    $pugong = (int)$pugong;
    $pufang = (int)$pufang;
    $tegong = (int)$tegong;
    $tefang = (int)$tefang;
    $minjie = (int)$minjie;
    $fuhao = ($osex == '雌' ? " " : "");
    //六维加成
    $pugong_jc = pet::get_liuwei_jiacheng($oid, 'pugong');
    $pufang_jc = pet::get_liuwei_jiacheng($oid, 'pufang');
    $tegong_jc = pet::get_liuwei_jiacheng($oid, 'tegong');
    $tefang_jc = pet::get_liuwei_jiacheng($oid, 'tefang');
    $minjie_jc = pet::get_liuwei_jiacheng($oid, 'minjie');
    $hp_jc = pet::get_liuwei_jiacheng($oid, 'hp');
    //获取种族属性
    $sql = "SELECT `image`,`desc`,`shuxing`,`study_lvl`,`jh_id`,`jh_lvl` FROM `pet` WHERE `id`={$ozzid}" . " LIMIT 1";
    $result = sql($sql);
    list($image, $desc, $shuxing, $study_lvl, $jh_id, $jh_lvl) = $result->fetch_row();
    //输出宠物名字
    echo $oname . "(" . $shuxing . ")" . ($is_pk ? "(战斗中)" : "");
    br();
    //输出图片 描述
    if (!value::get_user_value('kg.xscwtp')) {
        if ($image != "") {
            pet::img($image, true, false);
            br();
        }
    }
    //输出等级 六维 属性 属性点 忠诚度 状态 性格 天赋
    echo "等级:" . $lvl;
    br();
    $max_hp = $max_hp + $hp_jc;
    echo "生命:" . $hp . "/" . $max_hp;
    br();
    if ($desc != "") {
        echo $desc;
    } else {
        echo "这是一只" . $oname . "。";
    }
    br();
    //获取装配道具
    cmd::addcmd('e48,' . $oid, "攻击" . $oname);
    br();
    $pufang = $pufang + $pufang_jc;
    $tegong = $tegong + $tegong_jc;
    $tefang = $tefang + $tefang_jc;
    $minjie = $minjie + $minjie_jc;
    echo "<style>td,th{text-align:center;font-size:20px;}</style><table  border='0'><tbody>
    <tr><th>攻击：{$pugong}</th><th>         </th><th>防御：{$pufang}<br></th></tr>
    <tr><th>魔法：{$tegong}</th><th>         </th><th>魔防：{$tefang}<br></th></tr>
    </tbody></table>";
    if (!value::get_user_value('kg.xsdlxx')) {
        echo "<img src='br.jpg'>";
        br();
        $user_id = uid();
        $in_map_id = value::get_game_user_value('in_map_id', $user_id);
        $m_area_id = value::get_map_value($in_map_id, 'area_id');
        ck_map_dl_dq2($ozzid, $m_area_id);
    }
    $pugong = $pugong + $pugong_jc;
    //获取装配道具
    $equip_liuwei_id_arr = pet::get_prop_id($oid, 2);
    if (is_array($equip_liuwei_id_arr)) {
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_liuwei_id_arr as $equip_id) {
            $equip_name = prop::get($equip_id, 'name');
            $equip_subtype = value::get_game_prop_zz_value($equip_id, 'sub_leixing');
            echo $equip_subtype_arr[$equip_subtype], ':';
            cmd::addcmd("e98,{$equip_id},2", $equip_name);
            br();
        }
    }
    $equip_baowu_id = pet::get_prop_id($oid, 3);
    if ($equip_baowu_id) {
        $equip_baowu_name = prop::get($equip_baowu_id, 'name');
        echo '宝物:';
        cmd::addcmd("e98,{$equip_baowu_id},2", $equip_baowu_name);
        br();
    }
    //返回
    echo "<img src='br.jpg'>";
    br();
    cmd::addcmd('e14', '返回上级');
}

function gl_e15($oid = 0)
{
    if ($oid) {
        value::set_user_value('look_pet_id', $oid);
    } else {
        $oid = value::get_user_value('look_pet_id');
    }
    //获取宠物属性
    $sql = "SELECT `pet_id`,`name`,`sex`,`map_id`,`nick_name`,`lvl`,`max_lvl`,`hp`,`max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`exp`,`max_exp`,`shuxingdian`,`zhongcheng`,`zhuangtai`,`xingge`,`texing`,`zhuansheng`,`is_pk`,`hechongcishu` FROM `game_pet` WHERE `id`={$oid} LIMIT 1";
    $result = sql($sql);
    list($ozzid, $oname, $osex, $map_id, $nick_name, $lvl, $max_lvl, $hp, $max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $exp, $max_exp, $shuxingdian, $zhongcheng, $zhuangtai, $xingge, $texing, $zhuansheng, $is_pk, $hechongcishu) = $result->fetch_row();
    //获取失败返回地图
    if (!$ozzid) {
        echo '这只宠物已经不在这里了。';
        br();
        e14();
        return;
    }
    $hp = (int)$hp;
    $max_hp = (int)$max_hp;
    $pugong = (int)$pugong;
    $pufang = (int)$pufang;
    $tegong = (int)$tegong;
    $tefang = (int)$tefang;
    $minjie = (int)$minjie;
    $fuhao = ($osex == '雌' ? " " : "");
    //六维加成
    $pugong_jc = pet::get_liuwei_jiacheng($oid, 'pugong');
    $pufang_jc = pet::get_liuwei_jiacheng($oid, 'pufang');
    $tegong_jc = pet::get_liuwei_jiacheng($oid, 'tegong');
    $tefang_jc = pet::get_liuwei_jiacheng($oid, 'tefang');
    $minjie_jc = pet::get_liuwei_jiacheng($oid, 'minjie');
    $hp_jc = pet::get_liuwei_jiacheng($oid, 'hp');
    //获取种族属性
    $sql = "SELECT `image`,`desc`,`shuxing`,`study_lvl`,`jh_id`,`jh_lvl` FROM `pet` WHERE `id`={$ozzid}" . " LIMIT 1";
    $result = sql($sql);
    list($image, $desc, $shuxing, $study_lvl, $jh_id, $jh_lvl) = $result->fetch_row();
    //输出宠物名字
    echo $oname . "(" . $shuxing . ")" . ($is_pk ? "(战斗中)" : "");
    br();
    //输出图片 描述
    if (!value::get_user_value('kg.xscwtp')) {
        if ($image != "") {
            pet::img($image, true, false);
            br();
        }
    }
    //输出等级 六维 属性 属性点 忠诚度 状态 性格 天赋
    echo "等级:" . $lvl;
    br();
    $max_hp = $max_hp + $hp_jc;
    echo "生命:" . $hp . "/" . $max_hp;
    br();
    if ($desc != "") {
        echo $desc;
    } else {
        echo "这是一只" . $oname . "。";
    }
    br();
    $map_name = value::get_map_value($map_id, 'name');
    echo "<span style='color:green'>位置：" . $map_name . "</span>";
    br();
    //获取装配道具
    $pugong = $pugong + $pugong_jc;
    $pufang = $pufang + $pufang_jc;
    $tegong = $tegong + $tegong_jc;
    $tefang = $tefang + $tefang_jc;
    $minjie = $minjie + $minjie_jc;
    echo "<style>td,th{text-align:center;font-size:20px;}</style><table  border='0'><tbody>
    <tr><th>攻击：{$pugong}</th><th>         </th><th>防御：{$pufang}<br></th></tr>
    <tr><th>魔法：{$tegong}</th><th>         </th><th>魔防：{$tefang}<br></th></tr>
    </tbody></table>";
    //获取装配道具
    $equip_liuwei_id_arr = pet::get_prop_id($oid, 2);
    if (is_array($equip_liuwei_id_arr)) {
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_liuwei_id_arr as $equip_id) {
            $equip_name = prop::get($equip_id, 'name');
            $equip_subtype = value::get_game_prop_zz_value($equip_id, 'sub_leixing');
            echo $equip_subtype_arr[$equip_subtype], ':';
            cmd::addcmd("e98,{$equip_id},2", $equip_name);
            br();
        }
    }
    $equip_baowu_id = pet::get_prop_id($oid, 3);
    if ($equip_baowu_id) {
        $equip_baowu_name = prop::get($equip_baowu_id, 'name');
        echo '宝物:';
        cmd::addcmd("e98,{$equip_baowu_id},2", $equip_baowu_name);
        br();
    }
    //返回
    echo "<img src='br.jpg'>";
    br();
    cmd::addcmd('e36', '返回上级');
}

//角色 设置签名事件
function e16($from_list = 0)
{
    $desc = value::real_escape_string($_POST['desc']);
    if (!$desc) {
        $cmd = cmd::addcmd('e16', '提交', false);
        echo "<form action='game.php?cmd=" . $cmd . "' method='post'><span>请输入签名(30字内):</span><br/><input type='text' name='desc' maxlength='30'><input type='submit' 'name'='设置' value='设置'></form>";
    } else {
        if (c_check_str($desc, 0, 30)) {
            value::set_game_user_value('desc', $desc);
            echo '设置成功!';
            br();
        } else {
            echo '签名无法使用!';
            br();
        }
    }
    cmd::addcmd('e13,' . $from_list, '返回上级');
}

//村长家 获取称号事件
function e17($nick_name = '', $mode = 0, $is_br = false)
{
    set_time_limit(0);
    $user_id = uid();
    $zhang_count = user::get_zhang_count($user_id);
}

//村长家 结婚事件
function e18($step = 0, $oid = 0)
{
    $bl_id = value::get_user_value('bl.id');
    $bl_mode = value::get_user_value('bl.mode');
    $sex = value::get_game_user_value('sex');
    $in_map_id = value::get_game_user_value('in_map_id');
    if (!$step) {
        if ($bl_id) {
            if ($bl_mode == 1) {
                $bl_name = value::get_game_user_value('name', $bl_id);
                $qinmidu = user::get_qinmidu();
                if ($qinmidu < 1000) {
                    echo "你与{$bl_name}的亲密度达到1000才可以结婚!<br>(情侣双方同时在线与聊天可以增加亲密度)";
                    br();
                } else {
                    if (!value::get_game_user_value('is_online', $bl_id)) {
                        echo "{$bl_name}不在线,无法结婚!";
                        br();
                    } else {
                        //双方成功结婚
                        $u_name = value::get_game_user_value('name');
                        echo "恭喜你与{$bl_name}结为夫妻,祝你们百年好合!";
                        br();
                        c_add_xiaoxi("恭喜你与{$u_name}结为夫妻,祝你们百年好合!", 0, 0, $bl_id);
                        $in_map_name = value::get_map_value(value::get_game_user_value('in_map_id'), 'name');
                        c_add_guangbo("恭喜{$u_name}与{$bl_name}在{$in_map_name}结为夫妻!", uid(), 1);
                        //设置结婚属性
                        //设置结婚模式
                        value::set_user_value('bl.mode', 2);
                        value::set_user_value('bl.mode', 2, $bl_id);
                        //清除未婚亲密度
                        value::set_user_value('bl.qinmidu', 3600);
                        value::set_user_value('bl.qinmidu', 3600, $bl_id);
                    }
                }
            } else {
                echo "很抱歉,你已经有婚约在身了。";
                br();
            }
        } else {
            $user_count = 0;
            $sql = "SELECT `id`,`name` FROM `game_user` WHERE `sex`!='{$sex}' AND `is_online`=1";
            $result = sql($sql);
            while (list($oid, $oname) = $result->fetch_row()) {
                $user_count++;
                echo $oname;
                echo " ";
                cmd::addcmd('e18,1,' . $oid, '求婚');
                br();
            }
            if (!$user_count) {
                echo "这里一个人都没有,你要向谁求婚?";
                br();
            }
        }
    } else if ($step == 1) {
        $oname = value::get_game_user_value('name', $oid);
        echo "你确定向{$oname}求婚吗?";
        br();
        cmd::addcmd('e18,2,' . $oid, '确定求婚');
        br();
    } else if ($step == 2) {
        $uname = value::get_game_user_value('name');
        $oname = value::get_game_user_value('name', $oid);
        if (value::get_user_value('bl.id')) {
            echo "婚姻大事,岂可儿戏,你已经有婚约在身了!";
            br();
        } else if (value::get_user_value('bl.id', $oid)) {
            echo "很抱歉,{$oname}已经有婚约在身了!";
            br();
        } else {
            c_add_xiaoxi('恭喜你,' . $uname . '向你求婚了。', 14, uid(), $oid);
            echo "你成功向{$oname}求婚,请静候佳音!";
            br();
        }
    }
    cmd::set_return_game_br(false);
}

//村长家 离婚事件
function e19($step = 0)
{
    $bl_id = value::get_user_value('bl.id');
    if ($bl_id) {
        $bl_mode = value::get_user_value('bl.mode');
        $uname = value::get_game_user_value('name');
        $oname = value::get_game_user_value('name', $bl_id);
        switch ($bl_mode) {
            case 1:
                if (!$step) {
                    echo "你确定解除与{$oname}的婚约吗?";
                    br();
                    cmd::addcmd('e19,1', '确认解除');
                    br();
                } else {
                    value::set_user_value('bl.id', 0, uid());
                    value::set_user_value('bl.id', 0, $bl_id);
                    value::set_user_value('bl.mode', 0, uid());
                    value::set_user_value('bl.mode', 0, $bl_id);
                    c_add_xiaoxi("{$uname}解除了与你的婚约,从此天涯陌路!", 0, uid(), $bl_id);
                    echo "你解除了与{$oname}�����婚���,从此天涯陌路!";
                    br();
                }
                break;
            case 2:
                if (!$step) {
                    $cmd = cmd::addcmd('e19,1', '离婚', false);
                    echo <<<lihunform
你忍心与{$oname}离婚吗?<br>请你输入离婚确认操作:
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="lihun" maxlength="5">
	<br>
	<input type="submit" value="确定离婚" name="离婚">
</form>
lihunform;
                } else {
                    $lihun = value::real_escape_string($_POST['lihun']);
                    if ($lihun == 'lihun' || $lihun == '离婚') {
                        value::set_user_value('bl.id', 0, uid());
                        value::set_user_value('bl.id', 0, $bl_id);
                        value::set_user_value('bl.mode', 0, uid());
                        value::set_user_value('bl.mode', 0, $bl_id);
                        value::set_user_value('bl.qinmidu', 0, uid());
                        value::set_user_value('bl.qinmidu', 0, $bl_id);
                        c_add_xiaoxi("{$uname}解除了与你的婚约,从此一别个宽,各自生欢!", 0, uid(), $bl_id);
                        echo "你解除了与{$oname}的婚约,从此一别个宽,各自生欢!";
                        br();
                    } else {
                        echo "很抱歉,请你决定好离婚再来操作!";
                        br();
                        e0();
                    }
                }
                break;
        }
    } else {
        echo "你还没有婚约在身,谈何离婚?";
        br();
    }
    cmd::set_return_game_br(false);
}

//驿站 旅行事件
function e20($mode = 0)
{
    $user_id = uid();
    if ($mode) {
        $yizhan = 0;
        $sql = "SELECT `value` FROM  `game_user_value` WHERE  `valuename`= '{$user_id}.yizhan' ORDER BY CONVERT(`value`,SIGNED) ASC";
        $result = sql($sql);
        while (list($oid) = $result->fetch_row()) {
            cmd::addcmd('e7,' . $oid, value::getvalue('map', 'name', 'id', $oid));
            br();
            $yizhan++;
        }
        if (!$yizhan) {
            echo '你没有开通过的驿站。';
            br();
        }
    } else {
        $yizhan = 0;
        $sql = "SELECT `value` FROM  `game_user_value` WHERE  `valuename`= '{$user_id}.yizhan' ORDER BY CONVERT(`value`,SIGNED) ASC";
        $result = sql($sql);
        while (list($oid) = $result->fetch_row()) {
            cmd::addcmd('e7,' . $oid . ',,1', value::getvalue('map', 'name', 'id', $oid));
            br();
            $yizhan++;
        }
        if (!$yizhan) {
            echo '你没有开通过的驿站。';
            br();
        }
    }
    cmd::set_return_game_br(false);
}

//驿站 开通驿站事件
function e21()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $sql = "SELECT COUNT(*) FROM  `game_user_value` WHERE  `valuename`= '{$user_id}.yizhan' AND `value`= '{$in_map_id}'";
    $result = sql($sql);
    if (list($count) = $result->fetch_row()) {
        if ($count > 0) {
            echo '抱歉,你已开通过此驿站。';
        } else {
            value::insert("game_user_value", "`id`,`userid`,`petid`,`valuename`,`value`", "NULL,'{$user_id}','0','" . uid() . '.yizhan' . "','{$in_map_id}'");
            echo '你成功开通此处为驿站。';
        }
    }
}

//驿站 宠物黑市事件
function e22($show_mode = 0, $yeshu = 0)
{
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    //首次进入
    $is_first = value::get_user_value('hs_pet_first');
    if (!$is_first) {
        echo "宠物黑市交易规则:<br>1.每位玩家的寄售宠物上限为5只。<br>2.每次交易成功后,黑市向卖方收取10%手续费(金币/元宝)。<br>3.黑市中购买宠物所需的金币从杂货铺中收取。<br>4.黑市中购买宠物所需的元宝从玩家身上收取。<br>5.黑市中期限与广告费用所需的金币从身上收取。";
        br();
        cmd::addcmd('e22,' . $show_mode, '好的,我了解了');
        value::set_user_value('hs_pet_first', 1);
        cmd::set_show_return_game(false);
        return;
    }
    value::set_user_value('hs_look_mode', 0);
    $now_time = date("Y-m-d H:i:s");
    $fanye = false;
    $add_sql = "";
    $zhp_money = value::get_user_value('zahuopu.money');
    $lingshi = item::get_item(1);
    echo "元宝：{$lingshi}个";
    echo "  ";
    cmd::addcmd('e216', '充值');
    br();
    echo "杂货铺：{$zhp_money}金币";
    echo "  ";
    cmd::addcmd('e26', '存钱');
    br();
    if (!$show_mode) {
        echo "全部";
    } else {
        cmd::addcmd('e22', '全部');
    }
    echo "|";
    if ($show_mode == 1) {
        echo "金币";
        $add_sql = "AND `heishi_currency_type`=1";
    } else {
        cmd::addcmd('e22,1', '金币');
    }
    echo "|";
    if ($show_mode == 2) {
        echo "元宝";
        $add_sql = "AND `heishi_currency_type`=2";
    } else {
        cmd::addcmd('e22,2', '元宝');
    }
    br();
    $sql = "SELECT COUNT(*) FROM `game_pet` WHERE `master_mode`=7 " . $add_sql . " AND `heishi_time`>'{$now_time}'";
    $result = sql($sql);
    list($pet_count) = $result->fetch_row();
    $ocount = 0;
    $sql = "SELECT `id`,`name`,`lvl`,`nick_name`,`heishi_money`,`heishi_currency_type` FROM `game_pet` WHERE `master_mode`=7 " . $add_sql . " AND `heishi_time`>'{$now_time}' ORDER BY `heishi_currency_type`,`zhuansheng`,`lvl`,`heishi_money` ASC LIMIT {$start_count},{$danye_count}";
    $result = sql($sql);
    while (list($oid, $oname, $olvl, $onick_name, $omoney, $ocurrency_type) = $result->fetch_row()) {
        $ocount++;
        cmd::addcmd('e124,' . $oid . ',' . $show_mode . ',' . $yeshu, $olvl . '级' . $oname . '(' . $omoney . ($ocurrency_type == 1 ? '个金币' : '颗元宝') . ')');
        br();
    }
    if (!$ocount) {
        switch ($show_mode) {
            case 1:
                echo "金币黑市没有宠物!";
                break;
            case 2:
                echo "元宝黑市没有宠物!";
                break;
            default:
                echo "黑市里面空无一物!";
                break;
        }
        br();
    }
    //翻页系统
    $max_page_num = (int)(($pet_count - 1) / $danye_count) + 1;
    if ($yeshu) {
        if ($yeshu > 1) {
            cmd::addcmd('e22,' . $show_mode, '首页');
            echo "|";
        }
        cmd::addcmd('e22,' . $show_mode . ',' . ($yeshu - 1), '上—页');
        $fanye = true;
    }
    if ($pet_count > $danye_count * ($yeshu + 1)) {
        if ($yeshu) {
            echo "|";
        }
        cmd::addcmd('e22,' . $show_mode . ',' . ($yeshu + 1), '下—页');
        if ($yeshu + 2 < $max_page_num) {
            echo "|";
            cmd::addcmd('e22,' . $show_mode . ',' . ($max_page_num - 1), '末页');
        }
        $fanye = true;
    }
    //是否翻页换行
    if ($fanye) {
        br();
    }
    cmd::addcmd('e122', '我的卖品');
    br();
    cmd::addcmd('e123', '我要出售');
}

//驿站 装备黑市事件
function e23($mode = 0, $step = 0, $prop_id = 0, $yeshu = 0, $show_mode = 0)
{
    $now_time = date("Y-m-d H:i:s");
    $danye_count = 15;
    $is_first = value::get_user_value('hs_prop_first');
    if (!$is_first) {
        echo "装备黑市交易规则:<br>1.每位玩家的寄售道具上限为5件。<br>2.每次交易成功后,黑市向卖方收取10%手续费(金币)。<br>3.黑市中购买的道具直接放入背包。<br>4.黑市中购买道具所需的金币从杂货铺中收取。<br>5.黑市中期限与广告费用所需的金币从身上收取。";
        br();
        cmd::addcmd('e23,' . $mode, '好的,我了解了');
        value::set_user_value('hs_prop_first', 1);
        cmd::set_show_return_game(false);
        return;
    }
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $add_sql = "";
    $is_br = true;
    if ($prop_id) {
        $old_user_id = value::get_game_prop_value($prop_id, 'user_id');
        $prop_zz_id = value::get_game_prop_value($prop_id, 'prop_id');
        $prop_liangci = value::get_prop_value($prop_zz_id, 'liangci');
        $prop_name = value::get_game_prop_value($prop_id, 'name');
        $heishi_money = value::get_game_prop_value($prop_id, 'heishi_money');
        $prop_star = value::get_game_prop_value($prop_id, 'star');
        $prop_star_str = prop::get_star_str($prop_star);
    }
    if (!$mode) {
        cmd::addcmd('e23,1', '黑市道具');
        br();
        cmd::addcmd('e23,2', '我的道具');
    } else if ($mode == 1) {
        value::set_user_value('hs_look_mode', 0);
        $zhp_money = value::get_user_value('zahuopu.money');
        echo "杂货铺：{$zhp_money}金币";
        echo "  ";
        cmd::addcmd('e26', '存钱');
        br();
        if (!$show_mode) {
            echo "全部";
        } else {
            cmd::addcmd('e23,1', '全部');
        }
        echo "|";
        if ($show_mode == 1) {
            echo "装备";
            $add_sql = " AND `prop_id`>1 AND `prop_id`!=62 ";
        } else {
            cmd::addcmd('e23,1,0,0,0,1', '装备');
        }
        echo "|";
        if ($show_mode == 2) {
            $add_sql = " AND `prop_id`=1 ";
            echo "仙丹";
        } else {
            cmd::addcmd('e23,1,0,0,0,2', '仙丹');
        }
        echo "|";
        if ($show_mode == 3) {
            $add_sql = " AND `prop_id`=62 ";
            echo "宠物卡";
        } else {
            cmd::addcmd('e23,1,0,0,0,3', '宠物卡');
        }
        br();
        $sql = "SELECT COUNT(*) FROM `game_prop` WHERE `user_num`=3 AND `heishi_time`>='{$now_time}'";
        if ($add_sql) {
            $sql .= $add_sql;
        }
        $result = sql($sql);
        list($item_count) = $result->fetch_row();
        $ocount = 0;
        $yeshu = $step * $danye_count;
        $sql = "SELECT `id`,`name`,`heishi_money`,`prop_id`,`star` FROM `game_prop` WHERE `user_num`=3 AND `heishi_time`>='{$now_time}'";
        if ($add_sql) {
            $sql .= $add_sql;
        }
        $sql .= " ORDER BY `heishi_money`,`exp` ASC LIMIT {$yeshu},{$danye_count} ";
        $result = sql($sql);
        while (list($oid, $oname, $omoney, $ozzid, $ostar) = $result->fetch_row()) {
            $ocount++;
            $liangci = value::get_prop_value($ozzid, 'liangci');
            $leixing = value::get_prop_value($ozzid, 'leixing');
            $cmd_str = "1{$liangci}";
            if ($leixing == 1) {
                $exp = value::get_game_prop_value($oid, 'exp');
                $cmd_str .= "{$exp}点经验的仙丹";
            } else {
                $cmd_str .= prop::get_star_str($ostar);
                $cmd_str .= "{$oname}";
            }
            cmd::addcmd('e23,5,1,' . $oid . ',' . $step, $cmd_str . "({$omoney}个金币)");
            br();
        }
        if (!$ocount) {
            switch ($show_mode) {
                case 1:
                    echo "黑市里面没有装备。";
                    break;
                case 2:
                    echo "黑市里面没有仙丹。";
                    break;
                case 3:
                    echo "黑市里面没有宠物卡。";
                    break;
                default:
                    echo "黑市里面空无一物。";
                    break;
            }
        } else {
            $is_br = false;
        }
        //翻页系统
        $max_page_num = (int)(($item_count - 1) / $danye_count) + 1;
        if ($step) {
            $is_br = true;
            if ($step > 1) {
                cmd::addcmd('e23,1,0,0,0,' . $show_mode, '首页');
                echo "|";
            }
            cmd::addcmd('e23,1,' . ($step - 1) . ',0,0,' . $show_mode, '上—页');
        }
        if ($item_count > $danye_count * ($step + 1)) {
            $is_br = true;
            if ($step) {
                echo "|";
            }
            cmd::addcmd('e23,1,' . ($step + 1) . ',0,0,' . $show_mode, '下—页');
            if ($step + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e23,1,' . ($max_page_num - 1) . ',0,0,' . $show_mode, '末页');
            }
        }
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,2', '我的卖品');
        br();
        cmd::addcmd('e23,3', '我要出售');
    } else if ($mode == 2) {
        echo "客官,你的卖品如下:";
        br();
        $ocount = 0;
        $sql = "SELECT `id`,`name`,`prop_id`,`heishi_money`,`heishi_time`,`star` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=3 ORDER BY `heishi_money` ASC";
        $result = sql($sql);
        while (list($oid, $oname, $ozzid, $omoney, $otime, $ostar) = $result->fetch_row()) {
            $ocount++;
            $liangci = value::get_prop_value($ozzid, 'liangci');
            $leixing = value::get_prop_value($ozzid, 'leixing');
            $cmd_str = "1{$liangci}";
            if ($leixing == 1) {
                $exp = value::get_game_prop_value($oid, 'exp');
                $cmd_str .= "{$exp}点经验的仙丹";
            } else {
                $cmd_str .= prop::get_star_str($ostar);
                $cmd_str .= "{$oname}";
            }
            cmd::addcmd('e23,5,2,' . $oid, $cmd_str . "({$omoney}个金币)");
            if (strtotime($otime) < time()) {
                echo "[已过期]";
            }
            br();
        }
        if (!$ocount) {
            echo "你还没有黑市卖品！";
            br();
        }
        $is_br = false;
    } else if ($mode == 3) {
        echo "客官,你想要出售什么装备呢:";
        br();
        $ocount = 0;
        $sql = "SELECT `id`,`name`,`prop_id`,`star` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `is_jiaoyi`<1";
        $result = sql($sql);
        while (list($oid, $oname, $ozzid, $ostar) = $result->fetch_row()) {
            if (value::get_prop_value($ozzid, 'is_jiaoyi') < 1) {
                $ocount++;
                if ($ocount > 1) {
                    br();
                }
                if (value::get_prop_value($ozzid, 'leixing') == 1) {
                    $oname .= "(" . value::get_game_prop_value($oid, 'exp') . "点经验)";
                } else if (value::get_prop_value($ozzid, 'leixing') == 4) {
                    $pet_id = value::get_game_prop_value($oid, 'pet_id');
                    $oname .= "(" . pet::get_xingge(value::get_pet_value($pet_id, 'xingge')) . pet::get_texing(value::get_pet_value($pet_id, 'texing'), false) . ")";
                }
                cmd::addcmd('e23,4,1,' . $oid, $oname);
            }
        }
        if (!$ocount) {
            echo "你没有能在黑市出售的道具。";
        }
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,1', '返回上级');
        return;
    } else if ($mode == 4) {
        if (!$step) {
            prop::show_prop($prop_id, 4);
            $is_br = false;
        } else if ($step == 1) {
            $cmd = cmd::addcmd('e23,4,2,' . $prop_id, '出售', false);
            echo <<<buyform
你想为这{$prop_liangci}{$prop_name}标价多少个金币?<br>
<form action="game.php?cmd={$cmd}" method="post" name="buy_form">
    <span>价格:</span>
    <input type="text" name="money" maxlength="8" value="100">
    <br>
    <span>期限:</span>
    <select name="time">
        <option value="1">6小时 600金币</option>
        <option value="2">12小时 1200金币</option>
        <option value="3">18小时 1800金币</option>
        <option value="4">24小时 2400金币</option>
    </select>
    <br>
    <input type="submit"  value="确定出售" name="出售">
</form>
buyform;
            $is_br = false;
        } else if ($step == 2) {
            $sql = "SELECT COUNT(*) FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=3";
            $result = sql($sql);
            list($heishi_count) = $result->fetch_row();
            if ($heishi_count < 5) {
                $heishi_time = (int)value::real_escape_string($_POST['time']);
                if ($heishi_time > 0 && $heishi_time < 5) {
                    $heishi_money = (int)value::real_escape_string($_POST['money']);
                    if ($heishi_money >= 100 && $heishi_money <= 100000000) {
                        if (prop::user_have_prop($prop_id, 0, 1)) {
                            switch ($heishi_time) {
                                case 1:
                                    $heishi_time = date("Y-m-d H:i:s", strtotime("+6 hours"));
                                    $heishi_need_money = 600;
                                    break;
                                case 2:
                                    $heishi_time = date("Y-m-d H:i:s", strtotime("+12 hours"));
                                    $heishi_need_money = 1200;
                                    break;
                                case 3:
                                    $heishi_time = date("Y-m-d H:i:s", strtotime("+18 hours"));
                                    $heishi_need_money = 1800;
                                    break;
                                case 4:
                                    $heishi_time = date("Y-m-d H:i:s", strtotime("+24 hours"));
                                    $heishi_need_money = 2400;
                                    break;
                            }
                            if (item::add_money(-1 * $heishi_need_money)) {
                                value::set_game_prop_value($prop_id, 'user_num', 3);
                                value::set_game_prop_value($prop_id, 'heishi_money', $heishi_money);
                                value::set_game_prop_value($prop_id, 'heishi_time', $heishi_time);
                                echo "你成功把这{$prop_liangci}{$prop_name}放到黑市,售价为{$heishi_money}个金币!";
                            } else {
                                $is_br = false;
                            }
                        } else {
                            echo "你身上已经没有这件道具了。";
                        }
                    } else {
                        echo "价格输入错误,无法出售道具!";
                    }
                } else {
                    echo "期限选择错误,无法出售道具!";
                }
            } else {
                echo "抱歉,你在黑市中出售的道具上限已满!";
            }
        }
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,3', '返回上级');
        return;
    } else if ($mode == 5) {
        //设置查看黑市道具id
        value::set_user_value('hs_look_prop_id', $prop_id);
        //返回列表
        $from_list = value::get_user_value('hs_look_mode');
        //是否换行
        $is_br = false;
        //显示道具
        if (prop::show_prop($prop_id, 5)) {
            //显示操作
            $o_heishi_guoqi = false;
            $o_heishi_money = value::get_game_prop_value($prop_id, 'heishi_money');
            $o_heishi_time = value::get_game_prop_value($prop_id, 'heishi_time');
            $o_shengyu_time = strtotime($o_heishi_time) - time();
            if ($o_shengyu_time > 0) {
                $o_shengyu_hour = (int)($o_shengyu_time / 3600);
                $o_shengyu_min = (int)($o_shengyu_time % 3600 / 60);
            } else {
                $o_heishi_guoqi = true;
            }
            $o_user_id = value::get_game_prop_value($prop_id, 'user_id');
            $o_user_name = value::get_game_user_value('name', $o_user_id);
            $o_is_online = value::get_game_user_value('is_online', $o_user_id);
            echo "售价:";
            echo "{$o_heishi_money}个金币";
            br();
            echo "剩余:";
            if (!$o_heishi_guoqi) {
                echo "{$o_shengyu_hour}小时{$o_shengyu_min}分钟";
            } else {
                echo "已过期";
            }
            br();
            echo "卖家:";
            if ($o_is_online) {
                cmd::addcmd('e12,' . $o_user_id . ',8', $o_user_name);
            } else {
                echo $o_user_name;
            }
            br();
            if (prop::user_have_prop($prop_id, 0, 3)) {
                if (!$from_list) {
                    if (!$o_heishi_guoqi) {
                        cmd::addcmd('e23,6,0,' . $prop_id, '黑市广告');
                    } else {
                        cmd::addcmd('e23,7,0,' . $prop_id, '我要续期');
                    }
                    br();
                    cmd::addcmd('e23,8,0,' . $prop_id, '取回道具');
                    br();
                }
            } else {
                if (!$o_heishi_guoqi) {
                    cmd::addcmd('e23,9,0,' . $prop_id . ',' . $step, '购买道具');
                    br();
                }
            }
        }
        //返回操作
        if ($is_br) {
            br();
        }
        if (!$from_list) {
            cmd::addcmd('e23,1', '返回上级');
        } else {
            cmd::addcmd('e0', '返回上级');
        }
        return;
    } else if ($mode == 6) {
        if (!$step) {
            echo "你确定要花费200金币发送黑市广告吗?";
            br();
            cmd::addcmd('e23,6,1,' . $prop_id, '发送广告');
        } else {
            if (time() > (value::get_user_value('shoutuguanggao.time') + 10)) {
                if (item::add_money(-200)) {
                    value::set_user_value('shoutuguanggao.time', time(), $user_id);
                    echo "你的黑市广告已经发出,请静候佳音!";
                    $ozzid = value::get_game_prop_value($prop_id, 'prop_id');
                    if (value::get_prop_value($ozzid, 'leixing') == 1) {
                        $miaoshu = "1{$prop_liangci}含有" . value::get_game_prop_value($prop_id, 'exp') . "点经验的仙丹";
                    } else if (value::get_prop_value($ozzid, 'leixing') == 4) {
                        $pet_id = value::get_game_prop_value($prop_id, 'pet_id');
                        $xingge_str = pet::get_xingge(value::get_pet_value($pet_id, 'xingge'));
                        $texing_str = pet::get_texing(value::get_pet_value($pet_id, 'texing'), false);
                        $miaoshu = "1{$prop_liangci}性格为{$xingge_str},天赋为{$texing_str}的{$prop_name}";
                    } else {
                        $miaoshu = "1{$prop_liangci}{$prop_star_str}{$prop_name}";
                    }
                    c_add_xiaoxi("{$user_name}想用{$heishi_money}个金币出售{$miaoshu}!", 5, $user_id, $prop_id);
                } else {
                    cmd::addcmd('e23,5,2,' . $prop_id, '返回上级');
                    br();
                    return;
                }
            } else {
                echo "你的黑市广告太频繁了,请稍后再发!";
            }
        }
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,5,2,' . $prop_id, '返回上级');
        return;
    } else if ($mode == 7) {
        if (prop::user_have_prop($prop_id, 0, 3)) {
            if (!$step) {
                $cmd = cmd::addcmd('e23,7,1,' . $prop_id, '续期', false);
                echo <<<buyform
你想为这{$prop_liangci}{$prop_name}续期多久?<br>
<form action="game.php?cmd={$cmd}" method="post" name="buy_form">
    <span>期限:</span>
    <select name="time">
        <option value="1">6小时 600金币</option>
        <option value="2">12小时 1200金币</option>
        <option value="3">18小时 1800金币</option>
        <option value="4">24小时 2400金币</option>
    </select>
    <br>
    <input type="submit"  value="确定续期" name="续期">
</form>
buyform;
                $is_br = false;
            } else {
                $heishi_time = (int)value::real_escape_string($_POST['time']);
                if ($heishi_time > 0 && $heishi_time < 5) {
                    switch ($heishi_time) {
                        case 1:
                            $heishi_time = date("Y-m-d H:i:s", strtotime("+6 hours"));
                            $heishi_need_money = 600;
                            $heishi_xuqi_hour = 6;
                            break;
                        case 2:
                            $heishi_time = date("Y-m-d H:i:s", strtotime("+12 hours"));
                            $heishi_need_money = 1200;
                            $heishi_xuqi_hour = 12;
                            break;
                        case 3:
                            $heishi_time = date("Y-m-d H:i:s", strtotime("+18 hours"));
                            $heishi_need_money = 1800;
                            $heishi_xuqi_hour = 18;
                            break;
                        case 4:
                            $heishi_time = date("Y-m-d H:i:s", strtotime("+24 hours"));
                            $heishi_need_money = 2400;
                            $heishi_xuqi_hour = 24;
                            break;
                    }
                    if (item::add_money(-1 * $heishi_need_money)) {
                        value::set_game_prop_value($prop_id, 'heishi_time', $heishi_time);
                        echo "你成功把这{$prop_liangci}{$prop_name}续期{$heishi_xuqi_hour}小时!";
                    }
                }
            }
        } else {
            echo "黑市里已经没有这件道具了。";
        }
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,5,2,' . $prop_id, '返回上级');
        return;
    } else if ($mode == 8) {
        if (prop::user_have_prop($prop_id, 0, 3)) {
            value::set_game_prop_value($prop_id, 'user_num', 1);
            value::set_game_prop_value($prop_id, 'heishi_money', 0);
            echo "你把这{$prop_liangci}{$prop_name}带在了身上!";
        } else {
            echo "黑市里已经没有这件道具了。";
        }
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,2', '返回上级');
        return;
    } else if ($mode == 9) {
        if (value::get_game_prop_value($prop_id, 'user_num') == 3) {
            if (!$step) {
                echo "你确定用{$heishi_money}个金币购买这{$prop_liangci}{$prop_star_str}{$prop_name}吗?";
                br();
                cmd::addcmd('e23,9,1,' . $prop_id, '确定购买');
            } else {
                $buy_money = value::get_user_value('zahuopu.money');
                if ($buy_money >= $heishi_money) {
                    value::add_user_value('zahuopu.money', -$heishi_money);
                    $sell_money = (int)($heishi_money * 0.9);
                    value::add_user_value('zahuopu.money', $sell_money, $old_user_id);
                    prop::user_get_prop($prop_id, $user_id, 1, true, true);
                    c_add_xiaoxi("{$user_name}购买了你在黑市里出售的1{$prop_liangci}{$prop_star_str}{$prop_name},你获得了{$sell_money}个金币", 0, $user_id, $old_user_id);
                    cmd::set_return_game_br(false);
                    return;
                } else {
                    echo "杂货铺里没有足够的金币了。";
                }
            }
        } else {
            echo "黑市里已经没有这件道具了。";
        }
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,5,' . $yeshu . ',' . $prop_id, '返回上级');
        return;
    }
    if ($mode > 1) {
        if ($is_br) {
            br();
        }
        cmd::addcmd('e23,1', '返回上级');
        br();
    } else {
        br();
    }
    cmd::set_return_game_br(false);
}

//书店 买东西事件
function sd_e24($step = 1, $itemid = 0, $yeshu = 0)
{
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    switch ($step) {
        case 1:
            $fanye = false;
            //获取商品数量
            $sql = "SELECT COUNT(*) FROM `item` WHERE `is_zahuopu`=5";
            $result = sql($sql);
            list($item_count) = $result->fetch_row();
            //获取商品列表
            $money = value::get_user_value("money");
            $yiyongrongliang = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            //获取商品列表
            $money = value::get_user_value("money");
            echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要购买的技能书：";
            br();
            $sql = "SELECT `id`,`name`,`money` FROM `item` WHERE `is_zahuopu`=5 ORDER BY `id` ASC LIMIT {$start_count},{$danye_count}";
            $result = sql($sql);
            while (list($id, $name, $money) = $result->fetch_row()) {
                $i1 = $start_count + $i + 1;
                $i++;
                cmd::addcmd('sd_e24,2,' . $id . ',' . $yeshu, $i1 . "." . $name . "(" . $money . "金币)");
                br();
            }
            //翻页系统
            $max_page_num = (int)(($item_count - 1) / $danye_count) + 1;
            if ($yeshu) {
                if ($yeshu > 1) {
                    cmd::addcmd('sd_e24,1,0,0', '首页');
                    echo "|";
                }
                cmd::addcmd('sd_e24,1,0,' . ($yeshu - 1), '上—页');
                $fanye = true;
            }
            if ($item_count > ($yeshu + 1) * $danye_count) {
                if ($yeshu) {
                    echo "|";
                }
                cmd::addcmd('sd_e24,1,0,' . ($yeshu + 1), '下—页');
                if ($yeshu + 2 < $max_page_num) {
                    echo "|";
                    cmd::addcmd('sd_e24,1,0,' . ($max_page_num - 1), '末页');
                }
                $fanye = true;
            }
            //是否翻页换行
            if ($fanye) {
                br();
                cmd::set_return_game_br(false);
            }
            break;
        case 2://查看物品详情
            $name = value::getvalue('item', 'name', 'id', $itemid);
            $desc = value::getvalue('item', 'desc', 'id', $itemid);
            $item_money = value::getvalue('item', 'money', 'id', $itemid);
            $cmd = cmd::addcmd("sd_e24,3," . $itemid . ',' . $yeshu, '购买', false);
            echo <<<buyform
$name<br>$desc<br>价格:{$item_money}金币<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="3" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
            cmd::addcmd('sd_e24,1,0,' . $yeshu, '返回上级');
            break;
        case 3:
            $pcount = (int)value::real_escape_string($_POST['count']);
            $yiyongrongliang = user::get_fuzhong();
            $yiyongrongliang1 = $yiyongrongliang + $pcount;
            $beibaorongliang = user::get_rongliang();
            if ($beibaorongliang >= $yiyongrongliang1) {
                $money = value::get_user_value('money');
                $item_money = value::getvalue('item', 'money', 'id', $itemid);
                if ($pcount > 0 && $money >= ($item_money * $pcount)) {
                    if (item::add_item($itemid, $pcount)) {
                        item::add_money(-1 * $item_money * $pcount);
                        value::add_user_value('usemoney', $item_money * $pcount);
                    }
                } else {
                    echo "走开,没钱别在这捣乱!";
                    br();
                }
            } else {
                echo "抱歉,您的背包已满!";
                br();
            }
            cmd::addcmd('sd_e24,1,' . $itemid . ',' . $yeshu, '返回上级');
            break;
    }
}

//杂货铺 买东西事件
function yd_e24($step = 1, $itemid = 0, $yeshu = 0)
{
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    switch ($step) {
        case 1:
            $fanye = false;
            //获取商品数量
            $sql = "SELECT COUNT(*) FROM `item` WHERE `is_zahuopu`=6";
            $result = sql($sql);
            list($item_count) = $result->fetch_row();
            //获取商品列表
            $yiyongrongliang = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            $money = value::get_user_value("money");
            echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择需要购买的药品：";
            br();
            $sql = "SELECT `id`,`name`,`money` FROM `item` WHERE `is_zahuopu`=6 ORDER BY `id` ASC LIMIT {$start_count},{$danye_count}";
            $result = sql($sql);
            while (list($id, $name, $money) = $result->fetch_row()) {
                $i1 = $start_count + $i + 1;
                $i++;
                cmd::addcmd('yd_e24,2,' . $id . ',' . $yeshu, $i1 . "." . $name . "(" . $money . "金币)");
                br();
            }
            //翻页系统
            $max_page_num = (int)(($item_count - 1) / $danye_count) + 1;
            if ($yeshu) {
                if ($yeshu > 1) {
                    cmd::addcmd('yd_e24,1,0,0', '首页');
                    echo "|";
                }
                cmd::addcmd('yd_e24,1,0,' . ($yeshu - 1), '上—页');
                $fanye = true;
            }
            if ($item_count > ($yeshu + 1) * $danye_count) {
                if ($yeshu) {
                    echo "|";
                }
                cmd::addcmd('yd_e24,1,0,' . ($yeshu + 1), '下—页');
                if ($yeshu + 2 < $max_page_num) {
                    echo "|";
                    cmd::addcmd('yd_e24,1,0,' . ($max_page_num - 1), '末页');
                }
                $fanye = true;
            }
            //是否翻页换行
            if ($fanye) {
                br();
                cmd::set_return_game_br(false);
            }
            break;
        case 2://查看物品详情
            $name = value::getvalue('item', 'name', 'id', $itemid);
            $desc = value::getvalue('item', 'desc', 'id', $itemid);
            $item_money = value::getvalue('item', 'money', 'id', $itemid);
            $cmd = cmd::addcmd("yd_e24,3," . $itemid . ',' . $yeshu, '购买', false);
            echo <<<buyform
$name<br>$desc<br>价格:{$item_money}金币<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="3" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
            cmd::addcmd('yd_e24,1,0,' . $yeshu, '返回上级');
            break;
        case 3:
        $pcount = (int)value::real_escape_string($_POST['count']);
        $yiyongrongliang = user::get_fuzhong();
        $yiyongrongliang1 = $yiyongrongliang + $pcount;
        $beibaorongliang = user::get_rongliang();
        if ($beibaorongliang >= $yiyongrongliang1) {
            $money = value::get_user_value('money');
            $item_money = value::getvalue('item', 'money', 'id', $itemid);
            if ($pcount > 0 && $money >= ($item_money * $pcount)) {
                if (item::add_item($itemid, $pcount)) {
                    item::add_money(-1 * $item_money * $pcount);
                    value::add_user_value('usemoney', $item_money * $pcount);
                }
            } else {
                echo "走开,没钱别在这捣乱!";
                br();
            }
        } else {
            echo "抱歉,您的背包已满!";
            br();
        }
        cmd::addcmd('yd_e24,1,' . $itemid . ',' . $yeshu, '返回上级');
        break;
    }
}

//杂货铺 买东西事件
function e24($step = 1, $itemid = 0, $yeshu = 0)
{
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    switch ($step) {
        case 1:
            $fanye = false;
            //获取商品数量
            $sql = "SELECT COUNT(*) FROM `item` WHERE `is_zahuopu`=1";
            $result = sql($sql);
            list($item_count) = $result->fetch_row();
            //获取商品列表
            $money = value::get_user_value("money");
            $yiyongrongliang = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要购买的物品：";
            br();
            $sql = "SELECT `id`,`name`,`money` FROM `item` WHERE `is_zahuopu`=1 ORDER BY `id` ASC LIMIT {$start_count},{$danye_count}";
            $result = sql($sql);
            while (list($id, $name, $money) = $result->fetch_row()) {
                cmd::addcmd('e24,2,' . $id . ',' . $yeshu, $name . "(" . $money . "金币)");
                br();
            }
            //翻页系统
            $max_page_num = (int)(($item_count - 1) / $danye_count) + 1;
            if ($yeshu) {
                if ($yeshu > 1) {
                    cmd::addcmd('e24,1,0,0', '首页');
                    echo "|";
                }
                cmd::addcmd('e24,1,0,' . ($yeshu - 1), '上—页');
                $fanye = true;
            }
            if ($item_count > ($yeshu + 1) * $danye_count) {
                if ($yeshu) {
                    echo "|";
                }
                cmd::addcmd('e24,1,0,' . ($yeshu + 1), '下—页');
                if ($yeshu + 2 < $max_page_num) {
                    echo "|";
                    cmd::addcmd('e24,1,0,' . ($max_page_num - 1), '末页');
                }
                $fanye = true;
            }
            //是否翻页换行
            if ($fanye) {
                br();
                cmd::set_return_game_br(false);
            }
            break;
        case 2://查看物品详情
            ck_e41($itemid);
            $name = value::getvalue('item', 'name', 'id', $itemid);
            $desc = value::getvalue('item', 'desc', 'id', $itemid);
            $item_money = value::getvalue('item', 'money', 'id', $itemid);
            $cmd = cmd::addcmd("e24,3," . $itemid . ',' . $yeshu, '购买', false);
            echo <<<buyform
价格:{$item_money}金币<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="3" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
            cmd::addcmd('e24,1,0,' . $yeshu, '返回上级');
            break;
        case 3:
            $pcount = (int)value::real_escape_string($_POST['count']);
            $money = value::get_user_value('money');
            $item_money = value::getvalue('item', 'money', 'id', $itemid);
            $yiyongrongliang = user::get_fuzhong();
            $yiyongrongliang1 = $yiyongrongliang + $pcount;
            $beibaorongliang = user::get_rongliang();
            if ($beibaorongliang >= $yiyongrongliang1) {
                $money = value::get_user_value('money');
                $item_money = value::getvalue('item', 'money', 'id', $itemid);
                if ($pcount > 0 && $money >= ($item_money * $pcount)) {
                    if (item::add_item($itemid, $pcount)) {
                        item::add_money(-1 * $item_money * $pcount);
                        value::add_user_value('usemoney', $item_money * $pcount);
                    }
                } else {
                    echo "走开,没钱别在这捣乱!";
                    br();
                }
            } else {
                echo "抱歉,您的背包已满!";
                br();
            }
            cmd::addcmd('e24,1,' . $itemid . ',' . $yeshu, '返回上级');
            break;
    }
}

function gm_show_prop1($prop_id, $mode = 0, $show_name = true)
{
    $user_id = uid();
    $sql = "SELECT `name`,`star`,`ts_jz3`,`ts_jz6`,`ts_jz13`,`star1`,`max_naijiu`,`exp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`mz`,`hp`,`mp`,`sex`,`sub_leixing`,`mb`,`km`,`xx`,`zd`,`kd`,`bj` FROM `prop` WHERE `id`={$prop_id} LIMIT 1";
    $result = sql($sql);
    list($name, $star, $ts_jz3, $ts_jz6, $ts_jz13, $star1, $max_naijiu, $exp, $pugong, $pufang, $tegong, $tefang, $minjie, $mz, $hp, $mp, $sex, $sub_leixing, $mb, $km, $xx, $zd, $kd, $bj) = $result->fetch_row();
    if ($name) {
        $sql = "SELECT `desc`,`id`,`zhiye`,`equip_use_lvl`,`leixing`,`event`,`in_map_use`,`is_diuqi`,`is_xiaohui`,`zb_ls` FROM `prop` WHERE `id` ={$prop_id} LIMIT 1";
        $result = sql($sql);
        list($desc, $id, $zhiye, $equip_use_lvl, $leixing, $event, $in_map_use, $is_diuqi, $is_xiaohui, $is_budiao, $zb_ls) = $result->fetch_row();
        if ($show_name) {
            echo $name;
            br();
            $zb_naijiu = "耐久:{$max_naijiu}/{$max_naijiu}";
            $zb_zl = "重量：1";
            $zb_tp = "<img src=res/img/zb/" . $id . ".png style='width: 80px;height: 80px;'>";
            if ($leixing == 4) {
                $zb_tp = "<img src=res/img/zb/" . $id . ".gif style='width: 80px;height: 80px;'>";
            }
            echo "<style>td,th{text-align:center;font-size:16px;}</style><table  border='0'><tbody>
            <tr><td>{$zb_tp}</td><th>{$zb_zl}<br><br>{$zb_naijiu}</th></tr>
            </tbody></table>";
            if ($desc) {
                echo $desc;
                br();
            }
        }
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
            if ($equip_num == $sub_leixing) {
                if ($leixing == 4) {
                    echo "位置：翅膀{$equip_num}";
                    br();
                } else {
                    echo "位置：" . $equip_subtype;
                    br();
                }
            }
        }
        if ($equip_use_lvl) {
            echo "等级：" . $equip_use_lvl;
            br();
        }
        if ($zhiye) {
            echo "职业：" . $zhiye;
            br();
        }
        if ($sex) {
            echo "性别：" . $sex;
            br();
        }
        if ($is_jiaoyi) {
            echo "<span style=color:red>绑定：是</span>";
            br();
        } else {
            echo "<span style=color:green>绑定：否</span>";
            br();
        }
        if ($ts_jz13) {
            echo "<span style=color:red>套装：万能效果</span>";
            br();
        }
        if ($sj_lvl) {
            echo "<span style=color:red>升阶：{$sj_lvl}阶</span>";
            br();
        }
        if ($sx_lvl) {
            echo "<span style=color:red>升星：{$sx_lvl}星</span>";
            br();
        }
        if ($fm) {
            echo "<span style=color:red>附魔：绑耐</span>";
            br();
        }
        if ($pugong || $pufang || $tegong || $tefang || $hp || $mp) {
            echo "<span style=color:#006000>【基础属性】</span>";
            br();
            if ($leixing) {
                if ($pugong) {
                    echo "<span style=color:#006000>攻击：</span>" . $pugong;
                    br();
                }
                if ($pufang) {
                    echo "<span style=color:#006000>防御：</span>" . $pufang;
                    br();
                }
                if ($tegong) {
                    echo "<span style=color:#006000>魔攻：</span>" . $tegong;
                    br();
                }
                if ($tefang) {
                    echo "<span style=color:#006000>魔防：</span>" . $tefang;
                    br();
                }
                if ($hp) {
                    echo "<span style=color:#006000>生命：</span>" . $hp;
                    br();
                }
                if ($mp) {
                    echo "<span style=color:#006000>魔法：</span>" . $mp;
                    br();
                }
            }
        }
        if ($minjie || $mz || $mb || $km || $xx || $zd || $kd || $bj || $ts_jz6) {
            echo "<span style=color:#006000>【特殊属性】</span>";
            br();
            if ($minjie) {
                echo "<span style=color:red>躲避：+{$minjie}%</span>";
                br();
            }
            if ($mz) {
                echo "<span style=color:red>命中：+{$mz}%</span>";
                br();
            }
            if ($mb) {
                echo "<span style=color:red>麻痹：+{$mb}%</span>";
                br();
            }
            if ($km) {
                echo "<span style=color:red>免麻：+{$km}%</span>";
                br();
            }
            if ($xx) {
                echo "<span style=color:red>吸血：+{$xx}%</span>";
                br();
            }
            if ($zd) {
                echo "<span style=color:red>中毒：+{$zd}%</span>";
                br();
            }
            if ($kd) {
                echo "<span style=color:red>免毒：+{$kd}%</span>";
                br();
            }
            if ($bj) {
                echo "<span style=color:red>暴击：+{$bj}%</span>";
                br();
            }
            if ($ts_jz6) {
                echo "<span style=color:red>负重：+{$ts_jz6}</span>";
                br();
            }
        }
    }
}

//铁匠铺 买东西事件
function tjp_e24($step = 1, $propid = 0, $yeshu = 0)
{
    $user_id = uid();
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    switch ($step) {
        case 1:
            $fanye = false;
            //获取商品数量
            $sql = "SELECT COUNT(*) FROM `prop` WHERE `is_mm`=2";
            $result = sql($sql);
            list($prop_count) = $result->fetch_row();
            if ($start_count1 > $prop_count) {
                $danye_count = $prop_count;
            }
            //获取商品列表
            $money = value::get_user_value("money");
            $yiyongrongliang = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要购买的武器：";
            br();
            $sql = "SELECT `id`,`name`,`money`,`star1` FROM `prop` WHERE `is_mm`=2 ORDER BY `id` ASC LIMIT {$start_count},{$danye_count}";
            $result = sql($sql);
            while (list($id, $name, $money, $star1) = $result->fetch_row()) {
                $i1 = $start_count + $i + 1;
                $i++;
                cmd::addcmd('tjp_e24,2,' . $id . ',' . $yeshu, $i1 . "." . $name . "(" . $money . "金币)");
                br();
            }
            //翻页系统
            $max_page_num = (int)(($prop_count - 1) / $danye_count) + 1;
            if ($yeshu) {
                if ($yeshu > 1) {
                    cmd::addcmd('tjp_e24,1,0,0', '首页');
                    echo "|";
                }
                cmd::addcmd('tjp_e24,1,0,' . ($yeshu - 1), '上—页');
                $fanye = true;
            }
            if ($prop_count > ($yeshu + 1) * $danye_count) {
                if ($yeshu) {
                    echo "|";
                }
                cmd::addcmd('tjp_e24,1,0,' . ($yeshu + 1), '下—页');
                if ($yeshu + 2 < $max_page_num) {
                    echo "|";
                    cmd::addcmd('tjp_e24,1,0,' . ($max_page_num - 1), '末页');
                }
                $fanye = true;
            }
            //是否翻页换行
            if ($fanye) {
                br();
                cmd::set_return_game_br(false);
            }
            break;
        case 2://查看物品详情
            $prop_money = value::getvalue('prop', 'money', 'id', $propid);
            $cmd = cmd::addcmd("tjp_e24,3," . $propid . ',' . $yeshu, '购买', false);
            prop::gm_show_prop($propid);
            echo <<<buyform
价格:{$prop_money}金币<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="3" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
            cmd::addcmd('tjp_e24,1,0,' . $yeshu, '返回上级');
            break;
        case 3:
            $pcount = (int)value::real_escape_string($_POST['count']);
            $money = value::get_user_value('money');
            $prop_money = value::getvalue('prop', 'money', 'id', $propid);
            $yiyongrongliang = user::get_fuzhong();
            $yiyongrongliang1 = $yiyongrongliang + $pcount;
            $beibaorongliang = user::get_rongliang();
            if ($beibaorongliang >= $yiyongrongliang1) {
                $money = value::get_user_value('money');
                $item_money = value::getvalue('item', 'money', 'id', $itemid);
                if ($pcount > 0 && $money >= ($prop_money * $pcount)) {
                    item::add_money(-1 * $prop_money * $pcount);
                    value::add_user_value('usemoney', $prop_money * $pcount);
                    for ($i = 0; $i < $pcount; $i++) {
                        prop::user_get_prop(prop::new_prop($propid, 0, 0), 0, 1, false, true);
                        $bx_name = value::get_prop_value($propid, 'name');
                        echo "你购买了{$bx_name}!";
                        br();
                    }
                } else {
                    echo "走开,没钱别在这捣乱!";
                    br();
                }
            } else {
                echo "抱歉,您的背包已满!";
                br();
            }
            cmd::addcmd('tjp_e24,1,' . $propid . ',' . $yeshu, '返回上级');
            break;
    }
}

//铁匠铺 卖装备事件
function tjp_e25($mode = 0, $prop_id = 0, $yeshu = 0, $money = 0)
{
    $user_id = uid();
    $danye_count = 15;
    if (!$mode) {
        //获取商品列表
        $money = value::get_user_value("money");
        $yiyongrongliang = user::get_fuzhong();
        $beibaorongliang = user::get_rongliang();
        echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要卖掉的装备：";
        br();
        $item_count_array = array();
        $item_id_array = array();
        $item_leixing_array = array();
        $item_count = 0;
        //获取道具
        $sql = "SELECT `id`,`prop_id`,`name`,`money` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `user_num`!=5 ORDER BY LENGTH(`name`) ASC";
        $result = sql($sql);
        while (list($id, $prop_id, $name, $money) = $result->fetch_row()) {
            $p_ok = true;
            if ($p_ok) {
                array_push($item_id_array, $id);
                array_push($item_count_array, 1);
                $item_count++;
            }
        }
        //输出物品链接
        $max_count = $item_count < ($yeshu + 1) * $danye_count ? $item_count : ($yeshu + 1) * $danye_count;
        for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
            $i1 = $i + 1;
            $prop_name = value::get_game_prop_value($item_id_array[$i], 'name');
            $money = value::get_game_prop_value($item_id_array[$i], 'money');
            $star1 = value::get_game_prop_value($item_id_array[$i], 'star1');
            $prop_id = value::get_game_prop_value($item_id_array[$i], 'prop_id');
            $prop_money = $money > 0 ? $money / 10 : 1;
            $prop_money = (int)$prop_money;
            cmd::addcmd('tjp_e25,1,' . $item_id_array[$i] . ',' . $yeshu . ",{$money}", $i1 . "." . $prop_name . "(售价{$prop_money}金币)");
            br();
        }
        //上下页操作
        $fanye = false;
        $max_page_num = (int)(($item_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            if ($yeshu > 1) {
                cmd::addcmd('tjp_e25,0,0,' . $yeshu . ",0", '首页');
                echo "|";
            }
            cmd::addcmd('tjp_e25,0,0,' . ($yeshu - 1) . ",0", '上—页');
            $fanye = true;
        }
        if ($item_count > ($yeshu + 1) * $danye_count) {
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('tjp_e25,0,0,' . ($yeshu + 1) . ",0", '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('tjp_e25,0,0,' . ($max_page_num - 1). ",0", '末页');
            }
            $fanye = true;
        }
        //是否翻页换行
        if ($fanye) {
            br();
        }
    } else {
        $prop_money = $money > 0 ? $money / 10 : 1;
        if ($prop_money) {
            $prop_money = (int)$prop_money;
            $prop_name = value::get_game_prop_value($prop_id, 'name');
            echo "你卖掉了{$prop_name}!";
            br();
            prop::del_prop($prop_id);
            item::add_money($prop_money);
        } else {
            echo "走开,没东西别在这捣乱!";
            br();
        }
        cmd::addcmd('tjp_e25,0,0,0,0', "返回上级");
        br();
    }
}

//铁匠铺 卖装备事件
function zbybhs_e25($mode = 0, $prop_id = 0, $yeshu = 0, $money = 0)
{
    $user_id = uid();
    $danye_count = 15;
    if (!$mode) {
        //获取商品列表
        $money = item::get_lingshi();
        $yiyongrongliang = user::get_fuzhong();
        $beibaorongliang = user::get_rongliang();
        echo "你身上有元宝：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要回收的装备：";
        br();
        $item_count_array = array();
        $item_id_array = array();
        $item_leixing_array = array();
        $item_count = 0;
        //获取道具
        $sql = "SELECT `id`,`prop_id`,`name`,`star1` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `star1`>0 AND `user_num`!=5 ORDER BY LENGTH(`name`) ASC";
        $result = sql($sql);
        while (list($id, $prop_id, $name, $money) = $result->fetch_row()) {
            $p_ok = true;
            if ($p_ok) {
                array_push($item_id_array, $id);
                array_push($item_count_array, 1);
                $item_count++;
            }
        }
        //输出物品链接
        $max_count = $item_count < ($yeshu + 1) * $danye_count ? $item_count : ($yeshu + 1) * $danye_count;
        for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
            $i1 = $i + 1;
            $prop_name = value::get_game_prop_value($item_id_array[$i], 'name');
            $money = value::get_game_prop_value($item_id_array[$i], 'star1');
            $star1 = value::get_game_prop_value($item_id_array[$i], 'star1');
            $prop_id = value::get_game_prop_value($item_id_array[$i], 'prop_id');
            $prop_money = $money > 0 ? $money * 10 : 1;
            $prop_money = (int)$prop_money;
            cmd::addcmd('zbybhs_e25,1,' . $item_id_array[$i] . ',' . $yeshu . ",{$money}", $i1 . "." . $prop_name . "({$prop_money}元宝卷)");
            br();
        }
        cmd::addcmd('zbybhs_e25,2', "一键回收");
        //上下页操作
        $fanye = false;
        $max_page_num = (int)(($item_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            if ($yeshu > 1) {
                cmd::addcmd('zbybhs_e25,0,0,' . $yeshu . ",0", '首页');
                echo "|";
            }
            cmd::addcmd('zbybhs_e25,0,0,' . ($yeshu - 1) . ",0", '上—页');
            $fanye = true;
        }
        if ($item_count > ($yeshu + 1) * $danye_count) {
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('zbybhs_e25,0,0,' . ($yeshu + 1) . ",0", '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('zbybhs_e25,0,0,' . ($max_page_num - 1). ",0", '末页');
            }
            $fanye = true;
        }
        //是否翻页换行
        if ($fanye) {
            br();
        }
    } else if ($mode == 2) {
        $item_money = 0;
        //获取道具
        $sql = "SELECT `id`,`prop_id`,`name`,`star1` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `star1`>0 AND `user_num`!=5 ORDER BY LENGTH(`name`) ASC";
        $result = sql($sql);
        while (list($id, $prop_id, $name, $money) = $result->fetch_row()) {
            $money = $money * 10;
            $item_money += $money;
            prop::del_prop($id);
        }
        if ($item_money) {
            echo "你一键回收了装备!";
            br();
            $name = value::get_game_user_value("name");
            c_add_guangbo("恭喜玩家{$name}一键回收了装备获得<span style=color:red>{$item_money}</span>元宝卷!");
            item::add_item(199, $item_money);
            user::get_exp($user_id, $item_money * 1000);
        } else {
            echo "你没有可回收的装备!";
            br();
        }  
    } else if ($mode == 1) {
        $prop_money = $money > 0 ? $money * 10 : 1;
        if ($prop_money) {
            $prop_money = (int)$prop_money;
            $prop_name = value::get_game_prop_value($prop_id, 'name');
            $name = value::get_game_user_value('name', $user_id);
            echo "你回收了{$prop_name}!";
            c_add_guangbo("恭喜玩家{$name}回收了{$prop_name}获得<span style=color:red>{$prop_money}</span>元宝卷!");
            br();
            prop::del_prop($prop_id);
            item::add_item(199, $prop_money);
            user::get_exp($user_id, $prop_money * 1000);
        } else {
            echo "走开,没东西别在这捣乱!";
            br();
        }
        cmd::addcmd('zbybhs_e25,0,0,0,0', "返回上级");
        br();
    }
}

//首饰铺 买东西事件
function ss_e24($step = 1, $propid = 0, $yeshu = 0)
{
    $user_id = uid();
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    switch ($step) {
        case 1:
            $fanye = false;
            //获取商品数量
            $sql = "SELECT COUNT(*) FROM `prop` WHERE `is_mm`=3 or `is_mm`=6 or `is_mm`=7 or `is_mm`=8 or `is_mm`=9";
            $result = sql($sql);
            list($prop_count) = $result->fetch_row();
            if ($start_count1 > $prop_count) {
                $danye_count = $prop_count;
            }
            //获取商品列表
            $money = value::get_user_value("money");
            $yiyongrongliang = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要购买的首饰：";
            br();
            $sql = "SELECT `id`,`name`,`money`,`star1` FROM `prop` WHERE `is_mm`=3 or `is_mm`=6 or `is_mm`=7 or `is_mm`=8 or `is_mm`=9 ORDER BY `id` ASC LIMIT {$start_count},{$danye_count}";
            $result = sql($sql);
            while (list($id, $name, $money, $star1) = $result->fetch_row()) {
                $i1 = $start_count + $i + 1;
                $i++;
                cmd::addcmd('ss_e24,2,' . $id . ',' . $yeshu, $i1 . "." . $name . "(" . $money . "金币)");
                br();
            }
            //翻页系统
            $max_page_num = (int)(($prop_count - 1) / $danye_count) + 1;
            if ($yeshu) {
                if ($yeshu > 1) {
                    cmd::addcmd('ss_e24,1,0,0', '首页');
                    echo "|";
                }
                cmd::addcmd('ss_e24,1,0,' . ($yeshu - 1), '上—页');
                $fanye = true;
            }
            if ($prop_count > ($yeshu + 1) * $danye_count) {
                if ($yeshu) {
                    echo "|";
                }
                cmd::addcmd('ss_e24,1,0,' . ($yeshu + 1), '下—页');
                if ($yeshu + 2 < $max_page_num) {
                    echo "|";
                    cmd::addcmd('ss_e24,1,0,' . ($max_page_num - 1), '末页');
                }
                $fanye = true;
            }
            //是否翻页换行
            if ($fanye) {
                br();
                cmd::set_return_game_br(false);
            }
            break;
        case 2://查看物品详情
            $prop_money = value::getvalue('prop', 'money', 'id', $propid);
            $cmd = cmd::addcmd("ss_e24,3," . $propid . ',' . $yeshu, '购买', false);
            prop::gm_show_prop($propid);
            echo <<<buyform
价格:{$prop_money}金币<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="3" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
            cmd::addcmd('ss_e24,1,0,' . $yeshu, '返回上级');
            break;
        case 3:
            $pcount = (int)value::real_escape_string($_POST['count']);
            $money = value::get_user_value('money');
            $prop_money = value::getvalue('prop', 'money', 'id', $propid);
            $yiyongrongliang = user::get_fuzhong();
            $yiyongrongliang1 = $yiyongrongliang + $pcount;
            $beibaorongliang = user::get_rongliang();
            if ($beibaorongliang >= $yiyongrongliang1) {
                $money = value::get_user_value('money');
                $item_money = value::getvalue('item', 'money', 'id', $itemid);
                if ($pcount > 0 && $money >= ($prop_money * $pcount)) {
                    item::add_money(-1 * $prop_money * $pcount);
                    value::add_user_value('usemoney', $prop_money * $pcount);
                    for ($i = 0; $i < $pcount; $i++) {
                        prop::user_get_prop(prop::new_prop($propid, 0, 0), 0, 1, false, true);
                        $bx_name = value::get_prop_value($propid, 'name');
                        echo "你购买了{$bx_name}!";
                        br();
                    }
                } else {
                    echo "走开,没钱别在这捣乱!";
                    br();
                }
            } else {
                echo "抱歉,您的背包已满!";
                br();
            }
            cmd::addcmd('ss_e24,1,' . $propid . ',' . $yeshu, '返回上级');
            break;
    }
}

//衣服铺 买东西事件
function yf_e24($step = 1, $propid = 0, $yeshu = 0)
{
    $user_id = uid();
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    switch ($step) {
        case 1:
            $fanye = false;
            //获取商品数量
            $sql = "SELECT COUNT(*) FROM `prop` WHERE `is_mm`=5";
            $result = sql($sql);
            list($prop_count) = $result->fetch_row();
            if ($start_count1 > $prop_count) {
                $danye_count = $prop_count;
            }
            //获取商品列表
            $money = value::get_user_value("money");
            $yiyongrongliang = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要购买的服饰：";
            br();
            $sql = "SELECT `id`,`name`,`money`,`star1` FROM `prop` WHERE `is_mm`=5 ORDER BY `id` ASC LIMIT {$start_count},{$danye_count}";
            $result = sql($sql);
            while (list($id, $name, $money, $star1) = $result->fetch_row()) {
                $i1 = $start_count + $i + 1;
                $i++;
                cmd::addcmd('yf_e24,2,' . $id . ',' . $yeshu, $i1 . "." . $name . "(" . $money . "金币)");
                br();
            }
            //翻页系统
            $max_page_num = (int)(($prop_count - 1) / $danye_count) + 1;
            if ($yeshu) {
                if ($yeshu > 1) {
                    cmd::addcmd('yf_e24,1,0,0', '首页');
                    echo "|";
                }
                cmd::addcmd('yf_e24,1,0,' . ($yeshu - 1), '上—页');
                $fanye = true;
            }
            if ($prop_count > ($yeshu + 1) * $danye_count) {
                if ($yeshu) {
                    echo "|";
                }
                cmd::addcmd('yf_e24,1,0,' . ($yeshu + 1), '下—页');
                if ($yeshu + 2 < $max_page_num) {
                    echo "|";
                    cmd::addcmd('yf_e24,1,0,' . ($max_page_num - 1), '末页');
                }
                $fanye = true;
            }
            //是否翻页换行
            if ($fanye) {
                br();
                cmd::set_return_game_br(false);
            }
            break;
        case 2://查看物品详情
            $prop_money = value::getvalue('prop', 'money', 'id', $propid);
            $cmd = cmd::addcmd("yf_e24,3," . $propid . ',' . $yeshu, '购买', false);
            prop::gm_show_prop($propid);
            echo <<<buyform
价格:{$prop_money}金币<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="3" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
            cmd::addcmd('yf_e24,1,0,' . $yeshu, '返回上级');
            break;
        case 3:
            $pcount = (int)value::real_escape_string($_POST['count']);
            $money = value::get_user_value('money');
            $prop_money = value::getvalue('prop', 'money', 'id', $propid);
            $yiyongrongliang = user::get_fuzhong();
            $yiyongrongliang1 = $yiyongrongliang + $pcount;
            $beibaorongliang = user::get_rongliang();
            if ($beibaorongliang >= $yiyongrongliang1) {
                $money = value::get_user_value('money');
                $item_money = value::getvalue('item', 'money', 'id', $itemid);
                if ($pcount > 0 && $money >= ($prop_money * $pcount)) {
                    item::add_money(-1 * $prop_money * $pcount);
                    value::add_user_value('usemoney', $prop_money * $pcount);
                    for ($i = 0; $i < $pcount; $i++) {
                        prop::user_get_prop(prop::new_prop($propid, 0, 0), 0, 1, false, true);
                        $bx_name = value::get_prop_value($propid, 'name');
                        echo "你购买了{$bx_name}!";
                        br();
                    }
                } else {
                    echo "走开,没钱别在这捣乱!";
                    br();
                }
            } else {
                echo "抱歉,您的背包已满!";
                br();
            }
            cmd::addcmd('yf_e24,1,' . $propid . ',' . $yeshu, '返回上级');
            break;
    }
}

//杂货铺 卖东西事件
function e25($step = 1, $itemid = 0, $yeshu = 0, $sell_item_count = 0)
{
    $danye_count = 15;
    $user_id = uid();
    switch ($step) {
        case 1:
            $fanye = false;
            $benye_item_count = 0;
            $sell_item_count = 0;
            $sell_item_id_array = array();
            $sell_item_count_array = array();
            $yiyongrongliang = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            //获取商品列表
            $money = value::get_user_value("money");
            echo "你身上有金币：" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}<br>请选择你要卖掉的物品：";
            br();
            $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
            $result = sql($sql);
            while (list($id, $count) = $result->fetch_row()) {
                if ($count) {
                    $id = explode('.', $id);
                    $is_diuqi = value::getvalue('item', 'is_diuqi', 'id', $id[2]);
                    if ($is_diuqi) {
                        array_push($sell_item_id_array, $id[2]);
                        array_push($sell_item_count_array, $count);
                        $sell_item_count++;
                    }
                }
            }
            //输出卖品链接
            $max_count = $sell_item_count < ($yeshu + 1) * $danye_count ? $sell_item_count : ($yeshu + 1) * $danye_count;
            for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
                $name = value::getvalue('item', 'name', 'id', $sell_item_id_array[$i]);
                $liangci = value::getvalue('item', 'liangci', 'id', $sell_item_id_array[$i]);
                $item_money = (int)(value::getvalue('item', 'money', 'id', $itemid) / 10);
                $item_money = $item_money > 0 ? $item_money : 1;
                $i1 = $i + 1;
                cmd::addcmd('e25,2,' . $sell_item_id_array[$i] . "," . $yeshu . "," . $sell_item_count_array[$i], $i1 . "." . $name . "(" . $item_money . "金币x" . $sell_item_count_array[$i] . $liangci . ")");
                br();
                $benye_item_count++;
            }
            if (!$benye_item_count) {
                echo "你没有可以出售的东西。";
                br();
            }
            //翻页系统
            $max_page_num = (int)(($sell_item_count - 1) / $danye_count) + 1;
            if ($yeshu) {
                if ($yeshu > 1) {
                    cmd::addcmd('e25,1,0', '首页');
                    echo "|";
                }
                cmd::addcmd('e25,1,0,' . ($yeshu - 1), '上—页');
                $fanye = true;
            }
            if ($sell_item_count > ($yeshu + 1) * $danye_count) {
                if ($yeshu) {
                    echo "|";
                }
                cmd::addcmd('e25,1,0,' . ($yeshu + 1), '下—页');
                if ($yeshu + 2 < $max_page_num) {
                    echo "|";
                    cmd::addcmd('e25,1,0,' . ($max_page_num - 1), '末页');
                }
                $fanye = true;
            }
            //是否翻页换行
            if ($fanye) {
                br();
            }
            cmd::set_return_game_br(false);
            break;
        case 2://查看物品详情
            $name = value::getvalue('item', 'name', 'id', $itemid);
            $liangci = value::getvalue('item', 'liangci', 'id', $itemid);
            $desc = value::getvalue('item', 'desc', 'id', $itemid);
            $item_money = (int)(value::getvalue('item', 'money', 'id', $itemid) / 10);
            $item_money = $item_money > 0 ? $item_money : 1;
            $cmd = cmd::addcmd("e25,3," . $itemid . ",{$yeshu}", '出售', false);
            $cmd2 = cmd::addcmd("e25,4," . $itemid . ",{$yeshu}", '全部出售', false);
            echo <<<buyform
	$name x $sell_item_count  $liangci<br>$desc<br>售价:{$item_money}金币<br>
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="count" maxlength="8" value="1">
	<br>
	<input type="submit" value="确定出售" name="出售">
</form>
<form action="game.php?cmd=$cmd2" method="post">
	<input type="submit" value="全部出售" name="出售">
</form>
buyform;
            cmd::addcmd('e25,1,0' . ",{$yeshu}", '返回上级');
            break;
        case 3:
            $pcount = (int)value::real_escape_string($_POST['count']);
            $item_money = (int)(value::getvalue('item', 'money', 'id', $itemid) / 10);
            $item_money = $item_money > 0 ? $item_money : 1;
            $old_count = item::get_item($itemid);
            if ($pcount > 0 && $pcount <= $old_count) {
                item::add_item($itemid, -1 * $pcount);
                item::add_money($item_money * $pcount);
            } else {
                echo "走开,没东西别在这捣乱!";
                br();
            }
            cmd::addcmd('e25,1,' . $itemid . ",{$yeshu}", '返回上级');
            break;
        case 4:
            $pcount = item::get_item($itemid);
            $item_money = (int)(value::getvalue('item', 'money', 'id', $itemid) / 10);
            $item_money = $item_money > 0 ? $item_money : 1;
            if ($pcount > 0) {
                item::add_item($itemid, -1 * $pcount);
                item::add_money($item_money * $pcount);
            } else {
                echo "走开,没东西别在这捣乱!";
                br();
            }
            cmd::addcmd('e25,1,' . $itemid . ",{$yeshu}", '返回上级');
            break;
    }
}

//杂货铺 存钱事件
function e26($step = 1)
{
    $money = value::get_user_value('money');
    if ($step == 1) {
        $cmd = cmd::addcmd('e26,2', '存钱', false);
        echo <<<cunqianform
	你身上有{$money}个金币,想要存多少个金币?
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="money" maxlength="8">
	<br>
	<input type="submit" value="存入金币" name="存入">
</form>
cunqianform;
        cmd::set_return_game_br(false);
    } else {
        $pmoney = (int)value::real_escape_string($_POST['money']);
        if ($pmoney > 0 && $pmoney <= $money) {
            $zahuopumoney = value::add_user_value('zahuopu.money', $pmoney);
            $smoney = value::add_user_value('money', -1 * $pmoney);
            echo '你存入了' . $pmoney . '个金币<br>杂货铺有' . $zahuopumoney . '个金币<br>身上有' . $smoney . '个金币';
            br();
            cmd::set_return_game_br(false);
        } else {
            echo "走开,没钱别在这捣乱!";
            br();
            cmd::addcmd('e26', '返回上级');
        }
    }
}

//杂货铺 取钱事件
function e27($step = 1)
{
    $zahuopumoney = value::get_user_value('zahuopu.money');
    if ($step == 1) {
        $cmd = cmd::addcmd('e27,2', '取钱', false);
        echo <<<quqianform
	杂货铺有{$zahuopumoney}个金币,想要取多少个金币?
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="money" maxlength="8">
	<br>
	<input type="submit" value="取出金币" name="取出">
</form>
quqianform;
        cmd::set_return_game_br(false);
    } else {
        $pmoney = (int)value::real_escape_string($_POST['money']);
        if ($pmoney > 0 && $pmoney <= $zahuopumoney) {
            $money = value::add_user_value('money', $pmoney);
            $zahuopumoney = value::add_user_value('zahuopu.money', -1 * $pmoney);
            echo '你取出了' . $pmoney . '个金币<br>你身上有' . $money . '个金币<br>杂货铺有' . $zahuopumoney . '个金币';
            br();
            cmd::set_return_game_br(false);
        } else {
            echo "走开,没钱别在这捣乱!";
            br();
            cmd::addcmd('e27', '返回上级');
        }
    }
}

//仓库 治疗宠物事件
function e28($mode = 0, $pet_id = 0)
{
    $user_id = uid();
    if (!$mode) {
        $start_time = value::get_user_value('zlcw.start.time');
        $now_time = time();
        if (!$start_time) {
            value::set_user_value('zlcw.start.time', time());
        }
        echo '正在治疗宠物...';
        if ($start_time && $now_time > $start_time + 2) {
            //每日限次
            $today = date("Y-m-d");
            $xianci = 1000;
            if (value::get_user_value("zlcw.day.date") == $today) {
                value::add_user_value("zlcw.day.counts", 1);
            } else {
                value::set_user_value("zlcw.day.date", $today);
                value::set_user_value("zlcw.day.counts", 0);
            }
            $today_zl_counts = value::get_user_value("zlcw.day.counts");
            //$need_money = -1000 * ($today_zl_counts - $xianci);
            $need_money = -1000;
            if ($today_zl_counts < $xianci || item::add_money($need_money, 0, false)) {
                $have_dead = false;
                $u_pet_arr = user::get_pet_arr($user_id, 1);
                foreach ($u_pet_arr as $pet_id) {
                    $is_dead = value::get_pet_value($pet_id, 'is_dead');
                    $pet_lvl = value::get_pet_value($pet_id, 'lvl');
                    $pet_name = value::get_pet_value($pet_id, 'name');
                    if (!$is_dead || $pet_lvl < 60) {
                        br();
                        //开始操作
                        e28(4, $pet_id);
                        //输出提示
                        if (!$is_dead) {
                            echo '你的' . $pet_name . '恢复了。';
                        } else {
                            value::set_pet_value($pet_id, 'is_dead', '0');
                            echo '你的' . $pet_name . '复活了。';
                        }
                    } else {
                        $have_dead = true;
                    }
                }
                if ($have_dead) {
                    br();
                    cmd::addcmd('e28,1', '复活宠物');
                }
                value::set_user_value('zlcw.start.time', 0);
            } else {
                value::add_user_value("zlcw.day.counts", -1);
                echo "<br>本次治疗需要" . abs($need_money) . "个金币,你身上没有足够的金币了。";
            }
        } else {
            br();
            cmd::addcmd('e28', '等待');
            cmd::set_show_return_game(false);
            return;
        }
    } else if ($mode == 1) {
        $sql = "SELECT `id`,`exp`  FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `is_dead`=1 LIMIT 5";
        $result = sql($sql);
        $pet_arr = array();
        $exp_arr = array();
        while (list($pet_id, $exp) = $result->fetch_row()) {
            array_push($pet_arr, $pet_id);
            array_push($exp_arr, $exp);
        }
        $d_pet_count = count($pet_arr);
        $all_exp = 0;
        for ($i = 0; $i < $d_pet_count; $i++) {
            $all_exp += $exp_arr[$i];
        }
        $all_money = (int)($all_exp / 1000);
        cmd::addcmd('e28,2', '全部复活(' . $all_money . "金币)");
        br();
        for ($i = 0; $i < $d_pet_count; $i++) {
            if ($i) {
                br();
            }
            $pet_money = (int)($exp_arr[$i] / 1000);
            $pet_name = value::get_pet_value($pet_arr[$i], 'name');
            cmd::addcmd('e28,3,' . $pet_arr[$i], '复活' . $pet_name . '(' . $pet_money . "金币)");
        }
    } else if ($mode == 2) {
        $sql = "SELECT `id`,`exp`  FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `is_dead`=1";
        $result = sql($sql);
        $pet_arr = array();
        $exp_arr = array();
        while (list($pet_id, $exp) = $result->fetch_row()) {
            array_push($pet_arr, $pet_id);
            array_push($exp_arr, $exp);
        }
        $d_pet_count = count($pet_arr);
        $all_exp = 0;
        for ($i = 0; $i < $d_pet_count; $i++) {
            $all_exp += $exp_arr[$i];
        }
        $all_money = (int)($all_exp / 1000);
        if (item::add_money($all_money * -1)) {
            for ($j = 0; $j < $d_pet_count; $j++) {
                if ($j) {
                    br();
                }
                $pet_id = $pet_arr[$j];
                $pet_name = value::get_pet_value($pet_id, 'name');
                //开始操作
                e28(4, $pet_id);
                //输出提示
                echo '你的' . $pet_name . '复活了。';
            }
        } else {
            cmd::set_return_game_br(false);
        }
    } else if ($mode == 3) {
        $money = (int)(value::get_pet_value($pet_id, 'exp') / 1000);
        if (item::add_money($money * -1)) {
            $pet_name = value::get_pet_value($pet_id, 'name');
            //开始操作
            e28(4, $pet_id);
            //输出提示
            echo '你的' . $pet_name . '复活了。';
        } else {
            cmd::set_return_game_br(false);
        }
    } else if ($mode == 4) {
        $max_hp = pet::get_max_hp($pet_id);
        //恢复血量
        value::set_pet_value($pet_id, 'hp', $max_hp);
        //复活宠物
        value::set_pet_value($pet_id, 'is_dead', '0');
        //恢复状态
        value::set_pet_value($pet_id, 'zhuangtai', '0');
        //恢复技能pp
        $zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $pet_id, false)) {
            $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
            $max_pp *= $zhuansheng > 0 ? 1.5 : 1;
            $max_pp = (int)$max_pp;
            value::set_pet_value2('skill.' . $skill_id . '.pp', $max_pp, $pet_id);
            $i++;
        }
        return;
    }
}

//仓库 存取宠物事件
function e29($mode = 0, $pet_id = 0, $money_cunru = 0, $yeshu = 0, $step = 0)
{
    $user_id = uid();
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    $fyg_count = user::get_fuzhong(2);
    $fyg_rongliang = user::get_rongliang(2);
    if (!$mode) {
        echo "宠物容量:{$fyg_count}/{$fyg_rongliang}";
        echo "  ";
        cmd::addcmd('beib_e55,3', '扩充');
        br();
        //获取宠物数量
        $sql = "SELECT COUNT(*) FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=2";
        $result = sql($sql);
        list($pet_count) = $result->fetch_row();
        $count = 0;
        $sql = "SELECT `id`,`name`,`lvl`,`nick_name`,`is_lock` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=2 ORDER BY `zhuansheng`,`lvl`,`chujing`,`id` ASC LIMIT {$start_count},{$danye_count}";
        $result = sql($sql);
        while (list($oid, $oname, $olvl, $onick_name, $ois_lock) = $result->fetch_row()) {
            $is_dead = value::get_pet_value($oid, 'is_dead');
            cmd::addcmd('e29,4,' . $oid . ',0,' . $yeshu, ($onick_name ? "({$onick_name})" : "") . $oname . '(' . $olvl . '级)');
            echo $is_dead ? "(已死亡)" : "";
            echo ' ';
            cmd::addcmd('e29,3,' . $oid, '取出');
            echo " ";
            if (!$ois_lock) {
                cmd::addcmd('e29,7,' . $oid . ',0,' . $yeshu, '锁定');
                echo " ";
                cmd::addcmd('e29,5,' . $oid . ',0,' . $yeshu, '放生');
            } else {
                cmd::addcmd('e29,8,' . $oid . ',0,' . $yeshu, '解锁');
            }
            br();
            $count++;
        }
        if (!$count) {
            echo '你的仓库里没有宠物。';
            br();
        }
        //上下页操作
        $fanye = false;
        $max_page_num = (int)(($pet_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            if ($yeshu > 1) {
                cmd::addcmd('e29', '首页');
                echo "|";
            }
            cmd::addcmd('e29,0,0,0,' . ($yeshu - 1), '上—页');
            $fanye = true;
        }
        if ($pet_count > ($yeshu + 1) * $danye_count) {
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('e29,0,0,0,' . ($yeshu + 1), '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e29,0,0,0,' . ($max_page_num - 1), '末页');
            }
            $fanye = true;
        }
        //是否翻页换行
        if ($fanye) {
            br();
        }
        cmd::addcmd('e29,1', '存入宠物');
        br();
        if ($fyg_count) {
            cmd::addcmd('e29,10,0,0,' . $yeshu, '一键放生');
            br();
        }
        cmd::set_return_game_br(false);
    } else if ($mode == 1) {
        echo '你想存入哪只宠物?';
        br();
        $u_pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($u_pet_arr as $list_pet_id) {
            $is_dead = value::get_pet_value($list_pet_id, 'is_dead');
            $onick_name = value::get_pet_value($list_pet_id, 'nick_name');
            $name = value::get_pet_value($list_pet_id, 'name');
            cmd::addcmd('e29,2,' . $list_pet_id, ($onick_name ? "({$onick_name})" : "") . $name . "(" . value::get_pet_value($list_pet_id, 'lvl') . "级)");
            echo($is_dead ? "(已死亡)" : "");
            br();
        }
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 2) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        if ($fyg_count < $fyg_rongliang || $money_cunru) {
            if ($money_cunru) {
                $money = ($fyg_count + 1 - $fyg_rongliang) * 5000;
                if (value::get_user_value('money') >= $money) {
                } else {
                    echo "走开,没钱别在这捣乱!";
                    br();
                    cmd::addcmd('e29', '返回上级');
                    return;
                }
            }
            if (pet::user_lose_pet(uid(), $pet_id, 2)) {
                //金币存入
                if ($money_cunru) {
                    if (item::add_money(-1 * $money)) {
                    } else {
                        cmd::addcmd('e29', '返回上级');
                        return;
                    }
                }
                //卸下道具
                prop::pet_lose_all_prop($pet_id);
                //降低忠诚度 处理hp max_hp
                value::add_pet_value($pet_id, 3, -10, false);
                $hp = value::get_pet_value($pet_id, 'hp');
                $max_hp = pet::get_max_hp($pet_id);
                if ($hp > $max_hp) {
                    value::set_pet_value($pet_id, 'hp', $max_hp);
                }
                //输出提示
                echo '你把' . $pet_name . '存入了仓库。';
                br();
                cmd::addcmd('e29', '返回上级');
            } else {
                cmd::addcmd('e29', '返回上级');
            }
        } else {
            $money = ($fyg_count + 1 - $fyg_rongliang) * 5000;
            echo "你确定要花费" . $money . '个金币存入一只' . $pet_name . '吗?';
            br();
            cmd::addcmd('e29,2,' . $pet_id . ',1', '确定存入');
            br();
            cmd::addcmd('e29', '返回上级');
        }
    } else if ($mode == 3) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        if (pet::user_get_pet(uid(), $pet_id)) {
            echo '你把' . $pet_name . '带在了身上。';
            br();
            cmd::addcmd('e29', '返回上级');
        } else {
            cmd::addcmd('e29', '返回上级');
        }
    } else if ($mode == 4) {
        //获取宠物id
        $oid = $pet_id;
        $ois_lock = pet::get($pet_id, 'is_lock');
        //获取宠物属性
        $sql = "SELECT `pet_id`,`star`,`name`,`zhiye`,`tf`,`sx`,`czl`,`sex`,`is_yj`,`nick_name`,`lvl`,`max_lvl`,`hp`,`max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`exp`,`max_exp`,`shuxingdian`,`zhongcheng`,`zhuangtai`,`xingge`,`texing`,`zhuansheng`,`is_dead`,`hechongcishu` FROM `game_pet` WHERE `id`={$oid} LIMIT 1";
        $result = sql($sql);
        list($ozzid, $star, $oname, $zhiye, $tf, $sx, $czl, $osex, $is_yj, $nick_name, $lvl, $max_lvl, $hp, $max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $exp, $max_exp, $shuxingdian, $zhongcheng, $zhuangtai, $xingge, $texing, $zhuansheng, $is_dead, $hechongcishu) = $result->fetch_row();
        $hp = (int)$hp;
        $max_hp = (int)$max_hp;
        $fuhao = ($osex == '' ? "" : "");
        //六维加成
        $pugong_jc = pet::get_liuwei_jiacheng($oid, 'pugong');
        $pufang_jc = pet::get_liuwei_jiacheng($oid, 'pufang');
        $tegong_jc = pet::get_liuwei_jiacheng($oid, 'tegong');
        $tefang_jc = pet::get_liuwei_jiacheng($oid, 'tefang');
        $minjie_jc = pet::get_liuwei_jiacheng($oid, 'minjie');
        $hp_jc = pet::get_liuwei_jiacheng($oid, 'hp');
        //获取种族属性
        $sql = "SELECT `image`,`desc`,`star`,`wl`,`ty`,`zl`,`zz`,`ml`,`ys`,`shuxing`,`study_lvl`,`jh_id`,`jh_lvl` FROM `pet` WHERE `id`={$ozzid}" . " LIMIT 1";
        $result = sql($sql);
        list($image, $desc, $star10, $wl, $ty, $zl, $zz, $ml, $ys, $shuxing, $study_lvl, $jh_id, $jh_lvl) = $result->fetch_row();
        if (!$oname) {
            //返回地图
            echo '你已经没有这只宠物了。';
            br();
            e35();
            return;
        }
        //输出宠物星级
        if ($star <= 1) {
            $xj = "一";
        } else if ($star == 2) {
            $xj = "二";
        } else if ($star == 3) {
            $xj = "三";
        } else if ($star == 4) {
            $xj = "四";
        } else if ($star == 5) {
            $xj = "五";
        } else if ($star == 6) {
            $xj = "六";
        } else if ($star == 7) {
            $xj = "七";
        } else if ($star == 8) {
            $xj = "八";
        } else if ($star == 9) {
            $xj = "九";
        } else if ($star == 10) {
            $xj = "十";
        } else {
            $xj = "神级";
        }
        echo $xj . "星：" . $oname . ($nick_name ? "({$nick_name})" : "") . ($is_dead ? "(已死亡)" : "");
        br();
        //输出图片 描述
        if (!value::get_user_value('kg.xscwtp')) {
            if ($image != "") {
                pet::img($image, true, false);
                br();
            }
        }
        $xs_max_hp = $hp_jc + $max_hp;
        $xs_pugong = $pugong_jc + $pugong;
        $xs_pufang = $pufang_jc + $pufang;
        $xs_tegong = $tegong_jc + $tegong;
        $xs_tefang = $tefang_jc + $tefang;
        $xs_minjie = $minjie_jc + $minjie;
        echo "等级：" . $lvl;
        br();
        if ($sx <= 1) {
            $shuxing = "金";
        } else if ($sx == 2) {
            $shuxing = "木";
        } else if ($sx == 3) {
            $shuxing = "水";
        } else if ($sx == 4) {
            $shuxing = "火";
        } else if ($sx == 5) {
            $shuxing = "土";
        } else {
            $shuxing = "无";
        }
        if ($shuxing) {
            echo "五行：" . $shuxing;
        } else {
            echo "五行：无";
        }
        br();
        if ($czl == 100) {
            $czl_mz = "(极)";
        } else if ($czl >= 90) {
            $czl_mz = "(珍)";
        } else if ($czl >= 75) {
            $czl_mz = "(优)";
        } else {
            $czl_mz = "(普)";
        }
        if ($czl) {
            echo "成长率：" . $czl;
            echo "  ";
            echo $czl_mz;
        } else {
            echo "成长率：无";
        }
        br();
        if ($tf <= 1) {
            $tf_shuxing = "生命型";
        } else if ($tf == 2) {
            $tf_shuxing = "攻击型";
        } else if ($tf == 3) {
            $tf_shuxing = "防御型";
        } else if ($tf == 4) {
            $tf_shuxing = "魔攻型";
        } else if ($tf == 5) {
            $tf_shuxing = "魔防型";
        } else if ($tf == 6) {
            $tf_shuxing = "灵活型";
        } else {
            $tf_shuxing = "无";
        }
        if ($tf_shuxing) {
            echo "天赋：" . $tf_shuxing;
        } else {
            echo "天赋：无";
        }
        br();
        echo "经验：" . $exp . "/" . $max_exp;
        br();
        echo "生命：" . $hp . "/" . $xs_max_hp . " " . "忠诚度:" . $zhongcheng;
        br();
        if ($desc != "") {
            echo $desc;
        } else {
            echo "这是一只" . $oname . "。";
        }
        br();
        //输出等级 六维 属性 属性点 忠诚度 状态 性格 天赋
        $yj_xs = ($is_yj < 1) ? "临时":"永久";
        echo "<span style='color: green'><style>td,th{text-align:center;font-size:18px;}</style><table  border='0'><tbody>
        <tr><td>攻击：</td><th>{$xs_pugong}</th><td>防御：</td><th>{$xs_pufang}</th></tr>
        <tr><td>魔攻：</td><th>{$xs_tegong}</th><td>魔防：</td><th>{$xs_tefang}</th></tr>
        <tr><td>灵活：</td><th>{$xs_minjie}</th><td>状态：</td><th>{$yj_xs}</th></tr>
        </tbody></table></span>";
        //获取装配道具
        $equip_liuwei_id_arr = pet::get_prop_id($oid, 2);
        if (is_array($equip_liuwei_id_arr)) {
            $equip_subtype_arr = config::getConfigByName("equip_subtype");
            foreach ($equip_liuwei_id_arr as $equip_id) {
                $equip_name = prop::get($equip_id, 'name');
                $star1 = prop::get($equip_id, 'star1');
                $equip_subtype = value::get_game_prop_zz_value($equip_id, 'sub_leixing');
                echo $equip_subtype_arr[$equip_subtype], ':';
                cmd::addcmd("e98,{$equip_id},2", $equip_name);
                br();
            }
        }
        $equip_baowu_id = pet::get_prop_id($oid, 3);
        if ($equip_baowu_id) {
            $equip_baowu_name = prop::get($equip_baowu_id, 'name');
            echo '宝物:';
            cmd::addcmd("e98,{$equip_baowu_id},2", $equip_baowu_name);
            br();
        }
        cmd::addcmd('e29,3,' . $oid, '取出' . $oname);
        br();
        if (!$ois_lock) {
            cmd::addcmd('e29,7,' . $oid, '锁定' . $oname);
            echo "";
            br();
            cmd::addcmd('e29,5,' . $oid, '放生' . $oname);
        } else {
            cmd::addcmd('e29,8,' . $oid, '解锁' . $oname);
        }
        br();
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 5) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        if (!$step) {
            if (pet::is_xiyou($pet_id)) {
                $url = cmd::addcmd("e29,5,{$pet_id},0,0,1", "确认放生", false, true);
                echo <<<fangsheng
<form action='{$url}' method='post'>
你确定要放生这只{$pet_name}吗?<br>输入<span style="color: #ff0000">确定</span>或<span style="color: #ff0000">OK</span>确认操作:<br> 
<input type='text' id='chats' name='chats' maxlength='2'>
<br>
<input type='submit' name='确定' value='确定放生'>
</form>
fangsheng;
            } else {
                echo "你确定要放生这只{$pet_name}吗?";
                br();
                cmd::addcmd("e29,5,{$pet_id},0,0,1", "确定放生");
                br();
            }
        } else {
            if (pet::is_xiyou($pet_id)) {
                $chats = strtoupper(value::real_escape_string($_POST['chats']));
                if ($chats == "确定" || $chats == "ok" || $chats == "OK") {
                    echo "你成功放生了这只{$pet_name}。";
                    pet::del_pet($pet_id);
                } else {
                    echo "输入有误,请您重新输入。";
                }
            } else {
                echo "你成功放生了这只{$pet_name}。";
                pet::del_pet($pet_id);
            }
            br();
        }
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 6) {
        $yjfs_id_arr = array();
        $yjfs_str_arr = array();
        $sql = "SELECT `id`,`name`,`lvl`,`nick_name`,`xingge`,`texing` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=2 AND `is_lock`=0 ORDER BY `zhuansheng`,`lvl`,`chujing`,`id` ASC";
        $result = sql($sql);
        while (list($oid, $oname, $olvl, $onick_name, $oxingge, $otexing) = $result->fetch_row()) {
            if (!pet::is_xiyou($oid)) {
                $is_dead = value::get_pet_value($oid, 'is_dead');
                $ostr = ($onick_name ? "({$onick_name})" : "") . $oname . '(' . $olvl . '级)';
                $ostr .= ($is_dead ? "(已死亡)" : "") . "<br>";
                $ostr .= "性格:" . pet::get_xingge($oxingge) . " 天赋:" . pet::get_texing($otexing, false);
                array_push($yjfs_id_arr, $oid);
                array_push($yjfs_str_arr, $ostr);
            }
        }
        $yjfs_count = count($yjfs_id_arr);
        $yjfs_count = $yjfs_count > 20 ? 20 : $yjfs_count;
        if (!$step) {
            if (!$yjfs_count) {
                echo '你没有可以普通放生的宠物。';
                br();
            } else {
                echo "以下<span style='color:#ff0000'>{$yjfs_count}</span>只宠物将被普通放生,请你仔细查看!";
                br();
                for ($i = 0; $i < $yjfs_count; $i++) {
                    echo $yjfs_str_arr[$i];
                    br();
                    cmd::addcmd("e29,11," . $yjfs_id_arr[$i], "锁定宠物");
                    br();
                }
                $url = cmd::addcmd("e29,6,{$pet_id},0,0,1", "确认放生", false, true);
                echo <<<fangsheng
<form action='{$url}' method='post'>
输入<span style="color: #ff0000">确定</span>或<span style="color: #ff0000">OK</span>确认操作:<br> 
<input type='text' id='chats' name='chats' maxlength='2'>
<br>
<input type='submit' name='确定' value='普通放生'>
</form>
fangsheng;
            }
        } else {
            $chats = strtoupper(value::real_escape_string($_POST['chats']));
            if ($chats == "确定" || $chats == "ok" || $chats == "OK") {
                for ($i = 0; $i < $yjfs_count; $i++) {
                    pet::del_pet($yjfs_id_arr[$i]);
                }
                echo "你成功普通放生了<span style='color:#ff0000'>{$yjfs_count}</span>只宠物。";
                br();
                e29();
                return;
            } else {
                echo "输入有误,请您重新输入。";
            }
            br();
        }
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 7) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        if (!$step) {
            echo "锁定中的宠物无法被放生,你确定要锁定这只{$pet_name}吗?";
            br();
            cmd::addcmd("e29,7,{$pet_id},0,0,1", "确定锁定");
            br();
        } else {
            value::set_pet_value($pet_id, 'is_lock', 1);
            echo "你成功锁定了这只{$pet_name}。";
            br();
        }
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 8) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        if (!$step) {
            echo "解锁中的宠物可以被放生,你确定要解锁这只{$pet_name}吗?";
            br();
            cmd::addcmd("e29,8,{$pet_id},0,0,1", "确定解锁");
            br();
        } else {
            value::set_pet_value($pet_id, 'is_lock', 0);
            echo "你成功解锁了这只{$pet_name}。";
            br();
        }
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 9) {
        $yjfs_id_arr = array();
        $yjfs_str_arr = array();
        $sql = "SELECT `id`,`name`,`lvl`,`nick_name`,`xingge`,`texing` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=2 AND `is_lock`=0 ORDER BY `zhuansheng`,`lvl`,`chujing`,`id` ASC";
        $result = sql($sql);
        while (list($oid, $oname, $olvl, $onick_name, $oxingge, $otexing) = $result->fetch_row()) {
            $is_dead = value::get_pet_value($oid, 'is_dead');
            $ostr = ($onick_name ? "({$onick_name})" : "") . $oname . '(' . $olvl . '级)';
            $ostr .= ($is_dead ? "(已死亡)" : "") . "<br>";
            $ostr .= "性格:" . pet::get_xingge($oxingge) . " 天赋:" . pet::get_texing($otexing, false);
            array_push($yjfs_id_arr, $oid);
            array_push($yjfs_str_arr, $ostr);
        }
        $yjfs_count = count($yjfs_id_arr);
        $yjfs_count = $yjfs_count > 20 ? 20 : $yjfs_count;
        if (!$step) {
            if (!$yjfs_count) {
                echo '你没有可以强制放生的宠物。';
                br();
            } else {
                echo "以下<span style='color:#ff0000'>{$yjfs_count}</span>只宠物将被强制放生,请你仔细查看!";
                br();
                for ($i = 0; $i < $yjfs_count; $i++) {
                    echo $yjfs_str_arr[$i], "<br>";
                    cmd::addcmd("e29,12," . $yjfs_id_arr[$i], "锁定宠物");
                    echo "<br>";
                }
                $url = cmd::addcmd("e29,9,{$pet_id},0,0,1", "确认放生", false, true);
                echo <<<fangsheng
<form action='{$url}' method='post'>
输入<span style="color: #ff0000">确定</span>或<span style="color: #ff0000">OK</span>确认操作:<br> 
<input type='text' id='chats' name='chats' maxlength='2'>
<br>
<input type='submit' name='确定' value='强制放生'>
</form>
fangsheng;
            }
        } else {
            $chats = strtoupper(value::real_escape_string($_POST['chats']));
            if ($chats == "确定" || $chats == "ok" || $chats == "OK") {
                for ($i = 0; $i < $yjfs_count; $i++) {
                    pet::del_pet($yjfs_id_arr[$i]);
                }
                echo "你强制放生了<span style='color:#ff0000'>{$yjfs_count}</span>只宠物。";
                br();
                e29();
                return;
            } else {
                echo "输入有误,请您重新输入。";
            }
            br();
        }
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 10) {
        cmd::addcmd('e29,6,0,0,' . $yeshu, '普通放生');
        br();
        cmd::addcmd('e29,9,0,0,' . $yeshu, '强制放生');
        br();
        cmd::addcmd('e29,0,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 11) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        value::set_pet_value($pet_id, 'is_lock', 1);
        echo "你成功锁定了这只{$pet_name}。";
        br();
        e29(6);
        return;
    } else if ($mode == 12) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        value::set_pet_value($pet_id, 'is_lock', 1);
        echo "你成功锁定了这只{$pet_name}。";
        br();
        e29(9);
        return;
    }
}

//仓库 存取装备事件
function e30($mode = 0, $prop_id = 0, $yeshu = 0, $step = 0)
{
    $user_id = uid();
    $danye_count = 15;
    $start_count = $yeshu * $danye_count;
    $yiyongrongliang = user::get_fuzhong(1);
    $cangkurongliang = user::get_rongliang(1);
    if (!$mode) {
        echo "仓库容量:{$yiyongrongliang}/{$cangkurongliang}";
        echo "  ";
        cmd::addcmd('beib_e55,2', '扩充');
        br();
        $count = 0;
        //获取道具数量
        $sql = "SELECT COUNT(*) FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=2";
        $result = sql($sql);
        list($prop_count) = $result->fetch_row();
        $sql = "SELECT `id`,`name`,`prop_id`,`star` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=2 LIMIT {$start_count},{$danye_count}";
        $result = sql($sql);
        while (list($oid, $oname, $ozzid, $ostar) = $result->fetch_row()) {
            $liangci = value::get_prop_value($ozzid, 'liangci');
            $leixing = value::get_prop_value($ozzid, 'leixing');
            $cmd_str = "1{$liangci}";
            $cmd_str .= "{$oname}";
            if ($leixing == 1) {
                $exp = value::get_game_prop_value($oid, 'exp');
                $cmd_str .= "({$exp})";
            }
            cmd::addcmd('e98,' . $oid . ',3,' . $yeshu, $cmd_str);
            echo ' ';
            cmd::addcmd("e30,2,{$oid}", '取出');
            echo ' ';
            cmd::addcmd("e30,3,{$oid},{$yeshu}", '销毁');
            br();
            $count++;
        }
        if (!$count) {
            echo "你的仓库里没有装备。";
            br();
        }
        //上下页操作
        $fanye = false;
        $max_page_num = (int)(($prop_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            if ($yeshu > 1) {
                cmd::addcmd('e30', '首页');
                echo "|";
            }
            cmd::addcmd('e30,0,0,' . ($yeshu - 1), '上—页');
            $fanye = true;
        }
        if ($prop_count > ($yeshu + 1) * $danye_count) {
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('e30,0,0,' . ($yeshu + 1), '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e30,0,0,' . ($max_page_num - 1), '末页');
            }
            $fanye = true;
        }
        //是否翻页换行
        if ($fanye) {
            br();
        }
        cmd::addcmd("e30,1", '存入装备');
        br();
        cmd::set_return_game_br(false);
    } else if ($mode == 1) {
        if (!$prop_id) {
            echo "你想存入哪件装备?";
            br();
            $prop_count = 0;
            $sql = "SELECT `id`,`name`,`prop_id` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1";
            $result = sql($sql);
            while (list($oid, $oname, $ozzid) = $result->fetch_row()) {
                $liangci = value::get_prop_value($ozzid, 'liangci');
                $leixing = value::get_prop_value($ozzid, 'leixing');
                $cmd_str = "1{$liangci}{$oname}";
                if ($leixing == 1) {
                    $exp = value::get_game_prop_value($oid, 'exp');
                    $cmd_str .= "({$exp})";
                }
                cmd::addcmd('e30,1,' . $oid, $cmd_str);
                br();
                prop::show_prop($oid, 8, false);
                $prop_count++;
            }
            if (!$prop_count) {
                echo "没有可存入的装备";
                br();
            }
        } else {
            if (prop::user_lose_prop($prop_id, 3, 1, false)) {
                if (prop::user_get_prop($prop_id, 0, 2, false)) {
                    $oname = value::get_game_prop_value($prop_id, 'name');
                    $ozzid = value::get_game_prop_value($prop_id, 'prop_id');
                    $liangci = value::get_prop_value($ozzid, 'liangci');
                    echo "你把1{$liangci}{$oname}存了仓库。";
                    br();
                }
            }
        }
        cmd::addcmd('e30', '返回上级');
    } else if ($mode == 2) {
        if (prop::user_get_prop($prop_id, 0, 1, false)) {
            $oname = value::get_game_prop_value($prop_id, 'name');
            $ozzid = value::get_game_prop_value($prop_id, 'prop_id');
            $liangci = value::get_prop_value($ozzid, 'liangci');
            echo "你把1{$liangci}{$oname}带在身上。";
            br();
        }
        e30();
    } else if ($mode == 3) {
        $prop_name = value::get_game_prop_value($prop_id, 'name');
        $prop_liangci = value::get_game_prop_zz_value($prop_id, 'liangci');
        if (!$step) {
            echo "你确定要销毁这{$prop_liangci}{$prop_name}吗?";
            br();
            cmd::addcmd("e30,3,{$prop_id},0,1", "确定销毁");
            br();
            cmd::addcmd('e30,0,' . $prop_id . ',' . $yeshu, '返回上级');
        } else {
            echo "你成功销毁了这{$prop_liangci}{$prop_name}。";
            br();
            prop::del_prop($prop_id);
            e30();
        }
    }
}

//元宝商城 显示模板
function e31($lb = 1)
{
    //玩家数据
    cmd::addcmd('e31', '商场');
    echo ">> 元宝商店";
    echo " . ";
    cmd::addcmd('e33_ybj', '元宝卷店');
    echo " . ";
    cmd::addcmd('e33_jj', '金券商店');
    br();
    echo "-";
    br();
    $uname = value::get_game_user_value('name');
    $hy_name = value::get_game_user_value('hy_name');
    $hy_lvl = value::get_user_value('hy_lvl');
    if ($hy_lvl > 0) {
        if ($hy_lvl == 1) {
            $shop_sale = 0.9;
        }
        if ($hy_lvl == 2) {
            $shop_sale = 0.8;
        }
        if ($hy_lvl == 3) {
            $shop_sale = 0.7;
        }
    } else {
        $shop_sale = 1;
    }
    $lingshi = item::get_lingshi();
    echo "元宝:{$lingshi}";
    echo "  ";
    cmd::addcmd('e216', '充值');
    br();
    if ($lb != 1) {
        cmd::addcmd('e31,1', '辅助');
    } else {
        echo "辅助";
    }
    echo "|";
    if ($lb != 2) {
        cmd::addcmd('e31,2', '装备');
    } else {
        echo "装备";
    }
    echo "|";
    if ($lb != 3) {
        cmd::addcmd('e31,3', '祝福');
    } else {
        echo "祝福";
    }
    echo "|";
    if ($lb != 4) {
        cmd::addcmd('e31,4', '宠物');
    } else {
        echo "宠物";
    }
    echo "|";
    if ($lb != 5) {
        cmd::addcmd('e31,5', '技能');
    } else {
        echo "技能";
    }
    echo "|";
    if ($lb != 6) {
        cmd::addcmd('e31,6', '礼包');
    } else {
        echo "礼包";
    }
    echo "|";
    if ($lb != 7) {
        cmd::addcmd('e31,7', '会员');
    } else {
        echo "会员";
    }
    if ($shop_sale != 1) {
        br();
        echo "-";
        br();
        echo "尊贵的{$hy_name}享受全场<span style='color: #FF0000'>" . ($shop_sale * 10) . "折</span>特权！";
    }
    br();
    echo "<img src='br.jpg'>";
    br();
    $shop_sale = gstring::get("shop_sale");
    if (!$shop_sale) {
        $shop_sale = 1;
    }
    $sql = "SELECT `id`,`name`,`lingshi` FROM `item` WHERE `is_shangcheng`={$lb} ORDER BY LENGTH(`name`) ASC,`lingshi` ASC,`id` ASC";
    $result = sql($sql);
    while (list($oid, $oname, $olingshi) = $result->fetch_row()) {
        cmd::addcmd('e129,' . $oid . ',' . $lb, "{$oname}(" . ceil($olingshi * $shop_sale) . "元宝)");
        br();
    }
    for ($i = 0; $i < strlen($lingshi); $i++) {
        echo " ";
    }
    echo "<img src='br.jpg'>";
    br();
    cmd::addcmd('e0', '返回场景');
}

//竞技场 单人挑战事件
function e32()
{
    $user_id = uid();
    echo "武林争霸：";
    br();
    echo "-";
    br(); 
    $in_map_id = value::get_game_user_value("in_map_id");
    //获取地图在线玩家语句
    //普通方式
    $sql = "SELECT `id`,`name` FROM `game_user` WHERE `id`!='{$user_id}' AND `name`!='' AND `is_online` =1";
    $ucount = 0;
    //开始获取在线玩家
    if ($sql) {
        $result = sql($sql);
        while (list($oid, $oname) = $result->fetch_row()) {
            $ucount++;
            echo $ucount . ".";
            echo "争霸者";
            echo "   ";
            cmd::addcmd('e204,' . $oid, "挑战");
            br();
        }
    }
    if (!$ucount) {
        echo "当前没有玩家可以挑战!";
        br();
    }
    echo "-";
    br();
    cmd::set_return_game_br(false);
}

//竞技场 积分兑换事件
function e33($item_id = 0)
{
    $jjjf = value::get_game_user_value('jingji.jifen');
    $jjjf_shop_arr = config::getConfigByName("jingji_jifen_shop");
    if (!$item_id) {
        cmd::addcmd('e206', '积分排行');
        br();
        echo "-";
        br();
        $uname = value::get_game_user_value('name');
        echo "{$uname},欢迎来到竞技积分商城!";
        br();
        echo "  你有{$jjjf}点积分  ";
        br();
        asort($jjjf_shop_arr);
        foreach ($jjjf_shop_arr as $item_id => $item_price) {
            cmd::addcmd("e33,{$item_id}", value::get_item_value($item_id, "name") . "({$item_price}积分)");
            br();
        }
        echo "-";
        br();
        if (!is_array($jjjf_shop_arr)) {
            echo "积分商城暂无可兑换的道具。";
            br();
        }
        echo " ";
        br();
        cmd::addcmd('e0', '返回地图');
    } else {
        $count = (int)post::get("count");
        $item_jifen = $jjjf_shop_arr[$item_id];
        if (!$count) {
            $item_name = value::get_item_value($item_id, 'name');
            $item_desc = value::get_item_value($item_id, 'desc');
            $cmd = cmd::addcmd("e33," . $item_id, '兑换', false);
            echo <<<buyform
$item_name<br>$item_desc<br>价格:{$item_jifen}积分<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="8" value="1">
    <br>
    <input type="submit"  value="确定兑换" name="兑换">
</form>
buyform;
        } else {
            if ($count > 0) {
                $zjf = $item_jifen * $count;
                if ($jjjf >= $zjf) {
                    value::add_game_user_value("jingji.jifen", -1 * $zjf);
                    echo "你失去了{$zjf}点竞技积分";
                    br();
                    item::add_item($item_id, $count);
                } else {
                    echo "你没有足够的积分进行兑换!";
                    br();
                }
            } else {
                echo "兑换数量输入错误!";
                br();
            }
        }
        echo "-";
        br();
        cmd::addcmd('e33', '返回上级');
    }
}

//竞技场 元宝卷商场
function e33_ybj($item_id = 0)
{
    $user_id = uid();
    $money = item::get_item(199, $user_id);
    cmd::addcmd('e31', '商场');
    echo ">> 元宝卷店";
    br();
    echo "元宝卷： {$money} 个";
    br();
    echo "-";
    br();
    $yp_shop_arr = config::getConfigByName("yp_shop");
    if (!$item_id) {
        asort($yp_shop_arr);
        foreach ($yp_shop_arr as $item_id => $item_price) {
            cmd::addcmd("e33_ybj,{$item_id}", value::get_item_value($item_id, "name") . "({$item_price}元宝卷)");
            br();
        }
        if (!is_array($yp_shop_arr)) {
            echo "元宝卷店暂无可购买的物品！";
            br();
        }
        echo "-";
        br();
        cmd::addcmd('e0', '返回地图');
    } else {
        $count = (int)post::get("count");
        $item_jifen = $yp_shop_arr[$item_id];
        if (!$count) {
            ck_e41($item_id);
            $cmd = cmd::addcmd("e33_ybj," . $item_id, '购买', false);
            echo <<<buyform
价格:{$item_jifen}元宝卷<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="1" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
        } else {
            if ($count > 0) {
                $zjf = $item_jifen * $count;
                if ($money >= $zjf) {
                    item::add_item(199, -1 * $zjf);
                    item::add_item($item_id, $count);
                } else {
                    echo "你没有足够的元宝卷进行购买!";
                    br();
                }
            } else {
                echo "购买数量输入错误!";
                br();
            }
        }
        echo "-";
        br();
        cmd::addcmd('e33_ybj', '返回上级');
    }
}

//竞技场 元宝卷商场
function e33_jj($item_id = 0)
{
    $user_id = uid();
    $money = item::get_item(200, $user_id);
    cmd::addcmd('e31', '商场');
    echo ">> 金券商店";
    br();
    echo "金券： {$money} 张";
    br();
    echo "-";
    br();
    $yp_shop_arr = config::getConfigByName("jp_shop");
    if (!$item_id) {
        asort($yp_shop_arr);
        foreach ($yp_shop_arr as $item_id => $item_price) {
            cmd::addcmd("e33_jj,{$item_id}", value::get_item_value($item_id, "name") . "({$item_price}金券)");
            br();
        }
        if (!is_array($yp_shop_arr)) {
            echo "金券商店暂无可购买的物品！";
            br();
        }
        echo "-";
        br();
        cmd::addcmd('e0', '返回地图');
    } else {
        $count = (int)post::get("count");
        $item_jifen = $yp_shop_arr[$item_id];
        if (!$count) {
            ck_e41($item_id);
            $cmd = cmd::addcmd("e33_jj," . $item_id, '购买', false);
            echo <<<buyform
价格:{$item_jifen}金券<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="1" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
        } else {
            if ($count > 0) {
                $zjf = $item_jifen * $count;
                if ($money >= $zjf) {
                    item::add_item(200, -1 * $zjf);
                    item::add_item($item_id, $count);
                } else {
                    echo "你没有足够的金券进行购买!";
                    br();
                }
            } else {
                echo "购买数量输入错误!";
                br();
            }
        }
        echo "-";
        br();
        cmd::addcmd('e33_jj', '返回上级');
    }
}

//竞技场 积分兑换事件
function e334($item_id = 0)
{
    $money = value::get_user_value("fb10_money");
    $yp_shop_arr = config::getConfigByName("fb10_shop");
    if (!$item_id) {
        $uname = value::get_game_user_value('name');
        echo "{$uname},欢迎来到10级副本商店!";
        br();
        echo "  你有{$money}点10级副本值";
        br();
        asort($yp_shop_arr);
        foreach ($yp_shop_arr as $item_id => $item_price) {
            cmd::addcmd("e334,{$item_id}", value::get_prop_value($item_id, "name") . "({$item_price}点)");
            br();
        }
        if (!is_array($yp_shop_arr)) {
            echo "本店暂无可兑换的物品。";
            br();
        }
        echo " ";
        br();
        cmd::addcmd('e0', '返回地图');
    } else {
        $count = (int)post::get("count");
        $item_jifen = $yp_shop_arr[$item_id];
        if (!$count) {
            $item_name = value::get_prop_value($item_id, 'name');
            $item_desc = value::get_prop_value($item_id, 'desc');
            $cmd = cmd::addcmd("e334," . $item_id, '兑换', false);
            echo <<<buyform
$item_name<br>$item_desc<br>价格:{$item_jifen}点<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="8" value="1">
    <br>
    <input type="submit"  value="确定兑换" name="兑换">
</form>
buyform;
        } else {
            if ($count > 0) {
                $zjf = $item_jifen * $count;
                if ($money >= $zjf) {
                    value::add_user_value("fb10_money", -1 * $zjf);
                    echo "你失去了{$zjf}点";
                    br();
                    //随机装备
                    $sj = mt_rand(1, 1000);
                    if ($sj <= 5) {
                        $sji = 7;
                    } else if ($sj <= 20) {
                        $sji = 6;
                    } else if ($sj <= 50) {
                        $sji = 5;
                    } else if ($sj <= 100) {
                        $sji = 4;
                    } else if ($sj <= 200) {
                        $sji = 3;
                    } else if ($sj <= 400) {
                        $sji = 2;
                    } else if ($sj <= 600) {
                        $sji = 1;
                    } else {
                        $sji = 0;
                    }
                    prop::user_get_prop(prop::new_prop($item_id, 0, $sji), 0, $count, false, true);
                } else {
                    echo "你没有足够的副本点进行兑换!";
                    br();
                }
            } else {
                echo "兑换数量输入错误!";
                br();
            }
        }
        cmd::addcmd('e334', '返回上级');
    }
}

//竞技场 押注列表事件
function e34()
{
    echo "竞技押注 ";
    cmd::addcmd("e34", "刷新");
    $i = 0;
    $l = "SELECT id,uid,oid FROM game_sports WHERE status=0";
    $r = sql($l);
    while (list($sports_id, $uid, $oid) = $r->fetch_row()) {
        $i++;
        br();
        $user_name = user::get_game_user("name", $uid);
        $o_user_name = user::get_game_user("name", $oid);
        echo "{$user_name}VS{$o_user_name} ";
        cmd::addcmd("e205,$sports_id", "下注");
    }
    if (!$i) {
        br();
        echo "没有可以押注的竞技比赛!";
    }
}

//宠物 背包列表
function e35()
{
    cmd::addcmd('e13', '状态');
    echo ">> 宠物";
    br();
    echo "-";
    $user_id = uid();
    $pet_count = 0;
    $u_pet_arr = user::get_pet_arr($user_id, 1);
    foreach ($u_pet_arr as $pet_id) {
        br();
        $is_dead = value::get_pet_value($pet_id, 'is_dead');
        $pet_nick_name = value::getvalue('game_pet', 'nick_name', 'id', $pet_id);
        $pet_name = value::getvalue('game_pet', 'name', 'id', $pet_id);
        $pet_lvl = value::getvalue('game_pet', 'lvl', 'id', $pet_id);
        $star = value::get_pet_value($pet_id, 'star');
        cmd::addcmd('e62,' . $pet_id, ($pet_nick_name ? "({$pet_nick_name})" : "") . $pet_name . '(' . $pet_lvl . '级)');
        echo $is_dead ? "(已死亡)" : "";
        $pet_count++;
    }
    if (!$pet_count) {
        br();
        echo "身上暂时没有宠物！";
    } else {
        if ($pet_count > 1) {
            br();
            cmd::addcmd('e61', '宠物排序');
        }
    }
    br();
    echo "-";
}

//显示聊天模事件
function e36($mode = 0)
{
    $user_id = uid();
    if ($mode) {
        value::set_user_value('chat_mode', $mode);
    } else {
        $mode = value::get_user_value('chat_mode');
        if (!$mode) {
            $mode = -1;
        }
    }
    if ($mode == -1) {
        echo "[聊天系统]";
        br();
        cmd::addcmd('e36,7', '系统信息');
        br();
        cmd::addcmd('e36,2', '私聊信息');
        br();
        cmd::addcmd('e36,8', '广播信息');
        br();
        cmd::addcmd('e36,1', '公聊信息');
        br();
        cmd::addcmd('e36,5', '组队信息');
        br();
        $is_chushi = value::get_game_user_value('is_chushi', $user_id);
        if ($is_chushi) {
            $shifu_id = $user_id;
        } else {
            $shifu_id = value::get_game_user_value('shifu.id', $user_id);
        }
        if ($shifu_id) {
            cmd::addcmd('e36,3', '师门信息');
            br();
        }
        cmd::addcmd('e36,6', '帮派信息');
        br();
        cmd::addcmd('e36,4', '黑市信息');
    } else {
        ctm::show_ctm('ctm_chat');
    }
}

//显示选项模板事件
function e37()
{
    gd();
}

//聊天 发送地区聊天事件
function e38()
{
    $user_id = uid();
    if (value::get_user_value('jinyan', $user_id) < time()) {
        $now_time = date("Y-m-d H:i:s");
        $area_id = value::get_map_value(value::get_game_user_value('in_map_id'), 'area_id');
        $chats = value::real_escape_string($_POST['money']);
        if ($chats) {
            if (mb_strlen($chats, 'URF8') > 50) {
                echo "你好,内容输入长度过长。";
                br();
                cmd::addcmd('e36,1', '返回上级');
                return;
            }
            $chats = strip_tags($chats);
            $chats = get_ubb($chats);
            $sql = "SELECT `chats`,`time` FROM `game_chat` WHERE `mode`=1 AND `uid`={$user_id} ORDER BY `id` DESC LIMIT 1 ";
            $result = sql($sql);
            if (list($old_chats, $time) = $result->fetch_row()) {
                if ($old_chats == $chats) {
                    echo "请不要重复发言。";
                    br();
                    cmd::addcmd('e36,1', '返回上级');
                    return;
                } else if (time() < strtotime($time) + 2) {
                    echo "最低发言间隔为2秒。";
                    br();
                    cmd::addcmd('e36,1', '返回上级');
                    return;
                }
            }
            //聊天过滤
            if (!c_check_str($chats, 0, 2000)) {
                $chats = "绿色传奇:仙盟会(仙盟会游戏)";
            }
            $hy_lvl = value::get_user_value('hy_lvl', $user_id);
            if ($hy_lvl == 1) {
                $chats = "<span style=color:red>{$chats}</span>";
            }
            if ($hy_lvl == 2) {
                $chats = "<span style=color:green>{$chats}</span>";
            }
            if ($hy_lvl == 3) {
                $chats = "<span style=color:purple>{$chats}</span>";
            }
            //插入聊天
            $sql = "INSERT INTO `game_chat`(`mode`,`uid`,`chats`,`time`) VALUES (1,{$user_id},'" . $chats . "','{$now_time}')";
            sql($sql);
            e36(1);
        } else {
            echo "请输入聊天内容。";
            br();
            cmd::addcmd('e36,1', '返回上级');
        }
    } else {
        $jinyan_banzhu_id = value::get_user_value("jinyan.banzhu.id", $user_id);
        $jinyan_banzhu_name = value::get_game_user_value('name', $jinyan_banzhu_id);
        echo "你被{$jinyan_banzhu_name}禁言" . user::get_jinyan_str($user_id) . ",无法地区聊天与论坛发帖及回复。";
        br();
        cmd::addcmd('e36,1', '返回上级');
    }
}

//聊天 发送地区聊天事件
function e380()
{
    $user_id = uid();
    $wp_sl = item::get_item(263);
    if ($wp_sl > 0) {
        if (value::get_user_value('jinyan', $user_id) < time()) {
            item::add_item(263, -1);
            $now_time = date("Y-m-d H:i:s");
            $chats = value::real_escape_string($_POST['chats']);
            if ($chats) {
                if (mb_strlen($chats, 'URF8') > 50) {
                    echo "你好,内容输入长度过长。";
                    br();
                    cmd::addcmd('e36,8', '返回上级');
                    return;
                }
                $chats = strip_tags($chats);
                $sql = "SELECT `chats`,`time` FROM `game_chat` WHERE `mode`=30 AND `uid`={$user_id} ORDER BY `id` DESC LIMIT 1 ";
                $result = sql($sql);
                if (list($old_chats, $time) = $result->fetch_row()) {
                    if ($old_chats == $chats) {
                        echo "请不要重复发言。";
                        br();
                        cmd::addcmd('e36,8', '返回上级');
                        return;
                    } else if (time() < strtotime($time) + 2) {
                        echo "最低发言间隔为2秒。";
                        br();
                        cmd::addcmd('e36,8', '返回上级');
                        return;
                    }
                }
                //聊天过滤
                if (!c_check_str($chats, 0, 50)) {
                    $chats = "绿色传奇:仙盟会(仙盟会游戏)";
                }
                //插入聊天
                $sql = "INSERT INTO `game_chat`(`mode`,`uid`,`chats`,`time`) VALUES (30,{$user_id},'" . $chats . "','{$now_time}')";
                sql($sql);
                e36(8);
            } else {
                echo "请输入聊天内容。";
                br();
                cmd::addcmd('e36,8', '返回上级');
            }
        } else {
            $jinyan_banzhu_id = value::get_user_value("jinyan.banzhu.id", $user_id);
            $jinyan_banzhu_name = value::get_game_user_value('name', $jinyan_banzhu_id);
            echo "你被{$jinyan_banzhu_name}禁言" . user::get_jinyan_str($user_id) . ",无法地区聊天与论坛发帖及回复。";
            br();
            cmd::addcmd('e36,8', '返回上级');
        }
    } else {
        echo "你没有【小喇叭】无法广播,商场有售!";
    }
}

//首页 查看背景故事事件
function e39()
{
    echo gstring::get("shouye_beijing_xiangqing");
    br();
    cmd::addcmd('e0', '返回上级');
}

//首页 查看背景故事事件
function e301()
{
    echo gstring::get("shouye_beijing_js1");
    br();
    cmd::addcmd('e0', '返回上级');
}

//首页 查看背景故事事件
function e302()
{
    echo gstring::get("shouye_beijing_js2");
    br();
    cmd::addcmd('e0', '返回上级');
}

//首页 查看背景故事事件
function e331()
{
    echo gstring::get("shouye_beijing_js3");
    br();
    cmd::addcmd('e0', '返回上级');
}

//首页 查看背景故事事件
function e304()
{
    echo gstring::get("shouye_beijing_js4");
    br();
    cmd::addcmd('e0', '返回上级');
}

//背包 查看物品列表事件
function e40($from_list = 0, $mode = 0, $yeshu = 0)
{
    $user_id = uid();
    //设置宠物学习技能返回
    value::set_user_value('study_skill_from', 1);
    $danye_count = 15;
    if ($mode) {
        value::set_user_value('look_item_mode', $mode);
    } else {
        $mode = value::get_user_value('look_item_mode');
        if (!$mode) {
            $mode = 1;
        }
    }
    $item_count_array = array();
    $item_id_array = array();
    $item_leixing_array = array();
    //获取物品列表
    $money = value::get_user_value("money");
    $yiyongrongliang = user::get_fuzhong();
    $beibaorongliang = user::get_rongliang();
    $lingshi = item::get_lingshi();
    echo "我的背包：";
    br();
    echo "元宝:{$lingshi}";
    echo "  ";
    cmd::addcmd('e216', '充值');
    br();
    echo "金币:" . $money . "个<br>背包容量:" . $yiyongrongliang . "/{$beibaorongliang}";
    echo "  ";
    cmd::addcmd('beib_e55,1', '扩充');
    br();
    if ($mode != 1) {
        cmd::addcmd('e40,' . $from_list . ',1', '物品');
    } else {
        echo "物品";
    }
    echo "|";
    if ($mode != 4) {
        cmd::addcmd('e40,' . $from_list . ',4', '装备');
    } else {
        echo "装备";
    }
    echo "|";
    if ($mode != 2) {
        cmd::addcmd('e40,' . $from_list . ',2', '书籍');
    } else {
        echo "书籍";
    }
    echo "|";
    if ($mode != 3) {
        cmd::addcmd('e40,' . $from_list . ',3', '碎片');
    } else {
        echo "碎片";
    }
    echo "|";
    if ($mode != 5) {
        cmd::addcmd('e40,' . $from_list . ',5', '商场');
    } else {
        echo "商场";
    }
    echo "|";
    if ($mode != 6) {
        cmd::addcmd('e40,' . $from_list . ',6', '箱子');
    } else {
        echo "箱子";
    }
    echo "|";
    if ($mode != 7) {
        cmd::addcmd('e40,' . $from_list . ',7', '礼包');
    } else {
        echo "礼包";
    }
    br();
    $item_count = 0;
    $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
    $result = sql($sql);
    while (list($id, $count) = $result->fetch_row()) {
        if ($count) {
            $i_ok = true;
            $id = explode('.', $id);
            if ($mode == 1) {
                if (value::get_item_value($id[2], 'is_shuji') || value::get_item_value($id[2], 'is_huizhang') || value::get_item_value($id[2], 'is_sc') || value::get_item_value($id[2], 'is_bx') || value::get_item_value($id[2], 'is_lb')) {
                    $i_ok = false;
                }
            }
            if ($mode == 2) {
                if (!value::get_item_value($id[2], 'is_shuji')) {
                    $i_ok = false;
                }
            }
            if ($mode == 3) {
                if (!value::get_item_value($id[2], 'is_huizhang')) {
                    $i_ok = false;
                }
            }
            if ($mode == 4) {
                $i_ok = false;
            }
            if ($mode == 5) {
                if (!value::get_item_value($id[2], 'is_sc')) {
                    $i_ok = false;
                }
            }
            if ($mode == 6) {
                if (!value::get_item_value($id[2], 'is_bx')) {
                    $i_ok = false;
                }
            }
            if ($mode == 7) {
                if (!value::get_item_value($id[2], 'is_lb')) {
                    $i_ok = false;
                }
            }
            if ($i_ok) {
                array_push($item_id_array, $id[2]);
                array_push($item_count_array, $count);
                array_push($item_leixing_array, 0);
                $item_count++;
            }
        }
    }
    //获取道具
    $sql = "SELECT `id`,`prop_id`,`star1` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 ORDER BY LENGTH(`name`) ASC";
    $result = sql($sql);
    while (list($game_prop_id, $prop_zz_id, $star1) = $result->fetch_row()) {
        $p_ok = true;
        $prop_leixing = value::get_prop_value($prop_zz_id, 'leixing');
        if ($mode == 1) {
            if ($prop_leixing == 2 || $prop_leixing == 3) {
                $p_ok = false;
            }
        }
        if ($mode == 2) {
            $p_ok = false;
        }
        if ($mode == 3) {
            $p_ok = false;
        }
        if ($mode == 4) {
            if ($prop_leixing != 2 && $prop_leixing != 3) {
                $p_ok = false;
            }
        }
        if ($mode == 5) {
            $p_ok = false;
        }
        if ($mode == 6) {
            $p_ok = false;
        }
        if ($mode == 7) {
            $p_ok = false;
        }
        if ($p_ok) {
            array_push($item_id_array, $game_prop_id);
            array_push($item_count_array, 1);
            array_push($item_leixing_array, 1);
            $item_count++;
        }
    }
    //输出物品链接
    $max_count = $item_count < ($yeshu + 1) * $danye_count ? $item_count : ($yeshu + 1) * $danye_count;
    for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
        if (!$item_leixing_array[$i]) {
            $name = value::getvalue('item', 'name', 'id', $item_id_array[$i]);
            $liangci = value::getvalue('item', 'liangci', 'id', $item_id_array[$i]);
            $i1 = $i + 1;
            cmd::addcmd('e41,' . $item_id_array[$i] . ',' . $from_list . ',' . $yeshu, $i1 . "." . $name . "x" . $item_count_array[$i] . $liangci);
        } else {
            $prop_name = value::get_game_prop_value($item_id_array[$i], 'name');
            $prop_star = value::get_game_prop_value($item_id_array[$i], 'star');
            $star1 = value::get_game_prop_value($item_id_array[$i], 'star1');
            $prop_id = value::get_game_prop_value($item_id_array[$i], 'prop_id');
            $liangci = value::get_prop_value($prop_id, 'liangci');
            $leixing = value::get_prop_value($prop_id, 'leixing');
            $prop_pinzhi = prop::get_star_str($prop_star);
            if ($prop_pinzhi) {
                $prop_pinzhi = "($prop_pinzhi)";
            }
            if ($leixing == 1) {
                $prop_exp = value::get_game_prop_value($item_id_array[$i], 'exp');
                $prop_pinzhi = "($prop_exp)";
            }
            $i1 = $i + 1;
            cmd::addcmd('e98,' . $item_id_array[$i] . ',0,' . $yeshu, $i1 . "." . $prop_name . "x1" . $liangci);
        }
        br();
    }
    //输出空白提示
    if (!$item_count) {
        if ($mode == 1) {
            echo "你的身上什么物品也没有!";
            br();
        } else if ($mode == 2) {
            echo "你的身上什么书籍也没有!";
            br();
        } else if ($mode == 3) {
            echo "你的身上什么碎片也没有!";
            br();
        } else if ($mode == 4) {
            echo "你的身上什么装备也没有!";
            br();
        } else if ($mode == 5) {
            echo "你的身上什么商场也没有!";
            br();
        } else if ($mode == 6) {
            echo "你的身上什么箱子也没有!";
            br();
        } else if ($mode == 7) {
            echo "你的身上什么礼包也没有!";
            br();
        }
    }
    //上下页操作
    $fanye = false;
    $max_page_num = (int)(($item_count - 1) / $danye_count) + 1;
    if ($yeshu) {
        if ($yeshu > 1) {
            cmd::addcmd('e40,' . $from_list . ',' . $mode, '首页');
            echo "|";
        }
        cmd::addcmd('e40,' . $from_list . ',' . $mode . ',' . ($yeshu - 1), '上—页');
        $fanye = true;
    }
    if ($item_count > ($yeshu + 1) * $danye_count) {
        if ($yeshu) {
            echo "|";
        }
        cmd::addcmd('e40,' . $from_list . ',' . $mode . ',' . ($yeshu + 1), '下—页');
        if ($yeshu + 2 < $max_page_num) {
            echo "|";
            cmd::addcmd('e40,' . $from_list . ',' . $mode . ',' . ($max_page_num - 1), '末页');
        }
        $fanye = true;
    }
    //是否翻页换行
    if ($fanye) {
        br();
    }
    cmd::addcmd('zbybhs_e25', '装备回收');
    br();
    //输出返回系统
    if ($from_list == 1) {
        cmd::addcmd('e13', '返回上级');
    } else if ($from_list == 2) {
        cmd::addcmd('gd', '返回上级');
    } else {
        cmd::addcmd('e0', '返回上级');
    }
}

//背包 查看物品事件
function e41($itemid, $from_list = 0, $yeshu = 0)
{
    $name = value::getvalue('item', 'name', 'id', $itemid);
    $desc = value::getvalue('item', 'desc', 'id', $itemid);
    $liangci = value::getvalue('item', 'liangci', 'id', $itemid);
    $lingshi = value::getvalue('item', 'lingshi', 'id', $itemid);
    $fuzhong = value::getvalue('item', 'fuzhong', 'id', $itemid);
    $old_count = item::get_item($itemid);
    $is_map_use = value::getvalue('item', 'is_map_use', 'id', $itemid);
    $is_diuqi = value::getvalue('item', 'is_diuqi', 'id', $itemid);
    $is_xiaohui = value::getvalue('item', 'is_xiaohui', 'id', $itemid);
    $is_tp = value::getvalue('item', 'tp', 'id', $itemid);
    $is_zy = value::getvalue('item', 'zy', 'id', $itemid);
    $is_lx = value::getvalue('item', 'lx', 'id', $itemid);
    $is_lvl = value::getvalue('item', 'lvl', 'id', $itemid);
    $is_bd = value::getvalue('item', 'is_bd', 'id', $itemid);
    echo "{$name}x{$old_count}{$liangci}";
    br();
    if ($is_tp) {
        $wp_naijiu = "{$is_lx}";
        $wp_zl = "重量：{$fuzhong}";
        $wp_tp = "<img src=res/img/wp/{$is_tp} style='width: 80px;height: 80px;'>";
        echo "<style>td,th{text-align:center;font-size:16px;}</style><table  border='0'><tbody>
        <tr><td>{$wp_tp}</td><th>{$wp_zl}<br><br>{$wp_naijiu}</th></tr>
        </tbody></table>";
    }
    if ($desc) {
        echo $desc;
        br();
    }
    if (($is_bd && $lingshi > 0) || ($is_bd < 1 && $lingshi < 1)) {
        echo "<span style='color:green'>绑定：否</span>";
        br();
    } else {
        echo "<span style='color:red'>绑定：是</span>";
        br();
    }
    if ($is_lvl) {
        echo "<span style='color:green'>需要等级：{$is_lvl}</span>";
        br();
    }
    if ($is_zy) {
        echo "<span style='color:#D9B300'>适合职业：{$is_zy}</span>";
        br();
    }
    if ($is_map_use) {
        cmd::addcmd('e55,' . $itemid, '使用物品');
        br();
    }
    if ($is_diuqi && $lingshi < 1) {
        cmd::addcmd('e56,' . $itemid, '丢弃物品');
        br();
    }
    if ($is_xiaohui) {
        cmd::addcmd('e57,' . $itemid, '销毁物品');
        br();
    }
    cmd::addcmd('e40,' . $from_list . ',0,' . $yeshu, '返回上级');
}

function ck_e41($itemid)
{
    $name = value::getvalue('item', 'name', 'id', $itemid);
    $desc = value::getvalue('item', 'desc', 'id', $itemid);
    $liangci = value::getvalue('item', 'liangci', 'id', $itemid);
    $fuzhong = value::getvalue('item', 'fuzhong', 'id', $itemid);
    $old_count = item::get_item($itemid);
    $is_map_use = value::getvalue('item', 'is_map_use', 'id', $itemid);
    $is_diuqi = value::getvalue('item', 'is_diuqi', 'id', $itemid);
    $is_xiaohui = value::getvalue('item', 'is_xiaohui', 'id', $itemid);
    $is_tp = value::getvalue('item', 'tp', 'id', $itemid);
    $is_zy = value::getvalue('item', 'zy', 'id', $itemid);
    $is_lx = value::getvalue('item', 'lx', 'id', $itemid);
    $is_bd = value::getvalue('item', 'is_bd', 'id', $itemid);
    echo "{$name}";
    br();
    if ($is_tp) {
        $wp_naijiu = "{$is_lx}";
        $wp_zl = "重量：{$fuzhong}";
        $wp_tp = "<img src=res/img/wp/{$is_tp} style='width: 80px;height: 80px;'>";
        echo "<style>td,th{text-align:center;font-size:16px;}</style><table  border='0'><tbody>
        <tr><td>{$wp_tp}</td><th>{$wp_zl}<br><br>{$wp_naijiu}</th></tr>
        </tbody></table>";
    }
    if (($is_bd && $lingshi > 0) || ($is_bd < 1 && $lingshi < 1)) {
        echo "<span style='color:green'>绑定：否</span>";
        br();
    } else {
        echo "<span style='color:red'>绑定：是</span>";
        br();
    }
    if ($desc) {
        echo $desc;
        br();
    }
    if ($is_zy) {
        echo "<span style='color:#D9B300'>适合职业：{$is_zy}</span>";
        br();
    }
}
//系统 查看进化
function e42()
{
    cmd::addcmd("e42", "刷新宠物");
    br();
    $result = sql("SELECT `id` FROM `pet` WHERE `jh_id`!=0");
    $jh_pet_arr = array();
    while (list($id) = $result->fetch_row()) {
        array_push($jh_pet_arr, $id);
    }
    //输出结果
    $jh_pet_arr_count = count($jh_pet_arr);
    $end_echo_pet_arr = array();
    echo "可以进化的宠物:";
    br();
    for ($i = 0; $i < $jh_pet_arr_count; $i++) {
        if (!$end_echo_pet_arr[$jh_pet_arr[$i]]) {
            $result = sql("SELECT `name`,`shuxing`,`image` FROM `pet` WHERE `id`={$jh_pet_arr[$i]}");
            list($name, $shuxing, $img) = $result->fetch_row();
            if ($name) {
                pet::img($img, true, false);
                echo $name;
            }
            $t_p_id = $jh_pet_arr[$i];
            $end_echo_pet_arr[$t_p_id] = 1;
            while ($t_p_id = value::getvalue("pet", "jh_id", "id", $t_p_id)) {
                $result = sql("SELECT `name`,`shuxing`,`image` FROM `pet` WHERE `id`={$t_p_id}");
                list($name, $shuxing, $img) = $result->fetch_row();
                if ($name) {
                    pet::img($img, true, false);
                    echo $name;
                }
                $end_echo_pet_arr[$t_p_id] = 1;
            }
            br();
        }
    }
    //获取宠物id数组
    $result = sql("SELECT `id` FROM `pet` WHERE 1");
    $pet_arr = array();
    while (list($id) = $result->fetch_row()) {
        array_push($pet_arr, $id);
    }
    //获取可通过进化获得的宠物id数组
    $result = sql("SELECT `jh_id` FROM `pet` WHERE `jh_id`!=0");
    $jh_pet_arr = array();
    while (list($id) = $result->fetch_row()) {
        array_push($jh_pet_arr, $id);
    }
    //获取无法进化宠物id数组
    echo "无法进化的宠物:";
    br();
    $no_jh_pet_arr = array_diff($pet_arr, $jh_pet_arr);
    sort($no_jh_pet_arr);
    //输出结果
    $no_jh_pet_arr_count = count($no_jh_pet_arr);
    for ($i = 0; $i < $no_jh_pet_arr_count; $i++) {
        $result = sql("SELECT `name`,`shuxing`,`image` FROM `pet` WHERE `id`={$no_jh_pet_arr[$i]}");
        list($name, $shuxing, $img) = $result->fetch_row();
        if ($name) {
            pet::img($img, true, false);
            br();
            echo $name . "<br>属性:" . $shuxing;
            br();
        }
    }
    cmd::add_last_cmd("design_game");
}

//修行场 悬赏事件
function e43($mode, $yeshu = 0, $user_name = "", $o_user_id = 0)
{
    $user_id = uid();
    $uname = value::get_game_user_value('name', $user_id);
    $danye_count = 15;
    //提取在线玩家与数量
    $start_list_num = $yeshu * $danye_count;
    if (!$user_name) {
        $user_name = value::real_escape_string($_POST['qname']);
    }
    //显示悬赏
    if (!$mode) {
        cmd::addcmd('e43,1', '我要悬赏');
        $url = cmd::addcmd('e43', '搜索', false, true);
        echo <<<search_form
<form action="{$url}" method="post">
<input type="text" name="qname">
<input type="submit" value="搜索">
</form>
search_form;
        if (!$user_name) {
            $sql = "SELECT COUNT(*) FROM `game_user` WHERE `is_online`=1 AND `xuanshang`>0";
            $result = sql($sql);
            list($count) = $result->fetch_row();
            $sql = "SELECT `id`,`name`,`xuanshang` FROM `game_user` WHERE `is_online`=1 AND `xuanshang`>0 ORDER BY `user_id` ASC LIMIT {$start_list_num},{$danye_count} ";
        } else {
            $sql = "SELECT COUNT(*) FROM `game_user` WHERE `is_online`=1 AND `xuanshang`>0 AND `name` LIKE '%{$user_name}%'";
            $result = sql($sql);
            list($count) = $result->fetch_row();
            $sql = "SELECT `id`,`name`,`xuanshang` FROM `game_user` WHERE `is_online`=1 AND `xuanshang`>0 AND `name` LIKE '%{$user_name}%' ORDER BY `user_id` ASC LIMIT {$start_list_num},{$danye_count} ";
        }
        $result = sql($sql);
        $i = 0;
        while (list($oid, $oname, $xuanshang) = $result->fetch_row()) {
            if ($i) {
                br();
            }
            $i++;
            if ($oname) {
                cmd::addcmd('e12,' . $oid . ',10', $oname);
            } else {
                cmd::addcmd('e12,' . $oid . ',10', "无名氏");
            }
            echo "({$xuanshang}个金币) ";
            if ($oid == $user_id) {
                cmd::addcmd('e43,5', '撤销');
            } else {
                cmd::addcmd('e43,4,0,0,' . $oid, '打探');
                echo " ";
                cmd::addcmd('e43,6,0,0,' . $oid, '追加');
            }
        }
        if (!$count) {
            if ($user_name) {
                echo '没有找到你要找的玩家。';
                br();
            } else {
                echo '当前没有悬赏玩家在线。';
                br();
            }
            cmd::set_return_game_br(false);
        }
        //显示上下页
        $fanye_ok = false;
        $max_page_num = (int)(($count - 1) / $danye_count) + 1;
        if ($yeshu > 0) {
            if ($yeshu > 1) {
                cmd::addcmd('e43,' . $mode, '首页');
                echo "|";
            }
            cmd::addcmd('e43,' . $mode . ',' . ($yeshu - 1) . ',' . $user_name, '上—页');
            $fanye_ok = true;
        }
        if ($count > $danye_count * ($yeshu + 1)) {
            if ($fanye_ok) {
                echo '|';
            }
            cmd::addcmd('e43,' . $mode . ',' . ($yeshu + 1) . ',' . $user_name, '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e43,' . $mode . ',' . ($max_page_num - 1) . ',' . $user_name, '末页');
            }
        }
    } else if ($mode == 1) {
        //我要悬赏
        $danye_count = 15;
        //获取仇人数量
        $sql = "SELECT COUNT(*) FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.chouren'";
        $result = sql($sql);
        list($heiming_count) = $result->fetch_row();
        if (!$heiming_count) {
            echo "你还没有仇人。";
        } else {
            echo "仇人列表";
        }
        //开始获取仇人
        $i = 0;
        $sql = "SELECT `value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.chouren' LIMIT {$start_list_num},{$danye_count}";
        $result = sql($sql);
        while (list($oid) = $result->fetch_row()) {
            br();
            $i++;
            $oname = value::get_game_user_value('name', $oid);
            echo "{$oname} ";
            cmd::addcmd('e43,2,0,0,' . $oid, '悬赏');
        }
        //上下页操作
        $fanye = false;
        $max_page_num = (int)(($heiming_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            br();
            if ($yeshu > 1) {
                cmd::addcmd('e43,1', '首页');
                echo "|";
            }
            cmd::addcmd('e43,1,' . ($yeshu - 1), '上—页');
            $fanye = true;
        }
        if ($heiming_count > ($yeshu + 1) * $danye_count) {
            if (!$fanye) {
                br();
            }
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('e43,1,' . ($yeshu + 1), '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e43,1,' . ($max_page_num - 1), '末页');
            }
            $fanye = true;
        }
        //是否翻页换行
        br();
        cmd::addcmd('e43', '返回上级');
    } else if ($mode == 2) {
        //悬赏玩家
        $oname = value::get_game_user_value('name', $o_user_id);
        echo "你想要对{$oname}悬赏多少金币?";
        br();
        $url = cmd::addcmd('e43,3,0,0,' . $o_user_id, '悬赏', false, true);
        echo <<<xuanshang_form
<form action="{$url}" method="post">
<input type="text" name="money" value="10000">
<br>
<input type="submit" value="确认悬赏">
</form>
xuanshang_form;
        cmd::addcmd('e43,1', '返回上级');
    } else if ($mode == 3) {
        //正式悬赏
        $oname = value::get_game_user_value('name', $o_user_id);
        $ok = true;
        $error_miaoshu = "";
        $xuanshang_money = (int)value::real_escape_string($_POST['money']);
        if ($xuanshang_money < 10000) {
            $ok = false;
            $error_miaoshu = "悬赏金额不能低于10000金币,请你重新输入!";
            br();
        }
        if ($xuanshang_money > item::get_zhp_money($user_id)) {
            $ok = false;
            $error_miaoshu = "杂货铺里没有足够的金币了!";
            br();
        }
        //可以悬赏
        if ($ok) {
            value::add_user_value('zahuopu.money', -1 * $xuanshang_money);
            $zs_xuanshang_money = (int)($xuanshang_money * 0.9);
            echo "杂货铺里扣除了{$xuanshang_money}个金币<br>你悬赏了{$oname}{$zs_xuanshang_money}个金币";
            br();
            $xuanshang = value::add_game_user_value('xuanshang', $zs_xuanshang_money, $o_user_id);
            c_add_guangbo("{$uname}称打败{$oname}者可获得{$xuanshang}个金币!", $user_id);
            cmd::addcmd('e43', '返回上级');
        } else {
            echo $error_miaoshu;
            cmd::addcmd('e43,2,0,0,' . $o_user_id, '返回上级');
        }
    } else if ($mode == 4) {
        //打探
        $oname = value::get_game_user_value('name', $o_user_id);
        if (!$yeshu) {
            echo "你确定要花费100个金币打探{$oname}的行踪吗?";
            br();
            cmd::addcmd('e43,4,1,0,' . $o_user_id, '确认打探');
            br();
        } else {
            if (item::add_money(-100, $user_id)) {
                $is_online = value::get_game_user_value('is_online', $o_user_id);
                if ($is_online) {
                    $in_map_id = value::get_game_user_value('in_map_id', $o_user_id);
                    $in_map_name = value::get_map_value($in_map_id, 'name');
                    echo "根据可靠消息,{$oname}现在正在{$in_map_name}。";
                    br();
                } else {
                    echo "传奇之中仿佛丢失了{$oname}的消息。";
                    br();
                }
            }
        }
        cmd::addcmd('e43', '返回上级');
    } else if ($mode == 5) {
        //撤销
        $xuanshang = value::get_game_user_value('xuanshang', $user_id);
        $chexiao_money = $xuanshang * 2;
        if (!$yeshu) {
            echo "你确定要花费{$chexiao_money}个金币撤销悬赏吗?";
            br();
            cmd::addcmd('e43,5,1,0,' . $o_user_id, '确认撤销');
        } else {
            $ok = true;
            $error_miaoshu = "";
            if ($chexiao_money > item::get_zhp_money($user_id)) {
                $ok = false;
                $error_miaoshu = "杂货铺里没有足够的金币了!";
                br();
            }
            if ($ok) {
                value::add_user_value('zahuopu.money', -1 * $chexiao_money, $user_id);
                value::add_game_user_value('xuanshang', -1 * $xuanshang, $user_id);
                echo "杂货铺里扣除了{$chexiao_money}个金币<br>你成功花费{$chexiao_money}个金币撤销了悬赏。";
                br();
            } else {
                echo $error_miaoshu;
            }
        }
        cmd::addcmd('e43', '返回上级');
    } else if ($mode == 6) {
        //悬赏玩家
        $oname = value::get_game_user_value('name', $o_user_id);
        echo "你想要对{$oname}追加悬赏多少金币?";
        br();
        $url = cmd::addcmd('e43,7,0,0,' . $o_user_id, '追加悬赏', false, true);
        echo <<<xuanshang_form
<form action="{$url}" method="post">
<input type="text" name="money" value="10000">
<br>
<input type="submit" value="确认悬赏">
</form>
xuanshang_form;
        cmd::addcmd('e43', '返回上级');
    } else if ($mode == 7) {
        //正式追加悬赏
        $oname = value::get_game_user_value('name', $o_user_id);
        $ok = true;
        $error_miaoshu = "";
        $xuanshang_money = (int)value::real_escape_string($_POST['money']);
        if ($xuanshang_money < 10000) {
            $ok = false;
            $error_miaoshu = "悬赏金额不能低于10000金币,请你重新输入!";
            br();
        }
        if ($xuanshang_money > item::get_zhp_money($user_id)) {
            $ok = false;
            $error_miaoshu = "杂货铺里没有足够的金币了!";
            br();
        }
        //可以悬赏
        if ($ok) {
            value::add_user_value('zahuopu.money', -1 * $xuanshang_money);
            $zs_xuanshang_money = (int)($xuanshang_money * 0.9);
            echo "杂货铺里扣除了{$xuanshang_money}个金币<br>你悬赏了{$oname}{$zs_xuanshang_money}个金币";
            br();
            $xuanshang = value::add_game_user_value('xuanshang', $zs_xuanshang_money, $o_user_id);
            c_add_guangbo("{$uname}称打败{$oname}者可获得{$xuanshang}个金币!", $user_id);
            cmd::addcmd('e43', '返回上级');
        } else {
            echo $error_miaoshu;
            cmd::addcmd('e43,6,0,0,' . $o_user_id, '返回上级');
        }
    }
}

//显示传奇论坛模板事件
function e44($mode = 0, $yeshu = 0)
{
    $user_id = uid();
    echo "论坛";
    //获取版主
    echo "(版主:";
    $bbs_banzhu_count = 0;
    $sql = "SELECT `id`,`name`,`is_online` FROM `game_user` WHERE `is_bbs_banzhu` =1 LIMIT 5";
    $rs = sql($sql);
    while (list($bbs_banzhu_id, $bbs_banzhu_name, $bbs_banzhu_is_online) = $rs->fetch_row()) {
        if ($bbs_banzhu_count) {
            echo ",";
        }
        if ($bbs_banzhu_is_online) {
            cmd::addcmd("e12,{$bbs_banzhu_id},13", $bbs_banzhu_name);
        } else {
            echo $bbs_banzhu_name;
        }
        $bbs_banzhu_count++;
    }
    if (!$bbs_banzhu_count) {
        echo "无";
    }
    echo ")";
    br();
    cmd::addcmd("e159", "发新帖");
    echo "|";
    if ($mode != 1) {
        cmd::addcmd("e44,1", "精华区");
    } else {
        cmd::addcmd("e44", "全部区");
    }
    //跳转页数
    if ($_POST['page']) {
        $yeshu = (int)value::real_escape_string($_POST['page']) - 1;
    }
    //记录页数
    value::set_user_value('bbs.look.yeshu', $yeshu);
    //论坛帖子
    $danye_count = 5;
    $start_count = $danye_count * $yeshu;
    //所在版面
    $sql = "";
    $bbs_count = 0;
    $top_bbs_count = 0;
    if (!$mode) {
        //普通版面
        //置顶帖子
        if (!$yeshu) {
            $sql = "SELECT `id`,`name`,`content`,`post_by_id`,`reply_the_number`,`read_the_number`,`is_fine`,`is_lock` FROM `game_bbs` WHERE `is_main_bbs`=1 AND `is_sticky`=1 ORDER BY `last_reply_time` DESC LIMIT 3";
            $rs = sql($sql);
            while (list($bbs_id, $bbs_name, $bbs_content, $bbs_post_by_id, $bbs_reply_the_number, $bbs_read_the_number, $bbs_is_fine, $bbs_is_lock) = $rs->fetch_row()) {
                $top_bbs_count++;
                br();
                echo "<img src='res/img/system/bbs_sticky.png'>";
                if ($bbs_is_fine) {
                    echo "<img src='res/img/system/bbs_fine.png'>";
                }
                if ($bbs_is_lock) {
                    echo "<img src='res/img/system/bbs_lock.png'>";
                }
                cmd::addcmd("e157,{$bbs_id},{$mode}", " {$bbs_name}");
                br();
                $bbs_post_by_user_name = value::get_game_user_value("name", $bbs_post_by_id);
                $bbs_content_str_len = mb_strlen($bbs_content);
                echo "{$bbs_post_by_user_name},{$bbs_content_str_len}字/{$bbs_reply_the_number}回 {$bbs_read_the_number}阅";
            }
        }
        //普通帖子
        $sql = "SELECT `id`,`name`,`content`,`post_by_id`,`reply_the_number`,`read_the_number`,`is_fine`,`is_lock`,`is_sticky` FROM `game_bbs` WHERE `is_main_bbs`=1 AND `is_sticky`=0 ORDER BY `last_reply_time` DESC LIMIT $start_count,$danye_count";
    } else if ($mode == 1) {
        //精品版面
        $sql = "SELECT `id`,`name`,`content`,`post_by_id`,`reply_the_number`,`read_the_number`,`is_fine`,`is_lock`,`is_sticky` FROM `game_bbs` WHERE `is_main_bbs`=1 AND `is_fine`=1 ORDER BY `last_reply_time` DESC LIMIT $start_count,$danye_count";
    } else if ($mode == 2) {
        //我的帖子
        $sql = "SELECT `id`,`name`,`content`,`post_by_id`,`reply_the_number`,`read_the_number`,`is_fine`,`is_lock`,`is_sticky` FROM `game_bbs` WHERE `is_main_bbs`=1 AND `post_by_id`=$user_id ORDER BY `last_reply_time` DESC LIMIT $start_count,$danye_count";
    }
    //查询帖子
    $rs = sql($sql);
    while (list($bbs_id, $bbs_name, $bbs_content, $bbs_post_by_id, $bbs_reply_the_number, $bbs_read_the_number, $bbs_is_fine, $bbs_is_lock, $bbs_is_sticky) = $rs->fetch_row()) {
        $bbs_count++;
        br();
        if ($bbs_is_sticky) {
            echo "<img src='res/img/system/bbs_sticky.png'>";
        }
        if ($bbs_is_fine) {
            echo "<img src='res/img/system/bbs_fine.png'>";
        }
        if ($bbs_is_lock) {
            echo "<img src='res/img/system/bbs_lock.png'>";
        }
        cmd::addcmd("e157,{$bbs_id},{$mode}", ($start_count + $bbs_count) . ". {$bbs_name}");
        br();
        $bbs_post_by_user_name = value::get_game_user_value("name", $bbs_post_by_id);
        $bbs_content_str_len = mb_strlen($bbs_content);
        echo "{$bbs_post_by_user_name},{$bbs_content_str_len}字/{$bbs_reply_the_number}回 {$bbs_read_the_number}阅";
    }
    br();
    if (!$bbs_count && !$top_bbs_count) {
        echo "这里冷冷清清,还没有人发帖。";
        br();
    } else {
        //翻页系统
        $is_br = false;
        $sql = "";
        if (!$mode) {
            //普通版面
            $sql = "SELECT COUNT(*) FROM `game_bbs` WHERE `is_main_bbs`=1 AND `is_sticky`=0";
        } else if ($mode == 1) {
            //精品版面
            $sql = "SELECT COUNT(*) FROM `game_bbs` WHERE `is_main_bbs`=1 AND `is_fine`=1";
        } else if ($mode == 2) {
            //我的帖子
            $sql = "SELECT COUNT(*) FROM `game_bbs` WHERE `is_main_bbs`=1 AND `post_by_id`=$user_id";
        }
        $rs = sql($sql);
        list($main_bbs_count) = $rs->fetch_row();
        //当前所在页 帖子总页数
        $current_page = $yeshu + 1;
        $total_pages = (int)(($main_bbs_count - 1) / $danye_count) + 1;
        //上下页
        if ($current_page > 1) {
            $is_br = true;
            if ($yeshu > 1) {
                cmd::addcmd("e44,{$mode}", '首页');
                echo "|";
            }
            cmd::addcmd("e44,{$mode}," . ($yeshu - 1), "上—页");
        }
        if ($current_page < $total_pages) {
            if ($is_br) {
                echo "|";
            } else {
                $is_br = true;
            }
            cmd::addcmd("e44,{$mode}," . ($yeshu + 1), "下—页");
            if ($yeshu + 2 < $total_pages) {
                echo "|";
                cmd::addcmd("e44,{$mode}," . ($total_pages - 1), '末页');
            }
        }
        if (!$is_br) {
            echo "页数";
        }
        echo "($current_page/$total_pages)";
        br();
        $url = cmd::addcmd("e44,$mode", "跳转", false, true);
        echo <<<setpageform
<form action="{$url}" method="post">
<input type="text" name="page" placeholder="1-{$total_pages}" style="width: 32px">页
<button type="submit">跳转</button>
</form>
setpageform;
    }
    //我的帖子
    if ($mode != 2) {
        cmd::addcmd("e44,2", "我的帖子");
    } else {
        cmd::addcmd("e44", "全部帖子");
    }
    //返回游戏
}

//设置 桌面快捷设置
function e45($num, $event, $event_name)
{
    $user_id = uid();
    if (!$event) {
        echo "[快捷功能]";
        br();
        cmd::addcmd("e45,{$num},e40,物品", "随身物品");
        br();
        cmd::addcmd("e45,{$num},e51,好友", "好友列表");
        br();
        cmd::addcmd("e45,{$num},e105,师徒", "师徒关系");
        br();
        cmd::addcmd("e45,{$num},e106,帮派", "帮派相关");
        br();
        cmd::addcmd("e45,{$num},e107,组队", "组队相关");
        br();
        cmd::addcmd("e45,{$num},e76,宠物", "宠物相关");
        br();
        cmd::addcmd("e45,{$num},e108,任务", "任务列表");
        br();
        cmd::addcmd("e45,{$num},e47,排行", "传奇排行");
        br();
        cmd::addcmd("e45,{$num},e49,在线", "在线玩家");
        br();
        cmd::addcmd("e45,{$num},e73,开关", "开关设置");
        br();
        $kjfs_count = 0;
        echo "[快捷技能]";
        br();
        $u_pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($u_pet_arr as $pet_id) {
            $pet_name = value::get_pet_value($pet_id, 'name');
            for ($j = 166; $j < 175; $j++) {
                if ($j != 167) {
                    if (skill::pet_have_skill($pet_id, $j)) {
                        $kjfs_count++;
                        $skill_name = value::get_skill_value($j, 'name');
                        cmd::addcmd("e45,{$num},e83_{$pet_id}_3_{$j},$skill_name", $skill_name . "({$pet_name})");
                        br();
                    }
                }
            }
        }
        if (!$kjfs_count) {
            echo "宠物没有快捷技能。";
            br();
        }
    } else {
        if ($event != "clear") {
            value::set_user_value("kjgn.{$num}.event", str_replace("_", ",", $event));
            value::set_user_value("kjgn.{$num}.event_name", $event_name);
        } else {
            value::set_user_value("kjgn.{$num}.event", 0);
            value::set_user_value("kjgn.{$num}.event_name", 0);
        }
        e96();
        return;
    }
    cmd::addcmd('e96', '返回上级');
}

function map_hy($hy_xs_lvl = 0)
{
    $user_id = uid();
    if (!$hy_xs_lvl) {
        $hy_xs_lvl = value::get_user_value('hy_lvl', $user_id);
    }
    $hy_name = value::get_game_user_value('hy_name', $user_id);
    cmd::addcmd('e13', '状态');
    echo ">> 会员";
    br();
    echo "-";
    br();
    echo "您当前是尊贵的:";
    if ($hy_name) {
        echo $hy_name;
    } else {
        echo "无";
    }
    br();
    if ($hy_xs_lvl == 0) {
        $csnc = "普通昵称";
    }
    if ($hy_xs_lvl == 1) {
        $csnc = "<span style=color:red>红色昵称</span>";
    }
    if ($hy_xs_lvl == 2) {
        $csnc = "<span style=color:green>绿色昵称</span>";
    }
    if ($hy_xs_lvl == 3) {
        $csnc = "<span style=color:purple>紫色昵称</span>";
    }
    cmd::addcmd("e213", user::get('vip_login_guangbo') ? "1、上线提示" : "1、上线提示");
    br();
    echo "2、{$csnc}<br>";
    cmd::addcmd('hy_e209', '3、每日礼包');
    br();
    cmd::addcmd('map_hy1', '4、BOSS传送');
    br();
    cmd::addcmd('map_vip_zj', '5、会员之家');
    br();
    cmd::addcmd('map_vip_tz', '6、会员副本');
    br();
    echo "7、召唤宝宝额外数量+{$hy_xs_lvl}<br>";
    $hy_lvl_jc = $hy_xs_lvl * 10;
    echo "8、攻击,防御,魔攻加成 {$hy_lvl_jc}%<br>";
    echo "9、生命,魔法,魔防加成 {$hy_lvl_jc}%<br>";
    echo "10、死亡免掉装掉物(非PK)，原地复活<br>";
    $hy_lvl = value::get_user_value('hy_lvl');
    if ($hy_lvl > 0) {
        if ($hy_lvl == 1) {
            $shop_sale = 9;
        }
        if ($hy_lvl == 2) {
            $shop_sale = 8;
        }
        if ($hy_lvl == 3) {
            $shop_sale = 7;
        }
    }
    echo "11、元宝商场全部享受{$shop_sale}折特权<br>";
    echo "注：更多会员特权需自己探索<br>";
    echo "-";
    br();
    echo "介绍:";
    cmd::addcmd('map_hy,1', 'ST');
    echo " . ";
    cmd::addcmd('map_hy,2', '贵宾');
    echo " . ";
    cmd::addcmd('map_hy,3', '帝王');
}

function map_hy1()
{
    $user_id = uid();
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    cmd::addcmd('e13', '状态');
    echo ">> BOSS传送";
    br();
    echo "-";
    br();
    $i = 0;
    if ($hy_lvl) {
        $sql = "SELECT `id`,`name`,`yg_sx`,`yg_ys`,`yaoguai` FROM `map` WHERE `yg_sx`>0 ORDER BY `id`";
        $result = sql($sql);
        while (list($oid, $oname, $yg_sx, $yg_ys, $yaoguai) = $result->fetch_row()) {
            $i++;
            $name = value::getvalue('pet', 'name', 'id', $yaoguai);
            echo $i . "、" . $name . "：";
            echo "   ";
            cmd::addcmd('map_wj_id1,' . $oid, $oname);
            $now_time = time();
            $yg_time = (int)(($now_time - $yg_ys) / 60);
            $yg_time1 = (int)($yg_sx - $yg_time);
            if ($yg_time < $yg_sx) {
                echo "   ";
                echo "剩<span style='color:red'>{$yg_time1}</span>分钟";
            } else {
                echo "   ";
                echo "刷新";
            }
            br();
        }
        $min_120_del_time = date('Y-m-d H:i:s', strtotime('-120 minute'));
        $sql = "SELECT `id`,`name`,`map_id` FROM `game_pet` WHERE `cj_gw_time` > '$min_120_del_time' AND `master_id`=0 AND `enemy_user`=0 AND `star`>1 AND `npc_id`=0 AND `master_mode`!=8";
        $result = sql($sql);
        while (list($oid, $oname, $omap_id) = $result->fetch_row()) {
            $map_name = value::get_map_value($omap_id, 'name');
            $yg_sx = value::get_map_value($omap_id, 'yg_sx');
            if ($yg_sx < 1) {
                $i++;
                echo $i . "、" . $oname . "：位置";
                echo "  ";
                cmd::addcmd('map_wj_id1,' . $omap_id, $map_name);
                br();
            }
        }
    } else {
        echo "BOSS传送需要会员特权才能使用<br>";
    }
    echo "---<br>";
    echo "注：点击BOSS地图可以直接传送到当前BOSS位置";
}

function map_lb1($lb = 0)
{
    $i = 0;
    echo '【日充榜】 . ';
    cmd::addcmd('map_lb1,1', "奖励介绍");
    br();
    echo "-";
    br();
    if ($lb < 1) {
        $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.1.sc_money' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
        $result = sql($sql);
        while (list($oid, $ovalue) = $result->fetch_row()) {
            $i++;
            $phname = value::get_game_user_value('name', $oid);
            echo $i . '、';
            if (value::get_game_user_value('is_online', $oid)) {
                cmd::addcmd('e12,' . $oid . ',6', $phname);
            } else {
                cmd::addcmd('e12,' . $oid . ',6', $phname);
            }
            echo '（' . $ovalue . ')';
            echo "   ";
            cmd::addcmd('map_lb2,' . $oid . ',' . $i, "领奖");
            br();
        }
        if (!$i) {
            echo '暂时无人上榜！';
            br();
        }
    } else {
        echo "第一名:<span style=color:green>【强化石】</span>1~10各1个，<span style=color:green>【幸运石（高级）】</span>x8，<span style=color:orange>元宝</span>2000，<span style=color:green>权者为帝特权</span>ⅹ3，<span style=color:purple>苍穹之翼皮肤（未绑）</span>x2<br>

        第二名:<span style=color:green>【强化石】</span>1~8各1个，<span style=color:green>【幸运石（高级）】</span>x5，<span style=color:orange>元宝</span>1500，<span style=color:green>权者为帝特权</span>ⅹ2，<span style=color:purple>苍穹之翼皮肤（未绑）</span>x1<br>
        
        第三名:<span style=color:green>【强化石】</span>1~6各1个，<span style=color:green>【幸运石（高级）】</span>x3，<span style=color:orange>元宝</span>1000，<span style=color:green>权者为帝特权</span>ⅹ1，<span style=color:purple>苍穹之翼皮肤（未绑）</span>x1<br>
        
        第4~5名:<span style=color:green>【强化石】</span>1~5各1个，<span style=color:green>【幸运石（中级）】</span>x5，<span style=color:orange>元宝</span>500，<span style=color:red>风暴之翼皮肤（未绑）</span>x1<br>
        
        第6~10名:<span style=color:green>【强化石】</span>1~4各1个，<span style=color:green>【幸运石（中级）】</span>x3，<span style=color:orange>元宝</span>300，<span style=color:green>幻蓝羽翼皮肤（未绑）</span>x1";
        br();

    }
    echo "-";
    br();
    echo '提示:日充榜每日23:00结束统计,每天24:00重置！';
    br();
    cmd::add_last_cmd("map_lb");
}

function map_lb2($oid, $i)
{
    $user_id = uid();
    $gc_bx_jl = value::get_user_value('rc_lb_lq');
    $gc_d = date("d");
    $gc_h = date("H");
    if ($gc_h == 23) {
        if ($gc_bx_jl != $gc_d) {
            switch ($i) {
                case 1:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(189, 1);
                        item::add_item(190, 1);
                        item::add_item(191, 1);
                        item::add_item(192, 1);
                        item::add_item(193, 1);
                        item::add_item(194, 1);
                        item::add_item(197, 8);
                        item::add_item(1, 2000);
                        item::add_item(300, 3);
                        item::add_item(295, 2);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    }
                    break;
                case 2:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(189, 1);
                        item::add_item(190, 1);
                        item::add_item(191, 1);
                        item::add_item(192, 1);
                        item::add_item(197, 5);
                        item::add_item(1, 1500);
                        item::add_item(300, 2);
                        item::add_item(295, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break;  
                case 3:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(189, 1);
                        item::add_item(190, 1);
                        item::add_item(197, 3);
                        item::add_item(1, 1000);
                        item::add_item(300, 1);
                        item::add_item(295, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break;    
                case 4:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(189, 1);
                        item::add_item(196, 5);
                        item::add_item(1, 500);
                        item::add_item(294, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 5:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(189, 1);
                        item::add_item(196, 5);
                        item::add_item(1, 500);
                        item::add_item(294, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 6:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(196, 3);
                        item::add_item(1, 300);
                        item::add_item(293, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 7:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(196, 3);
                        item::add_item(1, 300);
                        item::add_item(293, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 8:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(196, 3);
                        item::add_item(1, 300);
                        item::add_item(293, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 9:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(196, 3);
                        item::add_item(1, 300);
                        item::add_item(293, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 10:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在日充活动领取第" . $i . "名奖励!");
                        echo "恭喜你领取了日充活动第" . $i . "名奖励!";
                        br();
                        item::add_item(185, 1);
                        item::add_item(186, 1);
                        item::add_item(187, 1);
                        item::add_item(188, 1);
                        item::add_item(196, 3);
                        item::add_item(1, 300);
                        item::add_item(293, 1);
                        value::set_user_value('rc_lb_lq', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要日充榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                default:
                    break;
            }
        } else {
            echo '你今天已经领取了日充奖励！';
        }
    } else {
        echo '领取日充奖励时间是23：00~ 23:59！';
    }
    br();
    cmd::add_last_cmd("map_lb1");
}

function map_lb($lb = 0)
{
    {
        $user_id = uid();
        cmd::addcmd('map_lb', '礼包');
        echo ">> 介绍";
        br();
        echo "-";
        br();
        if ($lb == 0) {
            cmd::addcmd('map_lb,10', '1、日常礼包');
            br();
            cmd::addcmd('map_lb1', '2、日冲礼包');
            br();
            cmd::addcmd('map_lb,7', '3、在线礼包');
            br();
            cmd::addcmd('map_lb,1', '4、等级礼包');
            br();
            cmd::addcmd('map_lb,2', '5、公测签到');
            br();
            cmd::addcmd('lc_e162', '6、累充礼包');
            br();
            cmd::addcmd('e162', '7、VIP礼包');
            br();
            cmd::addcmd('map_hy', '8、会员礼包');
            br();
            cmd::addcmd('map_lb,6', '9、首冲礼包');
            br();
        }
        if ($lb == 10) {
            cmd::addcmd('rqlb_e133', '进群礼包');
            br();
            cmd::addcmd('lb_e133', '推荐礼包');
            br();
            cmd::addcmd('lb_e133', '宣传礼包');
            br();
            cmd::addcmd('lb_e133', '反馈礼包');
            br();
            cmd::addcmd('e133', '充值礼包');
            br();
        }
        if ($lb == 7) {
            $lb_zx_fz_time = value::get_user_value('lb_zx_fz_time', $user_id);
            echo "当前在线<span style=color:red>{$lb_zx_fz_time}</span>分钟：";
            br();
            echo "-";
            br();
            if ($lb_zx_fz_time >= 5 && !value::get_user_value('lb_zx_fz_sz5')) {
                cmd::addcmd('lb_zx_fz_lb,5', '5分钟在线礼包');
            } else {
                echo "在线5分钟礼包";
            }
            br();
            if ($lb_zx_fz_time >= 10 && !value::get_user_value('lb_zx_fz_sz10')) {
                cmd::addcmd('lb_zx_fz_lb,10', '10分钟在线礼包');
            } else {
                echo "在线10分钟礼包";
            }
            br();
            if ($lb_zx_fz_time >= 30 && !value::get_user_value('lb_zx_fz_sz30')) {
                cmd::addcmd('lb_zx_fz_lb,30', '30分钟在线礼包');
            } else {
                echo "在线30分钟礼包";
            }
            br();
            if ($lb_zx_fz_time >= 60 && !value::get_user_value('lb_zx_fz_sz60')) {
                cmd::addcmd('lb_zx_fz_lb,60', '60分钟在线礼包');
            } else {
                echo "在线60分钟礼包";
            }
            br();
            if ($lb_zx_fz_time >= 90 && !value::get_user_value('lb_zx_fz_sz90')) {
                cmd::addcmd('lb_zx_fz_lb,90', '90分钟在线礼包');
            } else {
                echo "在线90分钟礼包";
            }
            br();
            if ($lb_zx_fz_time >= 120 && !value::get_user_value('lb_zx_fz_sz120')) {
                cmd::addcmd('lb_zx_fz_lb,120', '120分钟在线礼包');
            } else {
                echo "在线120分钟礼包";
            }
            br();
            echo "-";
            br();
            echo "提示：在线120分钟礼包可以领取<span style=color:purple>【会员卡】</span>";
            br();
        }
        if ($lb == 1) {
            $lvl = value::get_game_user_value('lvl', $user_id);
            echo "当前等级<span style=color:red>{$lvl}</span>级：";
            br();
            echo "-";
            br();
            if ($lvl >= 0 && !value::get_user_value('lb_lvl_sz1')) {
                cmd::addcmd('lb_lvl_lb,1', '1级礼包');
            } else {
                echo "1级礼包";
            }
            br();
            if ($lvl >= 10 && !value::get_user_value('lb_lvl_sz10')) {
                cmd::addcmd('lb_lvl_lb,10', '10级礼包');
            } else {
                echo "10级礼包";
            }
            br();
            if ($lvl >= 20 && !value::get_user_value('lb_lvl_sz20')) {
                cmd::addcmd('lb_lvl_lb,20', '20级礼包');
            } else {
                echo "20级礼包";
            }
            br();
            if ($lvl >= 30 && !value::get_user_value('lb_lvl_sz30')) {
                cmd::addcmd('lb_lvl_lb,30', '30级礼包');
            } else {
                echo "30级礼包";
            }
            br();
            if ($lvl >= 40 && !value::get_user_value('lb_lvl_sz40')) {
                cmd::addcmd('lb_lvl_lb,40', '40级礼包');
            } else {
                echo "40级礼包";
            }
            br();
            if ($lvl >= 50 && !value::get_user_value('lb_lvl_sz50')) {
                cmd::addcmd('lb_lvl_lb,50', '50级礼包');
            } else {
                echo "50级礼包";
            }
            br();
            if ($lvl >= 60 && !value::get_user_value('lb_lvl_sz60')) {
                cmd::addcmd('lb_lvl_lb,60', '60级礼包');
            } else {
                echo "60级礼包";
            }
            br();
            if ($lvl >= 70 && !value::get_user_value('lb_lvl_sz70')) {
                cmd::addcmd('lb_lvl_lb,70', '70级礼包');
            } else {
                echo "70级礼包";
            }
            br();
            if ($lvl >= 80 && !value::get_user_value('lb_lvl_sz80')) {
                cmd::addcmd('lb_lvl_lb,80', '80级礼包');
            } else {
                echo "80级礼包";
            }
            br();
        }
        if ($lb == 2) {
            $xqj = date("w");
            if ($xqj == 0) {
                $qd_xqj = "日";
            } else if ($xqj == 1) {
                $qd_xqj = "一";
            } else if ($xqj == 2) {
                $qd_xqj = "二";
            } else if ($xqj == 3) {
                $qd_xqj = "三";
            } else if ($xqj == 4) {
                $qd_xqj = "四";
            } else if ($xqj == 5) {
                $qd_xqj = "五";
            } else if ($xqj == 6) {
                $qd_xqj = "六";
            }
            echo "今天星期<span style=color:red>{$qd_xqj}</span>：";
            br();
            echo "-";
            br();
            echo "星期一：";
            if ($xqj == 1 && !value::get_user_value('lb_qd_sz1')) {
                cmd::addcmd('lb_qd_lb,1', '签到');
            } else {
                if (!value::get_user_value('lb_qd_sz1')) {
                    echo "未签";
                } else {
                    echo "已签";
                }
            }
            br();
            echo "星期二：";
            if ($xqj == 2 && !value::get_user_value('lb_qd_sz2')) {
                cmd::addcmd('lb_qd_lb,2', '签到');
            } else {
                if (!value::get_user_value('lb_qd_sz2')) {
                    echo "未签";
                } else {
                    echo "已签";
                }
            }
            br();
            echo "星期三：";
            if ($xqj == 3 && !value::get_user_value('lb_qd_sz3')) {
                cmd::addcmd('lb_qd_lb,3', '签到');
            } else {
                if (!value::get_user_value('lb_qd_sz3')) {
                    echo "未签";
                } else {
                    echo "已签";
                }
            }
            br();
            echo "星期四：";
            if ($xqj == 4 && !value::get_user_value('lb_qd_sz4')) {
                cmd::addcmd('lb_qd_lb,4', '签到');
            } else {
                if (!value::get_user_value('lb_qd_sz4')) {
                    echo "未签";
                } else {
                    echo "已签";
                }
            }
            br();
            echo "星期五：";
            if ($xqj == 5 && !value::get_user_value('lb_qd_sz5')) {
                cmd::addcmd('lb_qd_lb,5', '签到');
            } else {
                if (!value::get_user_value('lb_qd_sz5')) {
                    echo "未签";
                } else {
                    echo "已签";
                }
            }
            br();
            echo "星期六：";
            if ($xqj == 6 && !value::get_user_value('lb_qd_sz6')) {
                cmd::addcmd('lb_qd_lb,6', '签到');
            } else {
                if (!value::get_user_value('lb_qd_sz6')) {
                    echo "未签";
                } else {
                    echo "已签";
                }
            }
            br();
            echo "星期七：";
            if ($xqj == 0 && !value::get_user_value('lb_qd_sz0')) {
                cmd::addcmd('lb_qd_lb,0', '签到');
            } else {
                if (!value::get_user_value('lb_qd_sz0')) {
                    echo "未签";
                } else {
                    echo "已签";
                }
            }
            br();
            echo "-";
            br();
            echo "注：<span style=color:green>签到满七天额外获得签到大礼包！</span>";
            br();
        }
        if ($lb == 6) {
            $r_money = user::get("sc_money");
            $vip_libao_arr = config::getConfigByName("sc_libao");
            echo "你今日充值<span style=color:red>{$r_money}</span>元：";
            br();
            //VIP礼包物品1数组 物品2数组
            $vip_item_arr = $vip_libao_arr[6];
            echo "-";
            br();
            if (!user::get("sc6_last_month")) {
                for ($i = 6; $i <= 6; $i++) {
                    $t_m = $i;
                    $l_m = user::get("sc{$i}_last_month");
                    if ($t_m != $l_m) {
                        cmd::addcmd('sc_e209,' . $i, '首冲6元礼包领取');
                        br();
                    }
                }
                echo "首冲6元礼包礼包详情如下:";
                br();
                foreach ($vip_item_arr as $item_id => $item_count) {
                    echo value::get_item_value($item_id, "name"), "*", $item_count, value::get_item_value($item_id, "liangci");
                    $item_lingshi = value::get_item_value($item_id, "lingshi");
                    if (!$item_lingshi) {
                        echo "(无价之宝)";
                    } else {
                        echo "(", $item_lingshi * $item_count, "元宝)";
                    }
                    br();
                }
            }
            if (!user::get("sc56_last_month")) {
                for ($i = 56; $i <= 56; $i++) {
                    $t_m = $i;
                    $l_m = user::get("sc{$i}_last_month");
                    if ($t_m != $l_m) {
                        cmd::addcmd('sc_e209,' . $i, '首冲56元礼包领取');
                        br();
                    }
                }
                $vip_item_arr = $vip_libao_arr[56];
                echo "首冲56元礼包礼包详情如下:";
                br();
                foreach ($vip_item_arr as $item_id => $item_count) {
                    echo value::get_item_value($item_id, "name"), "*", $item_count, value::get_item_value($item_id, "liangci");
                    $item_lingshi = value::get_item_value($item_id, "lingshi");
                    if (!$item_lingshi) {
                        echo "(无价之宝)";
                    } else {
                        echo "(", $item_lingshi * $item_count, "元宝)";
                    }
                    br();
                }
            }
            if (!user::get("sc96_last_month")) {
                for ($i = 96; $i <= 96; $i++) {
                    $t_m = $i;
                    $l_m = user::get("sc{$i}_last_month");
                    if ($t_m != $l_m) {
                        cmd::addcmd('sc_e209,' . $i, '首冲96元礼包领取');
                        br();
                    }
                }
                $vip_item_arr = $vip_libao_arr[96];
                echo "首冲96元礼包礼包详情如下:";
                br();
                foreach ($vip_item_arr as $item_id => $item_count) {
                    echo value::get_item_value($item_id, "name"), "*", $item_count, value::get_item_value($item_id, "liangci");
                    $item_lingshi = value::get_item_value($item_id, "lingshi");
                    if (!$item_lingshi) {
                        echo "(无价之宝)";
                    } else {
                        echo "(", $item_lingshi * $item_count, "元宝)";
                    }
                    br();
                }
            }  
        }
        echo "-";
    }
}

function lb_zx_fz_lb($time = 0)
{
    $user_id = uid();
    echo "你领取了<span style=color:red>{$time}</span>分钟在线礼包！";
    br();
    if ($time == 5) {
        user::get_exp($user_id, 5000);
        item::add_money(100, $user_id);
        item::add_item(199, 5);
        value::set_user_value('lb_zx_fz_sz5', 1);
    } else if ($time == 10) {
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        item::add_item(199, 10);
        value::set_user_value('lb_zx_fz_sz10', 1);
    } else if ($time == 30) {
        user::get_exp($user_id, 50000);
        item::add_money(1000, $user_id);
        item::add_item(199, 30);
        value::set_user_value('lb_zx_fz_sz30', 1);
    } else if ($time == 60) {
        user::get_exp($user_id, 100000);
        item::add_money(1500, $user_id);
        item::add_item(199, 60);
        value::set_user_value('lb_zx_fz_sz60', 1);
    } else if ($time == 90) {
        user::get_exp($user_id, 500000);
        item::add_money(3000, $user_id);
        item::add_item(199, 90);
        value::set_user_value('lb_zx_fz_sz90', 1);
    } else if ($time == 120) {
        item::add_item(199, 120);
        user::get_exp($user_id, 1000000);
        item::add_money(5000, $user_id);
        item::add_item(283, 1);
        value::set_user_value('lb_zx_fz_sz120', 1);
    }
    $name = value::get_game_user_value('name', $user_id);
    c_add_guangbo("玩家{$name}领取了{$time}分钟在线礼包！");
    cmd::addcmd('map_lb,7', '返回在线礼包');
    cmd::set_show_return_game(false);
}

function lb_lvl_lb($time = 0)
{
    $user_id = uid();
    echo "你领取了<span style=color:red>{$time}</span>级等级礼包！";
    br();
    if ($time == 1) {
        user::get_exp($user_id, 1000);
        item::add_money(100, $user_id);
        item::add_item(201, 1);
        item::add_item(199, 10);
        value::set_user_value('lb_lvl_sz1', 1);
    } else if ($time == 10) {
        user::get_exp($user_id, 5000);
        item::add_money(500, $user_id);
        item::add_item(202, 1);
        item::add_item(199, 20);
        value::set_user_value('lb_lvl_sz10', 1);
    } else if ($time == 20) {
        user::get_exp($user_id, 10000);
        item::add_money(1000, $user_id);
        item::add_item(203, 1);
        item::add_item(199, 30);
        value::set_user_value('lb_lvl_sz20', 1);
    } else if ($time == 30) {
        user::get_exp($user_id, 50000);
        item::add_money(2000, $user_id);
        item::add_item(204, 1);
        item::add_item(199, 40);
        value::set_user_value('lb_lvl_sz30', 1);
    } else if ($time == 40) {
        user::get_exp($user_id, 100000);
        item::add_money(5000, $user_id);
        item::add_item(205, 1);
        item::add_item(199, 50);
        value::set_user_value('lb_lvl_sz40', 1);
    } else if ($time == 50) {
        user::get_exp($user_id, 500000);
        item::add_money(10000, $user_id);
        item::add_item(206, 1);
        item::add_item(199, 60);
        value::set_user_value('lb_lvl_sz50', 1);
    } else if ($time == 60) {
        user::get_exp($user_id, 1000000);
        item::add_money(20000, $user_id);
        item::add_item(207, 1);
        item::add_item(199, 70);
        value::set_user_value('lb_lvl_sz60', 1);
    } else if ($time == 70) {
        user::get_exp($user_id, 5000000);
        item::add_money(50000, $user_id);
        item::add_item(208, 1);
        item::add_item(199, 80);
        value::set_user_value('lb_lvl_sz70', 1);
    } else if ($time == 80) {
        user::get_exp($user_id, 10000000);
        item::add_money(100000, $user_id);
        item::add_item(209, 1);
        item::add_item(199, 100);
        value::set_user_value('lb_lvl_sz80', 1);
    }
    $name = value::get_game_user_value('name', $user_id);
    c_add_guangbo("玩家{$name}领取了{$time}级等级礼包！");
    cmd::addcmd('map_lb,1', '返回等级礼包');
    cmd::set_show_return_game(false);
}

function lb_qd_lb($time = 0)
{
    $user_id = uid();
    $xqj = $time;
    if ($xqj == 0) {
        $qd_xqj = "日";
    } elseif ($xqj == 1) {
        $qd_xqj = "一";
    } elseif ($xqj == 2) {
        $qd_xqj = "二";
    } elseif ($xqj == 3) {
        $qd_xqj = "三";
    } elseif ($xqj == 4) {
        $qd_xqj = "四";
    } elseif ($xqj == 5) {
        $qd_xqj = "五";
    } elseif ($xqj == 6) {
        $qd_xqj = "六";
    }
    echo "你领取了星期<span style=color:red>{$qd_xqj}</span>签到礼包！";
    br();
    if ($time == 1) {
        item::add_item(45, 30);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        value::set_user_value('lb_qd_sz1', 1);
    } else if ($time == 2) {
        item::add_item(73, 10);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        value::set_user_value('lb_qd_sz2', 1);
    } else if ($time == 3) {
        item::add_item(214, 2);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        value::set_user_value('lb_qd_sz3', 1);
    } else if ($time == 4) {
        item::add_item(280, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        value::set_user_value('lb_qd_sz4', 1);
    } else if ($time == 5) {
        item::add_item(279, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        value::set_user_value('lb_qd_sz5', 1);
    } else if ($time == 6) {
        item::add_item(296, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        value::set_user_value('lb_qd_sz6', 1);
    } else if ($time == 0) {
        item::add_item(405, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        value::set_user_value('lb_qd_sz0', 1);
    }
    if (value::get_user_value('lb_qd_sz0') && value::get_user_value('lb_qd_sz1') && value::get_user_value('lb_qd_sz2') && value::get_user_value('lb_qd_sz3') && value::get_user_value('lb_qd_sz4') && value::get_user_value('lb_qd_sz5') && value::get_user_value('lb_qd_sz6')) {
        item::add_item(45, 30);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        item::add_item(73, 10);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        item::add_item(214, 2);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        item::add_item(280, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        item::add_item(279, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        item::add_item(296, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
        item::add_item(405, 1);
        user::get_exp($user_id, 10000);
        item::add_money(500, $user_id);
    }
    $name = value::get_game_user_value('name', $user_id);
    c_add_guangbo("玩家{$name}领取了星期{$qd_xqj}签到礼包！");
    cmd::addcmd('map_lb,2', '返回签到礼包');
    cmd::set_show_return_game(false);
}

function map_jn($step, $s_id = 0, $ck_leixing = 1)
{
    cmd::addcmd('map_jn', "技能");
    echo ">> 我的技能";
    br();
    $userId = uid();
    $u = new game_user_object($userId);
    if (!$step) {
        echo "-";
        br();
        if ($ck_leixing != 1) {
            cmd::addcmd('map_jn,0,0,1', "普攻");
        } else {
            echo "普攻";
        }
        echo " · ";
        if ($ck_leixing != 2) {
            cmd::addcmd('map_jn,0,0,2', "魔攻");
        } else {
            echo "魔攻";
        }
        echo " · ";
        if ($ck_leixing != 3) {
            cmd::addcmd('map_jn,0,0,3', "防御");
        } else {
            echo "防御";
        }
        echo " · ";
        if ($ck_leixing != 4) {
            cmd::addcmd('map_jn,0,0,4', "辅助");
        } else {
            echo "辅助";
        }
        br();
        echo "-";
        br();
        $moren_skill_id = $u->get('skill_moren.id');
        $i = 0;
        $uSkillArr = $u->jget('skill.arr');
        // 确保uSkillArr是一个数组
        if (!is_array($uSkillArr)) {
            $uSkillArr = array();
        }
        // 检查并确保玩家拥有基础攻击技能(1)，这是必备技能
        if (!in_array(1, $uSkillArr)) {
            $u->jpush('skill.arr', NULL, 1);
            $uSkillArr = $u->jget('skill.arr');
            // 如果之前没有默认技能，设置基础攻击技能为默认技能
            if (!$moren_skill_id) {
                $u->set('skill_moren.id', 1);
                $moren_skill_id = 1;
            }
        }
        foreach ($uSkillArr as $skill_id) {
            $jn_lvl = value::get_user_value('skill.' . $skill_id . '.lvl', $userId);
            if (!$jn_lvl) {
                $jn_lvl_name = "初级";
            } else if ($jn_lvl == 1) {
                $jn_lvl_name = "中级";
            } else if ($jn_lvl == 2) {
                $jn_lvl_name = "高级";
            } else if ($jn_lvl == 3) {
                $jn_lvl_name = "专家";
            }
            if ($moren_skill_id == $skill_id) {
                echo "★";
            }
            // 获取技能类型
            $leixing = value::getvalue('skill', 'leixing', 'id', $skill_id);
            // 确保即使leixing为null或空，也能正常显示技能
            if ((!$leixing && $ck_leixing == 1) || $leixing == $ck_leixing) {
                $i1 = $i + 1;
                cmd::addcmd('map_jn,1,' . $skill_id, $i1 . ".({$jn_lvl_name})" . value::getvalue('skill', 'name', 'id', $skill_id));
                br();
            }
            $i++;
        }
        // 如果没有显示任何技能，添加提示信息
        if ($i == 0) {
            echo "暂无该类型的技能";
            br();
        }
        echo "-";
        cmd::add_last_cmd('e0');
        br();
        echo "-";
        return;
    } else if ($step == 1) {//查看技能
        echo "-";
        br();
        $jn_lvl = value::get_user_value('skill.' . $s_id . '.lvl', $userId);
        if (!$jn_lvl) {
            $jn_lvl_name = "初级";  
        } else if ($jn_lvl == 1) {
            $jn_lvl_name = "中级";
        } else if ($jn_lvl == 2) {
            $jn_lvl_name = "高级";
        } else if ($jn_lvl == 3) {
            $jn_lvl_name = "专家";
        }
        $jn_lvl = value::get_user_value('skill.' . $s_id . '.lvl', $userId);
        $jn_max_exp = $jn_lvl * 600 + 600;
        $jn_s_id = skill::get_skill_leixing($s_id);
        $jn_s_mz = value::getvalue('skill', 'mingzhong', 'id', $s_id);
        $jn_s_sld = "熟练度：(" . value::get_user_value('skill.' . $s_id . '.exp', $userId) . "/" .  $jn_max_exp . ")";
        $jn_wl = (int)($jn_lvl * (value::getvalue('skill', 'weili', 'id', $s_id) / 5) + value::getvalue('skill', 'weili', 'id', $s_id));
        echo value::getvalue('skill', 'name', 'id', $s_id);
        br();
        echo "<img src=res/img/jn/" . $s_id . ".png style='width: 80px;height: 80px;'>";
        br();
        echo "<style>td,th{text-align:center;font-size:20px;}</style><table  border='0'><tbody>
        <tr><td>等级:{$jn_lvl_name}</td><th>      类型:{$jn_s_id}</th></tr>
        </tbody></table>";
        echo "熟练度：[" . value::get_user_value('skill.' . $s_id . '.exp', $userId) . "/" .  $jn_max_exp . "]";
        br();
        echo "<span style=color:orange><style>td,th{text-align:center;font-size:20px;}</style><table  border='0'><tbody>
        <tr><td>威力：{$jn_wl}</td><th>      命中：{$jn_s_mz}</th></tr>
        </tbody></table></span>";
        echo "<span style=color:green>" . skill::get_skill_desc($s_id) . "</span>";
        br();
        $zhongji = value::get_skill_value($s_id, 'zhongji');
        if ($zhongji) {
            echo "<span style=color:red>暴击：" . value::get_skill_value($s_id, 'zhongji') . "%</span>";
            br();
        }
        $jn_lvl = value::get_user_value('skill.' . $s_id . '.lvl', $userId);
        if (!$jn_lvl) {
            $sld_id = 215;  
        } else if ($jn_lvl == 1) {
            $sld_id = 216;  
        } else if ($jn_lvl == 2) {
            $sld_id = 217;  
        } else if ($jn_lvl == 3) {
            $sld_id = 218;  
        }
        $sld_id1 = item::get_item($sld_id);
        if ($sld_id1) {
            $item_name = value::get_item_value($sld_id, 'name');
            cmd::addcmd('map_jn,5,' . $s_id, '使用' . $item_name);
            br();
        }
        if (value::get_skill_value($s_id, 'in_map_use')) {
            cmd::addcmd('map_jn,3,' . $s_id, '使用' . value::get_skill_value($s_id, 'name') . '技能');
            br();
        }
        if (value::get_skill_value($s_id, 'leixing') < 3) {
            cmd::addcmd('map_jn,2,' . $s_id, '设为默认');
            echo "   ";
            cmd::addcmd('map_jn,4,' . $s_id, '废除');
            br();
        }
    } else if ($step == 2) {//设置默认技能
        $u->set('skill_moren.id', $s_id);
        echo '你把[' . value::get_skill_value($s_id, 'name') . ']设置为默认技能。';
        br();
    } else if ($step == 3) {
        map_syjn($s_id, $userId);
    } else if ($step == 4) {//遗忘所学技能
        e10006($s_id, $userId);
    } else if ($step == 5) {//使用增加熟练度道具
        $jn_lvl = value::get_user_value('skill.' . $s_id . '.lvl', $userId);
        if (!$jn_lvl) {
            $sld_id = 215;  
        } else if ($jn_lvl == 1) {
            $sld_id = 216;  
        } else if ($jn_lvl == 2) {
            $sld_id = 217;  
        } else if ($jn_lvl == 3) {
            $sld_id = 218;  
        }
        item::add_item($sld_id, -1);
        $item_name = value::get_item_value($sld_id, 'name');
        $jn_name = value::get_skill_value($s_id, 'name');
        echo "你使用" . $item_name . "增加了" . $jn_name . "100点熟练度";
        br();
        value::add_user_value('skill.' . $s_id . '.exp', 100, $userId);
    }
    cmd::add_last_cmd('e0');
    br();
    echo "-";
}

function map_xx_jn()
{
    cmd::addcmd('e10005,1', '学习普攻');
    br();
    cmd::addcmd('e10005,2', '学习魔攻');
    br();
}

function bq_wk()
{
    $user_id = uid();
    $is_ct = equip::get_user_equip_jc('is_ct');
    $name = value::get_game_user_value('name', $user_id);
    $in_map_id = value::get_game_user_value('in_map_id', $user_id);
    $wk_sj = mt_rand(1, 100);
    if ($is_ct > 0) {
        pet::prop_mosun3($user_id, -1, 0);
        if ($wk_sj > 10) {
            //随机挖矿
            $sj = mt_rand(1, 2000);
            if ($sj <= 5) {
                $sji = 184;
            } else if ($sj <= 10) {
                $sji = 183;
            } else if ($sj <= 20) {
                $sji = 182;
            } else if ($sj <= 40) {
                $sji = 181;
            } else if ($sj <= 60) {
                $sji = 180;
            } else if ($sj <= 80) {
                $sji = 179;
            } else if ($sj <= 100) {
                $sji = 178;
            } else if ($sj <= 150) {
                $sji = 177;
            } else if ($sj <= 300) {
                $sji = 176;
            } else if ($sj <= 500) {
                $sji = 175;
            }
            if ($sj <= 500) {
                if ($sj < 60) {
                    $item_name = value::get_item_value($sji, 'name');
                    $in_map_id = value::get_game_user_value('in_map_id', $user_id);
                    $in_map_name = value::get_map_value($in_map_id, 'name');
                    c_add_guangbo('恭喜' . $name . '在' . $in_map_name . '挖矿获得了' . $item_name . '了!');
                }
                $item_name = value::get_item_value($sji, 'name');
                item::add_item($sji, 1);
                echo "恭喜你挖到了{$item_name}了!";
                br();
                echo "<img src='wk.gif' style='width: 125px;height: 125px;'>";
            } else {
                echo "很遗憾，什么都没有挖到!";
                br();
                echo "<img src='wk.gif' style='width: 125px;height: 125px;'>";
            }
        } else {
            pet::prop_mosun3($user_id, -1, 0);
            $sql = "SELECT `id`,`name` FROM `game_pet` WHERE `map_id` = {$in_map_id} AND `master_id`=0 AND `npc_id`=0 AND `master_mode`!=8 LIMIT 0 , 1";
            $result = sql($sql);
            while (list($oid, $oname) = $result->fetch_row()) {
                echo "你挖矿被{$oname}攻击提示:";
                br();
                echo "-";
                br();
                cmd::addcmd('e48,' . $oid, "攻击" . $oname);
                br();
                echo "-";
                br();
                cmd::addcmd('e48,' . $oid, "返回游戏");
            }
            cmd::set_show_return_game(false);
        }
    } else {
        echo "你没有装备鹤嘴锄，武器店都有卖的！";
    }
}

function map_zb()
{
    echo "[我的装备]";
    br();
    //强化
    cmd::addcmd("e200", "强化");
    echo ".  ";
    cmd::addcmd("e200_sx", "升星");
    echo ".  ";
    cmd::addcmd("e200_fm", "附魔");
    echo ".  ";
    cmd::addcmd("e200_kg", "开光");
    br();
    echo "-";
    br();
    $equip_subtype_arr = config::getConfigByName("equip_subtype");
    foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
        echo $equip_subtype, ':';
        $in_equip_id = equip::get_user_in_equip($equip_num, $user_id);
        $prop_name = equip::get($in_equip_id, 'name');
        $leixing = equip::get($in_equip_id, 'leixing');
        if ($prop_name && $in_equip_id > 0 && $leixing == 2) {
            $star1 = equip::get($in_equip_id, 'star1');
            $prop_name = equip::get($in_equip_id, 'name');
            $sx_lvl = equip::get($in_equip_id, 'sx_lvl');
            if ($sx_lvl) {
                echo "{$sx_lvl}星.";
            }
            cmd::addcmd("e10003,$in_equip_id", $prop_name);
            echo " ";
            $cDesc = "更换";
        } else {
            $cDesc = "选择";
        }
        cmd::addcmd("e10001,$equip_num", $cDesc);
        $leixing = equip::get($in_equip_id, 'leixing');
        if ($prop_name && $in_equip_id > 0 && $leixing == 2) {
            echo " ";
            cmd::addcmd('e10004,' . $in_equip_id, '卸下');
        }
        br();
    }
    map_tz_xg($user_id);
    $hp_jc = equip::get_user_equip_jc1('hp');
    $mp_jc = equip::get_user_equip_jc1('mp');
    $tegong_jc = equip::get_user_equip_jc1('tegong');
    $tefang_jc = equip::get_user_equip_jc1('tefang');
    $pugong_jc = equip::get_user_equip_jc1('pugong');
    $pufang_jc = equip::get_user_equip_jc1('pufang');
    $minjie_jc = equip::get_user_equip_jc1('minjie');
    $mb_jc = equip::get_user_equip_jc1('mb', $user_id);
    $km_jc = equip::get_user_equip_jc1('km', $user_id);
    $mz_jc = equip::get_user_equip_jc1('mz', $user_id);
    $xx_jc = equip::get_user_equip_jc1('xx', $user_id);
    $zd_jc = equip::get_user_equip_jc1('zd', $user_id);
    $kd_jc = equip::get_user_equip_jc1('kd', $user_id);
    $bj_jc = equip::get_user_equip_jc1('bj', $user_id);
    echo "<img src='br.jpg'>";
    echo "<style>td,th{text-align:center;font-size:14px;}</style><table  border='0'><tbody>
    <tr><td>生命+{$hp_jc}</td><th>魔法+{$mp_jc}</th><td>命中+{$mz_jc}</td><th>躲避+{$minjie_jc}</th><td>暴击+{$bj_jc}</td><th>吸血+{$xx_jc}</th><td>中毒+{$zd_jc}</td></tr>
    <tr><td>物攻+{$pugong_jc}</td><th>物防+{$pufang_jc}</th><td>魔攻+{$tegong_jc}</td><th>魔防+{$tefang_jc}</th><td>麻痹+{$mb_jc}</td><th>抗麻+{$km_jc}</th><td>免毒+{$kd_jc}</td></tr>
    </tbody></table>";
    echo "<img src='br.jpg'>";
}

function map_zb1()
{
    echo "[我的时装]";
    br();
    echo "-";
    br();
    $equip_subtype_arr = config::getConfigByName("equip_subtype");
    foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
        echo $equip_subtype, '时装:';
        $in_equip_id = equip::get_user_in_equip_sz($equip_num, $user_id);
        $prop_name = equip::get($in_equip_id, 'name');
        $leixing = equip::get($in_equip_id, 'leixing');
        if ($prop_name && $in_equip_id > 0  && $leixing == 3) {
            $star1 = equip::get($in_equip_id, 'star1');
            $prop_name = equip::get($in_equip_id, 'name');
            cmd::addcmd("e10003,$in_equip_id", $prop_name);
            echo " ";
            $cDesc = "更换";
        } else {
            $cDesc = "选择";
        }
        cmd::addcmd("e10001_sz,$equip_num", $cDesc);
        $leixing = equip::get($in_equip_id, 'leixing');
        if ($prop_name && $in_equip_id > 0 && $leixing == 3) {
            echo " ";
            cmd::addcmd('e10004_sz,' . $in_equip_id, '卸下');
        }
        br();
    }
    $hp_jc = equip::get_user_equip_jc2('hp');
    $mp_jc = equip::get_user_equip_jc2('mp');
    $tegong_jc = equip::get_user_equip_jc2('tegong');
    $tefang_jc = equip::get_user_equip_jc2('tefang');
    $pugong_jc = equip::get_user_equip_jc2('pugong');
    $pufang_jc = equip::get_user_equip_jc2('pufang');
    $minjie_jc = equip::get_user_equip_jc2('minjie');
    $mb_jc = equip::get_user_equip_jc2('mb', $user_id);
    $km_jc = equip::get_user_equip_jc2('km', $user_id);
    $mz_jc = equip::get_user_equip_jc2('mz', $user_id);
    $xx_jc = equip::get_user_equip_jc2('xx', $user_id);
    $zd_jc = equip::get_user_equip_jc2('zd', $user_id);
    $kd_jc = equip::get_user_equip_jc2('kd', $user_id);
    $bj_jc = equip::get_user_equip_jc2('bj', $user_id);
    echo "<img src='br.jpg'>";
    echo "<style>td,th{text-align:center;font-size:14px;}</style><table  border='0'><tbody>
    <tr><td>生命+{$hp_jc}</td><th>魔法+{$mp_jc}</th><td>命中+{$mz_jc}</td><th>躲避+{$minjie_jc}</th><td>暴击+{$bj_jc}</td><th>吸血+{$xx_jc}</th><td>中毒+{$zd_jc}</td></tr>
    <tr><td>物攻+{$pugong_jc}</td><th>物防+{$pufang_jc}</th><td>魔攻+{$tegong_jc}</td><th>魔防+{$tefang_jc}</th><td>麻痹+{$mb_jc}</td><th>抗麻+{$km_jc}</th><td>免毒+{$kd_jc}</td></tr>
    </tbody></table>";
    echo "<img src='br.jpg'>";
}

function map_cb1($lb = 0)
{
    $user_id = uid();
    if ($lb == 323) {
        $fm_sl = item::get_item(288);
        if ($fm_sl >= 10) {
            item::add_item(288, -10);
            $new_prop_id = prop::new_prop(323, 0, 0);
            prop::user_get_prop($new_prop_id, 0, 1, false, true);
            equip::user_get_equip_cb($new_prop_id, $user_id);
        } else {
            $item_name = value::get_item_value(288, 'name');
            echo "需要：" . $item_name . " * 10";
            br();
        }
    }
    if ($lb == 320) {
        $fm_sl1 = item::get_item(290);
        if ($fm_sl1 >= 1) {
            $fm_sl2 = 290;
        } else {
            $fm_sl2 = 293;
        }
        $fm_sl = item::get_item($fm_sl2);
        if ($fm_sl >= 1) {
            item::add_item($fm_sl2, -1);
            $new_prop_id = prop::new_prop(320, 0, 0);
            prop::user_get_prop($new_prop_id, 0, 1, false, true);
            equip::user_get_equip_cb($new_prop_id, $user_id);
        } else {
            $item_name = value::get_item_value(290, 'name');
            echo "需要：" . $item_name . " * 1";
            br();
        }
    }
    if ($lb == 321) {
        $fm_sl1 = item::get_item(291);
        if ($fm_sl1 >= 1) {
            $fm_sl2 = 291;
        } else {
            $fm_sl2 = 294;
        }
        $fm_sl = item::get_item($fm_sl2);
        if ($fm_sl >= 1) {
            item::add_item($fm_sl2, -1);
            $new_prop_id = prop::new_prop(321, 0, 0);
            prop::user_get_prop($new_prop_id, 0, 1, false, true);
            equip::user_get_equip_cb($new_prop_id, $user_id);
        } else {
            $item_name = value::get_item_value(291, 'name');
            echo "需要：" . $item_name . " * 1";
            br();
        }
    }
    if ($lb == 322) {
        $fm_sl1 = item::get_item(292);
        if ($fm_sl1 >= 1) {
            $fm_sl2 = 292;
        } else {
            $fm_sl2 = 295;
        }
        $fm_sl = item::get_item($fm_sl2);
        if ($fm_sl >= 1) {
            item::add_item($fm_sl2, -1);
            $new_prop_id = prop::new_prop(322, 0, 0);
            prop::user_get_prop($new_prop_id, 0, 1, false, true);
            equip::user_get_equip_cb($new_prop_id, $user_id);
        } else {
            $item_name = value::get_item_value(292, 'name');
            echo "需要：" . $item_name . " * 1";
            br();
        }
    }
    br();
    cmd::addcmd('map_cb', '返回上级');
}

function map_dh_cb($lb = 0, $lb1 = 0)
{
    $user_id = uid();
    $fm_sl = item::get_item($lb);
    if ($fm_sl > 0) {
        item::add_item($lb, -1 * $fm_sl);
        item::add_item($lb1, $fm_sl);
    } else {
        $item_name = value::get_item_value($lb, 'name');
        $item_name1 = value::get_item_value($lb1, 'name');
        echo "兑换" . $item_name1 . "需要" . $item_name . "！";
        br();
    }
    br();
    cmd::addcmd('map_cb', '返回上级');
}

function map_cb($lb = 0)
{
    echo "[我的翅膀]";
    echo " : ";
    cmd::addcmd('map_cb,1', '介绍');
    echo " . ";
    cmd::addcmd('map_cb_pf', '皮肤翅膀');
    br();
    echo "-";
    br();
    if ($lb == 1) {
        echo "翅膀 <br>
        神翼加身，飞升天外。翅膀系统可以给你的人物角色装上造型炫酷，华丽无比的翅膀，同时还能让你的角色实力飞速提升。同时大家可以通过翅膀强化系统对翅膀进行强化提升翅膀属性，进而提升角色战力<br>
        每阶分为10星<br>
        10星之后可以升至下一阶0星<br>
        升星消耗:羽毛<br>
        升阶消耗:羽翼精华";
        br();
        cmd::addcmd('map_cb', '返回上级');
    }
    if (!$lb) {
        echo "当前等级:";
        br();
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        $i = 322;
        foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
            if ($equip_num == 1) {
                $i++;
                $in_equip_id = equip::get_user_in_equip_cb($equip_num, $user_id);
                $prop_name = equip::get($in_equip_id, 'name');
                $leixing = equip::get($in_equip_id, 'leixing');
                if ($prop_name && $in_equip_id > 0 && $leixing == 4) {
                    $star1 = equip::get($in_equip_id, 'star1');
                    $prop_name = equip::get($in_equip_id, 'name');
                    cmd::addcmd("e10003,$in_equip_id", $prop_name);
                    echo "  ";
                    $sx_lvl = value::get_game_prop_value($in_equip_id, 'sx_lvl');
                    $sj_lvl = value::get_game_prop_value($in_equip_id, 'sj_lvl');
                    $sj_lvl1 = value::get_game_prop_value($in_equip_id, 'sj_lvl') * 10;
                    echo "{$sj_lvl}阶{$sx_lvl}星：";
                    echo "  ";
                    if ($sx_lvl < 10) {
                        cmd::addcmd("e200_cb_sx,1," . $in_equip_id . "," . value::get_game_prop_value($in_equip_id, 'prop_id'), "升星");
                    }
                    if (value::get_game_prop_value($in_equip_id, 'prop_id') == 323 && value::get_game_prop_value($in_equip_id, 'sx_lvl') == 10 && value::get_game_prop_value($in_equip_id, 'sj_lvl') < 15) {
                        echo " ";
                        cmd::addcmd("e200_cb_sx3,1," . $in_equip_id . "," . value::get_game_prop_value($in_equip_id, 'prop_id'), "升阶");
                    } 
                    br();
                    echo "ps升星成功:加攻击，加防御，加生命<br>
                    ps升阶成功:恝合度上升10% ";
                } else {
                    $cb_name = value::get_prop_value($i, 'name');
                    echo $cb_name;
                    echo "：";
                    cmd::addcmd('map_cb1,323', '激活');
                }
                br();
            }
        }
        $hp_jc = equip::get_user_equip_jc_cb('hp', $user_id);
        $mp_jc = equip::get_user_equip_jc_cb('mp', $user_id);
        $tegong_jc = equip::get_user_equip_jc_cb('tegong', $user_id);
        $tefang_jc = equip::get_user_equip_jc_cb('tefang', $user_id);
        $pugong_jc = equip::get_user_equip_jc_cb('pugong', $user_id);
        $pufang_jc = equip::get_user_equip_jc_cb('pufang', $user_id);
        $minjie_jc = equip::get_user_equip_jc_cb('minjie', $user_id);
        $mb_jc = equip::get_user_equip_jc_cb('mb', $user_id);
        $km_jc = equip::get_user_equip_jc_cb('km', $user_id);
        $mz_jc = equip::get_user_equip_jc_cb('mz', $user_id);
        $xx_jc = equip::get_user_equip_jc_cb('xx', $user_id);
        $zd_jc = equip::get_user_equip_jc_cb('zd', $user_id);
        $kd_jc = equip::get_user_equip_jc_cb('kd', $user_id);
        $bj_jc = equip::get_user_equip_jc_cb('bj', $user_id);
        echo "-";
        br();
        echo "当前羽翼加成:<br>
        当前羽翼恝合度{$sj_lvl1}%";
        br();
        echo "<style>td,th{text-align:center;font-size:14px;}</style><table  border='0'><tbody>
        <tr><td>生命+{$hp_jc}</td><td>魔法+{$mp_jc}</td><td>魔攻+{$tegong_jc}</td></tr>
        <tr><td>物攻+{$pugong_jc}</td><th>物防+{$pufang_jc}</th><th>魔防+{$tefang_jc}</th></tr>
        </tbody></table>";
        echo "-";
    }
}

function map_cb_pf($lb = 0)
{
    echo "[我的翅膀]";
    br();
    echo "-";
    br();
    if (!$lb) {
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        $i = 319;
        $sj_xs_lvl = 0;
        echo "皮肤：";
        br();
        foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
            if ($equip_num > 1 && $equip_num < 5) {
                $i++;
                $in_equip_id = equip::get_user_in_equip_cb($equip_num, $user_id);
                $prop_name = equip::get($in_equip_id, 'name');
                $leixing = equip::get($in_equip_id, 'leixing');
                if ($prop_name && $in_equip_id > 0  && $leixing == 4) {
                    $star1 = equip::get($in_equip_id, 'star1');
                    $prop_name = equip::get($in_equip_id, 'name');
                    cmd::addcmd("e10003,$in_equip_id", $prop_name);
                    echo "  ";
                    $sx_lvl = value::get_game_prop_value($in_equip_id, 'sx_lvl');
                    $sj_lvl = value::get_game_prop_value($in_equip_id, 'sj_lvl');
                    $sj_xs_lvl += $sx_lvl;
                    $sj_lvl1 = value::get_game_prop_value($in_equip_id, 'sj_lvl') * 10;
                    echo "{$sx_lvl}星：";
                    echo "  ";
                    if ($sx_lvl < 5) {
                        cmd::addcmd("e200_cb_sx1,1," . $in_equip_id . "," . value::get_game_prop_value($in_equip_id, 'prop_id'), "升星");
                    }
                } else {
                    $cb_name = value::get_prop_value($i, 'name');
                    echo $cb_name;
                    echo "：";
                    cmd::addcmd("map_cb1,{$i}", '激活');
                }
                br();
            }
        }
        $hp_jc = equip::get_user_equip_jc_cb1('hp');
        $mp_jc = equip::get_user_equip_jc_cb1('mp');
        $tegong_jc = equip::get_user_equip_jc_cb1('tegong');
        $tefang_jc = equip::get_user_equip_jc_cb1('tefang');
        $pugong_jc = equip::get_user_equip_jc_cb1('pugong');
        $pufang_jc = equip::get_user_equip_jc_cb1('pufang');
        $minjie_jc = equip::get_user_equip_jc_cb1('minjie');
        $mb_jc = equip::get_user_equip_jc_cb1('mb', $user_id);
        $km_jc = equip::get_user_equip_jc_cb1('km', $user_id);
        $mz_jc = equip::get_user_equip_jc_cb1('mz', $user_id);
        $xx_jc = equip::get_user_equip_jc_cb1('xx', $user_id);
        $zd_jc = equip::get_user_equip_jc_cb1('zd', $user_id);
        $kd_jc = equip::get_user_equip_jc_cb1('kd', $user_id);
        $bj_jc = equip::get_user_equip_jc_cb1('bj', $user_id);
        echo "-";
        br();
        $item_name = value::get_item_value(293, 'name');
        echo $item_name . " :兑换" . value::get_item_value(290, 'name');
        echo "  ";
        cmd::addcmd("map_dh_cb,293,290", '兑换');
        br();
        $item_name = value::get_item_value(294, 'name');
        echo $item_name . " :兑换" . value::get_item_value(291, 'name');
        echo "  ";
        cmd::addcmd("map_dh_cb,294,291", '兑换');
        br();
        $item_name = value::get_item_value(295, 'name');
        echo $item_name . " :兑换" . value::get_item_value(292, 'name');
        echo "  ";
        cmd::addcmd("map_dh_cb,295,292", '兑换');
        br();
        echo "-";
        br();
        echo "皮肤升星加成{$sj_xs_lvl}%:";
        br();
        echo "<style>td,th{text-align:center;font-size:14px;}</style><table  border='0'><tbody>
        <tr><td>生命+{$hp_jc}</td><td>魔法+{$mp_jc}</td><td>魔攻+{$tegong_jc}</td></tr>
        <tr><td>物攻+{$pugong_jc}</td><th>物防+{$pufang_jc}</th><th>魔防+{$tefang_jc}</th></tr>
        </tbody></table>";
        echo "-";
        br();
        cmd::addcmd('map_cb', '返回翅膀');
    }
}

function map_cs($qb = 0)
{
    $user_id = uid();
    echo "[地图传送]";
    br();
    echo "安全区：";
    br();
    cmd::addcmd('map_cs_id1,1', '银杏');
    echo " . ";
    cmd::addcmd('map_cs_id1,583', '盟重');
    echo " . ";
    cmd::addcmd('map_cs_id1,122', '比奇');
    echo " . ";
    cmd::addcmd('map_cs_id1,1044', '道馆');
    echo " . ";
    cmd::addcmd('map_cs_id1,1927', '沙巴克');
    br();
    echo "-";
    br();
    echo "危险区：";
    br();
    cmd::addcmd('map_cs_id1,24', '银杏山谷野外');
    echo "   ";
    echo "(等级 1 ` 10 )";
    br();
    cmd::addcmd('map_cs_id1,44', '银杏废矿');
    echo "   ";
    echo "(等级 10 ` 20 )";
    br();
    cmd::addcmd('map_cs_id1,148', '比奇北郊外');
    echo "   ";
    echo "(等级 1 ` 10 )";
    br();
    cmd::addcmd('map_cs_id1,189', '比奇南郊外');
    echo "   ";
    echo "(等级 10 ` 15 )";
    br();
    cmd::addcmd('map_cs_id1,221', '半兽洞穴');
    echo "   ";
    echo "(等级 20 ` 25 )";
    br();
    cmd::addcmd('map_cs_id1,275', '废矿矿山入口');
    echo "   ";
    echo "(等级 20 ` 30 )";
    br();
    cmd::addcmd('map_cs_id1,602', '盟重南郊外');
    echo "   ";
    echo "(等级 10 ` 15 )";
    br();
    cmd::addcmd('map_cs_id1,656', '盟重北郊外');
    echo "   ";
    echo "(等级 10 ` 15 )";
    br();
    cmd::addcmd('map_cs_id1,718', '石阁庙（野外）');
    echo "   ";
    echo "(等级 15 ` 20 )";
    br();
    cmd::addcmd('map_cs_id1,745', '石阁庙');
    echo "   ";
    echo "(等级 30 ` 40 )";
    br();
    cmd::addcmd('map_cs_id1,1061', '道馆郊外');
    echo "   ";
    echo "(等级 5 ` 10 )";
    br();
    cmd::addcmd('map_cs_id1,1137', '沃玛神殿入口');
    echo "   ";
    echo "(等级 20 ` 25 )";
    br();
    cmd::addcmd('map_cs_id1,1158', '沃玛神殿');
    echo "   ";
    echo "(等级 20 ` 30 )";
    br();
    cmd::addcmd('map_cs_id1,1351', '祖玛神殿（野外）');
    echo "   ";
    echo "(等级 15 ` 20 )";
    br();
    cmd::addcmd('map_cs_id1,1435', '祖玛神殿');
    echo "   ";
    echo "(等级 30 ` 40 )";
    br();
    cmd::addcmd('map_cs_id1,1960', '灌木林');
    echo "   ";
    echo "(等级 35 ` 40 )";
    br();
    cmd::addcmd('map_cs_id1,2020', '赤月山谷');
    echo "   ";
    echo "(等级 40 ` 50 )";
    br();
    cmd::addcmd('map_cs_id1,2635', '魔龙郊外入口');
    echo "   ";
    echo "(等级 60 ` 65 )";
    br();
    cmd::addcmd('map_cs_id1,3546', '蚂蚁洞穴');
    echo "   ";
    echo "(等级 30 ` 40 )~爆<span style=color:red>虹魔系列</span>";
    br();
    cmd::addcmd('map_cs_id1,3740', '潘夜岛');
    echo "   ";
    echo "(等级 40 ` 50 )~爆<span style=color:red>魔血系列</span>";
    br();
    cmd::addcmd('map_cs_id1,3934', '铗虫谷');
    echo "   ";
    echo "(等级 50 ` 60 )~爆<span style=color:red>神秘系列</span>";
    br();
    cmd::addcmd('map_cs_id1,4155', '万年谷');
    echo "   ";
    echo "(等级 60 ` 70 )~爆<span style=color:red>天地合一系列</span>";
    br();
    echo "-";
}

function map_cs1($qb = 0)
{
    $user_id = uid();
    $vip_lvl = user::getVipLvl($user_id);
    if ($vip_lvl > 0) {
        echo "[地图传送]";
        br();
        $i113 = item::get_item(113, $user_id);
        if ($i113 > 0) {
            if ($qb == 0) {
                echo "银杏";
            } else {
                cmd::addcmd('map_cs,0', '银杏');
            }
            echo " . ";
            if ($qb == 1) {
                echo "比奇";
            } else {
                cmd::addcmd('map_cs,1', '比奇');
            }
            echo " . ";
            if ($qb == 3) {
                echo "蛇谷";
            } else {
                cmd::addcmd('map_cs,3', '蛇谷');
            }
            echo " . ";
            if ($qb == 2) {
                echo "盟重";
            } else {
                cmd::addcmd('map_cs,2', '盟重');
            }
            echo " . ";
            if ($qb == 4) {
                echo "绿洲";
            } else {
                cmd::addcmd('map_cs,4', '绿洲');
            }
            echo " . ";
            if ($qb == 6) {
                echo "道馆";
            } else {
                cmd::addcmd('map_cs,6', '道馆');
            }
            br();
            if ($qb == 5) {
                echo "沙巴克";
            } else {
                cmd::addcmd('map_cs,5', '沙巴克');
            }
            br();
            echo "-";
            br();
            if ($qb == 0) {
                echo "安全区：";
                br();
                cmd::addcmd('map_cs_id1,1', '银杏');
                br();
                echo "危险区：";
                br();
                cmd::addcmd('map_cs_id1,24', '银杏山谷野外');
                br();
                cmd::addcmd('map_cs_id1,44', '银杏废矿');
                br();
            }
            if ($qb == 2) {
                echo "安全区：";
                br();
                cmd::addcmd('map_cs_id1,583', '盟重');
                br();
                echo "危险区：";
                br();
                cmd::addcmd('map_cs_id1,602', '盟重南郊外');
                br();
                cmd::addcmd('map_cs_id1,656', '盟重北郊外');
                br();
                cmd::addcmd('map_cs_id1,718', '石阁庙（野外）');
                br();
            }
            if ($qb == 1) {
                echo "安全区：";
                br();
                cmd::addcmd('map_cs_id1,122', '比奇');
                br();
                echo "危险区：";
                br();
                cmd::addcmd('map_cs_id1,148', '比奇北郊外');
                br();
                cmd::addcmd('map_cs_id1,189', '比奇南郊外');
                br();
                cmd::addcmd('map_cs_id1,221', '半兽洞穴');
                br();
                cmd::addcmd('map_cs_id1,275', '废矿矿山');
                br();
            }
            if ($qb == 6) {
                echo "安全区：";
                br();
                cmd::addcmd('map_cs_id1,1044', '道馆');
                br();
                echo "危险区：";
                br();
                cmd::addcmd('map_cs_id1,1061', '道馆郊外');
                br();
                cmd::addcmd('map_cs_id1,1137', '沃玛神殿入口');
                br();
            }
            if ($qb == 5) {
                echo "安全区：";
                br();
                cmd::addcmd('map_cs_id1,1927', '沙巴克');
                br();
                echo "危险区：";
                br();
                cmd::addcmd('map_cs_id1,1431', '祖玛神殿（野外）');
                br();
            }
            echo "-";
        } else {
            echo "传送功能需要<span style=color:red>【传送卷】</span>才能使用!";
            br();
        }
    } else {
        echo "传送功能需要VIP玩家才能使用!";
    }
}

function map_cs_id1($map_cs_id = 0)
{
    $user_id = uid();
    if ($map_cs_id) {
        $bx_map_name = value::get_map_value($map_cs_id, 'name', $user_id);
        value::set_game_user_value('in_map_id', $map_cs_id);
        echo "你已经进入{$bx_map_name}地图!<br><img src='cs.gif' style='width: 100px;height: 100px;'><br>";
        return;
    }
}

function map_wj_id($map_cs_id = 0)
{
    $user_id = uid();
    $i113 = item::get_item(113, $user_id);
    $item_name = value::get_item_value(113, 'name');
    if ($i113) {
        if ($map_cs_id && !value::get_map_value($map_cs_id, 'ts_map', $user_id)) {
            item::add_item(113, -1);
            $bx_map_name = value::get_map_value($map_cs_id, 'name', $user_id);
            value::set_game_user_value('in_map_id', $map_cs_id);
            echo "你已经进入{$bx_map_name}地图!<br><img src='cs.gif' style='width: 100px;height: 100px;'><br>";
            return;
        } else {
            $bx_map_name = value::get_map_value($map_cs_id, 'name', $user_id);
            echo "{$bx_map_name}特殊地图无法传送!";
        }
    } else {
        echo "你没有{$item_name}无法传送!";
    }
}
//攻城红包
function map_gc_hb($m_area_id)
{   
    $user_id = uid();
    $map_gcgw_hb_cs = value::get_system_value('gcgw_hb_cs');
    $map_gcgw_hb_je = value::get_system_value('gcgw_hb_je');
    $map_gcgw_id = value::get_system_value('map_gcgw_id');
    $map_gcgw_cs = value::get_user_value('map_gcgw_cs', $user_id);
    if ($map_gcgw_cs != $map_gcgw_id) {
        if ($map_gcgw_hb_cs > 0) {
            item::add_item(1, $map_gcgw_hb_je);
        } else {
            echo "这波25个红包已抢完了，等下一波再抢红包!";
        }
        $map_gcgw_hb_cs1 = $map_gcgw_hb_cs - 1;
        value::set_system_value('gcgw_hb_cs', $map_gcgw_hb_cs1);
        value::set_user_value('map_gcgw_cs', $map_gcgw_id, $user_id);
    } else {
        echo "你已经抢过这波红包，等下一波再抢红包!";
    }
}

//公测红包
function map_gc_hb2($m_area_id)
{   
    $user_id = uid();
    $map_gc_hb_cs = value::get_system_value('gc_hb_cs');
    $map_gc_hb_zg_je = value::get_system_value('gc_hb_zg_je');
    $map_gc_hb_zg_je1 = $map_gc_hb_zg_je / $map_gc_hb_cs;
    $map_gc_hb_zg_je2 = mt_rand(1, $map_gc_hb_zg_je1);
    $map_gc_cs = value::get_user_value('map_gc_hb_cs', $user_id);
    $hb_d = date("d");
    echo "公测活动一<br>
    元宝红包天天送，公测期间每天在线120分钟可领取元宝红包一份，数量有限，先到先得!<br>";
    $lb_zx_fz_time = value::get_user_value('lb_zx_fz_time', $user_id);
    echo "当前在线<span style=color:red>{$lb_zx_fz_time}</span>分钟：";
    br();
    echo "元宝总数{$map_gc_hb_zg_je}，共{$map_gc_hb_cs}份";
    br();
    $map_gc_hb_cs = value::get_system_value('gc_hb_cs') - 1;
    if ($lb_zx_fz_time >= 120) {
        $hb_time_h = date("H");
        if ($hb_time_h > 8) {
            if ($map_gc_cs != $hb_d && $map_gc_hb_cs > 0) {
                $map_gc_hb_zg_je3 = $map_gc_hb_zg_je - $map_gc_hb_zg_je2;
                value::set_system_value('gc_hb_zg_je', $map_gc_hb_zg_je3);
                item::add_item(1, $map_gc_hb_zg_je2);
                value::set_user_value('map_gc_hb_cs', $hb_d);
                value::set_system_value('gc_hb_cs', $map_gc_hb_cs);
                $name = value::get_game_user_value('name', $user_id);
                c_add_guangbo("恭喜玩家{$name}，在公测抢红包抢了{$map_gc_hb_zg_je2}元宝，还剩余{$map_gc_hb_cs}个!");
            } else {
                echo "你已经抢过这波红包，等明天再抢红包!";
            }
        } else {
            echo "你无法抢这波红包，等9点以后开抢!";
        }
    } else {
        echo "你无法这波红包，等在线时间120分钟再抢!";
    }
}

function map_gc_hb3($m_area_id)
{   
    $user_id = uid();
    $map_gc_hb_cs = value::get_system_value('gc_hb_cs');
    $map_gc_hb_zg_je = value::get_system_value('gc_hb_zg_je');
    echo "公测活动一<br>
    元宝红包天天送，公测期间每天在线120分钟可领取元宝红包一份，数量有限，先到先得!<br>";
    $lb_zx_fz_time = value::get_user_value('lb_zx_fz_time', $user_id);
    echo "当前在线<span style=color:red>{$lb_zx_fz_time}</span>分钟：";
    br();
    echo "元宝总数{$map_gc_hb_zg_je}，共{$map_gc_hb_cs}份";
    br();
    if ($map_gc_hb_cs > 0) {
        cmd::addcmd('map_gc_hb2', '抢元宝红包');
        br();
    }
}

function map_gc_hb_boss($m_area_id)
{   
    $user_id = uid();
    $map_gc_hb_cs = value::get_system_value('gc_hb_cs');
    $map_gc_hb_zg_je = value::get_system_value('gc_hb_zg_je');
    echo "公测活动五
公测超级福利boss来袭，<br>
活动期间:每天中午12:00会刷新出4只公测圣兽，1只公测神兽<br>
击杀后会100%掉落大量公测限定属性丹、极品道具、极品装备、极品皮肤<br>";
    echo "-";
    br();
    $i = 0;
    $sql = "SELECT `id`,`pet_id`,`map_id` FROM `game_pet` WHERE `pet_id`=221 OR `pet_id`=222 ";
    $rs = sql($sql);
    while (list($id, $pet_id, $map_id) = $rs->fetch_row()) {
        $i++;
        $map_name = value::get_map_value($map_id, 'name');
        $name = value::getvalue('pet', 'name', 'id', $pet_id);
        echo $i . "、" . $name . "在地图：";
        cmd::addcmd('map_wj_id1,' . $map_id, $map_name);
        br();
    } 
    if (!$i) {
        echo "BOSS位置：暂时还没有刷新！";
    }
    br();
    echo "-";
}

function map_gc_hb4($m_area_id)
{   
    $user_id = uid();
    echo "公测活动二<br>
    双倍经验助你快速升级!<br>
    每天<br>
    中午12:00~13:00<br>
    晚上22:00~23:00<br>";
}

function map_gc_hb_hd6($m_area_id)
{   
    $user_id = uid();
    echo "公测活动六→王府/皇城<br>
    活动期间累计充值达到一定金额<br>
    可联系管理给玩家建设一座，王府/皇城<br>
    王府/皇城，不仅能给自身提供大量特权，还可以给全服玩家提供大量福利<br>
    Ps:进入王府/皇城，需要王/皇同意才可进入<br>";
}

function map_gc_hb_hd7($m_area_id)
{   
    $user_id = uid();
    echo "活动七→累充送好礼<br>
    活动期间累计充值到一定金额，可以获取大量累充奖励，详情:礼包→累充礼包<br>";
    cmd::addcmd('lc_e162', '累充礼包');
}

function map_gc_hb_hd8($m_area_id)
{   
    $user_id = uid();
    echo "活动八→战力排行榜<br>
    战力排行榜截止日期5月26日24:00<br>
    Ps:排行榜活动称号为特殊属性，特殊称号的属性称号可以与其它称号叠加<br>
    -----------------------<br>
    第1名:任选安全城中心神像一座、元宝15000、自定义名称称号ⅹ1、装备改名符ⅹ3<br>
    第2~3名:安全城中心神像一座、元宝10000、公测大神特属称号ⅹ1、装备改名符ⅹ1<br>
    第4~5名:元宝x5000，公测使者特属称号<br>
    第6~10名:元宝x2000<br>";
}

function map_gc_hb1($lb = 0, $id = 0, $sl = 0)
{   $user_id = uid();
    $gwgc_jifen = value::get_user_value('gwgc_jifen', $user_id);
    if ($lb > 0) {
        if ($gwgc_jifen >= $sl) {
            item::add_item($id, 1);
            value::add_user_value('gwgc_jifen', -1 * $sl, $user_id);
        } else {
            echo "你的荣耀积分不足无法兑换！";
            br();
        }
    }
    $gwgc_jifen = value::get_user_value('gwgc_jifen', $user_id);
    echo "你有{$gwgc_jifen}荣耀积分：";
    br();
    $item_name = value::get_item_value(185, 'name');
    echo $item_name . "(50荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,185,50', '兑换');
    br();
    $item_name = value::get_item_value(186, 'name');
    echo $item_name . "(100荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,186,100', '兑换');
    br();
    $item_name = value::get_item_value(187, 'name');
    echo $item_name . "(200荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,187,200', '兑换');
    br();
    $item_name = value::get_item_value(188, 'name');
    echo $item_name . "(400荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,188,400', '兑换');
    br();
    $item_name = value::get_item_value(189, 'name');
    echo $item_name . "(800荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,189,800', '兑换');
    br();
    $item_name = value::get_item_value(196, 'name');
    echo $item_name . "(200荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,196,200', '兑换');
    br();
    $item_name = value::get_item_value(288, 'name');
    echo $item_name . "(10荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,288,10', '兑换');
    br();
    $item_name = value::get_item_value(289, 'name');
    echo $item_name . "(50荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,289,50', '兑换');
    br();
    $item_name = value::get_item_value(222, 'name');
    echo $item_name . "(500荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,222,500', '兑换');
    br();
    $item_name = value::get_item_value(290, 'name');
    echo $item_name . "(1000荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,290,1000', '兑换');
    br();
    $item_name = value::get_item_value(291, 'name');
    echo $item_name . "(3000荣耀积分)：";
    cmd::addcmd('map_gc_hb1,1,291,3000', '兑换');
    br();
}

//攻城事件
function map_gc_sj($m_area_id)
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id', $user_id);
    $map_gcgw_id = value::get_system_value('map_gcgw_id');
    $map_gcgw_cs = value::get_system_value('map_gcgw_cs');
    $map_gcgw_xc_id = value::get_system_value('map_gcgw_xc_id');
    if ($map_gcgw_xc_id < 1) {
        value::set_system_value('map_gcgw_xc_id', 5039);
    }
    $map_gcgw_xc_id1 = value::get_system_value('map_gcgw_xc_id');
    if ($in_map_id == 5039 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 184;
        $in_map_id1 = 5040;
    } else if ($in_map_id == 5040 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 187;
        $in_map_id1 = 5041;
    } else if ($in_map_id == 5041 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 198;
        $in_map_id1 = 5044;
    } else if ($in_map_id == 5044 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 188;
        $in_map_id1 = 5045;
    } else if ($in_map_id == 5045 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 189;
        $in_map_id1 = 5046;
    } else if ($in_map_id == 5046 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 190;
        $in_map_id1 = 5048;
    } else if ($in_map_id == 5048 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 191;
        $in_map_id1 = 5049;
    } else if ($in_map_id == 5049 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 202;
        $in_map_id1 = 5050;
    } else if ($in_map_id == 5050 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 192;
        $in_map_id1 = 5051;
    } else if ($in_map_id == 5051 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 193;
        $in_map_id1 = 5052;
    } else if ($in_map_id == 5052 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 194;
        $in_map_id1 = 5053;
    } else if ($in_map_id == 5053 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 201;
        $in_map_id1 = 5054;
    } else if ($in_map_id == 5054 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 195;
        $in_map_id1 = 5055;
    } else if ($in_map_id == 5055 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 196;
        $in_map_id1 = 5058;
    } else if ($in_map_id == 5058 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 200;
        $in_map_id1 = 5059;
    } else if ($in_map_id == 5059 && $map_gcgw_xc_id1 == $in_map_id) {
        $gc_id = 197;
    }
    $map_gcgw_xc_id = value::get_system_value('map_gcgw_xc_id');
    if ($in_map_id == $map_gcgw_xc_id) {
        if ($in_map_id == 5039 || $in_map_id == 5040 || $in_map_id == 5044 || $in_map_id == 5045 || $in_map_id == 5046 || $in_map_id == 5048 || $in_map_id == 5050 || $in_map_id == 5051 || $in_map_id == 5052 || $in_map_id == 5054 || $in_map_id == 5055 || $in_map_id == 5059 || $in_map_id == 5041 || $in_map_id == 5058 || $in_map_id == 5053 || $in_map_id == 5049) {
            $i1 = 0;
            $sql = "SELECT `id` FROM `game_pet` WHERE `pet_id`={$gc_id} AND `master_id`=0 AND `enemy_user`=0 AND `npc_id`=0";
            $result = sql($sql);
            while (list($oid) = $result->fetch_row()) {
                $i1++;
            }
            if ($i1) {
                $sql = "UPDATE `map` SET `shuxing`=1 WHERE `id`='{$in_map_id1}'";
                sql($sql);
            }
            $map_gcgw_id = value::get_system_value('map_gcgw_id');
            if ($i1 < 1 && $map_gcgw_id < 1) {
                value::set_system_value('map_gcgw_id', 1);
            }
            value::set_system_value('map_gcgw_npc_sl', $i1);
            $map_gcgw_id = value::get_system_value('map_gcgw_id');
            $map_gcgw_id9 = value::get_system_value('map_gcgw_id9');
            if ($i1 < 1 && $map_gcgw_id9 != $map_gcgw_id) {
                value::set_system_value('map_gcgw_id9', $map_gcgw_id);
                $map_gcgw_cs = value::get_system_value('map_gcgw_cs');
                $map_gcgw_id10 = $map_gcgw_id + 1;
                value::set_system_value('map_gcgw_cs', $map_gcgw_id10);
                $gcgw_time1 = time();
                value::set_system_value('gcgw_time', $gcgw_time1);
            }
        }
    }
    $map_gcgw_cs = value::get_system_value('map_gcgw_cs');
    $map_gcgw_id = value::get_system_value('map_gcgw_id');
    $gcgw_time = value::get_system_value('gcgw_time');
    $start_jj_time = $gcgw_time + 60;
    $sy_jj_time = $start_jj_time - time();
    $start_jj_time1 = $gcgw_time + 62;
    $sy_jj_time1 = $start_jj_time1 - time();
    if ($sy_jj_time1 > 0 && $map_gcgw_id > 0) {
        if ($sy_jj_time > 0) {
            cmd::addcmd('map_gc_hb1', '荣耀商人');
            br();
            echo "<span style=color:green>即将解封攻城第{$map_gcgw_cs}波怪物地图还剩{$sy_jj_time}秒,请做好准备!</span>";
            br();
            $map_gcgw_id_cs = $map_gcgw_cs * 5;
            value::set_system_value('gcgw_hb_cs', 25);
            value::set_system_value('gcgw_hb_je', $map_gcgw_id_cs);
        } else {
            echo "<span style=color:green>可以进入攻城怪物地图,请进入地图战斗!</span>";
            br();
        }
    } else {
        $map_gcgw_xc_id = value::get_system_value('map_gcgw_xc_id');
        if ($in_map_id == $map_gcgw_xc_id) {
            if ($in_map_id == 5039 || $in_map_id == 5040 || $in_map_id == 5044 || $in_map_id == 5045 || $in_map_id == 5046 || $in_map_id == 5048 || $in_map_id == 5050 || $in_map_id == 5051 || $in_map_id == 5052 || $in_map_id == 5054 || $in_map_id == 5055 || $in_map_id == 5059 || $in_map_id == 5041 || $in_map_id == 5058 || $in_map_id == 5053 || $in_map_id == 5049) {
                $i2 = 0;
                $sql = "SELECT `id` FROM `game_pet` WHERE `pet_id`={$gc_id} AND `master_id`=0 AND `enemy_user`=0 AND `npc_id`=0";
                $result = sql($sql);
                while (list($oid) = $result->fetch_row()) {
                    $i2++;
                }
                if (!$i2) {
                    $sql = "UPDATE `map` SET `shuxing`=0 WHERE `id`='{$in_map_id1}'";
                    sql($sql);
                    value::set_system_value('map_gcgw_xc_id', $in_map_id1);
                    $map_gcgw_cs = value::get_system_value('map_gcgw_cs');
                    value::set_system_value('map_gcgw_id', $map_gcgw_cs);
                }
            }
        }
    }
}

function map_wj_id1($map_cs_id = 0)
{
    $user_id = uid();
    $i214 = item::get_item(214, $user_id);
    $item_name = value::get_item_value(214, 'name');
    if ($i214) {
        if ($map_cs_id) {
            item::add_item(214, -1);
            $bx_map_name = value::get_map_value($map_cs_id, 'name', $user_id);
            value::set_game_user_value('in_map_id', $map_cs_id);
            echo "你已经进入{$bx_map_name}地图!<br><img src='cs.gif' style='width: 100px;height: 100px;'><br>";
            return;
        }
    } else {
        echo "你没有{$item_name}无法传送!";
    }
}

function map_wj_id2($map_cs_id = 0)
{
    $user_id = uid();
    echo "暂时关闭传送!";
}
function map_csz()
{
    $user_id = uid();
    echo "[传送阵]";
    br();
    echo "-";
    br();
    $in_map_id = value::get_game_user_value('in_map_id', $user_id);
    if ($in_map_id == 1) {
        cmd::addcmd('cs_cs_id,122,10,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>比奇（10级）");
        br();
    }
    if ($in_map_id == 122) {
        cmd::addcmd('cs_cs_id,1,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>银杏村");
        br();
    }
    if ($in_map_id == 122) {
        cmd::addcmd('cs_cs_id,583,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>盟重");
        br();
    }
    if ($in_map_id == 122) {
        cmd::addcmd('cs_cs_id,1044,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>道馆");
        br();
    }
    if ($in_map_id == 122) {
        cmd::addcmd('cs_cs_id,1927,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>沙巴克");
        br();
    }
    if ($in_map_id == 583) {
        cmd::addcmd('cs_cs_id,122,10,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>比奇（10级）");
        br();
    }
    if ($in_map_id == 583) {
        cmd::addcmd('cs_cs_id,1,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>银杏村");
        br();
    }
    if ($in_map_id == 583) {
        cmd::addcmd('cs_cs_id,1044,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>道馆");
        br();
    }
    if ($in_map_id == 583) {
        cmd::addcmd('cs_cs_id,1927,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>沙巴克");
        br();
    }
    if ($in_map_id == 1044) {
        cmd::addcmd('cs_cs_id,122,10,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>比奇（10级）");
        br();
    }
    if ($in_map_id == 1044) {
        cmd::addcmd('cs_cs_id,1,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>银杏村");
        br();
    }
    if ($in_map_id == 1044) {
        cmd::addcmd('cs_cs_id,583,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>盟重");
        br();
    }
    if ($in_map_id == 1044) {
        cmd::addcmd('cs_cs_id,1927,1,100', "<img src='cs.gif' style='width: 25px;height: 25px;'>沙巴克");
        br();
    }
    echo "-";
}

function map_cs_id($map_cs_id = 0)
{
    $user_id = uid();
    if ($map_cs_id) {
        $bx_map_name = value::get_map_value($map_cs_id, 'name', $user_id);
        value::set_game_user_value('in_map_id', $map_cs_id);
        echo "你已经进入{$bx_map_name}地图!<br><img src='cs.gif' style='width: 100px;height: 100px;'><br>";
        return;
    }
}

function cs_cs_id($map_cs_id, $cs_lvl, $cs_money)
{
    $user_id = uid();
    $lvl = value::get_game_user_value('lvl', $user_id);
    $money = value::get_user_value('money', $user_id);
    if ($money >= $cs_money) {
        if ($lvl >= $cs_lvl) {
            if ($map_cs_id) {
                $bx_map_name = value::get_map_value($map_cs_id, 'name', $user_id);
                value::set_game_user_value('in_map_id', $map_cs_id);
                value::add_user_value('money', -1 * $cs_money);
                echo "你已经进入{$bx_map_name}地图!<br><img src='cs.gif' style='width: 100px;height: 100px;'><br>";
                return;
            }
        } else {
            echo "你没有{$cs_lvl}级无法传送!";
        }
    } else {
        echo "你没有{$cs_money}个金币无法传送!";
    }
}

function map_mj()
{
    $user_id = uid();
    echo '[秘境]';
    br();
    echo "-";
    br();
    cmd::addcmd('map_mj2', '经验秘境');
    br();
    cmd::addcmd('map_mj_yy', '羽翼试练');
    br();
    echo "-";
}

function map_mj_yy()
{
    $user_id = uid();
    cmd::addcmd('map_mj', '秘境');
    echo " . ";
    cmd::addcmd('map_mj_yy3', '秘境榜');
    echo " . ";
    cmd::addcmd('map_mj_yy1', '秘境商城');
    br();
    echo "-";
    br();
    $mj_yysl_csid = value::get_user_value('mj_yysl_csid', $user_id);
    if ($mj_yysl_csid < 1) {
        $mj_yysl_csid = 5365;
    }
    value::set_user_value('4.hd_hyd_sz', 5, $user_id);
    $time_h = date("H");
    $sl_h = value::get_user_value('hd_hydz_h4', $user_id);
    if ($sl_h != $time_h) {
        value::add_user_value('hd_hydz', 5, $user_id);
        value::set_user_value('hd_hydz_h4', $time_h, $user_id);
    }
    cmd::addcmd("map_cs_id," . $mj_yysl_csid, '开始试练');
    br();
    echo "-";
    br();
    echo "这是曾经的传奇大佬为后人打造的翼翼试秘境<br>
    用于后起的传奇新秀，磨练自己羽翼，强大自己的法身<br>
    据说秘境深处，隐藏着大量羽翼资源，只不过要通过强大的羽翼试练boss认可，才可以通过";
    br();
    echo "-";
}

function map_mj_yy1($lb = 0, $sl = 0)
{
    $user_id = uid();
    $lb1 = item::get_item($lb);
    $yysl_jifen = value::get_user_value('yysl_jifen', $user_id);
    if ($lb > 0) {
        if ($lb1 >= $yysl_jifen && $yysl_jifen > 0) {
            item::add_item($lb, 1);
            value::add_user_value('yysl_jifen', -$sl, $user_id);
        } else {
            $item_qhs_name = value::get_item_value($lb, 'name');
            echo "秘境积分不足，兑换{$item_qhs_name}需要{$sl}秘境积分！";
            br();
        }
    }
    cmd::addcmd('map_mj', '秘境');
    echo " . ";
    echo '秘境商城：';
    echo " . ";
    cmd::addcmd('map_mj_yy2', '积分榜');
    br();
    $yysl_jifen = value::get_user_value('yysl_jifen', $user_id);
    echo "秘境积分：{$yysl_jifen}";
    br();
    echo "-";
    br();
    echo "1、<span style=color:purple>【羽毛】</span>(1积分)";
    echo "  ";
    cmd::addcmd('map_mj_yy1,288,1', '兑换');
    br();
    echo "2、<span style=color:purple>【羽翼精华】</span>(5积分)";
    echo "  ";
    cmd::addcmd('map_mj_yy1,289,5', '兑换');
    br();
    echo "3、<span style=color:red>风暴之翼皮肤</span>(200积分)";
    echo "  ";
    cmd::addcmd('map_mj_yy1,291,200', '兑换');
    br();
    echo "-";
}

function map_mj_yy2()
{
    $i = 0;
    echo '[秘境榜]';
    br();
    echo "-";
    br();
    $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.yysl_jifen' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        $phname = value::get_game_user_value('name', $oid);
        echo $i . '.';
        if (value::get_game_user_value('is_online', $oid)) {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        } else {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        }
        echo '(' . $ovalue . '积分)';
        br();
    }
    if (!$i) {
        echo '暂时无人上榜！';
        br();
    }
    echo "-";
    br();
    cmd::add_last_cmd("map_mj_yy1");
}

function map_mj_yy3()
{
    $i = 0;
    echo '[秘境榜]';
    br();
    echo "-";
    br();
    $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.mj_yysl_csid' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        $phname = value::get_game_user_value('name', $oid);
        echo $i . '.';
        if (value::get_game_user_value('is_online', $oid)) {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        } else {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        }
        $ovalue1 = $ovalue - 5364;
        echo '(' . $ovalue1 . '层)';
        br();
    }
    if (!$i) {
        echo '暂时无人上榜！';
        br();
    }
    echo "-";
    br();
    cmd::add_last_cmd("map_mj_yy");
}

function map_mj2()
{
    $user_id = uid();
    echo '[秘境]';
    br();
    echo "-";
    br();
    $map_jymj_cs = value::get_user_value('map_jymj_cs', $user_id);
    $ts_time = date("Y-m-d H:i:s");
    $map_60_time = value::get_user_value('map_jymj_time', $user_id);
    if (!$map_jymj_cs || $ts_time < $map_60_time) {
        if ($ts_time < $map_60_time) {
            $mzsysj = strtotime($map_60_time) - strtotime($ts_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            echo "提示:你还剩<span style=color:red>{$mz_min}</span>分钟无法进入</span>!";
            br();
            cmd::addcmd('map_mj1', '确认进入');
        } else {
            echo "你今天可以免费一次进入经验秘境！";
            br();
            value::set_user_value('3.hd_hyd_sz', 5, $user_id);
            $time_h = date("H");
            $sl_h = value::get_user_value('hd_hydz_h3', $user_id);
            if ($sl_h != $time_h) {
                value::add_user_value('hd_hydz', 5, $user_id);
                value::set_user_value('hd_hydz_h3', $time_h, $user_id);
            }
            cmd::addcmd('map_mj1', '确认进入');
        }
        $map_60_time1 = date('Y-m-d H:i:s', strtotime('+60 minute'));
        if ($ts_time > $map_60_time) {
            value::set_user_value('map_jymj_time', $map_60_time1, $user_id);
        }
    } else {
        if ($map_jymj_cs < 2) {
            $i296 = item::get_item(296);
            if ($i296 > 0) {
                item::add_item(296, -1);
                $item_qhs_name = value::get_item_value(296, 'name');
                echo "你已经免费进去了一次，现在需要{$item_qhs_name}才能进入！";
                br();
                cmd::addcmd('map_mj1', '进入秘境');
                $map_60_time = date('Y-m-d H:i:s', strtotime('+60 minute'));
                value::set_user_value('map_jymj_time', $map_60_time, $user_id);
            } else {
                $item_qhs_name = value::get_item_value(296, 'name');
                echo "你已经免费进去了一次，现在需要{$item_qhs_name}才能进入！";
            }
        } else {
            echo "经验秘境限制:每天限使用二次！";
        }
    }
    br();
    echo "-";
}

function map_mj1()
{
    cmd::addcmd('map_mj', '秘境');
    echo '：经验秘境';
    br();
    echo "-";
    br();
    cmd::addcmd("map_cs_id,5060", 'LV.10 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5085", 'LV.20 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5110", 'LV.30 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5135", 'LV.40 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5160", 'LV.50 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5185", 'LV.60 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5210", 'LV.70 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5235", 'LV.80 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5260", 'LV.90 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5285", 'LV.100 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5310", 'LV.110 经验秘境');
    br();
    cmd::addcmd("map_cs_id,5335", 'LV.120 经验秘境');
    br();
    echo "-";
    br();
    echo "经验秘籍每天可以免费在经验秘籍历练60分钟<br>
    商城道具，经验秘籍试练卷(效果增加60分钟经验秘境时间，限制:每天限使用一次)";
}

//积分排行
function map_yl_bx()
{
    $i = 0;
    echo '[金币榜]';
    br();
    echo "-";
    br();
    $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.yl_money' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        $phname = value::get_game_user_value('name', $oid);
        echo $i . '.';
        if (value::get_game_user_value('is_online', $oid)) {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        } else {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        }
        echo '(赚了' . $ovalue . '金币)';
        br();
    }
    if (!$i) {
        echo '暂时无人上榜！';
        br();
    }
    echo "-";
    br();
    cmd::add_last_cmd("map_yl");
}

function map_tz1_3()
{
    $i = 0;
    echo '[天元榜]';
    br();
    echo "-";
    br();
    $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.tz_tdxt_money' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        $phname = value::get_game_user_value('name', $oid);
        echo $i . '.';
        if (value::get_game_user_value('is_online', $oid)) {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        } else {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        }
        echo '(' . $ovalue . '个)';
        br();
    }
    if (!$i) {
        echo '暂时无人上榜！';
        br();
    }
    echo "-";
    br();
    cmd::add_last_cmd("map_tz1");
}

function map_tz1_4()
{
    $i = 0;
    echo '[天元商场]';
    br();
    echo "-";
    br();
    echo "暂时还没有上架商品！";
    br();
    echo "-";
    br();
    cmd::add_last_cmd("map_tz1");
}

function map_tz1_5()
{
    $i = 0;
    echo '[天元商场]';
    br();
    echo "-";
    br();
    echo "天梯系统<br>
    天元是一种货币，天元商城购买道具的货币<br>
    九重天→1个位置→产量:200天元/分钟<br>
    八重天→2个位置→产量:150天元/分钟<br>
    七重天→3个位置→产量:100天元/分钟<br>
    六重天→4个位置→产量:80天元/分钟<br>
    五重天→5个位置→产量:60天元/分钟<br>
    四重天→6个位置→产量:40天元/分钟<br>
    三重天→7个位置→产量:30天元/分钟<br>
    二重天→8个位置→产量:20天元/分钟<br>
    一重天→9个位置→产量:10天元/分钟<br>
    一个人只能占领一个位置，占领了之后系统记录你占领时的属性，其它玩家挑战你时，用系统记录的属性与其他玩家打<br>
    玩家挑战成功，以前占领的人下位，不在获得天元产量，挑战失败无影响";
    br();
    echo "-";
    br();
    cmd::add_last_cmd("map_tz1");
}

//攻城荣耀积分排行
function gc_ryjf()
{
    $i = 0;
    echo '[荣耀榜]';
    br();
    echo "-";
    br();
    $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.gwgc_jifen' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        $phname = value::get_game_user_value('name', $oid);
        echo $i . '.';
        if (value::get_game_user_value('is_online', $oid)) {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        } else {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        }
        echo '(' . $ovalue . '荣耀)';
        br();
    }
    if (!$i) {
        echo '暂时无人上榜！';
        br();
    }
    echo "-";
    br();
    cmd::add_last_cmd("hd_rxgc_1");
}

function ch_chsx()
{
    $user_id = uid();
    $using_nick_name = value::get_user_value("using_nick_name", $user_id);
    if ($using_nick_name == "") {
        value::set_user_value('ch_sx_gj', 0, $user_id);
        value::set_user_value('ch_sx_fy', 0, $user_id);
        value::set_user_value('ch_sx_hp', 0, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th1.gif>") {
        value::set_user_value('ch_sx_gj', 100, $user_id);
        value::set_user_value('ch_sx_fy', 100, $user_id);
        value::set_user_value('ch_sx_hp', 100, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th2.gif>") {
        value::set_user_value('ch_sx_gj', 200, $user_id);
        value::set_user_value('ch_sx_fy', 200, $user_id);
        value::set_user_value('ch_sx_hp', 200, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th3.gif>") {
        value::set_user_value('ch_sx_gj', 400, $user_id);
        value::set_user_value('ch_sx_fy', 400, $user_id);
        value::set_user_value('ch_sx_hp', 400, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th4.gif>") {
        value::set_user_value('ch_sx_gj', 800, $user_id);
        value::set_user_value('ch_sx_fy', 800, $user_id);
        value::set_user_value('ch_sx_hp', 800, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th5.gif>") {
        value::set_user_value('ch_sx_gj', 1000, $user_id);
        value::set_user_value('ch_sx_fy', 1000, $user_id);
        value::set_user_value('ch_sx_hp', 1000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th6.gif>") {
        value::set_user_value('ch_sx_gj', 2000, $user_id);
        value::set_user_value('ch_sx_fy', 2000, $user_id);
        value::set_user_value('ch_sx_hp', 2000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th7.gif>") {
        value::set_user_value('ch_sx_gj', 3000, $user_id);
        value::set_user_value('ch_sx_fy', 3000, $user_id);
        value::set_user_value('ch_sx_hp', 3000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th8.gif>") {
        value::set_user_value('ch_sx_gj', 4000, $user_id);
        value::set_user_value('ch_sx_fy', 4000, $user_id);
        value::set_user_value('ch_sx_hp', 4000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th9.gif>") {
        value::set_user_value('ch_sx_gj', 5000, $user_id);
        value::set_user_value('ch_sx_fy', 5000, $user_id);
        value::set_user_value('ch_sx_hp', 5000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/th10.gif>") {
        value::set_user_value('ch_sx_gj', 10000, $user_id);
        value::set_user_value('ch_sx_fy', 10000, $user_id);
        value::set_user_value('ch_sx_hp', 10000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/lzbz.png>") {
        value::set_user_value('ch_sx_gj', 500, $user_id);
        value::set_user_value('ch_sx_fy', 800, $user_id);
        value::set_user_value('ch_sx_hp', 1000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/1.gif>") {
        value::set_user_value('ch_sx_gj', 200, $user_id);
        value::set_user_value('ch_sx_fy', 200, $user_id);
        value::set_user_value('ch_sx_hp', 400, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/2.gif>") {
        value::set_user_value('ch_sx_gj', 400, $user_id);
        value::set_user_value('ch_sx_fy', 400, $user_id);
        value::set_user_value('ch_sx_hp', 800, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/3.gif>") {
        value::set_user_value('ch_sx_gj', 800, $user_id);
        value::set_user_value('ch_sx_fy', 800, $user_id);
        value::set_user_value('ch_sx_hp', 1600, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/4.gif>") {
        value::set_user_value('ch_sx_gj', 1600, $user_id);
        value::set_user_value('ch_sx_fy', 1600, $user_id);
        value::set_user_value('ch_sx_hp', 3200, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/5.gif>") {
        value::set_user_value('ch_sx_gj', 3200, $user_id);
        value::set_user_value('ch_sx_fy', 3200, $user_id);
        value::set_user_value('ch_sx_hp', 6400, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/6.gif>") {
        value::set_user_value('ch_sx_gj', 6400, $user_id);
        value::set_user_value('ch_sx_fy', 6400, $user_id);
        value::set_user_value('ch_sx_hp', 12800, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/7.gif>") {
        value::set_user_value('ch_sx_gj', 12800, $user_id);
        value::set_user_value('ch_sx_fy', 12800, $user_id);
        value::set_user_value('ch_sx_hp', 25600, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/gc1.gif>") {
        value::set_user_value('ch_sx_gj', 2000, $user_id);
        value::set_user_value('ch_sx_fy', 2000, $user_id);
        value::set_user_value('ch_sx_hp', 5000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/gc2.gif>") {
        value::set_user_value('ch_sx_gj', 1000, $user_id);
        value::set_user_value('ch_sx_fy', 1000, $user_id);
        value::set_user_value('ch_sx_hp', 3000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/txdy1.gif>") {
        value::set_user_value('ch_sx_hp', 10000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/txdy2.gif>") {
        value::set_user_value('ch_sx_hp', 10000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/txdy3.gif>") {
        value::set_user_value('ch_sx_hp', 10000, $user_id);
    } elseif ($using_nick_name == "<img src=res/img/ch/666666.gif>") {
        value::set_user_value('ch_sx_hp', 100, $user_id);
    } else {
        value::set_user_value('ch_sx_gj', 0, $user_id);
        value::set_user_value('ch_sx_fy', 0, $user_id);
        value::set_user_value('ch_sx_hp', 0, $user_id);
    }
}

function gc_shbx()
{
    $i = 0;
    echo '[攻城总伤害榜]';
    br();
    echo "-";
    br();
    $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.gwgc_sh' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        $phname = value::get_game_user_value('name', $oid);
        echo $i . '、';
        if (value::get_game_user_value('is_online', $oid)) {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        } else {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        }
        echo '（' . $ovalue . '总伤值)';
        echo "   ";
        cmd::addcmd('gc_shbx1,' . $oid . ',' . $i, "领奖");
        br();
    }
    if (!$i) {
        echo '暂时无人上榜！';
        br();
    }
    echo "-";
    br();
    cmd::add_last_cmd("hd_rxgc_1");
}

function gc_shbx1($oid, $i)
{
    $user_id = uid();
    $gc_bx_jl = value::get_user_value('gc_bx_jl');
    $gc_d = date("d");
    $gc_h = date("H");
    if ($gc_h == 21 || $gc_h == 22 || $gc_h == 23) {
        if ($gc_bx_jl != $gc_d) {
            switch ($i) {
                case 1:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励获得了<img src=res/img/ch/gc1.gif>称号!");
                        echo "恭喜你获得了<img src=res/img/ch/gc1.gif>，荣耀积分+1000";
                        br();
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/gc1.gif>");
                        prop::user_get_prop(prop::new_prop(312, 0, 0), 0, 1, false, true);
                        value::add_user_value('gwgc_jifen', 1000, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                        value::set_system_value('gczz_id', $user_id);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    }
                    break;
                case 2:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励获得了<img src=res/img/ch/gc2.gif>称号!");
                        echo "恭喜你获得了<img src=res/img/ch/gc2.gif>称号，荣耀积分+800。";
                        br();
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/gc2.gif>");
                        value::add_user_value('gwgc_jifen', 800, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                        value::set_system_value('gczz_id2', $user_id);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    }  
                    break;  
                case 3:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励获得了<img src=res/img/ch/gc1.gif>称号!");
                        echo "恭喜你获得了<img src=res/img/ch/gc2.gif>称号，荣耀积分+800。";
                        br();
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/gc2.gif>");
                        value::add_user_value('gwgc_jifen', 800, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                        value::set_system_value('gczz_id3', $user_id);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break;    
                case 4:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+400！";
                        br();
                        value::add_user_value('gwgc_jifen', 400, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 5:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+400！";
                        br();
                        value::add_user_value('gwgc_jifen', 400, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 6:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+400！";
                        br();
                        value::add_user_value('gwgc_jifen', 400, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 7:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+400！";
                        br();
                        value::add_user_value('gwgc_jifen', 400, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 8:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+400！";
                        br();
                        value::add_user_value('gwgc_jifen', 400, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 9:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+400！";
                        br();
                        value::add_user_value('gwgc_jifen', 400, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 10:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+400！";
                        br();
                        value::add_user_value('gwgc_jifen', 400, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 11:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 12:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 13:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 14:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 15:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 16:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 17:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                case 18:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break;
                case 19:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break;  
                case 20:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在攻城活动领取攻城第" . $i . "名奖励!");
                        echo "恭喜你获得了攻城第" . $i . "名奖励，荣耀积分+200！";
                        br();
                        value::add_user_value('gwgc_jifen', 200, $user_id);
                        value::set_user_value('gc_bx_jl', $gc_d);
                    } else {
                        echo "你无法领取奖励，领取条件需要攻城总伤害榜第" . $i . "名！";
                        br();
                    } 
                    break; 
                default:
                    break;
            }
        } else {
            echo '你今天已经领取了攻城奖励！';
        }
    } else {
        echo '领取攻城奖励时间是21：00~ 23:59！';
    }
    br();
    cmd::add_last_cmd("hd_rxgc_1");
}

function jj_ltjf($oid = 0, $i = 0)
{
    $user_id = uid();
    $gc_bx_jl = value::get_user_value('lt_bx_jl');
    $gc_d = date("d");
    $gc_h = date("H");
    if ($gc_h >= 20) {
        if ($gc_bx_jl != $gc_d) {
            switch ($i) {
                case 1:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励获得了<img src=res/img/ch/lzbz.png>称号!");
                        echo "恭喜你获得了<img src=res/img/ch/lzbz.png>称号";
                        br();
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/lzbz.png>");
                        value::set_user_value('lt_bx_jl', $gc_d);
                        item::add_item(285, 8);
                        item::add_item(287, 1000);
                        user::get_exp($user_id, 1000000);
                        item::add_money(100000, $user_id);
                        value::set_system_value('wlmz_id', $user_id);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break;
                case 2:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 800000);
                        item::add_money(80000, $user_id);
                        item::add_item(285, 5);
                        item::add_item(287, 800);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break;  
                case 3:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 800000);
                        item::add_money(80000, $user_id);
                        item::add_item(285, 3);
                        item::add_item(287, 500);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break;    
                case 4:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 800000);
                        item::add_money(80000, $user_id);
                        item::add_item(285, 3);
                        item::add_item(287, 500);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 5:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 500000);
                        item::add_money(50000, $user_id);
                        item::add_item(285, 3);
                        item::add_item(287, 500);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 6:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 500000);
                        item::add_money(50000, $user_id);
                        item::add_item(285, 2);
                        item::add_item(287, 300);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 7:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 500000);
                        item::add_money(50000, $user_id);
                        item::add_item(285, 2);
                        item::add_item(287, 300);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 8:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 500000);
                        item::add_money(50000, $user_id);
                        item::add_item(285, 2);
                        item::add_item(287, 300);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 9:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 500000);
                        item::add_money(50000, $user_id);
                        item::add_item(285, 2);
                        item::add_item(287, 300);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 10:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 500000);
                        item::add_money(50000, $user_id);
                        item::add_item(285, 2);
                        item::add_item(287, 300);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 11:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂������" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 100000);
                        item::add_money(10000, $user_id);
                        item::add_item(285, 2);
                        item::add_item(287, 300);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break;
                case 12:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 100000);
                        item::add_money(10000, $user_id);
                        item::add_item(285, 2);
                        item::add_item(287, 300);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break;  
                case 13:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 100000);
                        item::add_money(10000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break;    
                case 14:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 100000);
                        item::add_money(10000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 15:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 100000);
                        item::add_money(10000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 16:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 80000);
                        item::add_money(8000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 17:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 80000);
                        item::add_money(8000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 18:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 80000);
                        item::add_money(8000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 19:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 80000);
                        item::add_money(8000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                case 20:
                    if ($oid == $user_id) {
                        $name = value::get_game_user_value('name', $user_id);
                        c_add_guangbo("恭喜" . $name . "在竞技活动领取擂台第" . $i . "名奖励!");
                        echo "恭喜你获得了擂台" . $i . "名奖励!";
                        br();
                        value::set_user_value('lt_bx_jl', $gc_d);
                        user::get_exp($user_id, 80000);
                        item::add_money(8000, $user_id);
                        item::add_item(285, 1);
                        item::add_item(287, 200);
                    } else {
                        echo "你无法领取奖励，领取条件需要擂台榜第" . $i . "名！";
                        br();
                    }
                    break; 
                default:
                    break;
            }
        } else {
            echo '你今天已经领取了擂台奖励！';
        }
    } else {
        echo '领取擂台奖励时间是20：00~ 23:59！';
    }
    br();
    cmd::add_last_cmd("hd_wlzb_1");
}

function map_yl_bx1()
{
    $i = 0;
    echo '[元宝榜]';
    br();
    echo "-";
    br();
    $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.yl_lingshi' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        $phname = value::get_game_user_value('name', $oid);
        echo $i . '.';
        if (value::get_game_user_value('is_online', $oid)) {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        } else {
            cmd::addcmd('e12,' . $oid . ',6', $phname);
        }
        echo '(赚了' . $ovalue . '元宝)';
        br();
    }
    if (!$i) {
        echo '暂时无人上榜！';
        br();
    }
    echo "-";
    br();
    cmd::add_last_cmd("map_yl");
}

function map_yl_bx2($lb = 0, $je = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo '[金币称号]';
        br();
        $yl_lingshi = value::get_user_value('yl_money', $user_id);
        echo "你在娱乐大厅赚了" . $yl_lingshi . "金币：";
        br();
        echo "-";
        br();
        echo "称号：【赌徒】";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('ch_yldt_1', $user_id);
        if ($ch_yldt_1 < 1) {
            cmd::addcmd('map_yl_bx2,1,100', "领取");
        }
        br();
        echo "领取条件：需赚了100金币";
        br();
        echo "称号：【赌鬼】";
        echo "   ";
        $ch_yldt_2 = value::get_user_value('ch_yldt_2', $user_id);
        if ($ch_yldt_2 < 1) {
            cmd::addcmd('map_yl_bx2,2,500', "领取");
        }
        br();
        echo "领取条件：需赚了500金币";
        br();
        echo "称号：【赌豪】";
        echo "   ";
        $ch_yldt_3 = value::get_user_value('ch_yldt_3', $user_id);
        if ($ch_yldt_3 < 1) {
            cmd::addcmd('map_yl_bx2,3,1000', "领取");
        }
        br();
        echo "领取条件：需赚了1000金币";
        br();
        echo "称号：【赌痴】";
        echo "   ";
        $ch_yldt_4 = value::get_user_value('ch_yldt_4', $user_id);
        if ($ch_yldt_4 < 1) {
            cmd::addcmd('map_yl_bx2,4,5000', "领取");
        }
        br();
        echo "领取条件：需赚了5000金币";
        br();
        echo "称号：【赌怪】";
        echo "   ";
        $ch_yldt_5 = value::get_user_value('ch_yldt_5', $user_id);
        if ($ch_yldt_5 < 1) {
            cmd::addcmd('map_yl_bx2,5,10000', "领取");
        }
        br();
        echo "领取条件：需赚了10000金币";
        br();
        echo "称号：【赌狂】";
        echo "   ";
        $ch_yldt_6 = value::get_user_value('ch_yldt_6', $user_id);
        if ($ch_yldt_6 < 1) {
            cmd::addcmd('map_yl_bx2,6,20000', "领取");
        }
        br();
        echo "领取条件：需赚了20000金币";
        br();
        echo "称号：【赌魔】";
        echo "   ";
        $ch_yldt_7 = value::get_user_value('ch_yldt_7', $user_id);
        if ($ch_yldt_7 < 1) {
            cmd::addcmd('map_yl_bx2,7,30000', "领取");
        }
        br();
        echo "领取条件：需赚了30000金币";
        br();
        echo "称号：【赌侠】";
        echo "   ";
        $ch_yldt_8 = value::get_user_value('ch_yldt_8', $user_id);
        if ($ch_yldt_8 < 1) {
            cmd::addcmd('map_yl_bx2,8,50000', "领取");
        }
        br();
        echo "领取条件：需赚了50000金币";
        br();
        echo "称号：【赌圣】";
        echo "   ";
        $ch_yldt_9 = value::get_user_value('ch_yldt_9', $user_id);
        if ($ch_yldt_9 < 1) {
            cmd::addcmd('map_yl_bx2,9,80000', "领取");
        }
        br();
        echo "领取条件：需赚了80000金币";
        br();
        echo "称号：【赌神】";
        echo "   ";
        $ch_yldt_10 = value::get_user_value('ch_yldt_10', $user_id);
        if ($ch_yldt_10 < 1) {
            cmd::addcmd('map_yl_bx2,10,100000', "领取");
        }
        br();
        echo "领取条件：需赚了100000金币";
        br();
        echo "-";
        br();
        cmd::add_last_cmd("map_yl");
    }
    if ($lb > 0) {
        $yl_lingshi = value::get_user_value('yl_money', $user_id);
        switch ($lb) {
            case 1:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌徒】称号!');
                    echo '恭喜你获得了【赌徒】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌徒】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌徒】");
                    }
                    value::set_user_value('ch_yldt_1', 1);
                } else {
                    echo '你无法领取【赌徒】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break;
            case 2:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌鬼】称号!');
                    echo '恭喜你获得了【赌鬼】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌鬼】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌鬼】");
                    }
                    value::set_user_value('ch_yldt_2', 1);
                } else {
                    echo '你无法领取【赌鬼】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break;     
            case 3:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌豪】称号!');
                    echo '恭喜你获得了【赌豪】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌豪】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌豪】");
                    }
                    value::set_user_value('ch_yldt_3', 1);
                } else {
                    echo '你无法领取【赌豪】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break;    
            case 4:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌痴】称号!');
                    echo '恭喜你获得了【赌痴】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌痴】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌痴】");
                    }
                    value::set_user_value('ch_yldt_4', 1);
                } else {
                    echo '你无法领取【赌痴】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break; 
            case 5:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌怪】称号!');
                    echo '恭喜你获得了【赌怪】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌怪】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌怪】");
                    }
                    value::set_user_value('ch_yldt_5', 1);
                } else {
                    echo '你无法领取【赌怪】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break; 
            case 6:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌狂】称号!');
                    echo '恭喜你获得了【赌狂】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌狂】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌狂】");
                    }
                    value::set_user_value('ch_yldt_6', 1);
                } else {
                    echo '你无法领取【赌狂】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break; 
            case 7:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌魔】称号!');
                    echo '恭喜你获得了【赌魔】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌魔】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌魔】");
                    }
                    value::set_user_value('ch_yldt_7', 1);
                } else {
                    echo '你无法领取【赌魔】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break; 
            case 8:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌侠】称号!');
                    echo '恭喜你获得了【赌侠】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌侠】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌侠】");
                    }
                    value::set_user_value('ch_yldt_8', 1);
                } else {
                    echo '你无法领取【赌侠】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break; 
            case 9:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌圣】称号!');
                    echo '恭喜你获得了【赌圣】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌圣】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌圣】");
                    }
                    value::set_user_value('ch_yldt_9', 1);
                } else {
                    echo '你无法领取【赌圣】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break; 
            case 10:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了【赌神】称号!');
                    echo '恭喜你获得了【赌神】称号。';
                    br();
                    value::insert_user_value('nick_name', "【赌神】");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "【赌神】");
                    }
                    value::set_user_value('ch_yldt_10', 1);
                } else {
                    echo '你无法领取【赌神】称号，领取条件需要赚了' . $je . '金币！';
                    br();
                }
                break; 
            default:
                break;
        }
    }
}

function map_yl_bx3($lb = 0, $je = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo '[元宝称号]';
        br();
        $yl_lingshi = value::get_user_value('yl_lingshi', $user_id);
        echo "你在娱乐大厅赚了" . $yl_lingshi . "元宝：";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th1.gif>";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('ch_yldt_11', $user_id);
        if ($ch_yldt_1 < 1) {
            cmd::addcmd('map_yl_bx3,1,100', "领取");
        }
        br();
        echo "领取条件：需赚了100元宝";
        br();
        echo "称号属性：生命+100 攻击+100 防御+100";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th2.gif>";
        echo "   ";
        $ch_yldt_2 = value::get_user_value('ch_yldt_12', $user_id);
        if ($ch_yldt_2 < 1) {
            cmd::addcmd('map_yl_bx3,2,500', "领取");
        }
        br();
        echo "领取条件：需赚了500元宝";
        br();
        echo "称号属性：生命+200 攻击+200 防御+200";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th3.gif>";
        echo "   ";
        $ch_yldt_3 = value::get_user_value('ch_yldt_13', $user_id);
        if ($ch_yldt_3 < 1) {
            cmd::addcmd('map_yl_bx3,3,1000', "领取");
        }
        br();
        echo "领取条件：需赚了1000元宝";
        br();
        echo "称号属性：生命+400 攻击+400 防御+400";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th4.gif>";
        echo "   ";
        $ch_yldt_4 = value::get_user_value('ch_yldt_14', $user_id);
        if ($ch_yldt_4 < 1) {
            cmd::addcmd('map_yl_bx3,4,5000', "领取");
        }
        br();
        echo "领取条件：需赚了5000元宝";
        br();
        echo "称号属性：生命+800 攻击+800 防御+800";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th5.gif>";
        echo "   ";
        $ch_yldt_5 = value::get_user_value('ch_yldt_15', $user_id);
        if ($ch_yldt_5 < 1) {
            cmd::addcmd('map_yl_bx3,5,10000', "领取");
        }
        br();
        echo "领取条件：需赚了10000元宝";
        br();
        echo "称号属性：生命+1000 攻击+1000 防御+1000";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th6.gif>";
        echo "   ";
        $ch_yldt_6 = value::get_user_value('ch_yldt_16', $user_id);
        if ($ch_yldt_6 < 1) {
            cmd::addcmd('map_yl_bx3,6,20000', "领取");
        }
        br();
        echo "领取条件：需赚了20000元宝";
        br();
        echo "称号属性：生命+2000 攻击+2000 防御+2000";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th7.gif>";
        echo "   ";
        $ch_yldt_7 = value::get_user_value('ch_yldt_17', $user_id);
        if ($ch_yldt_7 < 1) {
            cmd::addcmd('map_yl_bx3,7,30000', "领取");
        }
        br();
        echo "领取条件：需赚了30000元宝";
        br();
        echo "称号属性：生命+3000 攻击+3000 防御+3000";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th8.gif>";
        echo "   ";
        $ch_yldt_8 = value::get_user_value('ch_yldt_18', $user_id);
        if ($ch_yldt_8 < 1) {
            cmd::addcmd('map_yl_bx3,8,50000', "领取");
        }
        br();
        echo "领取条件：需赚了50000元宝";
        br();
        echo "称号属性：生命+4000 攻击+4000 防御+4000";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th9.gif>";
        echo "   ";
        $ch_yldt_9 = value::get_user_value('ch_yldt_19', $user_id);
        if ($ch_yldt_9 < 1) {
            cmd::addcmd('map_yl_bx3,9,80000', "领取");
        }
        br();
        echo "领取条件：需赚了80000元宝";
        br();
        echo "称号属性：生命+5000 攻击+5000 防御+5000";
        br();
        echo "-";
        br();
        echo "称号：<img src=res/img/ch/th10.gif>";
        echo "   ";
        $ch_yldt_10 = value::get_user_value('ch_yldt_20', $user_id);
        if ($ch_yldt_10 < 1) {
            cmd::addcmd('map_yl_bx3,10,100000', "领取");
        }
        br();
        echo "领取条件：需赚了100000元宝";
        br();
        echo "称号属性：生命+10000 攻击+10000 防御+10000";
        br();
        echo "-";
        br();
        cmd::add_last_cmd("map_yl");
    }
    if ($lb > 0) {
        $yl_lingshi = value::get_user_value('yl_lingshi', $user_id);
        switch ($lb) {
            case 1:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th1.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th1.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th1.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th1.gif>");
                    }
                    value::set_user_value('ch_yldt_11', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th1.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break;
            case 2:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th2.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th2.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th2.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th2.gif>");
                    }
                    value::set_user_value('ch_yldt_12', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th2.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break;     
            case 3:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th3.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th3.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th3.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th3.gif>");
                    }
                    value::set_user_value('ch_yldt_13', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th3.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break;    
            case 4:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th4.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th4.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th4.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th4.gif>");
                    }
                    value::set_user_value('ch_yldt_14', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th4.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break; 
            case 5:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th5.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th5.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th5.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th5.gif>");
                    }
                    value::set_user_value('ch_yldt_15', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th5.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break; 
            case 6:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th6.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th6.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th6.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th6.gif>");
                    }
                    value::set_user_value('ch_yldt_16', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th6.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break; 
            case 7:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th7.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th7.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th7.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th7.gif>");
                    }
                    value::set_user_value('ch_yldt_17', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th7.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break; 
            case 8:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th8.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th8.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th8.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th8.gif>");
                    }
                    value::set_user_value('ch_yldt_18', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th8.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break; 
            case 9:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th9.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/th9.gif>称号。';
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th9.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th9.gif>");
                    }
                    value::set_user_value('ch_yldt_19', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th9.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break; 
            case 10:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo('恭喜' . $name . '在娱乐大厅领取了<img src=res/img/ch/th10.gif>称号!');
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/th10.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/th10.gif>");
                    }
                    value::set_user_value('ch_yldt_20', 1);
                } else {
                    echo '你无法领取<img src=res/img/ch/th10.gif>称号，领取条件需要赚了' . $je . '元宝！';
                    br();
                }
                break; 
            default:
                break;
        }
    }
}

function map_gc_ch($lb = 0, $je = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo '[攻城称号]';
        br();
        $yl_lingshi = value::get_user_value('gwgc_jifen', $user_id);
        echo "你有" . $yl_lingshi . "荣耀积分：";
        br();
        echo "-";
        br();
        echo "称号：<img src='res/img/ch/1.gif'>";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('ch_gwgc_1', $user_id);
        if ($ch_yldt_1 < 1) {
            cmd::addcmd('map_gc_ch,1,100', "领取");
        }
        br();
        echo "(领取条件：需100荣耀积分)";
        br();
        echo "称号：<img src='res/img/ch/2.gif'>";
        echo "   ";
        $ch_yldt_2 = value::get_user_value('ch_gwgc_2', $user_id);
        if ($ch_yldt_2 < 1) {
            cmd::addcmd('map_gc_ch,2,500', "领取");
        }
        br();
        echo "(领取条件：需500荣耀积分)";
        br();
        echo "称号：<img src='res/img/ch/3.gif'>";
        echo "   ";
        $ch_yldt_3 = value::get_user_value('ch_gwgc_3', $user_id);
        if ($ch_yldt_3 < 1) {
            cmd::addcmd('map_gc_ch,3,1000', "领取");
        }
        br();
        echo "(领取条件：需1000荣耀积分)";
        br();
        echo "称号：<img src='res/img/ch/4.gif'>";
        echo "   ";
        $ch_yldt_4 = value::get_user_value('ch_gwgc_4', $user_id);
        if ($ch_yldt_4 < 1) {
            cmd::addcmd('map_gc_ch,4,5000', "领取");
        }
        br();
        echo "(领取条件：需5000荣耀积分)";
        br();
        echo "称号：<img src='res/img/ch/5.gif'>";
        echo "   ";
        $ch_yldt_5 = value::get_user_value('ch_gwgc_5', $user_id);
        if ($ch_yldt_5 < 1) {
            cmd::addcmd('map_gc_ch,5,10000', "领取");
        }
        br();
        echo "(领取条件：需10000荣耀积分)";
        br();
        echo "称号：<img src='res/img/ch/6.gif'>";
        echo "   ";
        $ch_yldt_6 = value::get_user_value('ch_gwgc_6', $user_id);
        if ($ch_yldt_6 < 1) {
            cmd::addcmd('map_gc_ch,6,50000', "领取");
        }
        br();
        echo "(领取条件：需50000荣耀积分)";
        br();
        echo "称号：<img src='res/img/ch/7.gif'>";
        echo "   ";
        $ch_yldt_7 = value::get_user_value('ch_gwgc_7', $user_id);
        if ($ch_yldt_7 < 1) {
            cmd::addcmd('map_gc_ch,7,100000', "领取");
        }
        br();
        echo "(领取条件：需100000荣耀积分)";
        br();
        echo "-";
        br();
        cmd::add_last_cmd("hd_rxgc_1");
    }
    if ($lb > 0) {
        $yl_lingshi = value::get_user_value('gwgc_jifen', $user_id);
        switch ($lb) {
            case 1:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo("恭喜" . $name . "在攻城活动领取了<img src=res/img/ch/1.gif>称号!");
                    echo "恭喜你获得了<img src=res/img/ch/1.gif>称号。";
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/1.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/1.gif>");
                    }
                    value::add_user_value('gwgc_jifen', -1 * $je, $user_id);
                    value::set_user_value('ch_gwgc_1', 1);
                } else {
                    echo "你无法领取<img src=res/img/ch/1.gif>称号，领取条件需要" . $je . "荣耀积分！";
                    br();
                }
                break;
            case 2:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo("恭喜" . $name . "在攻城活动领取了<img src=res/img/ch/2.gif>称号!");
                    echo "恭喜你获得了<img src=res/img/ch/2.gif>称号。";
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/2.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/2.gif>");
                    }
                    value::add_user_value('gwgc_jifen', -1 * $je, $user_id);
                    value::set_user_value('ch_gwgc_2', 1);
                } else {
                    echo "你无法领取<img src=res/img/ch/2.gif>称号，领取条件需要" . $je . "荣耀积分！";
                    br();
                }
                break;     
            case 3:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo("恭喜" . $name . "在攻城活动领取了<img src=res/img/ch/3.gif>称号!");
                    echo "恭喜你获得了<img src=res/img/ch/3.gif>称号。";
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/3.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/3.gif>");
                    }
                    value::add_user_value('gwgc_jifen', -1 * $je, $user_id);
                    value::set_user_value('ch_gwgc_3', 1);
                } else {
                    echo "你无法领取<img src=res/img/ch/3.gif>称号，领取条件需要" . $je . "荣耀积分！";
                    br();
                }
                break;    
            case 4:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo("恭喜" . $name . "在攻城活动领取了<img src=res/img/ch/4.gif>称号!");
                    echo "恭喜你获得了<img src=res/img/ch/4.gif>称号。";
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/4.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/4.gif>");
                    }
                    value::add_user_value('gwgc_jifen', -1 * $je, $user_id);
                    value::set_user_value('ch_gwgc_4', 1);
                } else {
                    echo "你无法领取<img src=res/img/ch/4.gif>称号，领取条件需要" . $je . "荣耀积分！";
                    br();
                }
                break; 
            case 5:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo("恭喜" . $name . "在攻城活动领取了<img src=res/img/ch/5.gif>称号!");
                    echo "恭喜你获得了<img src=res/img/ch/5.gif>称号。";
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/5.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/5.gif>");
                    }
                    value::add_user_value('gwgc_jifen', -1 * $je, $user_id);
                    value::set_user_value('ch_gwgc_5', 1);
                } else {
                    echo "你无法领取<img src=res/img/ch/5.gif>称号，领取条件需要" . $je . "荣耀积分！";
                    br();
                }
                break; 
            case 6:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo("恭喜" . $name . "在攻城活动领取了<img src=res/img/ch/6.gif>称号!");
                    echo "恭喜你获得了<img src=res/img/ch/6.gif>称号。";
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/6.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/6.gif>");
                    }
                    value::add_user_value('gwgc_jifen', -1 * $je, $user_id);
                    value::set_user_value('ch_gwgc_6', 1);
                } else {
                    echo "你无法领取<img src=res/img/ch/6.gif>称号，领取条件需要" . $je . "荣耀积分！";
                    br();
                }
                break; 
            case 7:
                if ($yl_lingshi >= $je) {
                    $name = value::get_game_user_value('name', $user_id);
                    c_add_guangbo("恭喜" . $name . "在攻城活动领取了<img src=res/img/ch/7.gif>称号!");
                    echo "恭喜你获得了<img src=res/img/ch/7.gif>称号。";
                    br();
                    value::insert_user_value('nick_name', "<img src=res/img/ch/7.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/7.gif>");
                    }
                    value::add_user_value('gwgc_jifen', -1 * $je, $user_id);
                    value::set_user_value('ch_gwgc_7', 1);
                } else {
                    echo "你无法领取<img src=res/img/ch/7.gif>称号，领取条件需要" . $je . "荣耀积分！";
                    br();
                }
                break; 
            default:
                break;
        }
    }
}

function map_jb_gj_gw($lb = 0, $je = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo '[攻击鼓舞]';
        br();
        $money = value::get_user_value('money', $user_id);
        echo "你有" . $money . "金币:";
        br();
        echo "-";
        br();
        echo "金币鼓舞:共5级(不叠加,本次攻城区域有效)";
        br();
        echo "1级，消耗10万金币加成:5%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
        if ($ch_yldt_1 < 1) {
            cmd::addcmd('map_jb_gj_gw,1,100000', "升级");
        }
        br();
        echo "2级，消耗100万金币加成:10%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
        if ($ch_yldt_1 < 2) {
            cmd::addcmd('map_jb_gj_gw,2,1000000', "升级");
        }
        br();
        echo "3级，消耗1000万金币加成:17%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
        if ($ch_yldt_1 < 3) {
            cmd::addcmd('map_jb_gj_gw,3,10000000', "升级");
        }
        br();
        echo "4级，消耗5000万金币加成:25%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
        if ($ch_yldt_1 < 4) {
            cmd::addcmd('map_jb_gj_gw,4,50000000', "升级");
        }
        br();
        echo "5级，消耗3亿金币加成35%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
        if ($ch_yldt_1 < 5) {
            cmd::addcmd('map_jb_gj_gw,5,300000000', "升级");
        }
        br();
        echo "-";
        br();
        cmd::add_last_cmd("hd_rxgc_1");
    }
    if ($lb > 0) {
        $yl_lingshi = value::get_user_value('money', $user_id);
        switch ($lb) {
            case 1:
                $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
                if ($ch_yldt_1 == 0) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了1级金币攻击鼓舞加成5%攻击！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_gj', 5);
                        value::set_user_value('gc_jb_gjgw', 1);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要0级鼓舞！";
                    br();
                }
                break;
            case 2:
                $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
                if ($ch_yldt_1 == 1) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了2级金币攻击鼓舞加成10%攻击！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_gj', 10);
                        value::set_user_value('gc_jb_gjgw', 2);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要1级鼓舞！";
                    br();
                }
                break;    
            case 3:
                $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
                if ($ch_yldt_1 == 2) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了3级金币攻击鼓舞加成17%攻击！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_gj', 17);
                        value::set_user_value('gc_jb_gjgw', 3);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要2级鼓舞！";
                    br();
                }
                break;    
            case 4:
                $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
                if ($ch_yldt_1 == 3) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了4级金币攻击鼓舞加成25%攻击！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_gj', 25);
                        value::set_user_value('gc_jb_gjgw', 4);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要3级鼓舞！";
                    br();
                }
                break; 
            case 5:
                $ch_yldt_1 = value::get_user_value('gc_jb_gjgw', $user_id);
                if ($ch_yldt_1 == 4) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了5级金币攻击鼓舞加成35%攻击！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_gj', 35);
                        value::set_user_value('gc_jb_gjgw', 5);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要4级鼓舞！";
                    br();
                }
                break; 
            default:
                break;
        }
    }
}

function map_yb_gj_gw($lb = 0, $je = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo '[攻击鼓舞]';
        br();
        $money = item::get_item(1);
        echo "你有元宝：{$money}";
        br();
        echo "-";
        br();
        echo "元宝鼓舞:共5级(不叠加,本次攻城区域有效)";
        br();
        echo "1级，消耗100元宝加成10%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
        if ($ch_yldt_1 < 1) {
            cmd::addcmd('map_yb_gj_gw,1,100', "升级");
        }
        br();
        echo "2级，消耗500元宝加成30%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
        if ($ch_yldt_1 < 2) {
            cmd::addcmd('map_yb_gj_gw,2,500', "升级");
        }
        br();
        echo "3级，消耗2000元宝加成80%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
        if ($ch_yldt_1 < 3) {
            cmd::addcmd('map_yb_gj_gw,3,2000', "升级");
        }
        br();
        echo "4级，消耗6000元宝加成150%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
        if ($ch_yldt_1 < 4) {
            cmd::addcmd('map_yb_gj_gw,4,6000', "升级");
        }
        br();
        echo "5级，消耗10000元宝加成260%攻击";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
        if ($ch_yldt_1 < 5) {
            cmd::addcmd('map_yb_gj_gw,5,10000', "升级");
        }
        br();
        echo "-";
        br();
        cmd::add_last_cmd("hd_rxgc_1");
    }
    if ($lb > 0) {
        $yl_lingshi = item::get_item(1);
        switch ($lb) {
            case 1:
                $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
                if ($ch_yldt_1 == 0) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了1级元宝攻击鼓舞加成10%攻击！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_gj', 10);
                        value::set_user_value('gc_yb_gjgw', 1);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要0级鼓舞！";
                    br();
                }
                break;
            case 2:
                $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
                if ($ch_yldt_1 == 1) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了2级元宝攻击鼓舞加成30%攻击！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_gj', 30);
                        value::set_user_value('gc_yb_gjgw', 2);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要1级鼓舞！";
                    br();
                }
                break;    
            case 3:
                $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
                if ($ch_yldt_1 == 2) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了3级元宝攻击鼓舞加成80%攻击！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_gj', 80);
                        value::set_user_value('gc_yb_gjgw', 3);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要2级鼓舞！";
                    br();
                }
                break;    
            case 4:
                $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
                if ($ch_yldt_1 == 3) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了4级元宝攻击鼓舞加成150%攻击！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_gj', 150);
                        value::set_user_value('gc_yb_gjgw', 4);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要3级鼓舞！";
                    br();
                }
                break; 
            case 5:
                $ch_yldt_1 = value::get_user_value('gc_yb_gjgw', $user_id);
                if ($ch_yldt_1 == 4) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了5级元宝攻击鼓舞加成260%攻击！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_gj', 260);
                        value::set_user_value('gc_yb_gjgw', 5);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要4级鼓舞！";
                    br();
                }
                break; 
            default:
                break;
        }
    }
}

function map_jb_fy_gw($lb = 0, $je = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo '[防御鼓舞]';
        br();
        $money = value::get_user_value('money', $user_id);
        echo "你有" . $money . "金币:";
        br();
        echo "-";
        br();
        echo "金币鼓舞:共5级(不叠加,本次攻城区域有效)";
        br();
        echo "1级，消耗10万金币加成:5%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
        if ($ch_yldt_1 < 1) {
            cmd::addcmd('map_jb_fy_gw,1,100000', "升级");
        }
        br();
        echo "2级，消耗100万金币加成:10%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
        if ($ch_yldt_1 < 2) {
            cmd::addcmd('map_jb_fy_gw,2,1000000', "升级");
        }
        br();
        echo "3级，消耗1000万金币加成:17%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
        if ($ch_yldt_1 < 3) {
            cmd::addcmd('map_jb_fy_gw,3,10000000', "升级");
        }
        br();
        echo "4级，消耗5000万金币加成:25%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
        if ($ch_yldt_1 < 4) {
            cmd::addcmd('map_jb_fy_gw,4,50000000', "升级");
        }
        br();
        echo "5级，消耗3亿金币加成35%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
        if ($ch_yldt_1 < 5) {
            cmd::addcmd('map_jb_fy_gw,5,300000000', "升级");
        }
        br();
        echo "-";
        br();
        cmd::add_last_cmd("hd_rxgc_1");
    }
    if ($lb > 0) {
        $yl_lingshi = value::get_user_value('money', $user_id);
        switch ($lb) {
            case 1:
                $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
                if ($ch_yldt_1 == 0) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了1级金币防御鼓舞加成5%防御！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_fy', 5);
                        value::set_user_value('gc_jb_fygw', 1);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要0级鼓舞！";
                    br();
                }
                break;
            case 2:
                $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
                if ($ch_yldt_1 == 1) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了2级金币防御鼓舞加成10%防御！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_fy', 10);
                        value::set_user_value('gc_jb_fygw', 2);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要1级鼓舞！";
                    br();
                }
                break;    
            case 3:
                $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
                if ($ch_yldt_1 == 2) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了3级金币防御鼓舞加成17%防御！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_fy', 17);
                        value::set_user_value('gc_jb_fygw', 3);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要2级鼓舞！";
                    br();
                }
                break;    
            case 4:
                $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
                if ($ch_yldt_1 == 3) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了4级金币防御鼓舞加成25%防御！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_fy', 25);
                        value::set_user_value('gc_jb_fygw', 4);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要3级鼓舞！";
                    br();
                }
                break; 
            case 5:
                $ch_yldt_1 = value::get_user_value('gc_jb_fygw', $user_id);
                if ($ch_yldt_1 == 4) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了5级金币防御鼓舞加成35%防御！";
                        br();
                        item::add_money(-1 * $je, $user_id);
                        value::set_user_value('gc_gjgw_fy', 35);
                        value::set_user_value('gc_jb_fygw', 5);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "金币！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要4级鼓舞！";
                    br();
                }
                break; 
            default:
                break;
        }
    }
}

function map_yb_fy_gw($lb = 0, $je = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo '[防御鼓舞]';
        br();
        $money = item::get_item(1);
        echo "你有元宝：{$money}";
        br();
        echo "-";
        br();
        echo "元宝鼓舞:共5级(不叠加,本次攻城区域有效)";
        br();
        echo "1级，消耗100元宝加成10%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
        if ($ch_yldt_1 < 1) {
            cmd::addcmd('map_yb_fy_gw,1,100', "升级");
        }
        br();
        echo "2级，消耗500元宝加成30%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
        if ($ch_yldt_1 < 2) {
            cmd::addcmd('map_yb_fy_gw,2,500', "升级");
        }
        br();
        echo "3级，消耗2000元宝加成80%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
        if ($ch_yldt_1 < 3) {
            cmd::addcmd('map_yb_fy_gw,3,2000', "升级");
        }
        br();
        echo "4级，消耗6000元宝加成150%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
        if ($ch_yldt_1 < 4) {
            cmd::addcmd('map_yb_fy_gw,4,6000', "升级");
        }
        br();
        echo "5级，消耗10000元宝加成260%防御";
        echo "   ";
        $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
        if ($ch_yldt_1 < 5) {
            cmd::addcmd('map_yb_fy_gw,5,10000', "升级");
        }
        br();
        echo "-";
        br();
        cmd::add_last_cmd("hd_rxgc_1");
    }
    if ($lb > 0) {
        $yl_lingshi = item::get_item(1);
        switch ($lb) {
            case 1:
                $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
                if ($ch_yldt_1 == 0) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了1级元宝防御鼓舞加成10%防御！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_fy', 10);
                        value::set_user_value('gc_yb_fygw', 1);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要0级鼓舞！";
                    br();
                }
                break;
            case 2:
                $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
                if ($ch_yldt_1 == 1) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了2级元宝防御鼓舞加成30%防御！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_fy', 30);
                        value::set_user_value('gc_yb_fygw', 2);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要1级鼓舞！";
                    br();
                }
                break;    
            case 3:
                $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
                if ($ch_yldt_1 == 2) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了3级元宝防御鼓舞加成80%防御！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_fy', 80);
                        value::set_user_value('gc_yb_fygw', 3);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要2级鼓舞！";
                    br();
                }
                break;    
            case 4:
                $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
                if ($ch_yldt_1 == 3) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了4级元宝防御鼓舞加成150%防御！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_fy', 150);
                        value::set_user_value('gc_yb_fygw', 4);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要3级鼓舞！";
                    br();
                }
                break; 
            case 5:
                $ch_yldt_1 = value::get_user_value('gc_yb_fygw', $user_id);
                if ($ch_yldt_1 == 4) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了5级元宝防御鼓舞加成260%防御！";
                        br();
                        item::add_item(1, -1 * $je);
                        value::set_user_value('gc_gjgw_fy', 260);
                        value::set_user_value('gc_yb_fygw', 5);
                    } else {
                        echo "你无法升级鼓舞，升级条件需要" . $je . "元宝！";
                        br();
                    }
                } else {
                    echo "你无法升级鼓舞，升级条件需要4级鼓舞！";
                    br();
                }
                break; 
            default:
                break;
        }
    }
}

function map_ld($lb = 0, $ld_lvl = 0)
{
    $user_id = uid();
    cmd::addcmd('map_ld', "炼丹");
    br();
    echo "-";
    br();
    if ($lb < 1) {
        $yy_ld_exp = value::get_user_value('yy_ld_exp', $user_id);
        if ($yy_ld_exp < 120) {
            $yy_ld_exp1 = 120 - $yy_ld_exp;
            $yy_ld_name = "入门级炼丹师";
            $yy_ld_name1 = "见习级炼丹师";
        } elseif ($yy_ld_exp < 360) {
            $yy_ld_exp1 = 360 - $yy_ld_exp;
            $yy_ld_name = "见习级炼丹师";
            $yy_ld_name1 = "准师级炼丹师";
        } elseif ($yy_ld_exp < 1000) {
            $yy_ld_exp1 = 1000 - $yy_ld_exp;
            $yy_ld_name = "准师级炼丹师";
            $yy_ld_name1 = "宗师级炼丹师";
        } elseif ($yy_ld_exp < 3000) {
            $yy_ld_exp1 = 3000 - $yy_ld_exp;
            $yy_ld_name = "宗师级炼丹师";
            $yy_ld_name1 = "大宗师级炼丹师";
        } else {
            $yy_ld_exp1 = 0;
            $yy_ld_name = "大宗师级炼丹师";
            $yy_ld_name1 = "已经顶级炼丹师";
        }
        echo "当前炼丹熟练度：{$yy_ld_exp}";
        br();
        echo "我的炼丹等级：{$yy_ld_name}";
        br();
        echo "还差{$yy_ld_exp1}熟练度晋升为{$yy_ld_name1}";
        br();
        echo "-";
    }

    if ($lb == 1 && $ld_lvl == 1) {
        echo "请选择要炼制1级丹药：";
        br();
        cmd::addcmd('map_ld,2,1', "金乌丹");
        br();
        echo "练丹消耗:矮樱花ⅹ3、人发草x3、洗骨果x3";
        br();
        cmd::addcmd('map_ld,2,2', "玄元丹");
        br();
        echo "消耗:墨叶果ⅹ3、艾菊花x3、人胞草ⅹ3";
        br();
        cmd::addcmd('map_ld,2,3', "金还丹");
        br();
        echo "消耗:蛇涎果ⅹ3、芭蕉花x3、人参草ⅹ3";
        br();
        cmd::addcmd('map_ld,2,4', "冰心丹");
        br();
        echo "消耗:卜芥草ⅹ3、白鲜花x3、聚灵果ⅹ3";
        br();
        cmd::addcmd('map_ld,2,5', "回气丹");
        br();
        echo "消耗:凝血果ⅹ3、白芨花x3、儿茶草ⅹ3";
        br();
        cmd::addcmd('map_ld,2,6', "超级龙力丹");
        br();
        echo "消耗:刀豆草ⅹ50、百合花x50、生骨果ⅹ50、超级佛手柑x6、超级蒙大拿山蚤缀花x6、超级星辰天元果x6";
        br();
        echo "-";
    }
    if ($lb == 2) {
        $hd_hydz = value::get_user_value('hd_hydz', $user_id);
        if ($hd_hydz >= 5) {
            if ($ld_lvl == 1) {
                $i440 = item::get_item(440);
                $i406 = item::get_item(406);
                $i474 = item::get_item(474);
                if ($i440 >= 3 && $i406 >= 3 && $i474 >= 3) {
                    item::add_item(440, -3);
                    item::add_item(406, -3);
                    item::add_item(474, -3);
                    item::add_item(508, 1);
                    value::add_user_value('yy_ld_exp', 1, $user_id);
                    value::add_user_value('hd_hydz', -5, $user_id);
                    echo "炼丹消耗了5点活跃值！";
                    br();
                } else {
                    echo "练丹需要消耗:矮樱花ⅹ3、人发草x3、洗骨果x3";
                    br();
                }
            }
            if ($ld_lvl == 2) {
                $i440 = item::get_item(441);
                $i446 = item::get_item(407);
                $i474 = item::get_item(475);
                if ($i440 >= 3 && $i446 >= 3 && $i474 >= 3) {
                    item::add_item(441, -3);
                    item::add_item(407, -3);
                    item::add_item(475, -3);
                    item::add_item(509, 1);
                    value::add_user_value('yy_ld_exp', 1, $user_id);
                    value::add_user_value('hd_hydz', -5, $user_id);
                    echo "炼丹消耗了5点活跃值！";
                    br();
                } else {
                    echo "练丹需要消耗:墨叶果ⅹ3、艾菊花x3、人胞草ⅹ3";
                    br();
                }
            }
            if ($ld_lvl == 3) {
                $i476 = item::get_item(476);
                $i446 = item::get_item(442);
                $i474 = item::get_item(408);
                if ($i476 >= 3 && $i446 >= 3 && $i474 >= 3) {
                    item::add_item(476, -3);
                    item::add_item(442, -3);
                    item::add_item(408, -3);
                    item::add_item(510, 1);
                    value::add_user_value('yy_ld_exp', 1, $user_id);
                    value::add_user_value('hd_hydz', -5, $user_id);
                    echo "炼丹消耗了5点活跃值！";
                    br();
                } else {
                    echo "练丹需要消耗:蛇涎果ⅹ3、芭蕉花x3、人参草ⅹ3";
                    br();
                }
            }
            if ($ld_lvl == 4) {
                $i440 = item::get_item(409);
                $i446 = item::get_item(443);
                $i474 = item::get_item(477);
                if ($i440 >= 3 && $i446 >= 3 && $i474 >= 3) {
                    item::add_item(409, -3);
                    item::add_item(443, -3);
                    item::add_item(477, -3);
                    item::add_item(511, 1);
                    value::add_user_value('yy_ld_exp', 1, $user_id);
                    value::add_user_value('hd_hydz', -5, $user_id);
                    echo "炼丹消耗了5点活跃值！";
                    br();
                } else {
                    echo "练丹需要消耗:卜芥草ⅹ3、白鲜花x3、聚灵果ⅹ3";
                    br();
                }
            }
            if ($ld_lvl == 5) {
                $i440 = item::get_item(478);
                $i446 = item::get_item(444);
                $i474 = item::get_item(410);
                if ($i440 >= 3 && $i446 >= 3 && $i474 >= 3) {
                    item::add_item(478, -3);
                    item::add_item(444, -3);
                    item::add_item(410, -3);
                    item::add_item(512, 1);
                    value::add_user_value('yy_ld_exp', 1, $user_id);
                    value::add_user_value('hd_hydz', -5, $user_id);
                    echo "炼丹消耗了5点活跃值！";
                    br();
                } else {
                    echo "练丹需要消耗:凝血果ⅹ3、白芨花x3、儿茶草ⅹ3";
                    br();
                }
            }
            if ($ld_lvl == 6) {
                $i440 = item::get_item(411);
                $i446 = item::get_item(445);
                $i474 = item::get_item(479);
                $i436 = item::get_item(436);
                $i470 = item::get_item(470);
                $i504 = item::get_item(504);
                if ($i440 >= 50 && $i446 >= 50 && $i474 >= 50 && $i436 >= 6 && $i470 >= 6 && $i504 >= 6) {
                    item::add_item(411, -50);
                    item::add_item(445, -50);
                    item::add_item(479, -50);
                    item::add_item(436, -6);
                    item::add_item(470, -6);
                    item::add_item(504, -6);
                    item::add_item(513, 1);
                    value::add_user_value('yy_ld_exp', 1, $user_id);
                    value::add_user_value('hd_hydz', -5, $user_id);
                    echo "炼丹消耗了5点活跃值！";
                    br();
                } else {
                    echo "练丹需要消耗:刀豆草ⅹ50、百合花x50、生骨果ⅹ50、(极品)佛手柑x6、超级蒙大拿山蚤缀花x6、超级星辰天元果x6";
                    br();
                }
            }
        } else {
            echo "炼丹需要消耗5点活跃值！";
        br(); 
        }
    }
}

function map_yy($yp_lb = 0, $yp_lvl = 0)
{
    echo "我的种植等级：";
    br();
    $user_id = uid();
    $yy_yp_yc_lvl = value::get_user_value('yy_yp_yc_lvl', $user_id) + 1;
    $yy_yp_yc_exp = value::get_user_value('yy_yp_yc_exp', $user_id);
    $yy_yp_yc_map_exp = $yy_yp_yc_lvl * 15000;
    $yy_yp_yh_lvl = value::get_user_value('yy_yp_yh_lvl', $user_id) + 1;
    $yy_yp_yh_exp = value::get_user_value('yy_yp_yh_exp', $user_id);
    $yy_yp_yh_map_exp = $yy_yp_yh_lvl * 15000;
    $yy_yp_yg_lvl = value::get_user_value('yy_yp_yg_lvl', $user_id) + 1;
    $yy_yp_yg_exp = value::get_user_value('yy_yp_yg_exp', $user_id);
    $yy_yp_yg_map_exp = $yy_yp_yg_lvl * 15000;
    echo "{$yy_yp_yc_lvl}级药草：经验  {$yy_yp_yc_exp}/{$yy_yp_yc_map_exp}";
    br();
    echo "{$yy_yp_yh_lvl}级异花：经验  {$yy_yp_yh_exp}/{$yy_yp_yh_map_exp}";
    br();
    echo "{$yy_yp_yg_lvl}级奇果：经验  {$yy_yp_yg_exp}/{$yy_yp_yg_map_exp}";
    br();
    echo "-";
}

function map_yy1($lb = 0, $zz_lb = 0, $zz_lvl = 0, $zz_sl = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        echo "请选择要领取免费的种子类型：";
        br();
        cmd::addcmd('map_yy1,1,1', "药草种子");
        br();
        cmd::addcmd('map_yy1,1,2', "异花种子");
        br();
        cmd::addcmd('map_yy1,1,3', "奇果种子");
        br();
    }
    if ($lb == 1) {
        echo "请选择要领取免费的种子等级：";
        br();
        cmd::addcmd("map_yy1,2," . $zz_lb . ",0,20,", "1级种子");
        br();
        cmd::addcmd("map_yy1,2," . $zz_lb . ",1,16,", "2级种子");
        br();
        cmd::addcmd("map_yy1,2," . $zz_lb . ",2,12,", "3级种子");
        br();
        cmd::addcmd("map_yy1,2," . $zz_lb . ",3,8,", "4级种子");
        br();
        cmd::addcmd("map_yy1,2," . $zz_lb . ",4,4,", "5级种子");
        br();
    }
    if ($lb == 2) {
        echo "请选择要领取免费的种子：";
        br();
        $i = 0;
        $sql = "SELECT `id`,`name` FROM `item` WHERE `yp_lb`={$zz_lb} AND `yp_lvl`={$zz_lvl} AND `is_bd`<1 ";
        $result = sql($sql);
        while (list($id, $name) = $result->fetch_row()) {
            $i ++;
            if ($i == 1) {
                $id1 = $id;
            }
            $id2 = $id;
        }
        cmd::addcmd('map_yy12,' . $id1. ',' .  $id2 . ',' . $zz_sl, "领取种子");
        br();
    }
}

function map_yy12($id1 = 0, $id2 = 0, $zz_sl = 0)
{
    $user_id = uid();
    $sj = mt_rand($id1, $id2);
    item::add_item($sj, $zz_sl);
    echo "每日可以免费领取种子！";
    br();
    $time_d = date("d");
    value::set_user_value('yy_yp_yc_lq', $time_d, $user_id);
}

function map_yy5($i = 0, $id = 0)
{
    $user_id = uid();
    $item_exp = value::get_item_value($id, 'yp_lvl') * 50 + 100;
    $item_lb = value::get_item_value($id, 'yp_lb');
    if ($item_lb == 1) {
        value::add_user_value('yy_yp_yc_exp', $item_exp, $user_id);
        $yy_yp_yc_lvl = value::get_user_value('yy_yp_yc_lvl', $user_id) + 1;
        $yy_yp_yc_exp = value::get_user_value('yy_yp_yc_exp', $user_id);
        $yy_yp_yc_map_exp = $yy_yp_yc_lvl * 15000;
        if ($yy_yp_yc_exp >= $yy_yp_yc_map_exp && $yy_yp_yc_lvl < 5) {
            value::add_user_value('yy_yp_yc_lvl', 1, $user_id);
        }
    }
    if ($item_lb == 2) {
        value::add_user_value('yy_yp_yh_exp', $item_exp, $user_id);
        $yy_yp_yh_lvl = value::get_user_value('yy_yp_yh_lvl', $user_id) + 1;
        $yy_yp_yh_exp = value::get_user_value('yy_yp_yh_exp', $user_id);
        $yy_yp_yh_map_exp = $yy_yp_yh_lvl * 15000;
        if ($yy_yp_yh_exp >= $yy_yp_yh_map_exp && $yy_yp_yh_lvl < 5) {
            value::add_user_value('yy_yp_yh_lvl', 1, $user_id);
        }
    }
    if ($item_lb == 3) {
        value::add_user_value('yy_yp_yg_exp', $item_exp, $user_id);
        $yy_yp_yg_lvl = value::get_user_value('yy_yp_yg_lvl', $user_id) + 1;
        $yy_yp_yg_exp = value::get_user_value('yy_yp_yg_exp', $user_id);
        $yy_yp_yg_map_exp = $yy_yp_yg_lvl * 15000;
        if ($yy_yp_yg_exp >= $yy_yp_yg_map_exp && $yy_yp_yg_lvl < 5) {
            value::add_user_value('yy_yp_yg_lvl', 1, $user_id);
        }
    }
    $sj = mt_rand(5, 10);
    $id_zz = $id + 103;
    item::add_item($id_zz, $sj);
    value::set_user_value('yy_yp_yc_yp' . $i, 0, $user_id);
    br();
}
function map_yy2($i = 0, $lb = 0, $id = 0)
{
    $user_id = uid();
    if ($lb < 1) {
        $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
        $result = sql($sql);
        while (list($id, $count) = $result->fetch_row()) {
            $id = explode('.', $id);
            if (value::get_item_value($id[2], 'yp_lb') && value::get_item_value($id[2], 'is_bd') < 1) {
                $name = value::getvalue('item', 'name', 'id', $id[2]);
                $lvl = value::getvalue('item', 'yp_lvl', 'id', $id[2]) + 1;
                $lb10 = value::getvalue('item', 'yp_lb', 'id', $id[2]);
                cmd::addcmd('map_yy2,' . $i . ',' . $lb10 . ',' . $id[2], $lvl . "级" . $name);
                br();
            }
        }
    }
    if ($lb > 0) {
        if ($lb == 1) {
            $lb1 = value::get_user_value('yy_yp_yc_lvl', $user_id) + 1;
            $lb_name = "药草";
        }
        if ($lb == 2) {
            $lb1 = value::get_user_value('yy_yp_yh_lvl', $user_id) + 1;
            $lb_name = "异花";
        }
        if ($lb == 3) {
            $lb1 = value::get_user_value('yy_yp_yg_lvl', $user_id) + 1;
            $lb_name = "奇果";
        }
        $item_time = value::get_item_value($id, 'yp_lvl') * 120 + 360;
        $yp_lvl = value::get_item_value($id, 'yp_lvl') + 1;
        if ($lb > 0) {
            if ($lb1 >= $yp_lvl) {
                value::set_user_value('yy_yp_yc_yp' . $i, $id, $user_id);
                $now_time = date("Y-m-d H:i:s", strtotime("+{$item_time}minute"));
                value::set_user_value('yy_yp_yc_time' . $i, $now_time, $user_id);
                $item_name = value::get_item_value($id, 'name');
                echo "种植{$item_name}成功！";
                br();
            } else {
                $item_name = value::get_item_value($id, 'name');
                echo "种植{$item_name}需要{$yp_lvl}级{$lb_name}！";
                br();
            }
        }
    }
    br();
}
function map_yy3($lb = 0, $i = 0)
{
    $user_id = uid();
    $u_money = item::get_money();
    $u_lingshi = item::get_lingshi();
    $sl = value::get_user_value('yy_yp_yc_lt1', $user_id) + value::get_user_value('yy_yp_yc_lt2', $user_id) + value::get_user_value('yy_yp_yc_lt3', $user_id) + value::get_user_value('yy_yp_yc_lt4', $user_id) + value::get_user_value('yy_yp_yc_lt5', $user_id) + value::get_user_value('yy_yp_yc_lt6', $user_id) + value::get_user_value('yy_yp_yc_lt7', $user_id) + value::get_user_value('yy_yp_yc_lt8', $user_id);
    if ($sl == 0) {
        $money = 5000000;
    }
    if ($sl == 1) {
        $money = 15000000;
    }
    if ($sl == 2) {
        $money = 30000000;
    }
    if ($sl == 3) {
        $lingshi = 1000;
    }
    if ($sl == 4) {
        $lingshi = 2000;
    }
    if ($sl == 5) {
        $lingshi = 3000;
    }
    if ($sl == 6) {
        $lingshi = 4000;
    }
    if ($lb < 1) {
        if ($sl < 3) {
            echo "开耕{$i}灵田需要{$money}金币！";
            br();
            cmd::addcmd('map_yy3,1,' . $i, "确认");
            br();
        } else {
            echo "开耕{$i}灵田需要{$lingshi}元宝！";
            br();
            cmd::addcmd('map_yy3,1,' . $i, "确认");
            br();
        }
    } else {
        if ($sl < 3) {
            if ($u_money >= $money) {
                item::add_money(-1 * $money, $user_id);
                value::set_user_value('yy_yp_yc_lt' . $i, 1, $user_id);
                echo "恭喜开耕{$i}灵田成功！";
                br();
            } else {
                echo "开耕{$i}灵田需要{$money}金币！";
                br();
            }
        } else {
            if ($u_lingshi >= $lingshi) {
                value::set_user_value('yy_yp_yc_lt' . $i, 1, $user_id);
                item::add_item(1, -1 * $lingshi);
                echo "恭喜开耕{$i}灵田成功！";
                br();
            } else {
                echo "开耕{$i}灵田需要{$lingshi}元宝！";
                br();
            }
        }
    }
}

function map_qz($lb = 0, $je = 0)
{
    $user_id = uid();
    $item_name = value::getvalue('item', 'name', 'id', 300);
    if ($lb < 1) {
        echo '特权:权者为帝';
        br();
        $money = item::get_item(300);
        echo "你有<span style=color:green>{$item_name}</span>：{$money}个";
        br();
        $map_qz = value::get_user_value('map_qz', $user_id);
        $wj_sx_qzwd_jc = value::get_user_value('wj_sx_qzwd_jc', $user_id);
        echo "你当前{$map_qz}级权者为帝特权全属性加{$wj_sx_qzwd_jc}%";
        br();
        echo "-";
        br();
        echo "可升级，共7级";
        br();
        if ($map_qz == 0) {
            echo "1级，消耗权者为帝特权x1，全属性加5%";
            echo "   ";
            if ($map_qz < 1) {
                cmd::addcmd('map_qz,1,1', "升级");
            }
            br();
        }
        if ($map_qz == 1) {
            echo "2级，消耗权者为帝特权x5，全属性加12%";
            echo "   ";
            if ($map_qz < 2) {
                cmd::addcmd('map_qz,2,5', "升级");
            }
            br();
        }
        if ($map_qz == 2) {
            echo "3级，消耗权者为帝特权x15，全属性加21%";
            echo "   ";
            if ($map_qz < 3) {
                cmd::addcmd('map_qz,3,15', "升级");
            }
            br();
        }
        if ($map_qz == 3) {
            echo "4级，消耗权者为帝特权x25，全属性加32%";
            echo "   ";
            if ($map_qz < 4) {
                cmd::addcmd('map_qz,4,25', "升级");
            }
            br();
        }
        if ($map_qz == 4) {
            echo "5级，消耗权者为帝特权x35，全属性加45%";
            echo "   ";
            if ($map_qz < 5) {
                cmd::addcmd('map_qz,5,35', "升级");
            }
            br();
        }
        if ($map_qz == 5) {
            echo "6级，消耗权者为帝称号x50，全属性加60%";
            echo "   ";
            if ($map_qz < 6) {
                cmd::addcmd('map_qz,6,50', "升级");
            }
            br();
        }
        if ($map_qz == 6) {
            echo "7级，消耗权者为帝称号x70，全属性加80%";
            echo "   ";
            if ($map_qz < 7) {
                cmd::addcmd('map_qz,7,70', "升级");
            }
            br();
        }
        echo "-";
        br();
        cmd::add_last_cmd("e13");
    }
    if ($lb > 0) {
        $yl_lingshi = item::get_item(300);
        switch ($lb) {
            case 1:
                $ch_yldt_1 = value::get_user_value('map_qz', $user_id);
                if ($ch_yldt_1 == 0) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了1级权者为帝全属性加5%！";
                        br();
                        item::add_item(300, -1 * $je);
                        value::set_user_value('wj_sx_qzwd_jc', 5);
                        value::set_user_value('map_qz', 1);
                    } else {
                        echo "你无法升级权者为帝，升级条件需要" . $je . "{$item_name}！";
                        br();
                    }
                } else {
                    echo "你无法升级权者为帝，升级条件需要0级权者为帝特权！";
                    br();
                }
                break;
            case 2:
                $ch_yldt_1 = value::get_user_value('map_qz', $user_id);
                if ($ch_yldt_1 == 1) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了2级权者为帝全属性加12%！";
                        br();
                        item::add_item(300, -1 * $je);
                        value::set_user_value('wj_sx_qzwd_jc', 12);
                        value::set_user_value('map_qz', 2);
                    } else {
                        echo "你无法升级权者为帝，升级条件需要" . $je . "{$item_name}！";
                        br();
                    }
                } else {
                    echo "你无法升级权者为帝，升级条件需要1级权者为帝特权！";
                    br();
                }
                break;    
            case 3:
                $ch_yldt_1 = value::get_user_value('map_qz', $user_id);
                if ($ch_yldt_1 == 2) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了3级权者为帝全属性加21%！";
                        br();
                        item::add_item(300, -1 * $je);
                        value::set_user_value('wj_sx_qzwd_jc', 21);
                        value::set_user_value('map_qz', 3);
                    } else {
                        echo "你无法升级权者为帝，升级条件需要" . $je . "{$item_name}！";
                        br();
                    }
                } else {
                    echo "你无法升级权者为帝，升级条件需要2级权者为帝特权！";
                    br();
                }
                break;    
            case 4:
                $ch_yldt_1 = value::get_user_value('map_qz', $user_id);
                if ($ch_yldt_1 == 3) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了4级权者为帝全属性加32%！";
                        br();
                        item::add_item(300, -1 * $je);
                        value::set_user_value('wj_sx_qzwd_jc', 32);
                        value::set_user_value('map_qz', 4);
                    } else {
                        echo "你无法升级权者为帝，升级条件需要" . $je . "{$item_name}！";
                        br();
                    }
                } else {
                    echo "你无法升级权者为帝，升级条件需要3级权者为帝特权！";
                    br();
                }
                break; 
            case 5:
                $ch_yldt_1 = value::get_user_value('map_qz', $user_id);
                if ($ch_yldt_1 == 4) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了5级权者为帝全属性加45%！";
                        br();
                        item::add_item(300, -1 * $je);
                        value::set_user_value('wj_sx_qzwd_jc', 45);
                        value::set_user_value('map_qz', 5);
                    } else {
                        echo "你无法升级权者为帝，升级条件需要" . $je . "{$item_name}！";
                        br();
                    }
                } else {
                    echo "你无法升级权者为帝，升级条件需要4级权者为帝特权！";
                    br();
                }
                break; 
            case 6:
                $ch_yldt_1 = value::get_user_value('map_qz', $user_id);
                if ($ch_yldt_1 == 5) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了5级权者为帝全属性加60%！";
                        br();
                        item::add_item(300, -1 * $je);
                        value::set_user_value('wj_sx_qzwd_jc', 60);
                        value::set_user_value('map_qz', 6);
                    } else {
                        echo "你无法升级权者为帝，升级条件需要" . $je . "{$item_name}！";
                        br();
                    }
                } else {
                    echo "你无法升级权者为帝，升级条件需要5级权者为帝特权！";
                    br();
                }
                break; 
            case 7:
                $ch_yldt_1 = value::get_user_value('map_qz', $user_id);
                if ($ch_yldt_1 == 6) {
                    if ($yl_lingshi >= $je) {
                        echo "恭喜你获得了7级权者为帝全属性加80%！";
                        br();
                        item::add_item(300, -1 * $je);
                        value::set_user_value('wj_sx_qzwd_jc', 80);
                        value::set_user_value('map_qz', 7);
                    } else {
                        echo "你无法升级权者为帝，升级条件需要" . $je . "{$item_name}！";
                        br();
                    }
                } else {
                    echo "你无法升级权者为帝，升级条件需要6级权者为帝特权！";
                    br();
                }
                break; 
            default:
                break;
        }
        cmd::add_last_cmd("map_qz");
    }
}

function map_yl()
{
    echo "[娱乐大厅]";
    br();
    cmd::addcmd('map_yl_bx', "金币榜");
    echo " .  ";
    echo "   ";
    cmd::addcmd('map_yl_bx1', "元宝榜");
    echo " . ";
    echo "   ";
    cmd::addcmd('map_yl_bx3', "元宝称号");
    echo " . ";
    echo "   ";
    cmd::addcmd('map_yl_bx2', "金币称号");
    br();
    echo "-";
    br();
    cmd::addcmd('yl1', "<img src='res/img/yl/egg.gif'>砸金蛋");
    br();
    $yl_zjd_zg_cs = value::get_system_value('yl_zjd_zg_cs');
    $yl_zjd_zg_money = value::get_system_value('yl_zjd_zg_money');
    $yl_zjd_zg_lingshi = value::get_system_value('yl_zjd_zg_lingshi');
    echo "高赔率，快速致富的好途径！<br>
    今日玩家总次数:{$yl_zjd_zg_cs} 次<br>
    今日砸金总金额:{$yl_zjd_zg_money}金币， {$yl_zjd_zg_lingshi}元宝";
    br();
    cmd::addcmd('yl_sz', "<img src='res/img/yl/sz.gif'>激情骰子");
    br();
    $yl_sz_zg_cs = value::get_system_value('yl_sz_zg_cs');
    $yl_sz_zg_money = value::get_system_value('yl_sz_zg_money');
    $yl_sz_zg_lingshi = value::get_system_value('yl_sz_zg_lingshi');
    echo "疯狂刺激，爽，赚币多多！ <br>
    今日掷骰总次数: {$yl_sz_zg_cs} 次<br>
    今日掷骰总金额:{$yl_sz_zg_money}金币， {$yl_sz_zg_lingshi}元宝";
    br();
    cmd::addcmd('yl_smc', "<img src='res/img/yl/2.gif'>赛马场");
    br();
    $yl_smc_zg_cs = value::get_system_value('yl_smc_zg_cs');
    $yl_smc_zg_money = value::get_system_value('yl_smc_zg_money');
    $yl_smc_zg_lingshi = value::get_system_value('yl_smc_zg_lingshi');
    echo "疯狂刺激，爽，赚币多多！ <br>
    今日投注总次数: {$yl_smc_zg_cs} 次<br>
    今日投注总金额:{$yl_smc_zg_money}金币， {$yl_smc_zg_lingshi}元宝";
    br();
    cmd::addcmd('yl_jj', "<img src='res/img/yl/zhong.gif'>奖券抽奖");
    br();
    $yl_jj_zg_cs = value::get_system_value('yl_jj_zg_cs');
    $yl_jj_zg_money = value::get_system_value('yl_jj_zg_money');
    $yl_jj_zg_lingshi = value::get_system_value('yl_jj_zg_lingshi');
    echo "高赔率，快速致富的好途径！<br>
    今日玩家总次数:{$yl_jj_zg_cs} 次<br>
    今日抽奖总金额:{$yl_jj_zg_money}金币， {$yl_jj_zg_lingshi}元宝";
    br();
    echo "-";
}

function yl_sz($ms = 0, $lb = 0, $jq = 0)
{
    $user_id = uid();
    $lingshi = item::get_lingshi();
    $money = value::get_user_value('money');
    $yl_sz_zg_dc = value::get_system_value('yl_sz_zg_dc');
    $yl_sz_zg_cs1 = value::get_system_value('yl_sz_zg_cs') + 1;
    $yl_sz_zg_money1 = value::get_system_value('yl_sz_zg_money') + $jq;
    $yl_sz_zg_lingshi1 = value::get_system_value('yl_sz_zg_lingshi') + $jq;
    $yl_sz_sz1 = value::get_system_value('yl_sz_sz1');
    $yl_sz_sz2 = value::get_system_value('yl_sz_sz2');
    $yl_sz_sz3 = value::get_system_value('yl_sz_sz3');
    $yl_sz_sz = $yl_sz_sz1 + $yl_sz_sz2 + $yl_sz_sz3;
    $bz = 0;
    $yl_sz_bz = ""; 
    $yl_sz_ds = ""; 
    $yl_sz_dx = ""; 
    if ($yl_sz_sz1 == $yl_sz_sz2){
        $bz = $bz + 1;
    }
    if ($yl_sz_sz1 == $yl_sz_sz3){
        $bz = $bz + 1;
    }
    if ($yl_sz_sz2 == $yl_sz_sz3){
        $bz = $bz + 1;
    }
    if ($bz == 3){
        $yl_sz_bz = "豹子"; 
    }
    if ($bz != 3){
        if ($yl_sz_sz % 2 == 0) {
            $yl_sz_ds = "双"; 
        } else {
            $yl_sz_ds = "单"; 
        }
        if ($yl_sz_sz > 10) {
            $yl_sz_dx = "大"; 
        } else {
            $yl_sz_dx = "小"; 
        }
    }
    if ($lb == 4 || $lb == 3) {
        if ($ms == 1 && $lb == 4) {
            if ($money >= $jq) {
                value::add_user_value('money', -1 * $jq, $user_id);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_money', $yl_sz_zg_money1);
                $yl_sz_4_money4 = value::get_system_value('yl_sz_4_money') + $jq;
                value::set_system_value('yl_sz_4_money', $yl_sz_4_money4);
                if ($yl_sz_sz % 2 == 0 && $bz != 3) {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_money', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的金币不够！";
                br();
            }
        }
        if ($ms == 2 && $lb == 4) {
            if ($lingshi >= $jq) {
                item::add_item(1, -1 * $jq);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_lingshi', $yl_sz_zg_lingshi1);
                $yl_sz_4_money4 = value::get_system_value('yl_sz_4_lingshi') + $jq;
                value::set_system_value('yl_sz_4_lingshi', $yl_sz_4_money4);
                if ($yl_sz_sz % 2 == 0 && $bz != 3) {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_lingshi', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的元宝不够！";
                br();
            }
        }
        if ($ms == 1 && $lb == 3) {
            if ($money >= $jq) {
                value::add_user_value('money', -1 * $jq, $user_id);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_money', $yl_sz_zg_money1);
                $yl_sz_3_money3 = value::get_system_value('yl_sz_3_money') + $jq;
                value::set_system_value('yl_sz_3_money', $yl_sz_3_money3);
                if ($yl_sz_sz % 2 == 0 && $bz != 3) {
                    $yl = 1;
                } else {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_money', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的金币不够！";
                br();
            }
        }
        if ($ms == 2 && $lb == 3) {
            if ($lingshi >= $jq) {
                item::add_item(1, -1 * $jq);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_lingshi', $yl_sz_zg_lingshi1);
                $yl_sz_3_money4 = value::get_system_value('yl_sz_3_lingshi') + $jq;
                value::set_system_value('yl_sz_3_lingshi', $yl_sz_3_money4);
                if ($yl_sz_sz % 2 == 0 && $bz != 3) {
                    $yl = 1;
                } else {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_lingshi', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的元宝不够！";
                br();
            }
        }
    }
    if ($lb == 1 || $lb == 2) {
        if ($ms == 1 && $lb == 2) {
            if ($money >= $jq) {
                value::add_user_value('money', -1 * $jq, $user_id);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_money', $yl_sz_zg_money1);
                $yl_sz_2_money2 = value::get_system_value('yl_sz_2_money') + $jq;
                value::set_system_value('yl_sz_2_money', $yl_sz_2_money2);
                if ($yl_sz_sz > 10 && $bz != 3) {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_money', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的金币不够！";
                br();
            }
        }
        if ($ms == 2 && $lb == 2) {
            if ($lingshi >= $jq) {
                item::add_item(1, -1 * $jq);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_lingshi', $yl_sz_zg_lingshi1);
                $yl_sz_2_money2 = value::get_system_value('yl_sz_2_lingshi') + $jq;
                value::set_system_value('yl_sz_2_lingshi', $yl_sz_2_money2);
                if ($yl_sz_sz > 10 && $bz != 3) {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_lingshi', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的元宝不够！";
                br();
            }
        }
        if ($ms == 1 && $lb == 1) {
            if ($money >= $jq) {
                value::add_user_value('money', -1 * $jq, $user_id);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_money', $yl_sz_zg_money1);
                $yl_sz_1_money1 = value::get_system_value('yl_sz_1_money') + $jq;
                value::set_system_value('yl_sz_1_money', $yl_sz_1_money1);
                if ($yl_sz_sz < 11 && $bz != 3) {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_money', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的金币不够！";
                br();
            }
        }
        if ($ms == 2 && $lb == 1) {
            if ($lingshi >= $jq) {
                item::add_item(1, -1 * $jq);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_lingshi', $yl_sz_zg_lingshi1);
                $yl_sz_1_money1 = value::get_system_value('yl_sz_1_lingshi') + $jq;
                value::set_system_value('yl_sz_1_lingshi', $yl_sz_1_money1);
                if ($yl_sz_sz < 11 && $bz != 3) {
                    $jq = $jq * 2;
                    value::add_user_value('yl_sz_lingshi', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的元宝不够！";
                br();
            }
        }
    }
    if ($lb == 5){
        if ($ms == 1 && $lb == 5) {
            if ($money >= $jq) {
                value::add_user_value('money', -1 * $jq, $user_id);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_money', $yl_sz_zg_money1);
                $yl_sz_5_money5 = value::get_system_value('yl_sz_5_money') + $jq;
                value::set_system_value('yl_sz_5_money', $yl_sz_5_money5);
                if ($bz == 3 && $bz != 3) {
                    $jq = $jq * 10;
                    value::add_user_value('yl_sz_money', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的金币不够！";
                br();
            }
        }
        if ($ms == 2 && $lb == 5) {
            if ($lingshi >= $jq) {
                item::add_item(1, -1 * $jq);
                value::set_system_value('yl_sz_zg_cs', $yl_sz_zg_cs1);
                value::set_system_value('yl_sz_zg_lingshi', $yl_sz_zg_lingshi1);
                $yl_sz_5_money5 = value::get_system_value('yl_sz_5_lingshi') + $jq;
                value::set_system_value('yl_sz_5_lingshi', $yl_sz_5_money5);
                if ($bz == 3) {
                    $jq = $jq * 10;
                    value::add_user_value('yl_sz_lingshi', $jq, $user_id);
                    value::set_user_value('yl_sz_zg_dc', $yl_sz_zg_dc, $user_id);
                }
            } else {
                echo "抱歉，你的元宝不够！";
                br();
            }
        }
    }
    cmd::addcmd('map_yl', "娱乐大厅");
    echo ">> 赌骰子游戏";
    br();
    echo "-";
    br();
    $yl_sz_zg_cs = value::get_system_value('yl_sz_zg_cs');
    $yl_sz_zg_money = value::get_system_value('yl_sz_zg_money');
    $yl_sz_zg_lingshi = value::get_system_value('yl_sz_zg_lingshi');
    $yl_sz_1_money = value::get_system_value('yl_sz_1_money');
    $yl_sz_1_lingshi = value::get_system_value('yl_sz_1_lingshi');
    $yl_sz_2_money = value::get_system_value('yl_sz_2_money');
    $yl_sz_2_lingshi = value::get_system_value('yl_sz_2_lingshi');
    $yl_sz_3_money = value::get_system_value('yl_sz_3_money');
    $yl_sz_3_lingshi = value::get_system_value('yl_sz_3_lingshi');
    $yl_sz_4_money = value::get_system_value('yl_sz_4_money');
    $yl_sz_4_lingshi = value::get_system_value('yl_sz_4_lingshi');
    $yl_sz_5_money = value::get_system_value('yl_sz_5_money');
    $yl_sz_5_lingshi = value::get_system_value('yl_sz_5_lingshi');
    $yl_sz_zg_dc = value::get_system_value('yl_sz_zg_dc');
    echo "疯狂刺激，爽，赚币多多！ <br>
    今日掷骰总次数: {$yl_sz_zg_cs} 次<br>
    今日掷骰总金额:{$yl_sz_zg_money}金币， {$yl_sz_zg_lingshi}元宝";
    br();
    echo "我随身有 {$money} 个金币， {$lingshi}个元宝！";
    br();
    echo "第{$yl_sz_zg_dc}场-";
    cmd::addcmd('yl_sz', "刷新");
    br();
    $yl_sz_sz4 = value::get_system_value('yl_sz_sz4');
    $yl_sz_sz5 = value::get_system_value('yl_sz_sz5');
    $yl_sz_sz6 = value::get_system_value('yl_sz_sz6');
    echo "上场开{$yl_sz_sz4}{$yl_sz_sz5}{$yl_sz_sz6}";
    echo "  ";
    echo "{$yl_sz_dx}{$yl_sz_ds} {$yl_sz_bz}";
    br();
    echo "<img src=res/img/yl/" . $yl_sz_sz4 . ".jpg><img src=res/img/yl/" . $yl_sz_sz5 . ".jpg><img src=res/img/yl/" . $yl_sz_sz6 . ".jpg>";
    br();
    $time_i = date('i');
    $time_s = 60 - date('s');
    if ($time_i < 1) {
        $time_i1 = 0;
    } elseif ($time_i < 10) {
        $time_i1 = 9 - $time_i;
    } elseif ($time_i < 20) {
        $time_i1 = 19 - $time_i;
    } elseif ($time_i < 30) {
        $time_i1 = 29 - $time_i;
    } elseif ($time_i < 40) {
        $time_i1 = 39 - $time_i;
    } elseif ($time_i < 50) {
        $time_i1 = 49 - $time_i;
    } else {
        $time_i1 = 59 - $time_i;
    }
    $sm_time = date("i");
    if ($sm_time < 1 || $sm_time == 10 || $sm_time == 20 || $sm_time == 30 || $sm_time == 40 || $sm_time == 50) {
        echo "还有{$time_s}秒开盅,各位客官赶快下啦买定离手咯!";
        br();
    } else {
        echo "还有{$time_i1}分{$time_s}秒开盅,各位客官赶快下啦买定离手咯!";
        br();
    }
    echo "目前买小{$yl_sz_1_money}金币  {$yl_sz_1_lingshi}元宝<br>
    目前买大{$yl_sz_2_money}金币  {$yl_sz_2_lingshi}元宝<br>
    目前买单{$yl_sz_3_money}金币  {$yl_sz_3_lingshi}元宝<br>
    目前买双{$yl_sz_4_money}金币  {$yl_sz_4_lingshi}元宝<br>
    目前买豹子{$yl_sz_5_money}金币  {$yl_sz_5_lingshi}元宝";
    br();
    echo "-";
    br();
    echo "小(1赔2)";
    cmd::addcmd('yl_sz,1,1,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_sz,2,1,100', "压元宝(100)");
    br();
    echo "大(1赔2)";
    cmd::addcmd('yl_sz,1,2,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_sz,2,2,100', "压元宝(100)");
    br();
    echo "单(1赔2)";
    cmd::addcmd('yl_sz,1,3,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_sz,2,3,100', "压元宝(100)");
    br();
    echo "双(1赔2)";
    cmd::addcmd('yl_sz,1,4,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_sz,2,4,100', "压元宝(100)");
    br();
    echo "豹子(1赔10)";
    cmd::addcmd('yl_sz,1,5,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_sz,2,5,100', "压元宝(100)");
    br();
    echo "-";
    br();
    echo ">>游戏规则：<br>小:4,5,6,7,8,9,10<br>
    大:11,12,13,14,15,16,17<br>
    单:5,7,9,11,13,15,17<br>
    双:4,6,8,10,12,14,16<br>
    豹子:三个骰子点数相同<br>
    每次赢家获得奖金95%";
    br();
    echo "-";
}

function yl_smc($ms = 0, $lb = 0, $jq = 0)
{
    $user_id = uid();
    $lingshi = item::get_lingshi();
    $money = value::get_user_value('money');
    $yl_smc_zg_cs1 = value::get_system_value('yl_smc_zg_cs') + 1;
    $yl_smc_zg_money1 = value::get_system_value('yl_smc_zg_money') + $jq;
    $yl_smc_zg_lingshi1 = value::get_system_value('yl_smc_zg_lingshi') + $jq;
    $yl_smc_xt_dc = value::get_system_value('yl_smc_xt_dc');
    $yl_smc_zg_dc = value::get_system_value('yl_smc_zg_dc');
    if ($ms == 1 && $lb > 0) {
        if ($money >= $jq) {
            value::add_user_value('money', -1 * $jq, $user_id);
            value::set_system_value('yl_smc_zg_cs', $yl_smc_zg_cs1);
            value::set_system_value('yl_smc_zg_money', $yl_smc_zg_money1);
            if ($lb == 1) {
                $yl_smc_1_money1 = value::get_system_value('yl_smc_1_money') + $jq;
                value::set_system_value('yl_smc_1_money', $yl_smc_1_money1);
            }
            if ($lb == 2) {
                $yl_smc_2_money1 = value::get_system_value('yl_smc_2_money') + $jq;
                value::set_system_value('yl_smc_2_money', $yl_smc_2_money1);
            }
            if ($lb == 3) {
                $yl_smc_3_money1 = value::get_system_value('yl_smc_3_money') + $jq;
                value::set_system_value('yl_smc_3_money', $yl_smc_3_money1);
            }
            if ($lb == 4) {
                $yl_smc_4_money1 = value::get_system_value('yl_smc_4_money') + $jq;
                value::set_system_value('yl_smc_4_money', $yl_smc_4_money1);
            }
            if ($lb == 5) {
                $yl_smc_5_money1 = value::get_system_value('yl_smc_5_money') + $jq;
                value::set_system_value('yl_smc_5_money', $yl_smc_5_money1);
            }
            if ($lb == 6) {
                $yl_smc_6_money1 = value::get_system_value('yl_smc_6_money') + $jq;
                value::set_system_value('yl_smc_6_money', $yl_smc_6_money1);
            }
            if ($lb == $yl_smc_xt_dc) {
                $jq = $jq * 5;
                value::add_user_value('yl_smc_money', $jq, $user_id);
                value::set_user_value('yl_smc_zg_dc', $yl_smc_zg_dc, $user_id);
            }
        } else {
            echo "抱歉，你的金币不够！";
            br();
        }
    }
    if ($ms == 2 && $lb > 0) {
        if ($lingshi >= $jq) {
            item::add_item(1, -1 * $jq);
            value::set_system_value('yl_smc_zg_cs', $yl_smc_zg_cs1);
            value::set_system_value('yl_smc_zg_lingshi', $yl_smc_zg_lingshi1);
            if ($lb == 1) {
                $yl_smc_1_money1 = value::get_system_value('yl_smc_1_lingshi') + $jq;
                value::set_system_value('yl_smc_1_lingshi', $yl_smc_1_money1);
            }
            if ($lb == 2) {
                $yl_smc_2_money1 = value::get_system_value('yl_smc_2_lingshi') + $jq;
                value::set_system_value('yl_smc_2_lingshi', $yl_smc_2_money1);
            }
            if ($lb == 3) {
                $yl_smc_3_money1 = value::get_system_value('yl_smc_3_lingshi') + $jq;
                value::set_system_value('yl_smc_3_lingshi', $yl_smc_3_money1);
            }
            if ($lb == 4) {
                $yl_smc_4_money1 = value::get_system_value('yl_smc_4_lingshi') + $jq;
                value::set_system_value('yl_smc_4_lingshi', $yl_smc_4_money1);
            }
            if ($lb == 5) {
                $yl_smc_5_money1 = value::get_system_value('yl_smc_5_lingshi') + $jq;
                value::set_system_value('yl_smc_5_lingshi', $yl_smc_5_money1);
            }
            if ($lb == 6) {
                $yl_smc_6_money1 = value::get_system_value('yl_smc_6_lingshi') + $jq;
                value::set_system_value('yl_smc_6_lingshi', $yl_smc_6_money1);
            }
            if ($lb == $yl_smc_xt_dc) {
                $jq = $jq * 5;
                value::add_user_value('yl_smc_lingshi', $jq, $user_id);
                value::set_user_value('yl_smc_zg_dc', $yl_smc_zg_dc, $user_id);
            }
        } else {
            echo "抱歉，你的元宝不够！";
            br();
        }
    }
    cmd::addcmd('map_yl', "娱乐大厅");
    echo ">> 赛马场游戏";
    br();
    echo "-";
    br();
    $yl_smc_zg_dc = value::get_system_value('yl_smc_zg_dc');
    $yl_smc_zg_cs = value::get_system_value('yl_smc_zg_cs');
    $yl_smc_zg_money = value::get_system_value('yl_smc_zg_money');
    $yl_smc_1_money = value::get_system_value('yl_smc_1_money');
    $yl_smc_2_money = value::get_system_value('yl_smc_2_money');
    $yl_smc_3_money = value::get_system_value('yl_smc_3_money');
    $yl_smc_4_money = value::get_system_value('yl_smc_4_money');
    $yl_smc_5_money = value::get_system_value('yl_smc_5_money');
    $yl_smc_6_money = value::get_system_value('yl_smc_6_money');
    $yl_smc_1_lingshi = value::get_system_value('yl_smc_1_lingshi');
    $yl_smc_2_lingshi = value::get_system_value('yl_smc_2_lingshi');
    $yl_smc_3_lingshi = value::get_system_value('yl_smc_3_lingshi');
    $yl_smc_4_lingshi = value::get_system_value('yl_smc_4_lingshi');
    $yl_smc_5_lingshi = value::get_system_value('yl_smc_5_lingshi');
    $yl_smc_6_lingshi = value::get_system_value('yl_smc_6_lingshi');
    $yl_smc_zg_lingshi = value::get_system_value('yl_smc_zg_lingshi');
    echo "疯狂刺激，爽，赚币多多！ <br>
    今日投注总次数: {$yl_smc_zg_cs} 次<br>
    今日投注总金额:{$yl_smc_zg_money}金币， {$yl_smc_zg_lingshi}元宝";
    br();
    echo "我随身有 {$money} 个金币， {$lingshi}个元宝！";
    br();
    echo "第{$yl_smc_zg_dc}场-";
    cmd::addcmd('yl_smc', "刷新");
    br();
    $yl_smc_xt_dc1 = value::get_system_value('yl_smc_xt_dc1');
    echo "上场开{$yl_smc_xt_dc1}号马";
    br();
    echo "<img src=res/img/yl/" . $yl_smc_xt_dc1 . ".gif>";
    br();
    $time_i = date('i');
    $time_s = 60 - date('s');
    if ($time_i <= 10) {
        $time_i1 = 9 - $time_i;
    } elseif ($time_i <= 20) {
        $time_i1 = 19 - $time_i;
    } elseif ($time_i <= 30) {
        $time_i1 = 29 - $time_i;
    } elseif ($time_i <= 40) {
        $time_i1 = 39 - $time_i;
    } elseif ($time_i <= 50) {
        $time_i1 = 49 - $time_i;
    } else {
        $time_i1 = 59 - $time_i;
    }
    $sm_time = date("i");
    if ($sm_time < 1 || $sm_time == 10 || $sm_time == 20 || $sm_time == 30 || $sm_time == 40 || $sm_time == 50) {
        echo "还有{$time_s}秒开赛!";
        br();
    } else {
        echo "还有{$time_i1}分{$time_s}秒开赛!";
        br();
    }
    echo "<img src='res/img/yl/dm.gif'>";
    br();
    echo "压1号马共{$yl_smc_1_money}金币  共{$yl_smc_1_lingshi}元宝<br>
    压2号马共{$yl_smc_2_money}金币  共{$yl_smc_2_lingshi}元宝<br>
    压3号马共{$yl_smc_3_money}金币  共{$yl_smc_3_lingshi}元宝<br>
    压4号马共{$yl_smc_4_money}金币  共{$yl_smc_4_lingshi}元宝<br>
    压5号马共{$yl_smc_5_money}金币  共{$yl_smc_5_lingshi}元宝<br>
    压6号马共{$yl_smc_6_money}金币  共{$yl_smc_6_lingshi}元宝";
    br();
    echo "-";
    br();
    echo "1号马(1赔5)";
    cmd::addcmd('yl_smc,1,1,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_smc,2,1,100', "压元宝(100)");
    br();
    echo "2号马(1赔5)";
    cmd::addcmd('yl_smc,1,2,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_smc,2,2,100', "压元宝(100)");
    br();
    echo "3号马(1赔5)";
    cmd::addcmd('yl_smc,1,3,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_smc,2,3,100', "压元宝(100)");
    br();
    echo "4号马(1赔5)";
    cmd::addcmd('yl_smc,1,4,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_smc,2,4,100', "压元宝(100)");
    br();
    echo "5号马(1赔5)";
    cmd::addcmd('yl_smc,1,5,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_smc,2,5,100', "压元宝(100)");
    br();
    echo "6号马(1赔5)";
    cmd::addcmd('yl_smc,1,6,1000', "压金币(1000)");
    echo "   ";
    cmd::addcmd('yl_smc,2,6,100', "压元宝(100)");
    br();
    echo "-";
    br();
    echo ">>游戏规则：<br>1.每隔10分钟开赛<br>
    2.压中点数赔对应的倍数<br>
    3.每次赢家获得奖金95%";
    br();
    echo "-";
}

function yl1($ms = 0, $lb = 0, $jq = 100, $zd = 0)
{
    $user_id = uid();
    $lingshi = item::get_lingshi();
    $money = value::get_user_value('money');
    $yl_zjd_zg_cs = value::get_system_value('yl_zjd_zg_cs') + 1;
    $yl_zjd_zg_money = value::get_system_value('yl_zjd_zg_money') + $jq;
    $yl_zjd_zg_lingshi = value::get_system_value('yl_zjd_zg_lingshi') + $jq;
    if ($ms == 0 && $zd > 0) {
        if ($money >= $jq) {
            value::add_user_value('money', -1 * $jq, $user_id);
            value::set_system_value('yl_zjd_zg_cs', $yl_zjd_zg_cs);
            value::set_system_value('yl_zjd_zg_money', $yl_zjd_zg_money);
            $sj = mt_rand(1, 8);
            if ($zd == $sj) {
                $jq = $jq * 6;
                value::add_user_value('money', $jq, $user_id);
                value::add_user_value('yl_money', $jq, $user_id);
                echo "恭喜您，砸中金蛋，赚了{$jq}个金币！";
                $name = value::get_game_user_value('name', $user_id);
                c_add_guangbo("恭喜玩家{$name}，在砸金蛋幸运砸中金蛋，赚了{$jq}个金币！");
                $jq = $jq / 6;
                br();
            } else {
                echo "抱歉，亏了{$jq}个金币,<img src='res/img/yl/egg.gif'>居然在{$sj}号里面！";
                br();
            }
        } else {
            echo "抱歉，你的金币不够了！";
            br();
        }
    }
    if ($ms == 1 && $zd > 0) {
        if ($lingshi >= $jq) {
            item::add_item(1, -1 * $jq);
            value::set_system_value('yl_zjd_zg_cs', $yl_zjd_zg_cs);
            value::set_system_value('yl_zjd_zg_lingshi', $yl_zjd_zg_lingshi);
            $sj = mt_rand(1, 8);
            if ($zd == $sj) {
                $jq = $jq * 6;
                item::add_item(1, $jq);
                value::add_user_value('yl_lingshi', $jq, $user_id);
                echo "恭喜您，砸中金蛋，赚了{$jq}个元宝！";
                $name = value::get_game_user_value('name', $user_id);
                c_add_guangbo("恭喜玩家{$name}，在砸金蛋幸运砸中金蛋，赚了{$jq}个元宝！");
                $jq = $jq / 6;
                br();
            } else {
                echo "抱歉，亏了{$jq}个元宝,<img src='res/img/yl/egg.gif'>居然在{$sj}号里面！";
                br();
            }
        } else {
            echo "抱歉，你的元宝不够了！";
            br();
        }
    }
    cmd::addcmd('map_yl', "娱乐大厅");
    echo ">> 砸金蛋";
    br();
    echo "<img src='br.jpg'>";
    br();
    $yl_zjd_zg_cs = value::get_system_value('yl_zjd_zg_cs');
    $yl_zjd_zg_money = value::get_system_value('yl_zjd_zg_money');
    $yl_zjd_zg_lingshi = value::get_system_value('yl_zjd_zg_lingshi');
    echo "高赔率，快速致富的好途径！<br>
    今玩家总人次:{$yl_zjd_zg_cs} 次/总金额:{$yl_zjd_zg_money}金币,{$yl_zjd_zg_lingshi}元宝<br>
    我随身有 {$money} 个金币，{$lingshi} 个元宝！ ";
    br();
    if ($ms != 0) {
        cmd::addcmd('yl1,0,' . $lb . ',' . $jq, "金币区");
    } else {
        echo "金币区";
    }
    echo " | ";
    if ($ms != 1) {
        cmd::addcmd('yl1,1,' . $lb . ',' . $jq, "元宝区");
    } else {
        echo "元宝区";
    }
    br();
    echo "<img src='res/img/yl/egg.gif'>里面有粪土跟金蛋！砸到金蛋便能得到奖励！赔率1:6！";
    if ($lb == 0) {
        echo "贫民区";
    }
    if ($lb == 1) {
        echo "居民区";
    }
    if ($lb == 2) {
        echo "贵族区";
    }
    echo "需" . $jq;
    if ($ms == 0) {
        echo "金币!";
    }
    if ($ms == 1) {
        echo "元宝!";
    }
    br();
    if ($lb != 0) {
        cmd::addcmd('yl1,' . $ms . ',0,100', "贫民区");
    } else {
        echo "贫民区";
    }
    echo "  .  ";
    if ($lb != 1) {
        cmd::addcmd('yl1,' . $ms . ',1,500', "居民区");
    } else {
        echo "居民区";
    }
    echo "  .  ";
    if ($lb != 2) {
        cmd::addcmd('yl1,' . $ms . ',2,1000', "贵族区");
    } else {
        echo "贵族区";
    }
    br();
    echo "-";
    br();
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',1', "1号<img src='res/img/yl/egg.gif'>");
    echo "  .  ";
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',2', "2号<img src='res/img/yl/egg.gif'>");
    br();
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',3', "3号<img src='res/img/yl/egg.gif'>");
    echo "  .  ";
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',4', "4号<img src='res/img/yl/egg.gif'>");
    br();
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',5', "5号<img src='res/img/yl/egg.gif'>");
    echo "  .  ";
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',6', "6号<img src='res/img/yl/egg.gif'>");
    br();
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',7', "7号<img src='res/img/yl/egg.gif'>");
    echo "  .  ";
    cmd::addcmd('yl1,' . $ms . ',' . $lb . ',' . $jq . ',8', "8号<img src='res/img/yl/egg.gif'>");
    br();
    echo "-";
    br();
    echo ">>游戏规则：付一定的费用进行游戏，您就可以拿起锤子狠狠的砸八个蛋中的任意一个蛋了，蛋里面随机出现粪土跟金蛋，砸到粪土血本无归，砸到金蛋返回对应倍数奖金！";
    br();
}

function yl_jj($ms = 0, $lb = 0, $jq = 100)
{
    $user_id = uid();
    $lingshi = item::get_lingshi();
    $money = value::get_user_value('money');
    $yl_jj_zg_cs1 = value::get_system_value('yl_jj_zg_cs') + 1;
    $yl_jj_zg_money1 = value::get_system_value('yl_jj_zg_money') + $jq;
    $yl_jj_zg_lingshi1 = value::get_system_value('yl_jj_zg_lingshi') + $jq;
    if ($ms == 1) {
        $item_297_name = value::get_item_value(297, 'name');   
        if ($money >= $jq) {
            item::add_item(297, $lb);
            item::add_money(-1 * $jq, $user_id);
            value::set_system_value('yl_jj_zg_cs', $yl_jj_zg_cs1);
            value::set_system_value('yl_jj_zg_money', $yl_jj_zg_money1);
        } else {
            echo "你没有{$jq}金币购买{$item_297_name}*{$lb}！";
            br();
        }
    }
    if ($ms == 2) {
        $item_298_name = value::get_item_value(298, 'name');   
        if ($lingshi >= $jq) {
            item::add_item(298, $lb);
            item::add_item(1, -1 * $jq);
            value::set_system_value('yl_jj_zg_cs', $yl_jj_zg_cs1);
            value::set_system_value('yl_jj_zg_lingshi', $yl_jj_zg_lingshi1);
        } else {
            echo "你没有{$jq}元宝购买{$item_298_name}*{$lb}！";
            br();
        }
    }
    cmd::addcmd('map_yl', "娱乐大厅");
    echo ">> 奖券抽奖";
    br();
    echo "-";
    br();
    $yl_jj_zg_cs = value::get_system_value('yl_jj_zg_cs');
    $yl_jj_zg_money = value::get_system_value('yl_jj_zg_money');
    $yl_jj_zg_lingshi = value::get_system_value('yl_jj_zg_lingshi');
    echo "高赔率，快速致富的好途径！<br>
    今日玩家总次数:{$yl_jj_zg_cs} 次<br>
    今日抽奖总金额:{$yl_jj_zg_money}金币， {$yl_jj_zg_lingshi}元宝";
    br();
    echo "-";
    br();
    $item_297_name = value::get_item_value(297, 'name');      
    $item_298_name = value::get_item_value(298, 'name');   
    echo $item_297_name;
    echo "：(100金币*1) ";
    cmd::addcmd('yl_jj,1,1,100', "购1");
    echo "  ";
    cmd::addcmd('yl_jj,1,5,500', "购5");
    echo "  ";
    cmd::addcmd('yl_jj,1,10,1000', "购10");
    echo "  ";
    br();
    echo $item_298_name;
    echo "：(100元宝*1) ";
    cmd::addcmd('yl_jj,2,1,100', "购1");
    echo "  ";
    cmd::addcmd('yl_jj,2,5,500', "购5");
    echo "  ";
    cmd::addcmd('yl_jj,2,10,1000', "购10");
    echo "  ";
    br();
    echo "-";
    br();
    echo "奖项：1等 : 100 万 2等： 20 万 3等 : 10 万 4等 : 1 万 5等 : 1000  6等 : 500 ";
    br();
    echo "-";
}

function yl_jj_jg()
{
    $user_id = uid();
    $sj = mt_rand(1, 1000000);
    if ($sj <= 5) {
        $sji = 1000000;
        $sji1 = "1等奖";
    } else if ($sj <= 20) {
        $sji = 200000;
        $sji1 = "2等奖";
    } else if ($sj <= 50) {
        $sji = 100000;
        $sji1 = "3等奖";
    } else if ($sj <= 1000) {
        $sji = 10000;
        $sji1 = "4等奖";
    } else if ($sj <= 20000) {
        $sji = 1000;
        $sji1 = "5等奖";
    } else if ($sj <= 100000) {
        $sji = 500;
        $sji1 = "6等奖";
    } else {
        $sji = 0;
    }
    $item_297_name = value::get_item_value(297, 'name');  
    if ($sji) {
        item::add_money($sji, $user_id);
        value::add_user_value('yl_money', $sji, $user_id);
        c_add_guangbo("恭喜玩家,使用{$item_297_name}中了{$sji1}奖励{$sji}金币!");
    } else { 
        echo "你使用了{$item_297_name}没有中奖！";
    }
    br();
}

function yl_jj_jg1()
{
    $user_id = uid();
    $sj = mt_rand(1, 1000000);
    if ($sj <= 5) {
        $sji = 1000000;
        $sji1 = "1等奖";
    } else if ($sj <= 20) {
        $sji = 200000;
        $sji1 = "2等奖";
    } else if ($sj <= 50) {
        $sji = 100000;
        $sji1 = "3等奖";
    } else if ($sj <= 1000) {
        $sji = 10000;
        $sji1 = "4等奖";
    } else if ($sj <= 5000) {
        $sji = 1000;
        $sji1 = "5等奖";
    } else if ($sj <= 10000) {
        $sji = 500;
        $sji1 = "6等奖";
    } else {
        $sji = 0;
    }
    $item_298_name = value::get_item_value(298, 'name');   
    if ($sji) {
        item::add_item(1, $sji);
        value::add_user_value('yl_lingshi', $sji, $user_id);
        c_add_guangbo("恭喜玩家,使用{$item_298_name}中了{$sji1}奖励{$sji}元宝!");
    } else {
        echo "你使用了{$item_298_name}没有中奖！";
    }
    br();
}

function sy_dy_xg($user_id, $item_id)
{
    $user_id = uid();
    $item_name = value::get_item_value($item_id, 'name');  
    item::add_item($item_id, 1);
    if ($item_id == 301) {
        $sy_dy_301 = value::get_user_value('sy_dy_301', $user_id);
        if ($sy_dy_301 < 100) {
            value::add_user_value('sy_dy_301', 1, $user_id);
            value::add_game_user_value('pugong', 20, $user_id);
            value::add_game_user_value('tegong', 20, $user_id);
            value::add_game_user_value('pufang', 10, $user_id);
            value::add_game_user_value('tefang', 10, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+20双攻+10双防效果!";
        } else { 
            echo "你已经使用了100个{$item_name}，不能再使用了！";
        }
    }
    if ($item_id == 302) {
        $sy_dy_302 = value::get_user_value('sy_dy_302', $user_id);
        if ($sy_dy_302 < 100) {
            value::add_user_value('sy_dy_302', 1, $user_id);
            value::add_game_user_value('pugong', 40, $user_id);
            value::add_game_user_value('tegong', 40, $user_id);
            value::add_game_user_value('pufang', 20, $user_id);
            value::add_game_user_value('tefang', 20, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+40双攻+20双防效果!";
        } else { 
            echo "你已经使用了100个{$item_name}，不能再使用了！";
        }
    }
    if ($item_id == 508) {
        $sy_dy_508 = value::get_user_value('sy_dy_508', $user_id);
        if ($sy_dy_508 < 100) {
            value::add_user_value('sy_dy_508', 1, $user_id);
            value::add_game_user_value('pugong', 25, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+25物攻效果!";
        } else { 
            echo "你已经使用了100个{$item_name}，不能再使用了！";
        }
    }
    if ($item_id == 509) {
        $sy_dy_509 = value::get_user_value('sy_dy_509', $user_id);
        if ($sy_dy_509 < 100) {
            value::add_user_value('sy_dy_509', 1, $user_id);
            value::add_game_user_value('tegong', 25, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+25法攻效果!";
        } else { 
            echo "你已经使用了100个{$item_name}，不能再使用了！";
        }
    }
    if ($item_id == 510) {
        $sy_dy_510 = value::get_user_value('sy_dy_510', $user_id);
        if ($sy_dy_510 < 100) {
            value::add_user_value('sy_dy_510', 1, $user_id);
            value::add_game_user_value('tefang', 12, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+12法防效果!";
        } else { 
            echo "你已经使用了100个{$item_name}，不能再使用了！";
        }
    }
    if ($item_id == 511) {
        $sy_dy_511 = value::get_user_value('sy_dy_511', $user_id);
        if ($sy_dy_511 < 100) {
            value::add_user_value('sy_dy_511', 1, $user_id);
            value::add_game_user_value('pufang', 12, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+12物防效果!";
        } else { 
            echo "你已经使用了100个{$item_name}，不能再使用了！";
        }
    }
    if ($item_id == 512) {
        $sy_dy_512 = value::get_user_value('sy_dy_512', $user_id);
        if ($sy_dy_512 < 100) {
            value::add_user_value('sy_dy_512', 1, $user_id);
            value::add_game_user_value('jd_hp', 25, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+25血效果!";
        } else { 
            echo "你已经使用了100个{$item_name}，不能再使用了！";
        }
    }
    if ($item_id == 513) {
        $sy_dy_513 = value::get_user_value('sy_dy_513', $user_id);
        if ($sy_dy_513 < 10) {
            value::add_user_value('sy_dy_513', 1, $user_id);
            value::add_game_user_value('pugong', 500, $user_id);
            value::add_game_user_value('tegong', 500, $user_id);
            value::add_game_user_value('pufang', 250, $user_id);
            value::add_game_user_value('tefang', 250, $user_id);
            item::add_item($item_id, -1);
            echo "你使用{$item_name}增加了+500双攻+250双防效果!";
        } else { 
            echo "你已经使用了10个{$item_name}，不能再使用了！";
        }
    }
    br();
}

function map_hd($lb = 0)
{
    $user_id = uid();
    echo "活动专区：";
    br();
    echo "-";
    br();
    cmd::addcmd('hd_txdy', '1、天下第一');
    echo "  ";
    echo "时间：18:45~ 19:15";
    br();
    cmd::addcmd('hd_wlzb_1', '2、竞技擂台');
    echo "  ";
    echo "时间：19:30~ 20:00";
    br();
    cmd::addcmd('hd_rxgc_1', '3、<img src=res/img/ch/hot.gif>热血攻城');
    echo "  ";
    echo "时间：20:00~ 21:00";
    br();
    cmd::addcmd('hd_tg1', '4、进群领取奖励');
    br();
    cmd::addcmd('hd_tg2', '5、推荐玩家奖励');
    br();
    cmd::addcmd('hd_tg3', '6、宣传游戏奖励');
    br();
    cmd::addcmd('hd_tg4', '7、全民找茬奖励');
    br();
    cmd::addcmd('e452', '8、寻幸运宝箱');
    br();
    cmd::addcmd('e452_kt', '9、寻空投物资');
    br();
    cmd::addcmd('lz_e452', '10、寻找七龙珠');
    br();
    cmd::addcmd('hd_sx_e452', '11、寻十二生肖');
    br();
    cmd::addcmd('hd_xy_e452', '12、成幸运玩家');
    br();
    echo "-";
}

function hd_hyd()
{
    $user_id = uid();
    $hd_hyd_sz1 = value::get_user_value('1.hd_hyd_sz', $user_id);
    $hd_hyd_sz2 = value::get_user_value('2.hd_hyd_sz', $user_id);
    $hd_hyd_sz3 = value::get_user_value('3.hd_hyd_sz', $user_id);
    $hd_hyd_sz4 = value::get_user_value('4.hd_hyd_sz', $user_id);
    $hd_hyd_sz5 = value::get_user_value('5.hd_hyd_sz', $user_id);
    $hd_hyd_sz6 = value::get_user_value('6.hd_hyd_sz', $user_id);
    $hd_hyd_sz7 = value::get_user_value('7.hd_hyd_sz', $user_id);
    $hd_hyd_sz8 = value::get_user_value('8.hd_hyd_sz', $user_id);
    $hd_hyd_sz9 = value::get_user_value('9.hd_hyd_sz', $user_id);
    $hd_hyd_sz10 = value::get_user_value('10.hd_hyd_sz', $user_id);
    $hd_hydz = value::get_user_value('hd_hydz', $user_id);
    cmd::addcmd('map_hd', '活动');
    echo ">> 活跃度";
    $hyd_vip_lq = value::get_user_value('hyd_vip_lq_lq', $user_id);
    $time_d = date("d");
    if ($hyd_vip_lq != $time_d) {
        echo ' . ';
        $vip_lvl = user::getVipLvl($user_id);
        cmd::addcmd('hyd_vip_lq,' . $vip_lvl, "vip领取");
    }
    br();
    echo "-";
    br();
    echo "活跃度:<span style=color:green>{$hd_hydz}</span>";
    br();
    br();
    echo "参加天下第一(<span style=color:green>{$hd_hyd_sz1}</span>/10活跃度)<br>
    参加热血攻城(<span style=color:green>{$hd_hyd_sz2}</span>/10活跃度)<br>
    参加经验秘境(<span style=color:green>{$hd_hyd_sz3}</span>/5活跃度)<br>
    参加羽翼试练(<span style=color:green>{$hd_hyd_sz4}</span>/5活跃度)<br>
    挑战一次天梯(<span style=color:green>{$hd_hyd_sz5}</span>/5活跃度)<br>
    参加一次竞技(<span style=color:green>{$hd_hyd_sz6}</span>/5活跃度)<br>
    击杀一次十二生肖(<span style=color:green>{$hd_hyd_sz7}</span>/10活跃度)<br>
    击杀一次七龙珠(<span style=color:green>{$hd_hyd_sz8}</span>/10活跃度)<br>
    击杀10只任意boss(<span style=color:green>{$hd_hyd_sz9}</span>/20活跃度)<br>
    击杀2000只任意nbc(<span style=color:green>{$hd_hyd_sz10}</span>/20活跃度)";
    br();
    br();
    echo "任务每天24:00重置，活跃度不清空";
    br();
    echo "-";
}

function hyd_vip_lq($lb = 0)
{
    cmd::addcmd('map_hd', '活动');
    echo ">> 活跃度";
    br();
    $user_id = uid();
    $time_d = date("d");
    if ($lb) {
        $lb = user::getVipLvl($user_id);
        if ($lb < 6) {
            $sji = 50;
        } else if ($sj < 11) {
            $sji = 100;
        } else if ($sj < 16) {
            $sji = 150;
        } else if ($sj < 26) {
            $sji = 200;
        } else if ($sj < 31) {
            $sji = 250;
        } else {
            $sji = 300;
        }
        value::set_user_value('hyd_vip_lq_lq', $time_d, $user_id);
        value::add_user_value('hd_hydz', $sji, $user_id);
        echo "你领取了{$sji}活跃度！";
        br();
    } else {
        echo "你还不是vip，vip才能领取！";
        br();
    }
}
function hd_wlzb_1($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo " . ";
    echo "竞技争霸";
    echo " . ";
    cmd::addcmd('hd_wlzb_1,1', '奖励介绍');
    br();
    echo "-";
    br();
    if ($lb) {
        echo "擂主获得称号：<img src=res/img/ch/lzbz.png>,奖励天外神铁*8，升星石ⅹ1000<br>

        第2名天外神铁*5，升星石ⅹ800<br>
        
        第3~5名天外神铁*3，升星石x500<br>
        
        第5~12名天外神铁*2，升星石ⅹ300<br>
        
        第12~20名天外神铁*1，升星石x200<br>
        
        20名以后，参与奖升星石x200";
        br();
    } else {
        $wlmz_id = value::get_system_value('wlmz_id');
    $name = value::get_game_user_value('name', $wlmz_id);
    echo "竞技擂主：";
    if ($wlmz_id) {
        cmd::addcmd('e12,' . $wlmz_id, $name);
    } else {
        echo "无";
    }
    br(); 
    echo "竞技霸主是在传奇中享受极高威���的任务，可以发号施令，召集武林人士共同商议大事，具有一统江湖的能力，并能最终成就霸业。";
    br();
    echo "-";
    br();
    cmd::addcmd('e206', '排行');
    echo " . ";
    cmd::addcmd('e206', '领奖');
    br();
    echo "-";
    br();
    cmd::addcmd('hd_wlzb_9,1', '参与华山论剑');
    br();
    echo "-";
    br();
    cmd::addcmd('e33', '兑换');
    echo " . ";
    cmd::addcmd('e28', '治疗');
    echo " . ";
    cmd::addcmd('e34', '押注');
    echo " . ";
    cmd::addcmd('e26', '存钱');
    br();
    }
    echo "-";
}

function hd_wlzb_9($lb = 0)
{
    $user_id = uid();
    $time_i = date("i");
    $time_h = date("H");
    cmd::addcmd('map_hd', '活动');
    echo ">> 竞技争霸";
    br();
    echo "-";
    br();
    if ($lb > 0) {
        if ($time_h == 19 && $time_i >= 20) {
            echo "你已经进入参赛地图，等待19:30整开始比武！";
            br();
            value::set_game_user_value('in_map_id', 5565, $user_id);
        } else {
            echo "参赛时间不对，请19:30以后开赛！";
        }
    }
    br(); 
    echo "-";
}

function hd_wlzb_10()
{
    $user_id = uid();
    $pkjjzt = user::get('pkjjzt');
    if ($pkjjzt < 1) {
        $user_id = uid();
        echo "论剑者：";
        $in_map_id = value::get_game_user_value("in_map_id");
        //获取地图在线玩家语句
        //普通方式
        $sql = "SELECT `id`,`name` FROM `game_user` WHERE `id`!='{$user_id}' AND `name`!='' AND `is_online` =1 AND `in_map_id` =5565 ";
        $ucount = 0;
        //开始获取在线玩家
        if ($sql) {
            $result = sql($sql);
            while (list($oid, $oname) = $result->fetch_row()) {
                $ucount++;
                cmd::addcmd('e204,' . $oid, "竞技者");
                echo "，";
            }
        }
        if (!$ucount) {
            echo "当前没有玩家可以挑战!";
        }
        br();
    }
}

function hd_txdy($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 天下第一";
    br();
    echo "-";
    br();
    $txdy_id1 = value::get_system_value('txdy_id1');
    $name1 = value::get_game_user_value('name', $txdy_id1);
    echo "<img src=res/img/ch/txdy1.gif><br>第一战士:【";
    if ($txdy_id1) {
        cmd::addcmd('e12,' . $txdy_id1, $name1);
    } else {
        echo "暂无";
    }
    echo "】  ";
    cmd::addcmd('hd_txdy1,1', '参与');
    br(); 
    br(); 
    $txdy_id2 = value::get_system_value('txdy_id2');
    $name2 = value::get_game_user_value('name', $txdy_id2);
    echo "<img src=res/img/ch/txdy2.gif><br>第一道士:【";
    if ($txdy_id2) {
        cmd::addcmd('e12,' . $txdy_id2, $name2);
    } else {
        echo "暂无";
    }
    echo "】  ";
    cmd::addcmd('hd_txdy1,2', '参与');
    br(); 
    br(); 
    $txdy_id3 = value::get_system_value('txdy_id3');
    $name3 = value::get_game_user_value('name', $txdy_id3);
    echo "<img src=res/img/ch/txdy3.gif><br>第一法师:【";
    if ($txdy_id3) {
        cmd::addcmd('e12,' . $txdy_id3, $name3);
    } else {
        echo "暂无";
    }
    echo "】  ";
    cmd::addcmd('hd_txdy1,3', '参与');
    br();
    echo "-";
    br(); 
    echo "报名时间：18:50开始进入比武场<br>
    开始时间：19:00比武场玩家相互厮杀<br>
    结束时间：19:15比武场剩下最后一名玩家获得奖励天下第一称号，专属职业时装神器一把<br>";
    echo "<span style=color:red>活动副本，pk不计算红名，不会掉物品<br>
    所有参与的玩家，比赛开始都会有一份参与大礼包</span>";
    br();
    echo "-";
}

function hd_txdy1($lb = 0)
{
    $user_id = uid();
    $zhiye = value::get_game_user_value('zhiye', $user_id);
    $time_i = date("i");
    $time_h = date("H");
    cmd::addcmd('map_hd', '活动');
    echo ">> 天下第一";
    br();
    echo "-";
    br();
    if ($lb == 1) {
        if ($lb == 1 && $zhiye == "战士") {
            if ($time_h == 18 && $time_i > 49) {
                echo "你已经进入参赛地图，等待19点整开始比武！";
                br();
                value::set_game_user_value('in_map_id', 5361, $user_id);
            } else {
                echo "参赛时间不对，请18:50-18:59再来报名参赛！";
            }
        } else {
            echo "你的职业不符合参赛要求，重新选择对应职业参赛！";
        }
    }
    if ($lb == 2) {
        if ($lb == 2 && $zhiye == "道士") {
            if ($time_h == 18 && $time_i > 49) {
                echo "你已经进入参赛地图，等待19点整开始比武！";
                br();
                value::set_game_user_value('in_map_id', 5362, $user_id);
            } else {
                echo "参赛时间不对，请18:50-18:59再来报名参赛！";
            }
        } else {
            echo "你的职业不符合参赛要求，重新选择对应职业参赛！";
        }
    }
    if ($lb == 3) {
        if ($lb == 3 && $zhiye == "法师") {
            if ($time_h == 18 && $time_i >= 49) {
                echo "你已经进入参赛地图，等待19点整开始比武！";
                br();
                value::set_game_user_value('in_map_id', 5363, $user_id);
            } else {
                echo "参赛时间不对，请18:50-18:59再来报名参赛！";
            }
        } else {
            echo "你的职业不符合参赛要求，重新选择对应职业参赛！";
        }
    }
    br(); 
    echo "-";
}

function hd_wlzb_2($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 竞技争霸";
    br();
    echo "-";
    br();
    $wlmz_id = value::get_system_value('wlmz_id');
    $name = value::get_game_user_value('name', $wlmz_id);
    echo "竞技擂主：";
    if ($wlmz_id) {
        cmd::addcmd('e12,' . $wlmz_id, $name);
    } else {
        echo "无";
    }
    br(); 
    echo "武林盟主是在武林中享受极高威望的任务，可以发号施令，召集武林人士共同商议大事，具有一统江湖的能力，并能最终成就霸业。";
    br(); 
    echo "获得武林盟主称号的条件：";
    br(); 
    echo "1、获得积分排行第一：";
    cmd::addcmd('e206', '排行');
    br();
    $wlmz_time_h = date("H");
    $wlmz_time_h_ts = 24 - $wlmz_time_h;
    $sql = "SELECT `id`,`jingji.jifen` FROM `game_user` WHERE `jingji.jifen` >0 AND `name`!='' ORDER BY `jingji.jifen` DESC,`is_online` DESC LIMIT 0,1 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $name1 = value::get_game_user_value('name', $oid);
    }
    echo "2、剩余{$wlmz_time_h_ts}小时{$name1}将成为武林盟主。";
    br(); 
    echo "3、获得称号：";
    $nick_name = "<img src=res/img/ch/lzbz.png>";
    cmd::addcmd('e54,' . $nick_name, $nick_name);
    br(); 
    echo "4、获得大量福利奖励。";
    br(); 
    cmd::addcmd('e32', '挑战玩家:');
    br();
    cmd::addcmd('e33', '兑换');
    echo "  .   ";
    cmd::addcmd('e28', '治疗');
    br();
    cmd::addcmd('e34', '押注');
    echo "  .   ";
    cmd::addcmd('e26', '存钱');
    br();
    echo "-";
}

function hd_rxgc_1($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 热血攻城";
    br();
    echo "-";
    br();
    if (!$lb) {
        $name1 = "";
        $wlmz_id = value::get_system_value('gczz_id');
        $name = value::get_game_user_value('name', $wlmz_id);
        echo "攻城城主：";
        if ($wlmz_id) {
            cmd::addcmd('e12,' . $gccz_id, $name);
        } else {
            echo "无";
        }
        br(); 
        echo "攻城战伤害排名榜：";
        cmd::addcmd('gc_shbx', '排行');
        echo " . ";
        cmd::addcmd('gc_shbx', '奖励');
        br();
        $wlmz_time_h = date("H");
        $wlmz_time_h_ts = 21 - $wlmz_time_h;
        $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.gwgc_sh' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,1 ";
        $result = sql($sql);
        while (list($oid, $ovalue) = $result->fetch_row()) {
            $name1 = value::get_game_user_value('name', $oid);
        }
        if (!$name1) {
            $name1 = "暂无玩家";
        }
        echo "时间：剩余{$wlmz_time_h_ts}小时{$name1}将成为攻城城主";
        br(); 
        echo "开始时间：每晚20:00~21:00";
        br(); 
        echo "-";
        br();
        if ($wlmz_time_h == 20) {
            cmd::addcmd('map_cs_id1,5039', '开始攻城');
            br();
        } else {
            cmd::addcmd('hd_rxgc_1,2', '开始攻城');
            br();
        } 
        cmd::addcmd('hd_rxgc_1,1', '攻城介绍');
        br();
        cmd::addcmd('map_jb_gj_gw', '金币攻击鼓舞');
        br();
        cmd::addcmd('map_yb_gj_gw', '元宝攻击鼓舞');
        br();
        cmd::addcmd('map_jb_fy_gw', '金币防御鼓舞');
        br();
        cmd::addcmd('map_yb_fy_gw', '元宝防御鼓舞');
        br();
        cmd::addcmd('gc_ryjf', '荣耀榜');
        br();
        cmd::addcmd('map_gc_ch', '兑称号');
    }
    if ($lb == 1) {
        echo ">> 攻城活动介绍：<br>
        1 ，攻城战系统npc为守方<br>
        2 ，玩家为攻方，守方npc名字:守城士兵<br>
        3 ，攻城战目前为12波，每波npc数量为100个，击杀完第一波所有npc后，开启第二波<br>
        4 ，第一波npc等级10级，第二波npc等级20级，以此类推，第十二波npc等级120级<br>
        5 ，城战npc击杀者，有城战荣耀积分<br>
        6 ，第一波的npc，一个1积分，第二波的npc，一个2积分，以此类推，十二波的npc，一个12积分<br>
        7 ，每攻破一波后，下一波npc会在1分钟后，刷新在地图上<br>
        8 ，每攻破一波后，会出现一个，城战荣耀商人，荣耀商人，可以用城战荣耀积分兑换道具，每一层的荣耀商城卖的动西不同，城战荣耀商人，只会在攻破第一波后，第二波到来之前的那1分钟出现<br>
        9 ，每攻破一波，世界上会发全服元宝红包，红包分为25份，供玩家抢，抢到的元宝数量随机<br>
        10 ，每波都是25份红包，第一波:红包总数250元宝，第二波:500元宝，以此类推，每波数x250，十二波:红包总数2500元宝<br>
        11 ，攻城战伤害排名奖励，第一名:限时城主武器x1，限时城主称号x1，城战荣耀积分*1000，第二、第三名，限时副城主称号x1，城战荣耀积分*800，三~十名:城战荣耀积分500，十~20名:城战荣耀积分200，其它名次，无奖励
        ";
        br();
        cmd::addcmd('hd_rxgc_1', '返回上级');
    }
    if ($lb == 2) {
        echo "开始时间：每晚20:00~21:00";
        br(); 
    }
    br();
    echo "-";
}

function hd_tg($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 推广拉人活动";
    br();
    echo "-";
    br();
    echo "拉3个玩wap好友进群，联系群主可获得超级手拉手礼包,每个号限1次<br>";
    echo "奖励：内容:800元宝，幻蓝之翼x1，强化石1~5各1个，金条x1，升星石x1000";
    br();
    if ($user_id < 1) {
        $qh = "738323424";
        $wz = "仙盟会-梦回";
    } else {
        $qh = "qq-738323424";
        $wz = "仙盟会-梦回";
    } 
    echo "文本推荐:<span style=color:green><br>
    ST网首款史诗级wap页游大作，绿色传奇盛大公测中，群号:{$qh}拒绝无聊的数据比拼，真实的还原热血pk，热血攻城，所有极品装备全靠打，所有装备秒回收，<br>网址{$wz}
    <br>ID：{$user_id}</span>
    ";
    br();
    echo "-";
}

function hd_tg1($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 入群活动";
    br();
    echo "-";
    br();
    if ($user_id < 1) {
        $qh = "738323424";
        $wz = "仙盟会-梦回";
    } else {
        $qh = "qq-738323424";
        $wz = "仙盟会-梦回";
    } 
    echo "加入官方群领取入群礼包哦，欢迎加入绿色传奇官方聊天群:{$qh}";
    br();
    echo "-";
    br();
    echo "奖励：<img src=res/img/ch/666666.gif><br>装备修复神油x10<br>
    升星石x200<br>
    10倍经验卷x1<br>
    10倍掉宝卷x1"; 
    br();
    echo "-";
}

function hd_tg2($lb = 0)
{
    $user_id = uid();
    $ocount = 0;
    cmd::addcmd('map_hd', '活动');
    echo ">> 推荐活动";
    br();
    echo "-";
    br();
    echo "你推荐的玩家进入游戏充值时获赠10%元宝奖励！";
    br();
    //普通方式
    $sql = "SELECT `name`,`id` FROM `game_user` WHERE `js_id`=$user_id";
    //开始获取
    if ($sql) {
        $result = sql($sql);
        while (list($oname, $oid) = $result->fetch_row()) {
            $ocount++;
            echo "推荐{$ocount}玩家：";
            cmd::addcmd('e12,' . $oid . ',1', $oname);
            br();
        }
    }
    if (!$ocount) {
        echo "-";
        br();
        echo "你暂时还没有推荐的玩家！";
        br();
    }
    echo "-";
}

function hd_tg3($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 宣传活动";
    br();
    echo "-";
    br();
    if ($user_id < 1) {
        $qh = "738323424";
        $wz = "仙盟会-梦回";
    } else {
        $qh = "qq-738323424";
        $wz = "仙盟会-梦回";
    } 
    echo "宣传语:<br><span style=color:green>
    ST网首款史诗级wap页游大作，绿色传奇盛大公测中，群号:{$qh}拒绝无聊的数据比拼，真实的还原热血pk，热血攻城，所有极品装备全靠打，所有装备秒回收。<br>网址{$wz}<br>STID：{$user_id}</span>";
    br();
    echo "----------------<br>奖励一：①拉3个玩wap好友进群，联系群主可获得超级手拉手礼包，
    每个号限1次<br>
    内容:800元宝，幻蓝之翼x1，强化石1~5各1个，金条x1，升星石x1000";
    br();
    echo "----------------<br>奖励二：②空间宣传满24小时，且集齐8个赞，可联系群主获得超级空间礼包一份，每个号限1次<br>
    内容:800元宝，幻蓝之翼x1，补天三ⅹ1，经验秘境卷x1，升星石x1000";
    br();
    echo "----------------<br>奖励三：7天空间连续推广，好礼送不停
    每天qq空间新发一条推广文档，且齐集8个赞
    连续推广礼包，每天限领一次
    贵宾会员周卡x1，天外神铁x1，幻蓝之翼x1，辛运石初级x3";
    br();
    echo "----------------<br>奖励四：连续推广满7日超级礼包
    礼包内容:帝王会员月卡X1，超级蒙大拿山蚤缀种子x1、超级星辰天元种子x1，超级佛手柑种子x1，权者为帝x1，苍穹之翼x1";
    br();
    echo "-";
}

function hd_tg4($lb = 0)
{
    $user_id = uid();
    cmd::addcmd('map_hd', '活动');
    echo ">> 反馈活动";
    br();
    echo "-";
    br();
    if ($user_id < 1) {
        $qh = "738323424";
    } else {
        $qh = "qq-738323424";
    } 
    echo "《绿色传奇》,为给广大玩家提供一个更好的游戏环境,现大家可以对游戏中遇到的问题和体验不足的地方,通过加Q群({$qh})联系客服或者点击下方游戏反馈,将对好的建议或问题进行奖励,根据情况奖励1~1000不等的<span style=color:red>【元宝】</span>,奖励会在客服确认问题之后马上发放！<br>";
    br();
    cmd::addcmd('e46', '游戏反馈');
    br();
    echo "-";
}

function map_fb()
{
    {
        $user_id = uid();
        $hy_lvl = value::get_user_value('hy_lvl', $user_id);
        echo '[副本地图]';
        br();
        echo "-";
        br();
        echo "1 . ";
        cmd::addcmd('map_cs_id1,4393', '雷炎洞穴');
        echo ':（80级副本 ~  爆<span style=color:green>【卓越套】</span>）';
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    }
}

function map_tz()
{
    $user_id = uid();
    echo '[挑战]';
    br();
    echo "-";
    br();
    echo "1 . ";
    cmd::addcmd('map_tz1', '天梯');
    br();
    echo "-";
    br();
    cmd::set_return_game_br(false);
}

function map_tz1()
{
    $user_id = uid();
    echo '【天梯】 . ';
    cmd::addcmd('map_tz1_3', "天元榜");
    echo " . ";
    cmd::addcmd('map_tz1_4', "天元商场");
    br();
    echo "-";
    br();
    cmd::addcmd('map_tz1_5', "天梯奖励介绍");
    br();
    echo "-";
    for ($i = 1; $i < 46; $i++) {
        if ($i == 1) {
            echo "<br>【九重天】<br>";
        }
        if ($i == 2) {
            echo "<br>【八重天】<br>";
        }
        if ($i == 4) {
            echo "<br>【七重天】<br>";
        }
        if ($i == 7) {
            echo "<br>【六重天】<br>";
        }
        if ($i == 11) {
            echo "<br>【五重天】<br>";
        }
        if ($i == 16) {
            echo "<br>【四重天】<br>";
        }
        if ($i == 22) {
            echo "<br>【三重天】<br>";
        }
        if ($i == 29) {
            echo "<br>【二重天】<br>";
        }
        if ($i == 37) {
            echo "<br>【一重天】<br>";
        }
        $tz_tdxt_id = value::get_system_value('tz_tdxt_id' . $i);
        if ($tz_tdxt_id) {
            $name = value::get_game_user_value('name', $tz_tdxt_id);
            echo "第{$i} .";
            cmd::addcmd('e12,' . $tz_tdxt_id, $name);
            echo "  ";
            if ($tz_tdxt_id != $user_id) {
                cmd::addcmd('map_tz1_2,' . $i, "挑战");
            } else {
                cmd::addcmd('map_tz1_6,' . $i, "放弃");
            }
            echo "，";
        } else {
            echo "第{$i} .";
            cmd::addcmd('map_tz1_1,' . $i, "暂无");
            echo "，";
        } 
    }
    br();
    echo "-";
    br();
    cmd::addcmd('map_tz', '返回挑战');
    br();
    cmd::set_return_game_br(false);
}

function map_tz1_1($i1 = 0)
{
    $user_id = uid();
    $tz_tdxt_id1 = 0;
    if ($i1) {
        for ($i = 1; $i < 46; $i++) {
            $tz_tdxt_id = value::get_system_value('tz_tdxt_id' . $i);
            if ($tz_tdxt_id == $user_id) {
                $tz_tdxt_id1 = 1;
            } 
        }
    }
    if ($tz_tdxt_id1 < 1) {
        $tz_tdxt_id = 'tz_tdxt_id' . $i1;
        value::set_system_value("tz_tdxt_id" . $i1, $user_id);
        $name = value::get_game_user_value('name', $user_id);
        echo "恭喜你成为天梯第{$i1}名！";
        c_add_guangbo("恭喜玩家{$name}成为天梯第{$i1}名！");
    } else {
        echo "你已经是天梯排名玩家！";
    } 
    br();
    cmd::addcmd('map_tz', '返回挑战');
    br();
    cmd::set_return_game_br(false);
}

function map_tz1_6($i1 = 0)
{
    $user_id = uid();
    value::set_system_value("tz_tdxt_id" . $i1, 0); 
    echo "你已经放弃天梯排名{$i1}！";
    br();
    cmd::addcmd('map_tz', '返回挑战');
    br();
    cmd::set_return_game_br(false);
}

function map_tz1_2($i1 = 0)
{
    $user_id = uid();
    value::set_user_value('5.hd_hyd_sz', 5, $user_id);
    $time_h = date("H");
    $sl_h = value::get_user_value('hd_hydz_h5', $user_id);
    if ($sl_h != $time_h) {
        value::add_user_value('hd_hydz', 5, $user_id);
        value::set_user_value('hd_hydz_h5', $time_h, $user_id);
    }
    if ($i1) {
        for ($i = 1; $i < 46; $i++) {
            $tz_tdxt_id = value::get_system_value('tz_tdxt_id' . $i);
            if ($tz_tdxt_id == $user_id) {
                $tz_tdxt_id1 = 1;
            } 
        }
        if ($tz_tdxt_id1 < 1) {
            $lvl = value::get_game_user_value('lvl', $user_id);
            value::set_user_value('tz_tdxt_id', $i1, $user_id);
            $pet_id = pet::new_pet(218, $lvl, 0);
            e48($pet_id);
            return;
        } else {
            echo "你已经是天梯排名玩家！";
            br();
            cmd::addcmd('map_tz', '返回挑战');
        }
    }
    br();
    cmd::set_return_game_br(false);
}


//首页 意见反馈
function e46()
{
    if (!value::real_escape_string($_POST['fankui'])) {
        $cmd = cmd::addcmd("e46", '反馈', false);
        echo <<<fankuiform
	请输入你的反馈(50字内):<br>
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="fankui" maxlength="50">
	<br>
	<input type="submit" value="确定反馈" name="反馈">
</form>
fankuiform;
    } else {
        c_add_xiaoxi(value::real_escape_string($_POST['fankui']), 9, uid());
        echo "感谢您的反馈!";
        br();
    }
    cmd::addcmd('e0', '返回首页');
}

//选项 传奇排行
function e47($from_list = 0, $mode = 0)
{
    if (!$mode) {
        echo "[排行榜]";        
        br();
        echo "-";
        br();
        cmd::addcmd('map_lb1', '<img src=res/img/ch/ch_bcq.gif>日冲榜');
        br();
        echo "玩家榜：";
        br();
        cmd::addcmd('e47,' . $from_list . ',31', '战力榜');
        br();
        cmd::addcmd('e47,' . $from_list . ',1', '等级榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',2', '财富榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',3', '会员榜');
        br();
        cmd::addcmd('e47,' . $from_list . ',4', 'V I P榜');
        echo " .  ";
        cmd::addcmd('e47,' . $from_list . ',6', '胜利榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',7', '赏金榜');
        br();
        cmd::addcmd('e47,' . $from_list . ',8', '红名榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',9', '狱中榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',10', '在线榜');
        br();
        echo "神兵榜：";
        br();
        cmd::addcmd('e47,' . $from_list . ',11', '神兵榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',12', '生命榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',13', '攻击榜');
        br();
        cmd::addcmd('e47,' . $from_list . ',14', '防御榜');
        echo " .  ";
        cmd::addcmd('e47,' . $from_list . ',15', '魔攻榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',16', '魔防榜');
        br();
        echo "神宠榜：";
        br();
        cmd::addcmd('e47,' . $from_list . ',21', '神宠榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',22', '生命榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',23', '攻击榜');
        br();
        cmd::addcmd('e47,' . $from_list . ',24', '防御榜');
        echo " .  ";
        cmd::addcmd('e47,' . $from_list . ',25', '魔攻榜');
        echo " . ";
        cmd::addcmd('e47,' . $from_list . ',26', '魔防榜');
        br();
    } else {
        $i = 0;
        switch ($mode) {
            case 1:
                echo '[等级榜]';
                br();
                $sql = "SELECT  `id`,`lvl` FROM `game_user`  ORDER BY `lvl` DESC LIMIT 20";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo ' (' . $ovalue . '级)';
                    br();
                }
                break;
            case 2:
                echo '[财富榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.money' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . $ovalue . '金币)';
                    br();
                }
                break;
            case 3:
                echo '[会员榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`>'0' AND `valuename` LIKE '%.hy_lvl' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    $hy_name = value::get_game_user_value('hy_name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . $hy_name . ')';
                    br();
                }
                break;
            case 4:
                echo '[VIP榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.vip_lvl' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    $xs_vip_lvl = user::showVipLogo($oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . $xs_vip_lvl . ')';
                    br();
                }
                break;
            case 6:
                echo '[胜利榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.shenglishu' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . $ovalue . '次)';
                    br();
                }
                break;
            case 7:
                echo '[赏金榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.sjssshu' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . $ovalue . '次)';
                    br();
                }
                break;
            case 8:
                echo '[红名榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.hongming' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . $ovalue . '点)';
                    br();
                }
                break;
            case 9:
                echo '[狱中榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.yzckshu' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $ovalue) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . $ovalue . '次)';
                    br();
                }
                break;
            case 10:
                echo '[在线榜]';
                br();
                $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`>60 AND `valuename` LIKE '%.onlinetime' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,20 ";
                $result = sql($sql);
                while (list($oid, $oonlinetime) = $result->fetch_row()) {
                    $i++;
                    $phname = value::get_game_user_value('name', $oid);
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $phname);
                    }
                    echo '(' . (int)($oonlinetime / 60) . '小时)';
                    br();
                }
                break;
            case 11:
                echo '[神兵榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star1`,(`hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) FROM `game_prop` WHERE `user_id`>0 ORDER BY (`hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                    if (!$o_liuwei) {
                        break;
                    }
                    $i++;
                    echo $i . '.';
                    $o_user_id = prop::get($o_id, 'user_id');
                    if (!$o_user_id) {
                        $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                    }
                    cmd::addcmd("e10003,$o_id,2", $name);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                    br();
                }
                break;
            case 12:
                echo '[生命榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star1`,`hp` FROM `game_prop` WHERE `user_id`>0 ORDER BY `hp` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                    if (!$o_liuwei) {
                        break;
                    }
                    $i++;
                    echo $i . '.';
                    $o_user_id = prop::get($o_id, 'user_id');
                    if (!$o_user_id) {
                        $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                    }
                    cmd::addcmd("e10003,$o_id,2", $name);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                    br();
                }
                break;
            case 13:
                echo '[攻击榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star1`,`pugong` FROM `game_prop` WHERE `user_id`>0 ORDER BY `pugong` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                    if (!$o_liuwei) {
                        break;
                    }
                    $i++;
                    echo $i . '.';
                    $o_user_id = prop::get($o_id, 'user_id');
                    if (!$o_user_id) {
                        $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                    }
                    cmd::addcmd("e10003,$o_id,2", $name);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                    br();
                }
                break;
            case 14:
                echo '[防御榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star1`,`pufang` FROM `game_prop` WHERE `user_id`>0 ORDER BY `pufang` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                    if (!$o_liuwei) {
                        break;
                    }
                    $i++;
                    echo $i . '.';
                    $o_user_id = prop::get($o_id, 'user_id');
                    if (!$o_user_id) {
                        $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                    }
                    cmd::addcmd("e10003,$o_id,2", $name);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                    br();
                }
                break;
            case 15:
                echo '[魔攻榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star1`,`tegong` FROM `game_prop` WHERE `user_id`>0 ORDER BY `tegong` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                    if (!$o_liuwei) {
                        break;
                    }
                    $i++;
                    echo $i . '.';
                    $o_user_id = prop::get($o_id, 'user_id');
                    if (!$o_user_id) {
                        $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                    }
                    cmd::addcmd("e10003,$o_id,2", $name);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                    br();
                }
                break;
            case 16:
                echo '[魔防榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star1`,`tefang` FROM `game_prop` WHERE `user_id`>0 ORDER BY `tefang` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                    if (!$o_liuwei) {
                        break;
                    }
                    $i++;
                    echo $i . '.';
                    $o_user_id = prop::get($o_id, 'user_id');
                    if (!$o_user_id) {
                        $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                    }
                    cmd::addcmd("e10003,$o_id,2", $name);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                    br();
                }
                break;
            case 17:
                echo '[灵活榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star1`,`minjie` FROM `game_prop` WHERE `user_id`>0 ORDER BY `minjie` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                    if (!$o_liuwei) {
                        break;
                    }
                    $i++;
                    echo $i . '.';
                    $o_user_id = prop::get($o_id, 'user_id');
                    if (!$o_user_id) {
                        $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                    }
                    cmd::addcmd("e10003,$o_id,2", $name);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                    br();
                }
                break;
            case 21:
                echo '[神宠榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star`,(`max_hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) FROM `game_pet` WHERE `master_id`>0 ORDER BY (`max_hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    cmd::addcmd("bx_e621," . $o_id, $oname);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                    br();
                }
                break;
            case 22:
                echo '[生命榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star`,`max_hp` FROM `game_pet` WHERE `master_id`>0 ORDER BY `max_hp` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    cmd::addcmd("bx_e621," . $o_id, $oname);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                    br();
                }
                break;
            case 23:
                echo '[攻击榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star`,`pugong` FROM `game_pet` WHERE `master_id`>0 ORDER BY `pugong` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    cmd::addcmd("bx_e621," . $o_id, $oname);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                    br();
                }
                break;
            case 24:
                echo '[防御榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star`,`pufang` FROM `game_pet` WHERE `master_id`>0 ORDER BY `pufang` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    cmd::addcmd("bx_e621," . $o_id, $oname);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                    br();
                }
                break;
            case 25:
                echo '[魔攻榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star`,`tegong` FROM `game_pet` WHERE `master_id`>0 ORDER BY `tegong` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    cmd::addcmd("bx_e621," . $o_id, $oname);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                    br();
                }
                break;
            case 26:
                echo '[魔防榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star`,`tefang` FROM `game_pet` WHERE `master_id`>0 ORDER BY `tefang` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    cmd::addcmd("bx_e621," . $o_id, $oname);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                    br();
                }
                break;
            case 27:
                echo '[灵活榜]';
                br();
                $sql = "SELECT  `id`,`name`,`star`,`minjie` FROM `game_pet` WHERE `master_id`>0 ORDER BY `minjie` DESC LIMIT 20";
                $result = sql($sql);
                while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    cmd::addcmd("bx_e621," . $o_id, $oname);
                    echo '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                    br();
                }
                break;
            case 31:
                echo '[战力榜]';
                br();
                $sql = "SELECT  `id`,`name`,(`hp`+`pugong`+`pufang`) FROM `game_user` WHERE `xs_zhiye`>0 ORDER BY (`hp`+`pugong`+`pufang`) DESC LIMIT 20";
                $result = sql($sql);
                while (list($oid, $name, $oliuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $name);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $name);
                    }
                    echo '(' . $oliuwei . ')';
                    br();
                }
                break;
            case 32:
                echo '[法力榜]';
                br();
                $sql = "SELECT  `id`,`name`,(`hp`+`tegong`+`tefang`) FROM `game_user` WHERE `xs_zhiye`=2 ORDER BY (`hp`+`tegong`+`tefang`) DESC LIMIT 20";
                $result = sql($sql);
                while (list($oid, $name, $oliuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $name);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $name);
                    }
                    echo '(' . $oliuwei . ')';
                    br();
                }
                break;
            case 33:
                echo '[道力榜]';
                br();
                $sql = "SELECT  `id`,`name`,(`hp`+`tegong`+`tefang`) FROM `game_user` WHERE `xs_zhiye`=3 ORDER BY (`hp`+`tegong`+`tefang`) DESC LIMIT 20";
                $result = sql($sql);
                while (list($oid, $name, $oliuwei) = $result->fetch_row()) {
                    $i++;
                    echo $i . '.';
                    if (value::get_game_user_value('is_online', $oid)) {
                        cmd::addcmd('e12,' . $oid . ',6', $name);
                    } else {
                        cmd::addcmd('e12,' . $oid . ',6', $name);
                    }
                    echo '(' . $oliuwei . ')';
                    br();
                }
                break;
        }
        if (!$i) {
            echo '暂时无人上榜。';
            br();
        }
        cmd::addcmd('e47,' . $from_list, '返回排行');
        br();
    }
    echo "-";
}

//战斗 挑战野怪事件
function e48($oid)
{
    $ok = false;
    $user_id = uid();
    $team_id = team::get_user_team($user_id);
    $pet_id = 0;
    if (value::get_pet_value($oid, 'pet_id')) {
        $u_pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($u_pet_arr as $pet_id) {
            $is_dead = value::get_pet_value($pet_id, 'is_dead');
            if (!$is_dead) {
                $ok = true;
                break;
            }
        }
        if (!user::get_game_user('is_dead', $user_id)) {
            $ok = true;
        }
        if (!$ok) {
            echo '你已死亡且身上没有可以战斗的宠物了。';
        } else {
            //开始事务
            sql("BEGIN");
            //获取状态
            $result = sql("SELECT `is_pk`,`master_id`  FROM `game_pet` WHERE `id`={$oid} LIMIT 1 FOR UPDATE");
            list($is_pk, $master_id) = $result->fetch_row();
            //提交事务
            sql("COMMIT");
            if (!$user_id) {
                echo '该怪物正在战斗中,无法挑战！';
            } else if ($master_id) {
                echo '这只怪物已经不在这里了！';
                cmd::set_return_game_br(false);
            } else {
                //玩家状态
                //开始事务
                sql("BEGIN");
                $sql = "SELECT `is_pk` FROM `game_user` WHERE `id` = $user_id  LIMIT 1 FOR UPDATE";
                $rs = sql($sql);
                list($u_is_pk) = $rs->fetch_row();
                //提交事务
                sql("COMMIT");
                //对方正在PK
                if ($u_is_pk) {
                    e0();
                    return;
                }
                //设置角色PK状态
                value::set_game_user_value('is_pk', 0, $user_id);
                value::set_game_user_value('is_pk_id', $oid, $user_id);
                //设置敌方宠物PK状态
                value::set_pet_value($oid, 'is_pk', 0);
                value::set_pet_value($oid, 'enemy_user', $user_id);
                //设置全宠物未PK
                sql("UPDATE `game_pet` SET `is_pk`=0 WHERE  `master_id`={$user_id} AND `master_mode`=1");
                //设置角色属性 出战宠物 回合数 对战宠物 PK状态
                value::set_game_user_value('pk.now_pet.id', $pet_id);
                value::set_user_value('pk.huihe', '0', $user_id);
                value::set_game_user_value('pk.map_pet.id', $oid);
                value::set_user_value("pk_win_money", 0, $user_id);
                value::set_user_value("pk_win_exp", 0, $user_id);
                //清除战斗信息
                $obj = new game_user_object($user_id);
                $obj->del("pk_chats");
                //开始战斗
                if (!$team_id) {
                    ctm::show_ctm('ctm_pk_mappet');
                } else {
                    ctm::show_ctm('ctm_pk_team_npc');
                }
            }
        }
    } else {
        echo '这只怪物已经不在这里了！';
    }
}

//选项 在线玩家列表
function e49($yeshu = 0, $user_name = "")
{
    $user_id = uid();
    if ($yeshu > -1) {
        value::set_user_value('zx.user.yeshu', $yeshu);
    } else if ($yeshu == -1) {
        $yeshu = value::get_user_value('zx.user.yeshu');
    }
    //提取在线玩家与数量
    $wj_rs = 0;
    $danye_count = 15;
    $start_list_num = $yeshu * $danye_count;
    if (!$user_name) {
        $user_name = value::real_escape_string($_POST['qname']);
    }
    if (!$user_name) {
        $sql = "SELECT COUNT(*) FROM `game_user` WHERE `is_online`>0 AND `id`!= {$user_id}";
        $rs = sql($sql);
        list($count) = $rs->fetch_row();
        $sql = "SELECT `id`,`name` FROM `game_user` WHERE `is_online`>0 AND `id`!= {$user_id} ORDER BY `login_time` ASC LIMIT {$start_list_num},{$danye_count} ";
    } else {
        $sql = "SELECT COUNT(*) FROM `game_user` WHERE `is_online`>0 AND `name` LIKE '%{$user_name}%' AND `id`!= {$user_id}";
        $rs = sql($sql);
        list($count) = $rs->fetch_row();
        $sql = "SELECT `id`,`name` FROM `game_user` WHERE `is_online`>0 AND `name` LIKE '%{$user_name}%' AND `id`!= {$user_id} ORDER BY `login_time` ASC LIMIT {$start_list_num},{$danye_count} ";
    }
    $result = sql($sql);
    $onlineuser = array();
    while (list($oid, $oname) = $result->fetch_row()) {
        $onlineuser[$oid] = $oname;
    }
    //搜索在线玩家
    $cmd = cmd::addcmd("e49", '搜索', false);
    echo <<<qform
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="qname" maxlength="8">
	<input type="submit" value="搜索" name="搜索">
</form>
qform;
    //显示在线玩家
    $user_count = 0;
    foreach ($onlineuser as $oid => $oname) {
        $user_count++;
        $wj_rs += 1;
        user::showVipLogo($oid, true);
        if ($oname) {
            cmd::addcmd('e12,' . $oid . ',3', $oname);
        } else {
            cmd::addcmd('e12,' . $oid . ',3', "无名氏");
        }
        br();
    }
    if (!$user_count) {
        if ($user_name) {
            echo '没有找到你要找的玩家。';
            br();
        } else {
            if (!$yeshu) {
                echo '当前没有其他玩家在线。';
                br();
            } else {
                echo '本页没有其他玩家在线。';
                br();
            }
        }
    }
    //显示上下页
    $fanye_ok = false;
    $max_page_num = (int)(($count - 1) / $danye_count) + 1;
    if ($yeshu > 0) {
        if ($yeshu > 1) {
            cmd::addcmd('e49,0,' . $user_name, '首页');
            echo "|";
        }
        cmd::addcmd('e49,' . ($yeshu - 1) . ',' . $user_name, '上—页');
        $fanye_ok = true;
    }
    if ($count > $danye_count * ($yeshu + 1)) {
        if ($fanye_ok) {
            echo '|';
        }
        cmd::addcmd('e49,' . ($yeshu + 1) . ',' . $user_name, '下—页');
        if ($yeshu + 2 < $max_page_num) {
            echo "|";
            cmd::addcmd('e49,' . ($max_page_num - 1) . ',' . $user_name, '末页');
        }
        $fanye_ok = true;
    }
    //是否有操作
    if ($fanye_ok) {
        br();
    }
    echo $wj_rs . '玩家在线!';
    br();
    //返回功能
    cmd::addcmd('e0', '返回上级');
}

//角色 添加好友事件
function e50($oid)
{
    $user_id = uid();
    $sql = "SELECT `id` FROM `game_user_value` WHERE `userid`={$user_id} AND `valuename`='{$user_id}.haoyou' AND `value`='{$oid}'";
    $result = sql($sql);
    list($value_id) = $result->fetch_row();
    if (!$value_id) {
        $sql = "SELECT `id` FROM `game_chat` WHERE `mode`=7 AND `uid`={$user_id} AND `oid`={$oid}";
        $result = sql($sql);
        list($chat_id) = $result->fetch_row();
        if (!$chat_id) {
            $sql = "SELECT `id` FROM `game_chat` WHERE `mode`=7 AND `uid`={$oid} AND `oid`={$user_id}";
            $result = sql($sql);
            list($chat_id) = $result->fetch_row();
            if (!$chat_id) {
                c_add_hyqq($oid);
                echo '成功发送好友请求。';
            } else {
                c_add_hyqq($oid, 1, $chat_id);
            }
        } else {
            echo '请等待对方确认请求。';
        }
    } else {
        echo '对方已经是你的好友。';
    }
    br();
    cmd::addcmd('e12,' . $oid, '返回上级');
}

//角色 查看好友列表事件
function e51($from_list = 0, $yeshu = 0)
{
    $user_id = uid();
    $danye_count = 15;
    //好友列表
    cmd::addcmd('e13', '状态');
    echo ">> 好友";
    br();
    echo "-";
    br();
    echo "好友 . ";
    cmd::addcmd('e36,2', '聊天');
    echo " . ";
    cmd::addcmd('e139', '仇人');
    echo " . ";
    cmd::addcmd('e71', '黑名单');
    br();
    //获取好友数量
    $sql = "SELECT COUNT(*) FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.haoyou'";
    $result = sql($sql);
    list($haoyou_count) = $result->fetch_row();
    //开始获取
    $sql = "SELECT `value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.haoyou'";
    $result = sql($sql);
    //好友计数
    $count = 0;
    //离线好友 计数 名字数组
    $zxhy = array();
    $lxhy = array();
    $new_hy = array();
    $haoyou_leixing_array = array();
    while (list($oid) = $result->fetch_row()) {
        if ($oid) {
            if (value::get_game_user_value('is_online', $oid)) {
                array_push($zxhy, $oid);
                $haoyou_leixing_array[$oid] = 1;
            } else {
                array_push($lxhy, $oid);
                $haoyou_leixing_array[$oid] = 0;
            }
        }
        $count++;
    }
    if (!$count) {
        echo '你暂时还没有好友!';
        br();
    } else {
        $new_hy = array_merge($zxhy, $lxhy);
    }
    //输出好友链接
    $max_count = $count < ($yeshu + 1) * $danye_count ? $count : ($yeshu + 1) * $danye_count;
    for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
        $oname = value::get_game_user_value('name', $new_hy[$i]);
        user::showVipLogo($new_hy[$i], true);
        if ($haoyou_leixing_array[$new_hy[$i]]) {
            cmd::addcmd('e12,' . $new_hy[$i] . ',4', $oname);
        } else {
            echo $oname;
        }
        $o_map_id = value::get_game_user_value('in_map_id', $new_hy[$i]);
        $o_map_name = value::get_map_value($o_map_id, 'name');
        echo "({$o_map_name})";
        echo ' ';
        cmd::addcmd('e52,' . $new_hy[$i], '删除');
        br();
    }
    //上下页操作
    $fanye = false;
    $max_page_num = (int)(($count - 1) / $danye_count) + 1;
    if ($yeshu) {
        if ($yeshu > 1) {
            cmd::addcmd('e51,' . $from_list, '首页');
            echo "|";
        }
        cmd::addcmd('e51,' . $from_list . ',' . ($yeshu - 1), '上—页');
        $fanye = true;
    }
    if ($haoyou_count > ($yeshu + 1) * $danye_count) {
        if ($yeshu) {
            echo "|";
        }
        cmd::addcmd('e51,' . $from_list . ',' . ($yeshu + 1), '下—页');
        if ($yeshu + 2 < $max_page_num) {
            echo "|";
            cmd::addcmd('e51,' . $from_list . ',' . ($max_page_num - 1), '末页');
        }
        $fanye = true;
    }
    //是否翻页换行
    if ($fanye) {
        br();
    }
    //返回操作
    echo "-";
    br();
    if ($from_list == 1) {
        //状态进入
        cmd::addcmd('e13', '返回上级');
    } else if ($from_list == 2) {
        //选项进入
        cmd::addcmd('e37', '返回上级');
    } else if ($from_list == 3) {
        //私人频道进入
        cmd::addcmd('e36,2', '返回上级');
    } else {
        cmd::addcmd('e0', '返回上级');
    }
}

//角色 删除好友事件
function e52($oid, $ok = false)
{
    $user_id = uid();
    $oname = value::get_game_user_value('name', $oid);
    if ($ok) {
        $sql = "DELETE FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.haoyou' AND `value` LIKE '{$oid}'";
        sql($sql);
        $sql = "DELETE FROM `game_user_value` WHERE `valuename` LIKE '{$oid}.haoyou' AND `value` LIKE '{$user_id}'";
        sql($sql);
        echo '成功删除了' . $oname . '。';
        br();
        e51();
        return;
    } else {
        cmd::addcmd('e51', '好友');
        echo ">> 删除提示";
        br();
        echo "-";
        br();
        echo '确定要删除' . $oname . '吗?';
        br();
        cmd::addcmd('e52,' . $oid . ',true', '确认删除');
    }
    br();
    cmd::addcmd('e51', '返回上级');
}

//聊天 发送私聊事件
function e53($oid, $mode = 0)
{
    $user_id = uid();
    $now_time = date("Y-m-d H:i:s");
    //是否黑名单
    $value_id = user::is_heiming($user_id, $oid);
    if ($value_id) {
        echo '你在对方的黑名单中,无法发送私聊。';
        br();
        if (!$mode) {
            e12($oid);
        } else {
            e0();
        }
        return;
    }
    //检查私聊
    $chats = value::real_escape_string(strip_tags($_POST['chat']));
    if (!$chats) {
        $cmd = cmd::addcmd('e53,' . $oid . ',' . $mode, '提交', false);
        echo "<form action='game.php?cmd=" . $cmd . "' method='post'><span>请输入要说的话:</span><br/><input type='text' name='chat' maxlength='50'><input type='submit' 'name'='发送' value='发送'></form>";
        if (!$mode) {
            cmd::addcmd('e12,' . $oid, '返回上级');
        } else {
            cmd::addcmd('e0', '返回上级');
        }
    } else {
        //发送私聊
        $sql = "INSERT INTO `game_chat`(`mode`,`area_id`,`uid`,`oid`,`chats`,`time`) VALUES (2,0,{$user_id},{$oid},'" . $chats . "','{$now_time}')";
        sql($sql);
        //美女魅力值
        if (value::get_game_user_value('sex', $oid) == '女' && value::get_game_user_value('sex') == '男') {
            $meili_day = value::get_user_value('meili.day', $oid);
            $today = date("Y-m-d");
            if ($meili_day != $today) {
                value::set_user_value('today.meili', 0, $oid);
                value::set_user_value('meili.day', $today, $oid);
            }
            if (value::get_user_value('today.meili', $oid) < 100) {
                value::add_user_value('today.meili', 1, $oid);
                value::get_user_value('meilizhi', $oid);
                value::add_user_value('meilizhi', 1, $oid);
            }
        }
        //伴侣亲密度
        if ($oid == value::get_user_value('bl.id') && value::get_user_value('bl.mode') == 1) {
            value::add_user_value('bl.qinmidu', 10);
        }
        echo '你对' . value::get_game_user_value('name', $oid) . '说:' . $chats;
        br();
        if (!$mode) {
            e12($oid);
        } else {
            e0();
        }
    }
}

//角色 查看设置称号
function e54($nick_name, $mode = 0, $is_ouser = 0, $from_list = 0)
{
    if (!$mode) {
        echo "[{$nick_name}]";
        br();
        $nick_name_arr = config::getConfigByName("nick_name");
        echo $nick_name_arr["$nick_name"];
        br();
        if (!$is_ouser && $nick_name != value::get_user_value('using_nick_name', 0, false)) {
            cmd::addcmd('e54,' . $nick_name . ',1', '设为默认称号');
            br();
        }
    } else {
        $user_id = uid();
        $sql = "SELECT `id` FROM `game_user_value` WHERE `valuename`='{$user_id}.nick_name' AND `value`='{$nick_name}'";
        $result = sql($sql);
        list($id) = $result->fetch_row();
        if ($nick_name) {
            value::set_user_value('using_nick_name', $nick_name);
            echo "成功把设置{$nick_name}为默认称号。";
        } else {
            echo "没有找到要设置的称号。";
        }
        br();
    }
    if ($is_ouser) {
        if (!$from_list) {
            cmd::addcmd('e12', '返回上级');
        } else {
            cmd::addcmd('e109,' . value::get_user_value('look_user.id'), '返回上级');
        }
    } else {
        cmd::addcmd('e13', '返回上级');
    }
}

//背包 使用物品事件
function e55($item_id, $pet_id = 0, $mode = 0, $step = 0, $tmp_str = "")
{
    $user_id = uid();
    $is_user_use = value::get_item_value($item_id, 'is_user_use');
    //是否玩家使用
    if ($is_user_use && !$pet_id) {
        item::user_use_item($item_id, $step, $tmp_str);
        //是否宠物使用
    } else {
        if (!$pet_id) {
            echo '你要给谁使用?';
            br();
            $u_pet_arr = user::get_pet_arr($user_id, 1);
            foreach ($u_pet_arr as $list_pet_id) {
                $onick_name = value::get_pet_value($list_pet_id, 'nick_name');
                $name = value::get_pet_value($list_pet_id, 'name');
                $is_dead = value::get_pet_value($list_pet_id, 'is_dead');
                cmd::addcmd('e55,' . $item_id . ',' . $list_pet_id . ',' . $mode, ($onick_name ? "({$onick_name})" : "") . $name . "(" . value::get_pet_value($list_pet_id, 'lvl') . "级)");
                echo $is_dead ? "(已死亡)" : "";
                br();
            }
        } else {
            item::pet_use_item($pet_id, $item_id);
        }
    }
    //返回操作
    if (!$mode) {
        if (item::get_item($item_id)) {
            cmd::addcmd('e41,' . $item_id, '返回上级');
        } else {
            cmd::addcmd('e40,2', '返回上级');
        }
    } else {
        cmd::addcmd('e62', '返回上级');
    }
}

//背包 使用物品事件
function beib_e55($mode = 0)
{
    $user_id = uid();
    if ($mode == 1) {
        $beib_yb_sl = value::get_user_value('beib_yb_sl') * 100 + 100;
        if (item::get_item(1) > $beib_yb_sl) {
            item::add_item(1, -1 * $beib_yb_sl);
            echo '恭喜你的背包容量成功扩充+10！';
            br();
            value::add_user_value("qiankundai.bb.rongliang", 10);
            value::add_user_value('beib_yb_sl', 1, $user_id);
        } else {
            echo '扩充+10背包容量需要' . $beib_yb_sl . '元宝！';
            br();
        }
    } else if ($mode == 2) {
        $ck_yb_sl = value::get_user_value('ck_yb_sl') * 100 + 100;
        if (item::get_item(1) > $ck_yb_sl) {
            item::add_item(1, -1 * $ck_yb_sl);
            echo '恭喜你的仓库容量成功扩充+10！';
            br();
            value::add_user_value("qiankundai.zbck.rongliang", 10);
            value::add_user_value('ck_yb_sl', 1, $user_id);
        } else {
            echo '扩充+10仓库容量需要' . $ck_yb_sl . '元宝！';
            br();
        }
    } else if ($mode == 3) {
        $cw_yb_sl = value::get_user_value('cw_yb_sl') * 100 + 100;
        if (item::get_item(1) > $cw_yb_sl) {
            item::add_item(1, -1 * $cw_yb_sl);
            echo '恭喜你的宠物仓库容量成功扩充+10！';
            br();
            value::add_user_value("qiankundai.ygck.rongliang", 10);
            value::add_user_value('cw_yb_sl', 1, $user_id);
        } else {
            echo '扩充+10宠物仓库容量需要' . $ck_yb_sl . '元宝！';
            br();
        }
    }
}

//背包 丢弃物品事件
function e56($item_id, $mode = 0, $ok = 0)
{
    $name = value::getvalue('item', 'name', 'id', $item_id);
    $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
    $old_count = item::get_item($item_id);
    $count = value::real_escape_string($_POST['count']);
    $in_map_id = value::get_game_user_value('in_map_id');
    if (!$mode) {
        $cmd = cmd::addcmd("e56," . $item_id . ",1", '丢弃', false);
        $cmd2 = cmd::addcmd("e56," . $item_id . ",2", '全部丢弃', false);
        echo <<<diuqiform
	你有{$old_count}{$liangci}{$name},要丢弃多少{$liangci}?<br>
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="count" maxlength="8" value="1">
	<br>
	<input type="submit" value="确定丢弃" name="丢弃">
</form>
<form action="game.php?cmd=$cmd2" method="post">
	<input type="submit" value="全部丢弃" name="丢弃">
</form>
diuqiform;
        cmd::addcmd('e41,' . $item_id, '返回上级');
    } else if ($mode == 1) {
        //批量丢弃
        $success = item::lose_item($item_id, $count);
        if ($count == $old_count) {
            e40();
        } else {
            cmd::addcmd('e41,' . $item_id, '返回上级');
        }
    } else if ($mode == 2) {
        //全部丢弃
        if (!$ok) {
            echo '你确定要丢弃全部的' . $name . '吗?';
            br();
            cmd::addcmd('e56,' . $item_id . ',2,1', '全部丢弃');
            br();
            cmd::addcmd('e41,' . $item_id, '返回上级');
        } else {
            $count = $old_count;
            $success = item::lose_item($item_id, $count);
            e40();
        }
    }
    if ($success) {
        $team_id = 0;
        $user_id = 0;
        $union_id = 0;
        $danrenfuben = value::getvalue('map', 'is_danrenfuben', 'id', $in_map_id);
        $duorenfuben = value::getvalue('map', 'is_duorenfuben', 'id', $in_map_id);
        $is_gonghuilingdi = value::getvalue('map', 'is_gonghuilingdi', 'id', $in_map_id);
        if ($danrenfuben) {
            $user_id = uid();
        }
        if ($duorenfuben) {
            $team_id = value::get_game_user_value('team_id');
        }
        if ($is_gonghuilingdi) {
            $union_id = user::get_union();
        }
        item::map_add_item($in_map_id, $item_id, $count, $team_id, $user_id, $union_id);
    }
}

//背包 丢弃物品事件
function zd_e56($item_id)
{
    $old_count = item::get_item($item_id);
    $user_id = uid();
    $name = value::getvalue('item', 'name', 'id', $item_id);
    $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
    item::lose_item($item_id, $old_count, false);
    echo "你爆了" . $old_count . $liangci . $name . "在地上！<br>";
    $in_map_id = value::get_game_user_value('in_map_id');
    item::map_add_item($in_map_id, $item_id, $old_count);
}

//背包 销毁物品事件
function e57($item_id, $mode = 0, $ok = 0)
{
    $name = value::getvalue('item', 'name', 'id', $item_id);
    $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
    $old_count = item::get_item($item_id);
    $count = value::real_escape_string($_POST['count']);
    if (!$mode) {
        $cmd = cmd::addcmd("e57," . $item_id . ",1", '销毁', false);
        $cmd2 = cmd::addcmd("e57," . $item_id . ",2", '全部销毁', false);
        echo <<<xiaohuiform
	你有{$old_count}{$liangci}{$name},要销毁多少{$liangci}?<br>
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="count" maxlength="8" value="1">
	<br>
	<input type="submit" value="确定销毁" name="销毁">
</form>
<form action="game.php?cmd=$cmd2" method="post">
	<input type="submit" value="全部销毁" name="销毁">
</form>
xiaohuiform;
    } else if ($mode == 1) {
        item::lose_item($item_id, $count);
        if ($old_count == $count) {
            e40();
            return;
        }
    } else if ($mode == 2) {
        if (!$ok) {
            echo '你确定要销毁全部的' . $name . '吗?';
            br();
            cmd::addcmd('e57,' . $item_id . ',2,1', '全部销毁');
            br();
        } else {
            item::lose_item($item_id, $old_count);
            e40();
            return;
        }
    }
    cmd::addcmd('e41,' . $item_id, '返回上级');
}

//地图 地图物品列表
function e58()
{
    //获取玩家ID
    $user_id = uid();
    echo '地上掉落有:';
    br();
    //获取队伍id
    $user_team_id = value::get_game_user_value('team_id');
    //获取帮派id
    $union_id = user::get_union();
    //获取玩家所在地图ID
    $in_map_id = value::get_game_user_value('in_map_id');
    $is_danrenfuben = value::getvalue('map', 'is_danrenfuben', 'id', $in_map_id);
    $is_duorenfuben = value::getvalue('map', 'is_duorenfuben', 'id', $in_map_id);
    $is_gonghuilingdi = value::getvalue('map', 'is_gonghuilingdi', 'id', $in_map_id);
    //查询地图物品
    $item_count = 0;
    $search = "map.{$in_map_id}.i.";
    $sql = "SELECT `id`,`valuename`,`value` FROM `game_value` WHERE `valuename` LIKE 'map.{$in_map_id}.i.%'";
    $result = sql($sql);
    while (list($value_id, $item_id, $count) = $result->fetch_row()) {
        if ($item_count) {
            br();
        }
        $item_count++;
        $item_id = str_replace($search, "", $item_id);
        $name = value::getvalue('item', 'name', 'id', $item_id);
        $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
        cmd::addcmd('e59,' . $value_id . ',' . $item_id . ',' . $count . ',' . $name . ',' . $liangci, $name . 'x' . $count . $liangci);
    }
    //查询地图道具
    $sql = "SELECT `id`,`name`,`prop_id`,`star1` FROM `game_prop` WHERE `map_id`={$in_map_id}";
    $result = sql($sql);
    while (list($prop_id, $prop_name, $prop_zz_id, $star1) = $result->fetch_row()) {
        if ($item_count) {
            br();
        }
        $liangci = value::get_prop_value($prop_zz_id, 'liangci');
        $item_count++;
        cmd::addcmd('e98,' . $prop_id . ',1', $prop_name . "x1{$liangci}");
    }
    if (!$item_count) {
        echo '你在找什么东西?';
    }
}

//地图 查看地上物品详情事件
function e59($value_id, $item_id, $item_count, $item_name, $item_liangci, $mode = 0)
{
    if (!$mode) {
        ck_e41($item_id);
        echo '数量:' . $item_count . $item_liangci;
        br();
        cmd::addcmd('e59,' . $value_id . "," . $item_id . "," . $item_count . "," . $item_name . "," . $item_liangci . ",1", '捡起物品');
        br();
        cmd::addcmd('e58', '返回上级');
    } else {
        if (value::getvalue('game_value', 'value', 'id', $value_id)) {
            sql("DELETE FROM `game_value` WHERE `id`={$value_id} LIMIT 1");
            item::add_item($item_id, $item_count);
            e5();
        } else {
            echo '你要捡的东西已经不在这里了。';
            br();
            e5();
        }
    }
    return true;
}

//背包 宠物排序
function e61($pet_sort_str = '')
{
    $user_id = uid();
    $pet_id = explode('_', $pet_sort_str);
    $c_count = count($pet_id);
    //身上宠物总数
    $pet_count = user::get_pet_count($user_id, 1);
    if ($pet_count < 2) {
        echo "宠物无需排序。";
        br();
        e35();
        return;
    }
    if ($pet_count == $c_count) {
        //判断宠物是否都属于该玩家
        $pet_ok = true;
        for ($l = 1; $l <= $c_count; $l++) {
            if (!user::have_pet(0, $pet_id[$l - 1])) {
                $pet_ok = false;
            }
        }
        //宠物都属于该玩家 进行排序
        if ($pet_ok) {
            for ($k = 1; $k <= $c_count; $k++) {
                value::set_pet_value($pet_id[$k - 1], 'master_num', $k);
            }
        }
        e35();
        return;
    }
    //正在设置第几只宠物
    if ($pet_sort_str) {
        $i = count($pet_id) + 1;
    } else {
        $i = 1;
    }
    if ($c_count < ($pet_count - 1)) {
        echo '请选择第' . $i . '只出场的宠物:';
        br();
    }
    //排除已设置宠物
    $not_str = "";
    if ($i > 1) {
        for ($j = 0; $j < count($pet_id); $j++) {
            $not_str .= " AND `id` != " . $pet_id[$j];
        }
    }
    //查询未设置宠物
    $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`=$user_id AND `master_mode`=1 $not_str ORDER BY `master_num` LIMIT 5";
    $result = sql($sql);
    while (list($c_pet_id) = $result->fetch_row()) {
        if ($pet_count == ($c_count + 1) && $pet_sort_str) {
            e61($pet_sort_str . '_' . $c_pet_id);
            return;
        }
        if ($pet_sort_str) {
            $cmd_str = 'e61,' . $pet_sort_str . "_" . $c_pet_id;
        } else {
            $cmd_str = 'e61,' . $pet_sort_str . $c_pet_id;
        }
        $pet_nick_name = value::get_pet_value($c_pet_id, 'nick_name');
        cmd::addcmd($cmd_str, ($pet_nick_name ? "({$pet_nick_name})" : "") . value::get_pet_value($c_pet_id, 'name') . '(' . value::get_pet_value($c_pet_id, 'lvl') . '级)');
        br();
    }
    cmd::addcmd('e35', '返回上级');
}

//背包 查看宠物
function e62($oid = 0)
{
    value::set_user_value('study_skill_from', 2);
    if ($oid) {
        value::set_user_value('look_pet_id', $oid);
    } else {
        $oid = value::get_user_value('look_pet_id');
    }
    if (!user::have_pet(0, $oid)) {
        echo "该宠物已经不属于你了。";
        br();
        cmd::addcmd('e35', '返回上级');
        return;
    }
    //获取宠物属性
    $sql = "SELECT `pet_id`,`star`,`name`,`zhiye`,`tf`,`sx`,`czl`,`sex`,`is_yj`,`nick_name`,`lvl`,`max_lvl`,`hp`,`max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`exp`,`max_exp`,`shuxingdian`,`zhongcheng`,`zhuangtai`,`xingge`,`texing`,`zhuansheng`,`is_dead`,`hechongcishu` FROM `game_pet` WHERE `id`={$oid} LIMIT 1";
    $result = sql($sql);
    list($ozzid, $star, $oname, $zhiye, $tf, $sx, $czl, $osex, $is_yj, $nick_name, $lvl, $max_lvl, $hp, $max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $exp, $max_exp, $shuxingdian, $zhongcheng, $zhuangtai, $xingge, $texing, $zhuansheng, $is_dead, $hechongcishu) = $result->fetch_row();
    $hp = (int)$hp;
    $max_hp = (int)$max_hp;
    $fuhao = ($osex == '' ? "" : "");
    //六维加成
    $pugong_jc = pet::get_liuwei_jiacheng($oid, 'pugong');
    $pufang_jc = pet::get_liuwei_jiacheng($oid, 'pufang');
    $tegong_jc = pet::get_liuwei_jiacheng($oid, 'tegong');
    $tefang_jc = pet::get_liuwei_jiacheng($oid, 'tefang');
    $minjie_jc = pet::get_liuwei_jiacheng($oid, 'minjie');
    $hp_jc = pet::get_liuwei_jiacheng($oid, 'hp');
    //获取种族属性
    $sql = "SELECT `image`,`desc`,`star`,`wl`,`ty`,`zl`,`zz`,`ml`,`ys`,`shuxing`,`study_lvl`,`jh_id`,`jh_lvl` FROM `pet` WHERE `id`={$ozzid}" . " LIMIT 1";
    $result = sql($sql);
    list($image, $desc, $star10, $wl, $ty, $zl, $zz, $ml, $ys, $shuxing, $study_lvl, $jh_id, $jh_lvl) = $result->fetch_row();
    if (!$oname) {
        //返回地图
        echo '你已经没有这只宠物了。';
        br();
        e35();
        return;
    }
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    echo $xj . "星：" . $oname . ($nick_name ? "({$nick_name})" : "") . ($is_dead ? "(已死亡)" : "");
    br();
    //输出图片 描述
    if (!value::get_user_value('kg.xscwtp')) {
        if ($image != "") {
            pet::img($image, true, false);
            br();
        }
    }
    $xs_max_hp = $hp_jc + $max_hp;
    $xs_pugong = $pugong_jc + $pugong;
    $xs_pufang = $pufang_jc + $pufang;
    $xs_tegong = $tegong_jc + $tegong;
    $xs_tefang = $tefang_jc + $tefang;
    $xs_minjie = $minjie_jc + $minjie;
    echo "等级：" . $lvl;
    br();
    if ($sx <= 1) {
        $shuxing = "金";
    } else if ($sx == 2) {
        $shuxing = "木";
    } else if ($sx == 3) {
        $shuxing = "水";
    } else if ($sx == 4) {
        $shuxing = "火";
    } else if ($sx == 5) {
        $shuxing = "土";
    } else {
        $shuxing = "无";
    }
    if ($shuxing) {
        echo "五行：" . $shuxing;
    } else {
        echo "五行：无";
    }
    br();
    if ($czl == 100) {
        $czl_mz = "(极)";
    } else if ($czl >= 90) {
        $czl_mz = "(珍)";
    } else if ($czl >= 75) {
        $czl_mz = "(优)";
    } else {
        $czl_mz = "(普)";
    }
    if ($czl) {
        echo "成长率：" . $czl;
        echo "  ";
        echo $czl_mz;
    } else {
        echo "成长率：无";
    }
    br();
    if ($tf <= 1) {
        $tf_shuxing = "生命型";
    } else if ($tf == 2) {
        $tf_shuxing = "攻击型";
    } else if ($tf == 3) {
        $tf_shuxing = "防御型";
    } else if ($tf == 4) {
        $tf_shuxing = "魔攻型";
    } else if ($tf == 5) {
        $tf_shuxing = "魔防型";
    } else if ($tf == 6) {
        $tf_shuxing = "灵活型";
    } else {
        $tf_shuxing = "无";
    }
    if ($tf_shuxing) {
        echo "天赋：" . $tf_shuxing;
    } else {
        echo "天赋：无";
    }
    br();
    echo "经验：" . $exp . "/" . $max_exp;
    br();
    echo "生命：" . $hp . "/" . $xs_max_hp . " " . "忠诚度:" . $zhongcheng;
    br();
    if ($desc != "") {
        echo $desc;
    } else {
        echo "这是一只" . $oname . "。";
    }
    br();
    //输出等级 六维 属性 属性点 忠诚度 状态 性格 天赋
    $yj_xs = ($is_yj < 1) ? "临时":"永久";
    echo "<span style='color: green'><style>td,th{text-align:center;font-size:18px;}</style><table  border='0'><tbody>
    <tr><td>攻击：</td><th>{$xs_pugong}</th><td>防御：</td><th>{$xs_pufang}</th></tr>
    <tr><td>魔攻：</td><th>{$xs_tegong}</th><td>魔防：</td><th>{$xs_tefang}</th></tr>
    <tr><td>灵活：</td><th>{$xs_minjie}</th><td>状态：</td><th>{$yj_xs}</th></tr>
    </tbody></table></span>";
    //获取装配道具
    $equip_liuwei_id_arr = pet::get_prop_id($oid, 2);
    if (is_array($equip_liuwei_id_arr)) {
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_liuwei_id_arr as $equip_id) {
            $equip_name = prop::get($equip_id, 'name');
            $star1 = prop::get($equip_id, 'star1');
            $equip_subtype = value::get_game_prop_zz_value($equip_id, 'sub_leixing');
            echo $equip_subtype_arr[$equip_subtype], ':';
            cmd::addcmd("e98,{$equip_id},2", $equip_name);
            br();
        }
    }
    $equip_baowu_id = pet::get_prop_id($oid, 3);
    if ($equip_baowu_id) {
        $equip_baowu_name = prop::get($equip_baowu_id, 'name');
        echo '宝物:';
        cmd::addcmd("e98,{$equip_baowu_id},2", $equip_baowu_name);
        br();
    }
    //获取装配道具
    //宠物操作
    if ($shuxingdian) {
        cmd::addcmd('e78,' . $oid, "属性分配 (" . $shuxingdian . ")");
        br();
    }
    cmd::addcmd('e66,' . $oid, '使用物品');
    br();
    if ($zhiye) {
        cmd::addcmd('e102,' . $oid, '使用装备');
        br();
    } else {
        cmd::addcmd('sy_e102,' . $oid, '使用装备');
        br();
    }
    cmd::addcmd('e104,' . $oid, '宠物昵称');
    br();
    cmd::addcmd('e83,' . $oid, '宠物技能');
    br();
    cmd::addcmd('e64,' . $oid, '抛弃宠物');
    br();
    cmd::addcmd('e75,' . $oid, '打入宠物袋');
    br();
    //返回
    cmd::addcmd('e35', '返回上级');
}

//背包 查看宠物
function sy_e102($oid = 0)
{
    cmd::addcmd('e35', '宠物');
    echo ' <<';
    br();
    echo '你的宠物不能使用装备，只能召唤英雄和元神分身可以使用装备了！';
    br();
}
//背包 查看宠物
function e621($oid = 0, $o_id = 0)
{
    if ($oid) {
        value::set_user_value('look_user.id', $oid);
    } else {
        $oid = value::get_user_value('look_user.id');
    }
    //获取宠物属性
    $sql = "SELECT `pet_id`,`star`,`name`,`sex`,`tf`,`sx`,`czl`,`is_yj`,`nick_name`,`lvl`,`max_lvl`,`hp`,`max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`exp`,`max_exp`,`shuxingdian`,`zhongcheng`,`zhuangtai`,`xingge`,`texing`,`zhuansheng`,`is_dead`,`hechongcishu` FROM `game_pet` WHERE `id`={$oid} LIMIT 1";
    $result = sql($sql);
    list($ozzid, $star, $oname, $osex, $tf, $sx, $czl, $is_yj, $nick_name, $lvl, $max_lvl, $hp, $max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $exp, $max_exp, $shuxingdian, $zhongcheng, $zhuangtai, $xingge, $texing, $zhuansheng, $is_dead, $hechongcishu) = $result->fetch_row();
    $hp = (int)$hp;
    $max_hp = (int)$max_hp;
    $fuhao = ($osex == '' ? "" : "");
    //六维加成
    $pugong_jc = pet::get_liuwei_jiacheng($oid, 'pugong');
    $pufang_jc = pet::get_liuwei_jiacheng($oid, 'pufang');
    $tegong_jc = pet::get_liuwei_jiacheng($oid, 'tegong');
    $tefang_jc = pet::get_liuwei_jiacheng($oid, 'tefang');
    $minjie_jc = pet::get_liuwei_jiacheng($oid, 'minjie');
    $hp_jc = pet::get_liuwei_jiacheng($oid, 'hp');
    //获取种族属性
    $sql = "SELECT `image`,`desc`,`star`,`wl`,`ty`,`zl`,`zz`,`ml`,`ys`,`shuxing`,`study_lvl`,`jh_id`,`jh_lvl` FROM `pet` WHERE `id`={$ozzid}" . " LIMIT 1";
    $result = sql($sql);
    list($image, $desc, $star10, $wl, $ty, $zl, $zz, $ml, $ys, $shuxing, $study_lvl, $jh_id, $jh_lvl) = $result->fetch_row();
    if (!$oname) {
        //返回地图
        echo '你已经没有这只宠物了。';
        br();
        e35();
        return;
    }
    //输出宠物名字
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    echo $xj . "星：" . $oname . ($nick_name ? "({$nick_name})" : "") . ($is_dead ? "(已死亡)" : "");
    br();
    //输出图片 描述
    if (!value::get_user_value('kg.xscwtp')) {
        if ($image != "") {
            pet::img($image, true, false);
            br();
        }
    }
    $xs_max_hp = $hp_jc + $max_hp;
    $xs_pugong = $pugong_jc + $pugong;
    $xs_pufang = $pufang_jc + $pufang;
    $xs_tegong = $tegong_jc + $tegong;
    $xs_tefang = $tefang_jc + $tefang;
    $xs_minjie = $minjie_jc + $minjie;
    echo "等级：" . $lvl;
    br();
    if ($sx <= 1) {
        $shuxing = "金";
    } else if ($sx == 2) {
        $shuxing = "木";
    } else if ($sx == 3) {
        $shuxing = "水";
    } else if ($sx == 4) {
        $shuxing = "火";
    } else if ($sx == 5) {
        $shuxing = "土";
    } else {
        $shuxing = "无";
    }
    if ($shuxing) {
        echo "五行：" . $shuxing;
    } else {
        echo "五行：无";
    }
    br();
    if ($czl == 100) {
        $czl_mz = "(极)";
    } else if ($czl >= 90) {
        $czl_mz = "(珍)";
    } else if ($czl >= 75) {
        $czl_mz = "(优)";
    } else {
        $czl_mz = "(普)";
    }
    if ($czl) {
        echo "成长率：" . $czl;
        echo "  ";
        echo $czl_mz;
    } else {
        echo "成长率：无";
    }
    br();
    if ($tf <= 1) {
        $tf_shuxing = "生命型";
    } else if ($tf == 2) {
        $tf_shuxing = "攻击型";
    } else if ($tf == 3) {
        $tf_shuxing = "防御型";
    } else if ($tf == 4) {
        $tf_shuxing = "魔攻型";
    } else if ($tf == 5) {
        $tf_shuxing = "魔防型";
    } else if ($tf == 6) {
        $tf_shuxing = "灵活型";
    } else {
        $tf_shuxing = "无";
    }
    if ($tf_shuxing) {
        echo "天赋：" . $tf_shuxing;
    } else {
        echo "天赋：无";
    }
    br();
    echo "经验:" . $exp . "/" . $max_exp;
    br();
    echo "生命:" . $hp . "/" . $xs_max_hp . " " . "忠诚度:" . $zhongcheng;
    br();
    if ($desc != "") {
        echo $desc;
    } else {
        echo "这是一只" . $oname . "。";
    }
    br();
    //输出等级 六维 属性 属性点 忠诚度 状态 性格 天赋
    $yj_xs = ($is_yj < 1) ? "临时":"永久";
    echo "<span style='color: green'><style>td,th{text-align:center;font-size:20px;}</style><table  border='0'><tbody>
    <tr><td>攻击:</td><th>{$xs_pugong}</th><td>防御:</td><th>{$xs_pufang}</th></tr>
    <tr><td>魔攻:</td><th>{$xs_tegong}</th><td>魔防:</td><th>{$xs_tefang}</th></tr>
    <tr><td>灵活:</td><th>{$xs_minjie}</th><td>状态:</td><th>{$yj_xs}</th></tr>
    </tbody></table></span>";
    //获取装配道具
    $equip_liuwei_id_arr = pet::get_prop_id($oid, 2);
    if (is_array($equip_liuwei_id_arr)) {
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_liuwei_id_arr as $equip_id) {
            $equip_name = prop::get($equip_id, 'name');
            $star1 = prop::get($equip_id, 'star1');
            $equip_subtype = value::get_game_prop_zz_value($equip_id, 'sub_leixing');
            echo $equip_subtype_arr[$equip_subtype], ':';
            cmd::addcmd("e98,{$equip_id},2", $equip_name);
            br();
        }
    }
    $equip_baowu_id = pet::get_prop_id($oid, 3);
    if ($equip_baowu_id) {
        $equip_baowu_name = prop::get($equip_baowu_id, 'name');
        echo '宝物:';
        cmd::addcmd("e981,{$equip_baowu_id},2", $equip_baowu_name);
        br();
    }
    /*if (!$step) {
        $zhuansheng = value::get_pet_value($oid, 'zhuansheng');
        echo '技能:';
        $moren_skill_id = value::get_pet_value2('skill_moren.id', $oid, false);
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $oid, false)) {
            $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
            $max_pp *= $zhuansheng ? 1.5 : 1;
            $max_pp = (int)$max_pp;
            cmd::addcmd('e831,' . $oid . ',1,' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
            echo ",";
            $i++;
        }
        echo '';
        return;
    } else if ($step == 1) {
        echo '[' . value::getvalue('skill', 'name', 'id', $skill_id) . ']';
        br();
        echo '威力:' . value::getvalue('skill', 'weili', 'id', $skill_id) . ' 命中:' . value::getvalue('skill', 'mingzhong', 'id', $s_id);
        br();
    }*/
    cmd::addcmd('e351,' . $o_id, '返回上级');
}

//背包 查看宠物
function bx_e621($oid = 0, $mode = 0)
{
    //获取宠物属性
    $sql = "SELECT `pet_id`,`star`,`name`,`sex`,`tf`,`sx`,`czl`,`is_yj`,`nick_name`,`lvl`,`max_lvl`,`hp`,`max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`exp`,`max_exp`,`shuxingdian`,`zhongcheng`,`zhuangtai`,`xingge`,`texing`,`zhuansheng`,`is_dead`,`hechongcishu` FROM `game_pet` WHERE `id`={$oid} LIMIT 1";
    $result = sql($sql);
    list($ozzid, $star, $oname, $osex, $tf, $sx, $czl, $is_yj, $nick_name, $lvl, $max_lvl, $hp, $max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $exp, $max_exp, $shuxingdian, $zhongcheng, $zhuangtai, $xingge, $texing, $zhuansheng, $is_dead, $hechongcishu) = $result->fetch_row();
    $hp = (int)$hp;
    $max_hp = (int)$max_hp;
    $fuhao = ($osex == '' ? "" : "");
    //六维加成
    $pugong_jc = pet::get_liuwei_jiacheng($oid, 'pugong');
    $pufang_jc = pet::get_liuwei_jiacheng($oid, 'pufang');
    $tegong_jc = pet::get_liuwei_jiacheng($oid, 'tegong');
    $tefang_jc = pet::get_liuwei_jiacheng($oid, 'tefang');
    $minjie_jc = pet::get_liuwei_jiacheng($oid, 'minjie');
    $hp_jc = pet::get_liuwei_jiacheng($oid, 'hp');
    //获取种族属性
    $sql = "SELECT `image`,`desc`,`star`,`wl`,`ty`,`zl`,`zz`,`ml`,`ys`,`shuxing`,`study_lvl`,`jh_id`,`jh_lvl` FROM `pet` WHERE `id`={$ozzid}" . " LIMIT 1";
    $result = sql($sql);
    list($image, $desc, $star10, $wl, $ty, $zl, $zz, $ml, $ys, $shuxing, $study_lvl, $jh_id, $jh_lvl) = $result->fetch_row();
    if (!$oname) {
        //返回地图
        echo '你已经没有这只宠物了。';
        br();
        e35();
        return;
    }
    //输出宠物名字
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    echo $xj . "星宠物:" . $oname . ($nick_name ? "({$nick_name})" : "") . ($is_dead ? "(已死亡)" : "");
    br();
    //输出图片 描述
    if (!value::get_user_value('kg.xscwtp')) {
        if ($image != "") {
            pet::img($image, true, false);
            br();
        }
    }
    $xs_max_hp = $hp_jc + $max_hp;
    $xs_pugong = $pugong_jc + $pugong;
    $xs_pufang = $pufang_jc + $pufang;
    $xs_tegong = $tegong_jc + $tegong;
    $xs_tefang = $tefang_jc + $tefang;
    $xs_minjie = $minjie_jc + $minjie;
    echo "等级:" . $lvl;
    br();
    if ($sx <= 1) {
        $shuxing = "金";
    } else if ($sx == 2) {
        $shuxing = "木";
    } else if ($sx == 3) {
        $shuxing = "水";
    } else if ($sx == 4) {
        $shuxing = "火";
    } else if ($sx == 5) {
        $shuxing = "土";
    } else {
        $shuxing = "无";
    }
    if ($shuxing) {
        echo "五行：" . $shuxing;
    } else {
        echo "五行：无";
    }
    br();
    if ($czl == 100) {
        $czl_mz = "(极)";
    } else if ($czl >= 90) {
        $czl_mz = "(珍)";
    } else if ($czl >= 75) {
        $czl_mz = "(优)";
    } else {
        $czl_mz = "(普)";
    }
    if ($czl) {
        echo "成长率：" . $czl;
        echo "  ";
        echo $czl_mz;
    } else {
        echo "成长率：无";
    }
    br();
    if ($tf <= 1) {
        $tf_shuxing = "生命型";
    } else if ($tf == 2) {
        $tf_shuxing = "攻击型";
    } else if ($tf == 3) {
        $tf_shuxing = "防御型";
    } else if ($tf == 4) {
        $tf_shuxing = "魔攻型";
    } else if ($tf == 5) {
        $tf_shuxing = "魔防型";
    } else if ($tf == 6) {
        $tf_shuxing = "灵活型";
    } else {
        $tf_shuxing = "无";
    }
    if ($tf_shuxing) {
        echo "天赋：" . $tf_shuxing;
    } else {
        echo "天赋：无";
    }
    br();
    echo "经验:" . $exp . "/" . $max_exp;
    br();
    echo "生命:" . $hp . "/" . $xs_max_hp . " " . "忠诚度:" . $zhongcheng;
    br();
    if ($desc != "") {
        echo $desc;
    } else {
        echo "这是一只" . $oname . "。";
    }
    br();
    //输出等级 六维 属性 属性点 忠诚度 状态 性格 天赋
    $yj_xs = ($is_yj < 1) ? "临时":"永久";
    echo "<span style='color: green'><style>td,th{text-align:center;font-size:20px;}</style><table  border='0'><tbody>
    <tr><td>攻击:</td><th>{$xs_pugong}</th><td>防御:</td><th>{$xs_pufang}</th></tr>
    <tr><td>魔攻:</td><th>{$xs_tegong}</th><td>魔防:</td><th>{$xs_tefang}</th></tr>
    <tr><td>灵活:</td><th>{$xs_minjie}</th><td>状态:</td><th>{$yj_xs}</th></tr>
    </tbody></table></span>";
    //获取装配道具
    $equip_liuwei_id_arr = pet::get_prop_id($oid, 2);
    if (is_array($equip_liuwei_id_arr)) {
        $equip_subtype_arr = config::getConfigByName("equip_subtype");
        foreach ($equip_liuwei_id_arr as $equip_id) {
            $equip_name = prop::get($equip_id, 'name');
            $star1 = prop::get($equip_id, 'star1');
            $equip_subtype = value::get_game_prop_zz_value($equip_id, 'sub_leixing');
            echo $equip_subtype_arr[$equip_subtype], ':';
            cmd::addcmd("e98,{$equip_id},2", $equip_name);
            br();
        }
    }
    $equip_baowu_id = pet::get_prop_id($oid, 3);
    if ($equip_baowu_id) {
        $equip_baowu_name = prop::get($equip_baowu_id, 'name');
        echo '宝物:';
        cmd::addcmd("e981,{$equip_baowu_id},2", $equip_baowu_name);
        br();
    }
    /*if (!$step) {
        $zhuansheng = value::get_pet_value($oid, 'zhuansheng');
        echo '技能:';
        $moren_skill_id = value::get_pet_value2('skill_moren.id', $oid, false);
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $oid, false)) {
            $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
            $max_pp *= $zhuansheng ? 1.5 : 1;
            $max_pp = (int)$max_pp;
            cmd::addcmd('e831,' . $oid . ',1,' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
            echo ",";
            $i++;
        }
        echo '';
        return;
    } else if ($step == 1) {
        echo '[' . value::getvalue('skill', 'name', 'id', $skill_id) . ']';
        br();
        echo '威力:' . value::getvalue('skill', 'weili', 'id', $skill_id) . ' 命中:' . value::getvalue('skill', 'mingzhong', 'id', $s_id);
        br();
    }*/
    if (!$mode) {
        cmd::addcmd('e47', '返回上级');
    } else {
        cmd::addcmd('e0', '返回上级');
    }
}

//宠物 查看天赋详情
function e63($texing_num, $mode = 0, $pet_id = 0)
{
    $texingmiaoshu = explode(':', pet::get_texing($texing_num));
    echo $texingmiaoshu[1] . "。";
    br();
    if (!$mode) {
        cmd::addcmd('e62', '返回上级');
    } else {
        cmd::addcmd('e124,' . $pet_id, '返回上级');
    }
}

//宠物 查看天赋详情
function e633($texing_num, $mode = 0, $pet_id = 0)
{
    $texingmiaoshu = explode(':', pet::get_texing($texing_num));
    echo $texingmiaoshu[1] . "。";
    br();
    if (!$mode) {
        cmd::addcmd('e621', '返回上级');
    } else {
        cmd::addcmd('e621,' . $pet_id, '返回上级');
    }
}

//宠物 查看天赋详情
function e631($xingge_num, $mode = 0, $pet_id = 0)
{
    $xinggemiaoshu = explode(':', pet::get_xingge1($xingge_num));
    echo $xinggemiaoshu[1] . "。";
    br();
    if (!$mode) {
        cmd::addcmd('e62', '返回上级');
    } else {
        cmd::addcmd('e124,' . $pet_id, '返回上级');
    }
}

//宠物 查看天赋详情
function e632($xingge_num, $mode = 0, $pet_id = 0)
{
    $xinggemiaoshu = explode(':', pet::get_xingge1($xingge_num));
    echo $xinggemiaoshu[1] . "。";
    br();
    if (!$mode) {
        cmd::addcmd('e621', '返回上级');
    } else {
        cmd::addcmd('e621,' . $pet_id, '返回上级');
    }
}

//宠物 抛弃宠物
function e64($oid, $step = 0)
{
    $oname = value::get_pet_value($oid, 'name');
    $paoqi = strtoupper(value::real_escape_string($_POST['paoqi']));
    if ($step) {
        if ($paoqi == '确定' || $paoqi == 'ok' || $paoqi == 'OK') {
            if (pet::user_lose_pet(uid(), $oid, 1)) {
                prop::pet_lose_all_prop($oid);
                echo "你成功抛弃了" . $oname . "。";
                pet::del_pet($oid);
                br();
                cmd::addcmd('e35', '返回上级');
            } else {
                cmd::addcmd('e62', '返回上级');
            }
        } else {
            e62();
        }
    } else {
        $cmd = cmd::addcmd('e64,' . $oid . ',1', '抛弃', false);
        echo <<<paoqiform
你忍心抛弃{$oname}吗?<br>输入<span style="color: #ff0000">确定</span>或<span style="color: #ff0000">OK</span>确认操作:
<form action="game.php?cmd=$cmd" method="post">
    <input type="text" name="paoqi" maxlength="2">
	<br>
	<input type="submit" value="确定抛弃" name="抛弃">
</form>
paoqiform;
        cmd::addcmd('e62', '返回上级');
    }
}

//排行 获取排行第一名
function e65($mode)
{
    $oid = 0;
    switch ($mode) {
        case 1:
            //[练宠之王]
            $oid = value::get_system_value("lyzw.id");
            break;
        case 2:
            //[猎妖圣手]
            $oid = value::get_system_value("lyss.id");
            break;
        case 3:
            //[名动江湖]
            $oid = value::get_system_value("mdjh.id");
            break;
        case 4:
            //[倾国倾城]
            $oid = value::get_system_value("qgqc.id");
            break;
        case 5:
            //[富甲天下]
            $oid = value::get_system_value("fjtx.id");
            break;
        case 6:
            //[百战天师]
            $oid = value::get_system_value("bzts.id");
            break;
        case 7:
            //[赏金杀手]
            $oid = value::get_system_value("sjss.id");
            break;
        case 8:
            //[妙手神匠]
            $oid = value::get_system_value("mssj.id");
            break;
        case 9:
            //[狱中常客]
            $oid = value::get_system_value("yzck.id");
            break;
        case 10:
            //[抗眠勇士]
            $oid = value::get_system_value("bmys.id");
            break;
    }
    return $oid;
}

//宠物 使用药品
function e66($pet_id)
{
    if (!user::have_pet(0, $pet_id)) {
        echo "该宠物已经不属于你了。";
        br();
        return;
    }
    echo "你想要喂什么东西?";
    br();
    //获取可使用物品列表
    $user_id = uid();
    $item_count = 0;
    $item_shuji_array = array();
    //道具
    $sql = "SELECT `id`,`name`,`prop_id`,`exp` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `exp`>0";
    $result = sql($sql);
    while (list($game_prop_id, $name, $prop_id, $exp) = $result->fetch_row()) {
        $liangci = value::get_prop_value($prop_id, 'liangci');
        cmd::addcmd('e101,' . $game_prop_id . ',' . $pet_id . ',0,1', $name . "x1" . $liangci);
        br();
        echo "存有{$exp}点经验的仙丹。";
        br();
        $item_count++;
    }
    //药品
    $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
    $result = sql($sql);
    while (list($id, $count) = $result->fetch_row()) {
        if ($count) {
            $id = explode('.', $id);
            if (value::get_item_value($id[2], 'is_map_use') && value::get_item_value($id[2], 'is_pet_use')) {
                if (!value::get_item_value($id[2], 'is_shuji')) {
                    $name = value::getvalue('item', 'name', 'id', $id[2]);
                    $liangci = value::getvalue('item', 'liangci', 'id', $id[2]);
                    $desc = value::getvalue('item', 'desc', 'id', $id[2]);
                    cmd::addcmd('e55,' . $id[2] . ',' . $pet_id . ',1', $name . "x" . $count . $liangci);
                    br();
                    echo $desc;
                    br();
                }
                $item_count++;
            }
        }
    }
    //秘籍
    if ($item_shuji_array) {
        foreach ($item_shuji_array as $shuji_id) {
            $name = value::getvalue('item', 'name', 'id', $shuji_id);
            $count = item::get_item($shuji_id, $user_id);
            $liangci = value::getvalue('item', 'liangci', 'id', $shuji_id);
            $desc = value::getvalue('item', 'desc', 'id', $shuji_id);
            cmd::addcmd('e55,' . $shuji_id . ',' . $pet_id . ',1', $name . "x" . $count . $liangci);
            br();
            echo $desc;
            br();
        }
    }
    if (!$item_count) {
        echo "你身上什么东西都没有。";
        br();
    }
    cmd::addcmd('e62', '返回上级');
}

//角色 获取初始宠物
function e67()
{
    ctm::show_ctm('ctm_shouye');
    cmd::set_show_return_game(false);
}

//活动道具掉落
function hd_dj_dl($o_pet_id, $map_id)
{
    $user_id = uid();
    $pet_id = value::get_pet_value($o_pet_id, 'pet_id');
    $map_id = value::get_game_user_value('in_map_id', $user_id);
    $cs_boss = mt_rand(264, 269);
    $cs = mt_rand(0, 100);
    if ($cs < 10) {
        item::map_add_item($map_id, $cs_boss, 1);
    }
    switch ($pet_id) {
        case 85:
            item::map_add_item($map_id, 251, 1);
            break;        
        case 86:
            item::map_add_item($map_id, 252, 1);
            break;        
        case 87:
            item::map_add_item($map_id, 253, 1);
            break;        
        case 88:
            item::map_add_item($map_id, 254, 1);
            break;        
        case 89:
            item::map_add_item($map_id, 255, 1);
            break;        
        case 90:
            item::map_add_item($map_id, 256, 1);
            break;
        case 91:
            item::map_add_item($map_id, 257, 1);
            break;
        case 92:
            item::map_add_item($map_id, 258, 1);
            break;
        case 93:
            item::map_add_item($map_id, 259, 1);
            break;
        case 94:
            item::map_add_item($map_id, 260, 1);
            break;
        case 95:
            item::map_add_item($map_id, 261, 1);
            break;
        case 96:
            item::map_add_item($map_id, 262, 1);
            break;
        default:
            break;
    }
}

//战斗 玩家战胜事件
function e68($mode, $o_pet_id = 0, $o_npc_id = 0, $user_id = 0)
{
    //获取玩家ID 队伍ID NPCID
    if (!$user_id) {
        $user_id = uid();
    }
    $u_team_id = team::get_user_team($user_id);
    $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
    $u_in_map_is_danrenfuben = value::get_map_value($u_in_map_id, 'is_danrenfuben');
    $u_in_map_is_duorenfuben = value::get_map_value($u_in_map_id, 'is_duorenfuben');
    $o_user_id = value::get_game_user_value('pk.user.id', $user_id);
    $o_user_name = value::get_game_user_value('name', $o_user_id);
    if (!$o_npc_id) {
        $o_npc_id = value::get_game_user_value('pk.npc.id', $user_id);
    }
    //设置PK模式
    value::set_user_value("pk_mode", $mode, $user_id);
    //玩家返回地图
    if ($mode > 2) {
        value::set_user_value('is_pk_settlement_doing', 1, $user_id);
        cmd::delallcmd($user_id);
    }
    value::set_game_user_value('in_ctm', 'ctm_map', $user_id);
    //对方宠物数据
    $o_pet_name = value::get_pet_value($o_pet_id, 'name');
    $o_pet_zzid = value::get_pet_value($o_pet_id, 'pet_id');
    $o_pet_lvl = 0;
    $o_pet_exp = 0;
    $win_exp = 0;
    $win_money = 0;
    //野怪 NPC
    if ($mode < 4) {
        //任务系统
        $task_arr = array();
        $sql = "SELECT `value` FROM `game_user_value` WHERE `userid`={$user_id} AND `valuename` LIKE '{$user_id}.task' LIMIT 0,5";
        $result = sql($sql);
        while (list($task_id) = $result->fetch_row()) {
            if (!call_task($task_id, 5, 0, 0, true, 0, $user_id)) {
                array_push($task_arr, $task_id);
            }
        }
        $task_count = count($task_arr);
        //验证任务
        if ($task_count) {
            for ($i = 0; $i < $task_count; $i++) {
                call_task($task_arr[$i], 3, $o_pet_zzid, $o_npc_id, false, 0, $user_id);
            }
        }
        //根据PK模式 处理敌方宠物
        //与野怪战斗
        if ($mode == 1) {
            //输出胜利语句
            skill::add_skill_chat($o_pet_name . '战死了', $user_id, $o_user_id);
            //获取被杀宠物 等级lvl 经验exp
            $pk_dy_money = value::get_user_value("pk_dy_money", $user_id);
            $pk_dy_exp = value::get_user_value("pk_dy_exp", $user_id);
            if ($pk_dy_exp) {
                $o_pet_money = $pk_dy_money;
                $o_pet_exp = $pk_dy_exp;
                value::set_user_value("pk_dy_money", 0, $dy_id);
                value::set_user_value("pk_dy_exp", 0, $dy_id);
            } else {
                $o_pet_money = value::get_pet_value($o_pet_id, 'money');
                $o_pet_exp = value::get_pet_value($o_pet_id, 'exp');
            }
            //boss战败提示
            $o_star = value::get_pet_value($o_pet_id, 'star');
            if ($o_star > 1) {
                //活动道具掉落
                hd_dj_dl($o_pet_id, $u_in_map_id);
                c_add_guangbo("恭喜玩家" . value::get_game_user_value('name') . "在" . value::get_map_value($u_in_map_id, 'name') . "击杀了" . value::get_pet_value($o_pet_id, 'name') . "!");
            }
            //道具掉落
            prop::pet_lose_all_prop($o_pet_id);
            //掉落奖励
            e221($o_pet_id, $u_in_map_id, $user_id);
            //处理被杀宠物
            pet::del_pet($o_pet_id);
            //增加除妖名声
            $chuyaoms = value::add_user_value('chuyaoshu', 1, $user_id);
            //奇遇事件
            if ($o_pet_lvl >= 50) {
                //奇遇系统 奖励修正
                $qiyu_count = value::get_user_value("qiyu_count", $user_id);
                $qiyu_success = value::get_user_value("qiyu_success", $user_id);
                if ($qiyu_count > 100 && $qiyu_success) {
                    $o_pet_exp *= ($qiyu_success / $qiyu_count);
                }
                //进入奇遇
                if ($chuyaoms % 500 == 0) {
                    value::set_user_value("is_qiyu", "1", $user_id);
                    value::set_user_value("qiyu_dclc", "0", $user_id);
                }
            }
            //刷将保护数量
            $qiyu_scbhsl = value::get_user_value("qiyu_scbhsl", $user_id);
            if ($qiyu_scbhsl) {
                value::add_user_value("qiyu_scbhsl", -1, $user_id);
            }
            //单人与NPC战斗
        } else if ($mode == 2) {
            //输出胜利语句
            skill::add_skill_chat('你打败了' . value::get_npc_value($o_npc_id, 'name') . '。', $user_id, $o_user_id);
            //处理NPC宠物
            $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$o_npc_id} AND `enemy_user`={$user_id} ORDER BY `id` ASC LIMIT 5";
            $result = sql($sql);
            while (list($oid) = $result->fetch_row()) {
                //道具掉落
                e170($o_npc_id, $u_in_map_id, $u_team_id, $user_id);
                //等级经验累加
                $o_pet_money = value::get_pet_value($o_pet_id, 'money');
                $o_pet_exp = value::get_pet_value($o_pet_id, 'exp');
            }
            //组队与NPC战斗
        } else if ($mode == 3) {
            //输出胜利语句
            skill::add_skill_chat('你打败了' . value::get_npc_value($o_npc_id, 'name') . '。', $user_id, $o_user_id);
            //处理NPC宠物
            $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$o_npc_id} AND `team_id`={$u_team_id} ORDER BY `id` ASC LIMIT 5";
            $result = sql($sql);
            while (list($oid) = $result->fetch_row()) {
                //道具掉落
                prop::pet_lose_all_prop($oid);
                //等级经验累加
                $o_pet_money = value::get_pet_value($o_pet_id, 'money');
                $o_pet_exp = value::get_pet_value($o_pet_id, 'exp');
            }
            //组队副本
            if ($u_in_map_is_duorenfuben) {
                //副本掉落
                e170($o_npc_id, $u_in_map_id, $u_team_id, $user_id);
                //记录首次挑战NPC
                user::set("first.drfb.npc.{$o_npc_id}.{$u_in_map_id}", 1, $user_id);
            }
        }
        //计算获得金币 经验
        if ($mode < 4) {
            $win_money = $o_pet_money;
            $win_exp = $o_pet_exp;
            $win_money = (int)$win_money;
            $win_exp = (int)$win_exp;
        } else {
            $win_money = value::get_user_value("pk_win_money", $user_id);
            $win_exp = value::get_user_value("pk_win_exp", $user_id);
        }
        //NPC模式
        if ($mode > 1 && $mode < 4) {
            //拦路事件
            if (value::get_npc_value($o_npc_id, 'is_lanlu')) {
                value::set_user_value('map.lanlu.' . $o_npc_id, 1, $user_id);
            }
        }
        //玩家战斗
    } else if ($mode == 4) {
        //增加红名
        $sports_id = value::get_user_value('pkjjid', $user_id);
        if ($sports_id) {
            sports::out_of_sports($sports_id, $user_id);
        }
        ///同帮派或同盟帮派 10倍红名惩罚
        $union_id = user::get_union($user_id);
        $o_union_id = user::get_union($o_user_id);
        if ($union_id == $o_union_id || union::is_tongmeng($union_id, $o_union_id)) {
            if ($union_id > 0) {
                $hongming *= 5;
            }
        }
        $is_zd_pk = value::get_user_value('is_zd_pk', $user_id);
        $o_hongming = value::get_user_value('hongming', $o_user_id);
        $is_hongming = value::get_user_value('hongming', $user_id);
        $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
        $u_ts_pk = value::get_map_value($u_in_map_id, 'ts_pk');
        if ($is_zd_pk > 0 && $u_ts_pk < 1) {
            value::add_user_value('hongming', 1, $user_id);
            skill::add_skill_chat("你获得了1点红名值", $user_id, 0);
        }
        //增加胜利数
        $today = date("Y-m-d");
        $in_sl_time = value::get_user_value('shengli_time', $user_id);
        if ($in_sl_time != $today) {
            value::set_user_value("shengli_time", $today, $user_id);
            value::set_user_value("shengli_count", 0, $user_id);
        }
        $sl_count = value::get_user_value("shengli_count", $user_id);
        if ($sl_count < 5) {
            value::add_user_value('shenglishu', 1, $user_id);
            value::add_user_value('shengli_count', 1, $user_id);
        }
    }

    //设置PK宠物
    $pet_arr = array();
    $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `is_pk`=1 AND `is_dead`=0 LIMIT 5";
    $result = sql($sql);
    while (list($u_pet_id) = $result->fetch_row()) {
        //增加忠诚
        value::add_pet_value($u_pet_id, 3, 1, false);
        //装备磨损
        pet::prop_mosun($u_pet_id, -1, $mode);
        //加入宠物数组
        array_push($pet_arr, $u_pet_id);
    }
    value::set_user_value("pk_pet_arr", json_encode((object)$pet_arr), $user_id);
    //设置金钱经验
    value::set_user_value("pk_win_money", $win_money, $user_id);
    value::set_user_value("pk_win_exp", $win_exp, $user_id);
    //胜利语句 金钱经验
    if ($mode < 4) {
        $in_map_id = value::get_game_user_value('in_map_id', $user_id);
        $team_id = team::get_user_team($user_id);
        $u_name = value::get_game_user_value('name', $user_id);
        skill::add_skill_chat('你获得了胜利。', $user_id, 0);
        $team_xx1 = value::get_user_value('pk_dy_xx1', $user_id);
        $team_xx3 = value::get_user_value('pk_dy_xx3', $user_id);
        $team_xx2 = $o_pet_name . "被" . $u_name . "杀死了";
        $sql = "SELECT `id` FROM `game_user` WHERE `pk.map_pet.id` = {$o_pet_id} AND `is_online` =1 AND `id` != {$user_id} LIMIT 0, 50";
        //开始获取
        if ($sql) {
            $result = sql($sql);
            while (list($gw_id) = $result->fetch_row()) {
                value::set_user_value('pk_dy_xx1', $team_xx2, $gw_id);
                value::set_user_value('pk_dy_xx3', 10, $gw_id);
            }
        }
        //队友获得经验方式
        value::set_user_value("pk_dy_money", 0, $user_id);
        value::set_user_value("pk_dy_exp", 0, $user_id);
        if ($team_xx3 < 1 && $team_id) {
            $sql = "SELECT COUNT(*) FROM `game_user` WHERE `in_map_id` = {$in_map_id} AND `id`!={$user_id} AND `team_id` = {$team_id} AND `is_online` =1";
            $result = sql($sql);
            list($dy_count) = $result->fetch_row();
            $sql = "SELECT `id` FROM `game_user` WHERE `in_map_id` = {$in_map_id} AND `is_online` =1 AND `id` != {$user_id} AND `team_id` = {$team_id} LIMIT 0, 5";
            //开始获取
            if ($sql) {
                $result = sql($sql);
                while (list($dy_id) = $result->fetch_row()) {
                    value::set_user_value("pk_dy_money", $win_money / 5 * $dy_count, $dy_id);
                    value::set_user_value("pk_dy_exp", $win_exp / 5 * $dy_count, $dy_id);
                }
            }
        }
        if ($team_xx3 > 0) {
            echo $team_xx1;
            br();
            value::set_user_value('pk_dy_xx3', 0, $user_id);
            value::set_user_value('pk_dy_xx1', 0, $user_id);
        }
        //野外宠物奖励
        if ($mode == 1) {
            //宠物星级
            $o_pet_star = (int)($o_pet_lvl / 20);
            if (!$o_pet_star) {
                $o_pet_star = 1;
            }
            $o_pet_star = $o_pet_star > 5 ? 5 : $o_pet_star;
        }
    }
    //玩家退出战斗
    user::exit_pk($user_id);
    //战斗结果
    if ($mode < 3) {
        //野怪 单人NPC
        e137();
    } else {
        //组队NPC 玩家
        if ($mode == 3) {
            skill::add_skill_chat('', $user_id, 0, true);
            $team_user_arr = team::get_team_user($u_team_id);
            foreach ($team_user_arr as $team_user_id) {
                if ($team_user_id != $user_id && value::get_game_user_value('pk.npc.id', $team_user_id) == $o_npc_id && value::get_game_user_value('in_ctm', $team_user_id) == 'ctm_pk_team_npc') {
                    e68($mode, 0, $o_npc_id, $team_user_id);
                }
            }
        }
        //结算完成
        value::set_user_value('is_pk_settlement_doing', 2, $user_id);
    }
}

//战斗 玩家逃跑事件
function e69($mode, $user_id = 0, $o_user_id = 0)
{
    $user_id = uid();
    if ($mode > 2) {
        //设置开始结算
        value::set_user_value('is_pk_settlement_doing', 1, $user_id);
        //设置PK模式
        value::set_user_value("pk_mode", $mode, $user_id);
        //更新刷新命令
        cmd::delallcmd($user_id);
        if ($o_user_id) {
            value::set_user_value('is_pk_settlement_doing', 1, $o_user_id);
            value::set_user_value("pk_mode", $mode, $o_user_id);
            cmd::delallcmd($o_user_id);
        }
    }
    $u_name = value::get_game_user_value('name', $user_id);
    //提取宠物ID
    $u_pet_id = value::get_game_user_value('pk.now_pet.id', $user_id);
    $u_name = value::get_game_user_value('name', $user_id);
    $u_pet_name = value::get_pet_value($u_pet_id, 'name');
    //设置PK属性
    value::set_user_value("pk_win_money", 0, $user_id);
    value::set_user_value("pk_win_exp", 0, $user_id);
    //战斗结果
    if ($mode < 3) {
        //野怪 NPC 单人
        //添加逃跑描述
        skill::add_skill_chat($u_name . "逃跑成功了！", $user_id, $o_user_id);
        e137();
    } else {
        //提交战斗信息
        skill::add_skill_chat($u_name . "逃跑成功了！", $user_id, $o_user_id);
        //组队NPC 玩家
        //战斗结算完成
        value::set_user_value('is_pk_settlement_doing', 2, $user_id);
        //玩家操作
        if ($mode == 4) {
            value::set_user_value('is_pk_settlement_doing', 2, $o_user_id);
            //敌方玩家退出PK
            user::exit_pk($o_user_id);
        }
    }
    //己方玩家退出PK
    user::exit_pk($user_id);
    return;
}

//角色 拉黑玩家事件
function e70($oid, $ok = false)
{
    $user_id = uid();
    if ($ok) {
        $sql = "SELECT `id` FROM `game_user_value` WHERE `userid`={$user_id} AND `valuename`='{$user_id}.heimingdan' AND `value`='{$oid}'";
        $result = sql($sql);
        list($value_id) = $result->fetch_row();
        if (!$value_id) {
            value::insert_user_value('heimingdan', $oid);
            echo '你把' . value::get_game_user_value('name', $oid) . '拉入了黑名单。';
        } else {
            echo '对方已经在你的黑名单内。';
        }
    } else {
        $oname = value::get_game_user_value('name', $oid);
        echo '确定要拉黑' . $oname . '吗?';
        br();
        cmd::addcmd('e70,' . $oid . ',true', '确认拉黑');
    }
    br();
    cmd::addcmd('e12,' . $oid, '返回上级');
}

//角色 查看黑名单列表
function e71($yeshu = 0)
{
    $user_id = uid();
    $danye_count = 15;
    cmd::addcmd('e13', '状态');
    echo ">> 黑名单";
    br();
    echo "-";
    br();
    //获取黑名单列表
    cmd::addcmd('e51', '好友');
    echo " . ";
    cmd::addcmd('e36,2', '聊天');
    echo " . ";
    cmd::addcmd('e139', '仇人');
    echo " . 黑名单";
    br();
    //获取黑名数量
    $sql = "SELECT COUNT(*) FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.heimingdan'";
    $result = sql($sql);
    list($heiming_count) = $result->fetch_row();
    //开始获取
    $sql = "SELECT `value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.heimingdan'";
    $result = sql($sql);
    //黑名单计数
    $count = 0;
    //离线黑名单 计数 名字数组
    $lxhm = array();
    $zxhm = array();
    $new_hm = array();
    $heiming_leixing_arr = array();
    while (list($oid) = $result->fetch_row()) {
        if ($oid) {
            if (value::get_game_user_value('is_online', $oid)) {
                array_push($zxhm, $oid);
                $heiming_leixing_arr[$oid] = 1;
            } else {
                array_push($lxhm, $oid);
                $heiming_leixing_arr[$oid] = 0;
            }
        }
        $count++;
    }
    if (!$count) {
        echo '你还没有黑名单哦！';
    } else {
        $new_hm = array_merge($zxhm, $lxhm);
    }
    //输出黑名链接
    $max_count = $count < ($yeshu + 1) * $danye_count ? $count : ($yeshu + 1) * $danye_count;
    for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
        if ($i > $yeshu * $danye_count) {
            br();
        }
        $oname = value::get_game_user_value('name', $new_hm[$i]);
        user::showVipLogo($new_hm[$i], true);
        if ($heiming_leixing_arr[$new_hm[$i]]) {
            cmd::addcmd('e12,' . $new_hm[$i] . ',4', $oname);
        } else {
            echo $oname;
        }
        $o_map_id = value::get_game_user_value('in_map_id', $new_hm[$i]);
        $o_map_name = value::get_map_value($o_map_id, 'name');
        echo "({$o_map_name})";
        echo ' ';
        cmd::addcmd('e72,' . $new_hm[$i], '删除');
    }
    //上下页操作
    $fanye = false;
    $max_page_num = (int)(($count - 1) / $danye_count) + 1;
    if ($yeshu) {
        if ($yeshu > 1) {
            cmd::addcmd('e71', '首页');
            echo "|";
        }
        cmd::addcmd('e71,' . ($yeshu - 1), '上—页');
        $fanye = true;
    }
    if ($heiming_count > ($yeshu + 1) * $danye_count) {
        if ($yeshu) {
            echo "|";
        }
        cmd::addcmd('e71,' . ($yeshu + 1), '下—页');
        if ($yeshu + 2 < $max_page_num) {
            echo "|";
            cmd::addcmd('e71,' . ($max_page_num - 1), '末页');
        }
        $fanye = true;
    }
    //是否翻页换行
    if ($fanye) {
        br();
    }
    br();
    echo "-";
}

//角色 删除黑名单
function e72($oid)
{
    $uid = uid();
    $oname = value::get_game_user_value('name', $oid);
    $sql = "DELETE FROM `game_user_value` WHERE `valuename` LIKE '{$uid}.heimingdan' AND `value` LIKE '{$oid}'";
    sql($sql);
    echo '成功将' . $oname . '从黑名单里删除。';
    br();
    e71();
}

//选项 显示开关功能
function e73()
{
    echo "[游戏显示开关]";
    br();
    echo '会员上线提示 ';
    cmd::addcmd("e213", user::get('vip_login_guangbo') ? "  开" : "  关");
    br();
    //开关列表
    echo '显示宠物图片 ';
    if (value::get_user_value("kg.xscwtp")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,1,' . $on, $desc);
    br();
    echo '显示场景描述 ';
    if (value::get_user_value("kg.xscjms")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,2,' . $on, $desc);
    br();
    echo '显示人物走向 ';
    if (value::get_user_value("kg.xsrwzx")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,3,' . $on, $desc);
    br();
    echo '显示交易请求 ';
    if (value::get_user_value("kg.xsjyqq")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,10,' . $on, $desc);
    br();
    echo '显示私人频道 ';
    if (value::get_user_value("kg.xssrpd")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,5,' . $on, $desc);
    br();
    echo '显示地区频道 ';
    if (value::get_user_value("kg.xsdqpd")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,4,' . $on, $desc);
    br();
    echo '显示组队频道 ';
    if (value::get_user_value("kg.xszdpd")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,8,' . $on, $desc);
    br();
    echo '显示帮派频道 ';
    if (value::get_user_value("kg.xsghpd")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,9,' . $on, $desc);
    br();
    echo '显示师门频道 ';
    if (value::get_user_value("kg.xssmpd")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,7,' . $on, $desc);
    br();
    echo '显示黑市频道 ';
    if (value::get_user_value("kg.xshspd")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,6,' . $on, $desc);
    br();
    echo '显示战斗信息 ';
    if (value::get_user_value("kg.xszdxx")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,11,' . $on, $desc);
    br();
    echo '显示掉落信息 ';
    if (value::get_user_value("kg.xsdlxx")) {
        $on = 0;
        $desc = '开';
    } else {
        $on = 1;
        $desc = '关';
    }
    cmd::addcmd('e74,12,' . $on, $desc);
    br();
    if (value::get_user_value('game_master', 0, false)) {
        echo "[设计系统开关]";
        br();
        echo '显示设计系统 ';
        if (value::get_user_value("kg.xssjxt")) {
            $on = 0;
            $desc = '开';
        } else {
            $on = 1;
            $desc = '关';
        }
        cmd::addcmd('e74,1024,' . $on, $desc);
        br();
    }
    //返回功能
    cmd::addcmd('e0', '返回上级');
}

//选项 显示开关 on是否关闭显示 0为开 1为关
function e74($setting, $on)
{
    switch ($setting) {
        case 1:
            $name = 'xscwtp';
            $kgname = "显示宠物图片";
            break;
        case 2:
            $name = 'xscjms';
            $kgname = "显示场景描述";
            break;
        case 3:
            $name = 'xsrwzx';
            $kgname = "显示人物走向";
            break;
        case 5:
            $name = 'xssrpd';
            $kgname = "显示私人频道";
            break;
        case 4:
            $name = 'xsdqpd';
            $kgname = "显示地区频道";
            break;
        case 7:
            $name = 'xssmpd';
            $kgname = "显示师门频道";
            break;
        case 6:
            $name = 'xshspd';
            $kgname = "显示黑市频道";
            break;
        case 8:
            $name = 'xszdpd';
            $kgname = "显示组队频道";
            break;
        case 9:
            $name = 'xsghpd';
            $kgname = "显示帮派频道";
            break;
        case 10:
            $name = 'xsjyqq';
            $kgname = "显示交易请求";
            break;
        case 11:
            $name = 'xszdxx';
            $kgname = "显示战斗信息";
            break;
        case 12:
            $name = 'xsdlxx';
            $kgname = "显示掉落信息";
            break;
        case 1024:
            $name = 'xssjxt';
            $kgname = "显示设计系统";
            break;
    }
    value::set_user_value('kg.' . $name, $on);
    if ($on) {
        $caozuo = '关闭';
    } else {
        $caozuo = '开启';
    }
    echo "你" . $caozuo . '了' . $kgname . "。";
    br();
    e73();
}

//宠物 打入宠物袋
function e75($pet_id, $ok = false)
{
    $user_id = uid();
    $oname = value::get_pet_value($pet_id, 'name');
    if ($ok) {
        $can_daru = false;
        $cyd_count = user::get_fuzhong(3);
        $cyd_rongliang = user::get_rongliang(3);
        if ($cyd_count < $cyd_rongliang) {
            if (pet::is_xiyou($pet_id)) {
                $chats = strtoupper(value::real_escape_string($_POST['chats']));
                if ($chats == "确定" || $chats == "ok" || $chats == "OK") {
                    $can_daru = true;
                }
            } else {
                $can_daru = true;
            }
            if ($can_daru) {
                if (pet::user_lose_pet($user_id, $pet_id, 3)) {
                    prop::pet_lose_all_prop($pet_id);
                    $sql = "SELECT `value` FROM `game_user_value` WHERE `userid`={$user_id} AND `valuename`='{$user_id}.task' LIMIT 0,5";
                    $result = sql($sql);
                    while (list($task_id) = $result->fetch_row()) {
                        $task_leixing = value::get_task_value($task_id, 'leixing');
                        if ($task_leixing == 1 && call_task($task_id, 5, 0, 0, true)) {
                            $task_name = value::get_task_value($task_id, 'name');
                            $task_lvl = value::get_task_value($task_id, 'lvl');
                            echo "{$task_name}({$task_lvl}级):<span style='color: blue'>任务已完成,快去领奖吧!</span>";
                            br();
                        }
                    }
                    echo '你成功把' . $oname . '打入了宠物袋。';
                    br();
                    cmd::addcmd('e77', '查看宠物袋');
                    br();
                    cmd::addcmd('e35', '返回上级');
                } else {
                    cmd::addcmd('e62', '返回上级');
                }
            } else {
                echo "输入有误,请您重新输入。";
                br();
                cmd::addcmd('e62', '返回上级');
            }
        } else {
            echo '宠物袋里不能放太多宠物,否则它们会打架的。';
            br();
            cmd::addcmd('e62', '返回上级');
        }
    } else {
        if (pet::is_xiyou($pet_id)) {
            $url = cmd::addcmd("e75,{$pet_id},1", "确认打入", false, true);
            echo <<<fangsheng
<form action='{$url}' method='post'>
你确定要将{$oname}打入宠物袋?(无法取出)<br>输入<span style="color: #ff0000">确定</span>或<span style="color: #ff0000">OK</span>确认操作:<br> 
<input type='text' id='chats' name='chats' maxlength='2'>
<br>
<input type='submit' name='确定' value='确定打入'>
</form>
fangsheng;
        } else {
            echo '你确定要将' . $oname . '打入宠物袋?(无法取出)';
            br();
            cmd::addcmd('e75,' . $pet_id . ',1', '确定打入');
            br();
        }
        cmd::addcmd('e62', '返回上级');
    }
}

//宠物相关 查看宠物相关
function e76()
{
    cmd::addcmd('e77', '宠物袋');
    echo "<img src='res/img/system/cangyaodai.png'>";
    br();
    cmd::addcmd('e113', '合成袋');
    echo "<img src='res/img/system/heyaodai.png'>";
    br();
    cmd::addcmd('e114', '孵化巢');
    echo "<img src='res/img/system/fuhuachao.png'>";
    br();
    cmd::addcmd('e115', '育将袋');
    echo "<img src='res/img/system/yuyaodai.png'>";
    br();
    cmd::addcmd('e0', '返回上级');
}

//宠物相关 查看宠物袋
function e77()
{
    $user_id = uid();
    $cangyaofuzhong = user::get_fuzhong(3);
    $cangyaorongliang = user::get_rongliang(3);
    $sql = "SELECT `id`,`name`,`lvl` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=3 ORDER BY `lvl` ASC";
    $result = sql($sql);
    echo "宠物容量:{$cangyaofuzhong}/{$cangyaorongliang}";
    br();
    while (list($oid, $oname, $olvl) = $result->fetch_row()) {
        echo $oname . '(' . $olvl . '级) ';
        cmd::addcmd('e97,' . $oid, '查看');
        br();
    }
    if (!$cangyaofuzhong) {
        echo '你的宠物袋里没有宠物。';
        br();
    } else {
        cmd::addcmd('e163', '一键炼化');
        br();
    }
    cmd::addcmd('e76', '返回上级');
}

//宠物 属性加点事件
function e78($pet_id, $mode = 0, $dianshu = 1)
{
    //判断宠物归属
    if (!user::have_pet(0, $pet_id)) {
        echo "该宠物已经不属于你了。";
        br();
        return;
    }
    //获取宠物六维
    $sql = "SELECT `max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`shuxingdian`,`zhuansheng`,`is_dead` FROM `game_pet` WHERE `id`={$pet_id} LIMIT 1";
    $result = sql($sql);
    list($max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $shuxingdian, $zhuansheng, $is_dead) = $result->fetch_row();
    if (!$is_dead) {
        //处理属性加点
        if ($shuxingdian) {
            switch ($mode) {
                case 1:
                    $max_hp = value::add_pet_value($pet_id, 'max_hp', 3 * $dianshu, 0, 1);
                    $shuxingdian = value::add_pet_value($pet_id, 'shuxingdian', -1 * $dianshu, 0, 1);
                    value::add_pet_value2('sxd.max_hp', 1 * $dianshu, $pet_id);
                    break;
                case 2:
                    $pugong = value::add_pet_value($pet_id, 'pugong', 1 * $dianshu, 0, 1);
                    $shuxingdian = value::add_pet_value($pet_id, 'shuxingdian', -1 * $dianshu, 0, 1);
                    value::add_pet_value2('sxd.pugong', 1 * $dianshu, $pet_id);
                    break;
                case 3:
                    $pufang = value::add_pet_value($pet_id, 'pufang', 1 * $dianshu, 0, 1);
                    $shuxingdian = value::add_pet_value($pet_id, 'shuxingdian', -1 * $dianshu, 0, 1);
                    value::add_pet_value2('sxd.pufang', 1 * $dianshu, $pet_id);
                    break;
                case 4:
                    $tegong = value::add_pet_value($pet_id, 'tegong', 1 * $dianshu, 0, 1);
                    $shuxingdian = value::add_pet_value($pet_id, 'shuxingdian', -1 * $dianshu, 0, 1);
                    value::add_pet_value2('sxd.tegong', 1 * $dianshu, $pet_id);
                    break;
                case 5:
                    $tefang = value::add_pet_value($pet_id, 'tefang', 1 * $dianshu, 0, 1);
                    $shuxingdian = value::add_pet_value($pet_id, 'shuxingdian', -1 * $dianshu, 0, 1);
                    value::add_pet_value2('sxd.tefang', 1 * $dianshu, $pet_id);
                    break;
                case 6:
                    $minjie = value::add_pet_value($pet_id, 'minjie', 0.5 * $dianshu, 0, 1);
                    $shuxingdian = value::add_pet_value($pet_id, 'shuxingdian', -1 * $dianshu, 0, 1);
                    value::add_pet_value2('sxd.minjie', 1 * $dianshu, $pet_id);
                    break;
            }
        }
        //属性点上限
        $max_sxd = $zhuansheng > 2 ? (value::get_system_value("is_qiangyaotai_open") ? 75 : 45) : 30;
        //获取加点情况
        $sxd_max_hp = value::get_pet_value2('sxd.max_hp', $pet_id, false);
        $sxd_pugong = value::get_pet_value2('sxd.pugong', $pet_id, false);
        $sxd_pufang = value::get_pet_value2('sxd.pufang', $pet_id, false);
        $sxd_tegong = value::get_pet_value2('sxd.tegong', $pet_id, false);
        $sxd_tefang = value::get_pet_value2('sxd.tefang', $pet_id, false);
        $sxd_minjie = value::get_pet_value2('sxd.minjie', $pet_id, false);
        //显示加点操作
        echo "你有" . $shuxingdian . "属性点:";
        br();
        echo '生命:' . (int)$max_hp . "(+" . $sxd_max_hp . ")";
        if ($shuxingdian > 0 && $sxd_max_hp < $max_sxd) {
            cmd::addcmd('e78,' . $pet_id . ',1', '+1');
        }
        if ($shuxingdian > 2 && $sxd_max_hp < ($max_sxd - 2)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',1,3', '+3');
        }
        if ($shuxingdian > 4 && $sxd_max_hp < ($max_sxd - 4)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',1,5', '+5');
        }
        br();
        echo '攻击:' . (int)$pugong . "(+" . $sxd_pugong . ")";
        if ($shuxingdian > 0 && $sxd_pugong < $max_sxd) {
            cmd::addcmd('e78,' . $pet_id . ',2', '+1');
        }
        if ($shuxingdian > 2 && $sxd_pugong < ($max_sxd - 2)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',2,3', '+3');
        }
        if ($shuxingdian > 4 && $sxd_pugong < ($max_sxd - 4)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',2,5', '+5');
        }
        br();
        echo '防御:' . (int)$pufang . "(+" . $sxd_pufang . ")";
        if ($shuxingdian > 0 && $sxd_pufang < $max_sxd) {
            cmd::addcmd('e78,' . $pet_id . ',3', '+1');
        }
        if ($shuxingdian > 2 && $sxd_pufang < ($max_sxd - 2)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',3,3', '+3');
        }
        if ($shuxingdian > 4 && $sxd_pufang < ($max_sxd - 4)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',3,5', '+5');
        }
        br();
        echo '魔攻:' . (int)$tegong . "(+" . $sxd_tegong . ")";
        if ($shuxingdian > 0 && $sxd_tegong < $max_sxd) {
            cmd::addcmd('e78,' . $pet_id . ',4', '+1');
        }
        if ($shuxingdian > 2 && $sxd_tegong < ($max_sxd - 2)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',4,3', '+3');
        }
        if ($shuxingdian > 4 && $sxd_tegong < ($max_sxd - 4)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',4,5', '+5');
        }
        br();
        echo '魔防:' . (int)$tefang . "(+" . $sxd_tefang . ")";
        if ($shuxingdian > 0 && $sxd_tefang < $max_sxd) {
            cmd::addcmd('e78,' . $pet_id . ',5', '+1');
        }
        if ($shuxingdian > 2 && $sxd_tefang < ($max_sxd - 2)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',5,3', '+3');
        }
        if ($shuxingdian > 4 && $sxd_tefang < ($max_sxd - 4)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',5,5', '+5');
        }
        br();
        echo '灵活:' . (int)$minjie . "(+" . $sxd_minjie . ")";
        if ($shuxingdian > 0 && $sxd_minjie < $max_sxd) {
            cmd::addcmd('e78,' . $pet_id . ',6', '+1');
        }
        if ($shuxingdian > 2 && $sxd_minjie < ($max_sxd - 2)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',6,3', '+3');
        }
        if ($shuxingdian > 4 && $sxd_minjie < ($max_sxd - 4)) {
            echo " ";
            cmd::addcmd('e78,' . $pet_id . ',6,5', '+5');
        }
        br();
        if (($sxd_max_hp + $sxd_pugong + $sxd_pufang + $sxd_tegong + $sxd_tefang + $sxd_minjie) >= $max_sxd * 6 && $shuxingdian > 2) {
            cmd::addcmd('e138,' . $pet_id, '兑换玉菩提');
            br();
        }
    } else {
        echo '宠物已死亡,无法加点。';
        br();
    }
    cmd::addcmd('e62', '返回上级');
}

//宠物 宠物进化事件
function e79($pet_id, $jh_id, $ok = false, $is_tehsu = false)
{
    //判断宠物归属
    if (!user::have_pet(0, $pet_id)) {
        echo "该宠物已经不属于你了。";
        br();
        return;
    }
    //获取宠物属性
    $sql = "SELECT `pet_id`,`name`,`sex`,`lvl`,`max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`xingge`,`is_dead` FROM `game_pet` WHERE `id`={$pet_id} LIMIT 1";
    $result = sql($sql);
    list($old_zzid, $name, $sex, $lvl, $max_hp, $pugong, $pufang, $tegong, $tefang, $minjie, $xingge, $is_dead) = $result->fetch_row();
    //宠物是否死亡
    if ($is_dead) {
        echo "宠物已死亡,无法进化。";
        br();
        cmd::addcmd('e62', '返回上级');
        return;
    }
    //进化属性
    $jh_name = value::getvalue('pet', 'name', 'id', $jh_id);
    $jh_chujing = value::getvalue('pet', 'exp', 'id', $jh_id);
    $fuhao = ($sex == '雌' ? " " : "");
    //开始进化操作
    if ($ok) {
        //设置进化后 名称 种族 初经
        value::set_pet_value($pet_id, 'pet_id', $jh_id);
        value::set_pet_value($pet_id, 'name', $jh_name . $fuhao);
        value::set_pet_value($pet_id, 'chujing', $jh_chujing);
        //获取原种族六维与现种族六维 合成次数
        $sql = "SELECT `hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie` FROM `pet` WHERE `id`={$old_zzid} LIMIT 1";
        $result = sql($sql);
        list($old_zzhp, $old_zzpg, $old_zzpf, $old_zztg, $old_zztf, $old_zzmj) = $result->fetch_row();
        $sql = "SELECT `hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`hechongcishu` FROM `pet` WHERE `id`={$jh_id} LIMIT 1";
        $result = sql($sql);
        list($new_zzhp, $new_zzpg, $new_zzpf, $new_zztg, $new_zztf, $new_zzmj, $new_hechongcishu) = $result->fetch_row();
        //合成次数
        if (value::get_pet_value($pet_id, 'hechongcishu') > $new_hechongcishu) {
            value::set_pet_value($pet_id, 'hechongcishu', $new_hechongcishu);
        }
        //六维
        $zz_hp = ($new_zzhp - $old_zzhp) * $lvl;
        $zz_pugong = ($new_zzpg - $old_zzpg) * $lvl;
        $zz_pufang = ($new_zzpf - $old_zzpf) * $lvl;
        $zz_tegong = ($new_zztg - $old_zztg) * $lvl;
        $zz_tefang = ($new_zztf - $old_zztf) * $lvl;
        $zz_minjie = ($new_zzmj - $old_zzmj) * $lvl;
        //修正宠物种族数据
        if ($xingge < 5) {
            //孤独 固执 纯洁 无畏 +攻击
            $zz_pugong *= 1.1;
        } else if ($xingge < 9) {
            //凶猛 潇洒 敏捷 悠闲 +防御
            $zz_pufang *= 1.1;
        } else if ($xingge < 13) {
            //保守 坚强 马虎 冷静 +魔攻
            $zz_tegong *= 1.1;
        } else if ($xingge < 17) {
            //深沉 平庸 精明 狂妄 +魔防
            $zz_tefang *= 1.1;
        } else if ($xingge < 21) {
            //迟缓 急躁 稳健 天真 +灵活
            $zz_minjie *= 1.1;
        }
        if ($xingge == 5 || $xingge == 9 || $xingge == 13 || $xingge == 17) {
            //凶猛 保守 深沉 迟缓 -攻击
            $zz_pugong *= 0.9;
        }
        if ($xingge == 1 || $xingge == 10 || $xingge == 14 || $xingge == 18) {
            //孤独 坚强 平庸 急躁 -防御
            $zz_pufang *= 0.9;
        }
        if ($xingge == 2 || $xingge == 6 || $xingge == 15 || $xingge == 19) {
            //固执 潇洒 精明 稳健 -魔攻
            $zz_tegong *= 0.9;
        }
        if ($xingge == 3 || $xingge == 7 || $xingge == 11 || $xingge == 20) {
            //纯洁 敏捷 马虎 天真 -魔防
            $zz_tefang *= 0.9;
        }
        if ($xingge == 4 || $xingge == 8 || $xingge == 12 || $xingge == 16) {
            //无畏 悠闲 冷静 狂妄 -灵活
            $zz_minjie *= 0.9;
        }
        //增加宠物属性
        $now_hp = value::add_pet_value($pet_id, "max_hp", $zz_hp, 0, 1);
        value::add_pet_value($pet_id, "hp", $zz_hp, 0, 1);
        $now_pugong = value::add_pet_value($pet_id, "pugong", $zz_pugong, 0, 1);
        $now_pufang = value::add_pet_value($pet_id, "pufang", $zz_pufang, 0, 1);
        $now_tegong = value::add_pet_value($pet_id, "tegong", $zz_tegong, 0, 1);
        $now_tefang = value::add_pet_value($pet_id, "tefang", $zz_tefang, 0, 1);
        $now_minjie = value::add_pet_value($pet_id, "minjie", $zz_minjie, 0, 1);
        //格式化属性
        $old_hp = (int)$max_hp;
        $old_pugong = (int)$pugong;
        $old_pufang = (int)$pufang;
        $old_tegong = (int)$tegong;
        $old_tefang = (int)$tefang;
        $old_minjie = (int)$minjie;
        $now_hp = (int)$now_hp;
        $now_pugong = (int)$now_pugong;
        $now_pufang = (int)$now_pufang;
        $now_tegong = (int)$now_tegong;
        $now_tefang = (int)$now_tefang;
        $now_minjie = (int)$now_minjie;
        //显示属性数据
        echo <<<jhlvl
恭喜,你的{$name}成功进化为了{$jh_name}{$fuhao}。<br>
生命:{$old_hp} → {$now_hp}<br>
攻击:{$old_pugong} → {$now_pugong}<br>
防御:{$old_pufang} → {$now_pufang}<br>
魔攻:{$old_tegong} → {$now_tegong}<br>
魔防:{$old_tefang} → {$now_tefang}<br>
灵活:{$old_minjie} → {$now_minjie}<br>
jhlvl;
        if (!$is_tehsu) {
            cmd::addcmd('e62', '返回上级');
        }
    } else {
        echo '你确定要将' . $name . '进化为' . $jh_name . $fuhao . '吗?(无法取消)';
        br();
        cmd::addcmd('e79,' . $pet_id . "," . $jh_id . ',1', '确定进化');
        br();
        cmd::addcmd('e62', '返回上级');
    }
}

//物品 宠物 使用白蛇皮事件
function e80($pet_id, $item_id, $step = 0)
{
    //判断宠物归属
    if (!user::have_pet(0, $pet_id)) {
        echo "该宠物已经不属于你了。";
        br();
        return;
    }
    $name = value::get_pet_value($pet_id, 'name');
    //宠物是否死亡
    if (value::get_pet_value($pet_id, 'is_dead')) {
        echo "宠物已死亡,无法喂食白蛇皮。";
        br();
        cmd::addcmd('e62', '返回上级');
        return;
    }
    //开始操作
    if ($step) {
        if (item::lose_item($item_id, 1)) {
            //获取等级 种族ID 性格 转生
            $lvl = value::get_pet_value($pet_id, 'lvl') - 1;
            $zzid = value::get_pet_value($pet_id, 'pet_id');
            $xingge = value::get_pet_value($pet_id, 'xingge');
            $zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
            //获取种族六维
            $sql = "SELECT `hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie` FROM `pet` WHERE `id`={$zzid} LIMIT 1";
            $result = sql($sql);
            list($zzhp, $zzpg, $zzpf, $zztg, $zztf, $zzmj) = $result->fetch_row();
            $zz_max_hp = $zzhp * $lvl;
            $zz_pugong = $zzpg * $lvl;
            $zz_pufang = $zzpf * $lvl;
            $zz_tegong = $zztg * $lvl;
            $zz_tefang = $zztf * $lvl;
            $zz_minjie = $zzmj * $lvl;
            //修正宠物种族数据
            if ($xingge < 5) {
                //孤独 固执 纯洁 无畏 +攻击
                $zz_pugong *= 1.1;
            } else if ($xingge < 9) {
                //凶猛 潇洒 敏捷 悠闲 +防御
                $zz_pufang *= 1.1;
            } else if ($xingge < 13) {
                //保守 坚强 马虎 冷静 +魔攻
                $zz_tegong *= 1.1;
            } else if ($xingge < 17) {
                //深沉 平庸 精明 狂妄 +魔防
                $zz_tefang *= 1.1;
            } else if ($xingge < 21) {
                //迟缓 急躁 稳健 天真 +灵活
                $zz_minjie *= 1.1;
            }
            if ($xingge == 5 || $xingge == 9 || $xingge == 13 || $xingge == 17) {
                //凶猛 保守 深沉 迟缓 -攻击
                $zz_pugong *= 0.9;
            }
            if ($xingge == 1 || $xingge == 10 || $xingge == 14 || $xingge == 18) {
                //孤独 坚强 平庸 急躁 -防御
                $zz_pufang *= 0.9;
            }
            if ($xingge == 2 || $xingge == 6 || $xingge == 15 || $xingge == 19) {
                //固执 潇洒 精明 稳健 -魔攻
                $zz_tegong *= 0.9;
            }
            if ($xingge == 3 || $xingge == 7 || $xingge == 11 || $xingge == 20) {
                //纯洁 敏捷 马虎 天真 -魔防
                $zz_tefang *= 0.9;
            }
            if ($xingge == 4 || $xingge == 8 || $xingge == 12 || $xingge == 16) {
                //无畏 悠闲 冷静 狂妄 -灵活
                $zz_minjie *= 0.9;
            }
            //获取属性加点
            $sxd_max_hp = value::get_pet_value2('sxd.max_hp', $pet_id, false) * 3;
            $sxd_pugong = value::get_pet_value2('sxd.pugong', $pet_id, false);
            $sxd_pufang = value::get_pet_value2('sxd.pufang', $pet_id, false);
            $sxd_tegong = value::get_pet_value2('sxd.tegong', $pet_id, false);
            $sxd_tefang = value::get_pet_value2('sxd.tefang', $pet_id, false);
            $sxd_minjie = value::get_pet_value2('sxd.minjie', $pet_id, false) * 0.5;
            //设置宠物属性
            //等级 最大等级 经验 最大经验 属性点
            value::set_pet_value($pet_id, 'lvl', '1');
            if (value::get_pet_value($pet_id, 'max_lvl') < 120 || (value::get_pet_value($pet_id, 'max_lvl') > 120 && value::get_pet_value($pet_id, 'zhuansheng') < 3)) {
                value::set_pet_value($pet_id, 'max_lvl', '10');
            }
            value::set_pet_value($pet_id, 'exp', '0');
            value::set_pet_value($pet_id, 'max_exp', value::get_pet_value($pet_id, 'chujing'));
            switch ($zhuansheng) {
                case 1:
                    $shuxingdian = 15;
                    break;
                case 2:
                    $shuxingdian = 30;
                    break;
                case 3:
                    $shuxingdian = 45;
                    break;
                default:
                    $shuxingdian = 0;
                    break;
            }
            value::set_pet_value($pet_id, 'shuxingdian', $shuxingdian);
            //宠物六维
            $max_hp = value::add_pet_value($pet_id, 'max_hp', -1 * ($zz_max_hp + $sxd_max_hp), 0, 1);
            if ($max_hp < 0) {
                $max_hp = 1;
            }
            value::set_pet_value($pet_id, 'max_hp', $max_hp);
            value::set_pet_value($pet_id, 'hp', $max_hp);
            if (value::add_pet_value($pet_id, 'pugong', -1 * ($zz_pugong + $sxd_pugong), 0, 1) < 0) {
                value::set_pet_value($pet_id, 'pugong', 1);
            }
            if (value::add_pet_value($pet_id, 'pufang', -1 * ($zz_pufang + $sxd_pufang), 0, 1) < 0) {
                value::set_pet_value($pet_id, 'pufang', 1);
            }
            if (value::add_pet_value($pet_id, 'tegong', -1 * ($zz_tegong + $sxd_tegong), 0, 1) < 0) {
                value::set_pet_value($pet_id, 'tegong', 1);
            }
            if (value::add_pet_value($pet_id, 'tefang', -1 * ($zz_tefang + $sxd_tefang), 0, 1) < 0) {
                value::set_pet_value($pet_id, 'tefang', 1);
            }
            if (value::add_pet_value($pet_id, 'minjie', -1 * ($zz_minjie + $sxd_minjie), 0, 1) < 0) {
                value::set_pet_value($pet_id, 'minjie', 1);
            }
            //删除属性加点记录
            $obj = new game_pet_object($pet_id);
            $obj->adel("sxd.*");
            //删除宠物技能 学习初始技能
            $obj = new game_pet_object($pet_id);
            $obj->adel("*skill*");
            //读取种族技能
            $p_study_skill_str = value::getvalue('pet', 'study_skill', 'id', $zzid);
            $p_study_skill_arr = explode(',', $p_study_skill_str);
            skill::study_skill($pet_id, $p_study_skill_arr[0], 0, false);
            //输出提示
            echo '你的' . $name . '很不情愿的服下了白蛇皮,变为了1级。';
            br();
            cmd::addcmd('e62,' . $pet_id, '返回上级');
        }
    } else {
        echo "服下白蛇皮后你的" . $name . "将降为1级并遗忘已学会的技能,确定要使用白蛇皮吗?";
        br();
        cmd::addcmd('e80,' . $pet_id . ',' . $item_id . ',1', '确定使用');
        br();
    }
}

//角色 交易事件
function e81($oid, $mode = 0, $step = 0, $item_id = 0)
{
    $user_id = uid();
    if (!$mode) {
        //是否关闭显示交易请求
        if (value::get_user_value('kg.xsjyqq', $oid)) {
            echo '对方已经关闭显示交易请求,无法交易。';
            br();
            e12();
            return;
        }
        cmd::addcmd('e81,' . $oid . ',1', '交易物品(金币)');
        br();
        cmd::addcmd('e81,' . $oid . ',3', '交易物品(元宝)');
        br();
        cmd::addcmd('e81,' . $oid . ',2', '交易宠物(金币)');
        br();
        cmd::addcmd('e81,' . $oid . ',4', '交易宠物(元宝)');
        br();
    } else if ($mode == 1) {
        if (!$step) {
            //是否黑名单
            $value_id = user::is_heiming($user_id, $oid);
            if ($value_id) {
                echo '你在对方的黑名单中,无法交易！';
                return;
            }
            $item_count = 0;
            $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
            $result = sql($sql);
            while (list($id, $count) = $result->fetch_row()) {
                if ($count) {
                    $id = explode('.', $id);
                    if (value::getvalue('item', 'is_jiaoyi', 'id', $id[2]) && !value::getvalue('item', 'lingshi', 'id', $id[2]) || value::getvalue('item', 'is_bd', 'id', $id[2])) {
                        $name = value::getvalue('item', 'name', 'id', $id[2]);
                        $liangci = value::getvalue('item', 'liangci', 'id', $id[2]);
                        cmd::addcmd('e81,' . $oid . ',1,1,' . $id[2], $name . "x" . $count . $liangci);
                        br();
                        $item_count++;
                    }
                }
            }
            $sql = "SELECT `id`,`name`,`prop_id` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `is_jiaoyi`<1";
            $result = sql($sql);
            while (list($prop_id, $prop_name, $prop_zzid) = $result->fetch_row()) {
                $liangci = value::get_prop_value($prop_zzid, 'liangci');
                $leixing = value::get_prop_value($prop_zzid, 'leixing');
                $cmd_str = "{$prop_name}x1{$liangci}";
                if ($leixing == 1) {
                    $exp = value::get_game_prop_value($prop_id, 'exp');
                    $cmd_str .= "({$exp})";
                }
                cmd::addcmd('e81,' . $oid . ',1,3,' . $prop_id, $cmd_str);
                br();
                prop::show_prop($prop_id, 6, false);
                $item_count++;
            }
            if (!$item_count) {
                echo '你没有可以交易的物品。';
                br();
            }
        } else if ($step == 1) {
            $name = value::getvalue('item', 'name', 'id', $item_id);
            $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
            $cmd = cmd::addcmd("e81,{$oid},1,2," . $item_id, '交易', false);
            echo <<<buyform
你要用多少金币卖多少{$liangci}{$name}?<br>
<form action="game.php?cmd=$cmd" method="post">
    单价:
    <input type="text" name="danjia" maxlength="8" value="1">
    <br>
    数量:
    <input type="text" name="count" maxlength="8" value="1">
	<br>
	<input type="submit" value="确定交易" name="交易">
</form>
buyform;
        } else if ($step == 2) {
            $danjia = (int)value::real_escape_string($_POST['danjia']);
            $count = (int)value::real_escape_string($_POST['count']);
            if ($danjia > 0 && $count > 0 && $danjia < 100000000 && $count < 100000000) {
                if ($count < 1) {
                    $count = 1;
                }
                if ($danjia < 1) {
                    $danjia = 1;
                }
                if (item::get_item($item_id) >= $count) {
                    echo '交易请求已发出,请等待对方回应。';
                    br();
                    c_add_jywpqq($oid, 0, $item_id, $danjia, $count);
                    e12();
                    return;
                } else {
                    echo '你没有足够的物品可以交易。';
                    br();
                }
            } else {
                echo '请输入正确的单价与数量。';
                br();
            }
        } else if ($step == 3) {
            $name = value::get_game_prop_value($item_id, 'name');
            $zzid = value::get_game_prop_value($item_id, 'prop_id');
            $liangci = value::get_prop_value($zzid, 'liangci');
            $cmd = cmd::addcmd("e81,{$oid},1,4," . $item_id, '交易', false);
            echo <<<buyform
你要用多少金币卖这{$liangci}{$name}?<br>
<form action="game.php?cmd=$cmd" method="post">
    单价:
    <input type="text" name="danjia" maxlength="8" value="1">
    <br>
	<input type="submit" value="确定交易" name="交易">
</form>
buyform;
        } else if ($step == 4) {
            $danjia = (int)value::real_escape_string($_POST['danjia']);
            if ($danjia > 0 && $danjia < 100000000) {
                if ($danjia < 1) {
                    $danjia = 1;
                }
                if (prop::user_have_prop($item_id)) {
                    echo '交易请求已发出,请等待对方回应。';
                    br();
                    c_add_jydjqq($oid, 0, $item_id, $danjia);
                    e12();
                    return;
                } else {
                    echo '你身上没有这件物品了。';
                    br();
                }
            } else {
                echo '请输入正确的单价。';
                br();
            }
        }
        if ($step) {
            cmd::addcmd('e81,' . $oid . ',1', '返回上级');
            return;
        }
    } else if ($mode == 3) {
        if (!$step) {
            //是否黑名单
            $value_id = user::is_heiming($user_id, $oid);
            if ($value_id) {
                echo '你在对方的黑名单中,无法交易！';
                return;
            }
            $item_count = 0;
            $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
            $result = sql($sql);
            while (list($id, $count) = $result->fetch_row()) {
                if ($count) {
                    $id = explode('.', $id);
                    if (value::getvalue('item', 'is_jiaoyi', 'id', $id[2]) && !value::getvalue('item', 'lingshi', 'id', $id[2]) || value::getvalue('item', 'is_bd', 'id', $id[2])) {
                        $name = value::getvalue('item', 'name', 'id', $id[2]);
                        $liangci = value::getvalue('item', 'liangci', 'id', $id[2]);
                        cmd::addcmd('e81,' . $oid . ',3,1,' . $id[2], $name . "x" . $count . $liangci);
                        br();
                        $item_count++;
                    }
                }
            }
            $sql = "SELECT `id`,`name`,`prop_id` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `is_jiaoyi`<1";
            $result = sql($sql);
            while (list($prop_id, $prop_name, $prop_zzid) = $result->fetch_row()) {
                $liangci = value::get_prop_value($prop_zzid, 'liangci');
                $leixing = value::get_prop_value($prop_zzid, 'leixing');
                $cmd_str = "{$prop_name}x1{$liangci}";
                if ($leixing == 1) {
                    $exp = value::get_game_prop_value($prop_id, 'exp');
                    $cmd_str .= "({$exp})";
                }
                cmd::addcmd('e81,' . $oid . ',3,3,' . $prop_id, $cmd_str);
                br();
                prop::show_prop($prop_id, 6, false);
                $item_count++;
            }
            if (!$item_count) {
                echo '你没有可以交易的物品。';
                br();
            }
        } else if ($step == 1) {
            $name = value::getvalue('item', 'name', 'id', $item_id);
            $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
            $cmd = cmd::addcmd("e81,{$oid},3,2," . $item_id, '交易', false);
            echo <<<buyform
你要用多少元宝卖多少{$liangci}{$name}?<br>
<form action="game.php?cmd=$cmd" method="post">
    单价:
    <input type="text" name="danjia" maxlength="8" value="1">
    <br>
    数量:
    <input type="text" name="count" maxlength="8" value="1">
	<br>
	<input type="submit" value="确定交易" name="交易">
</form>
buyform;
        } else if ($step == 2) {
            $danjia = (int)value::real_escape_string($_POST['danjia']);
            $count = (int)value::real_escape_string($_POST['count']);
            if ($danjia > 0 && $count > 0 && $danjia < 100000000 && $count < 100000000) {
                if ($count < 1) {
                    $count = 1;
                }
                if ($danjia < 1) {
                    $danjia = 1;
                }
                if (item::get_item($item_id) >= $count) {
                    echo '交易请求已发出,请等待对方回应。';
                    br();
                    c_add_jywpqq1($oid, 0, $item_id, $danjia, $count);
                    e12();
                    return;
                } else {
                    echo '你没有足够的物品可以交易。';
                    br();
                }
            } else {
                echo '请输入正确的单价与数量。';
                br();
            }
        } else if ($step == 3) {
            $name = value::get_game_prop_value($item_id, 'name');
            $zzid = value::get_game_prop_value($item_id, 'prop_id');
            $liangci = value::get_prop_value($zzid, 'liangci');
            $cmd = cmd::addcmd("e81,{$oid},3,4," . $item_id, '交易', false);
            echo <<<buyform
你要用多少元宝卖这{$liangci}{$name}?<br>
<form action="game.php?cmd=$cmd" method="post">
    单价:
    <input type="text" name="danjia" maxlength="8" value="1">
    <br>
	<input type="submit" value="确定交易" name="交易">
</form>
buyform;
        } else if ($step == 4) {
            $danjia = (int)value::real_escape_string($_POST['danjia']);
            if ($danjia > 0 && $danjia < 100000000) {
                if ($danjia < 1) {
                    $danjia = 1;
                }
                if (prop::user_have_prop($item_id)) {
                    echo '交易请求已发出,请等待对方回应。';
                    br();
                    c_add_jydjqq1($oid, 0, $item_id, $danjia);
                    e12();
                    return;
                } else {
                    echo '你身上没有这件物品了。';
                    br();
                }
            } else {
                echo '请输入正确的单价。';
                br();
            }
        }
        if ($step) {
            cmd::addcmd('e81,' . $oid . ',3', '返回上级');
            return;
        }
    } else if ($mode == 2) {
        if (!$step) {
            //是否黑名单
            $value_id = user::is_heiming($user_id, $oid);
            if ($value_id) {
                echo '你在对方的黑名单中,无法交易！';
                return;
            }
            $pet_count = 0;
            $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `zhuansheng`=0 AND `lvl`<=5";
            $result = sql($sql);
            while (list($pet_id) = $result->fetch_row()) {
                $onick_name = value::get_pet_value($pet_id, 'nick_name');
                $name = value::get_pet_value($pet_id, 'name');
                $lvl = value::get_pet_value($pet_id, 'lvl');
                cmd::addcmd('e81,' . $oid . ',2,1,' . $pet_id, ($onick_name ? "({$onick_name})" : "") . $name . "(" . $lvl . "级)");
                br();
                $pet_count++;
            }
            if (!$pet_count) {
                echo '你没有可以交易的宠物！';
                br();
            }
        } else if ($step == 1) {
            $pet_id = $item_id;
            $cmd = cmd::addcmd("e81,{$oid},2,2," . $item_id, '交易', false);
            $name = value::get_pet_value($pet_id, 'name');
            echo <<<buyform
你要用多少金币卖出这只{$name}?<br>
<form action="game.php?cmd=$cmd" method="post">
    价格:
    <input type="text" name="danjia" maxlength="8" value="1">
    <br>
	<input type="submit" value="确定交易" name="交易">
</form>
buyform;
        } else if ($step == 2) {
            $danjia = (int)value::real_escape_string($_POST['danjia']);
            if ($danjia > 0 && $danjia < 100000000) {
                echo '交易请求已发出,请等待对方回应。';
                br();
                c_add_jycwqq($oid, 0, $item_id, $danjia);
                e12();
                return;
            } else {
                echo '请输入正确的价格。';
                br();
            }
        }
        if ($step) {
            cmd::addcmd('e81,' . $oid . ',2', '返回上级');
            return;
        }
    } else if ($mode == 4) {
        if (!$step) {
            //是否黑名单
            $value_id = user::is_heiming($user_id, $oid);
            if ($value_id) {
                echo '你在对方的黑名单中,无法交易！';
                return;
            }
            $pet_count = 0;
            $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `zhuansheng`=0 AND `lvl`<=5";
            $result = sql($sql);
            while (list($pet_id) = $result->fetch_row()) {
                $onick_name = value::get_pet_value($pet_id, 'nick_name');
                $name = value::get_pet_value($pet_id, 'name');
                $lvl = value::get_pet_value($pet_id, 'lvl');
                cmd::addcmd('e81,' . $oid . ',4,1,' . $pet_id, ($onick_name ? "({$onick_name})" : "") . $name . "(" . $lvl . "级)");
                br();
                $pet_count++;
            }
            if (!$pet_count) {
                echo '你没有可以交易的宠物。';
                br();
            }
        } else if ($step == 1) {
            $pet_id = $item_id;
            $cmd = cmd::addcmd("e81,{$oid},4,2," . $item_id, '交易', false);
            $name = value::get_pet_value($pet_id, 'name');
            echo <<<buyform
你要用多少元宝卖出这只{$name}?<br>
<form action="game.php?cmd=$cmd" method="post">
    价格:
    <input type="text" name="danjia" maxlength="8" value="1">
    <br>
	<input type="submit" value="确定交易" name="交易">
</form>
buyform;
        } else if ($step == 2) {
            $danjia = (int)value::real_escape_string($_POST['danjia']);
            if ($danjia > 0 && $danjia < 100000000) {
                echo '交易请求已发出,请等待对方回应。';
                br();
                c_add_jycwqq1($oid, 0, $item_id, $danjia);
                e12();
                return;
            } else {
                echo '请输入正确的价格。';
                br();
            }
        }
        if ($step) {
            cmd::addcmd('e81,' . $oid . ',4', '返回上级');
            return;
        }
    }
    if ($mode) {
        cmd::addcmd('e81,' . $oid, '返回上级');
    } else {
        cmd::addcmd('e12,' . $oid, '返回上级');
    }
}

//战斗 回合事件
function e82($user_id = 0, $is_auto = false)
{
    //确认玩家
    if (!$user_id) {
        $user_id = uid();
    }
    $u = new game_user_object($user_id);
    $u_team_id = team::get_user_team($user_id);
    $o_user_id = value::get_game_user_value('pk.user.id', $user_id);
    if ($o_user_id) {
        $o = new game_user_object($o_user_id);
    }
    $o_npc_id = 0;
    $o_npc_name = "";
    //战斗参数
    //获取战斗模式  mode 1 野怪战斗 2 单人NPC 3 组队NPC 4 与玩家战斗 敌我宠物ID 使用技能ID
    $mode = 0;
    $u_pet_id = value::get_game_user_value('pk.now_pet.id', $user_id);
    $o_pet_id = 0;
    $pk_ctm = value::get_game_user_value('in_ctm', $user_id);
    switch ($pk_ctm) {
        //野怪
        case 'ctm_pk_mappet':
            $mode = 1;
            $o_pet_id = value::get_game_user_value('pk.map_pet.id', $user_id);
            break;
        //NPC 单人
        case 'ctm_pk_npc':
            $mode = 2;
            $o_npc_id = value::get_game_user_value('pk.npc.id', $user_id);
            $o_npc_name = value::get_npc_value($o_npc_id, 'name');
            $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$o_npc_id} AND `enemy_user`={$user_id} AND `is_dead`=0 ORDER BY `id` ASC LIMIT 1";
            $result = sql($sql);
            list($o_pet_id) = $result->fetch_row();
            break;
        //NPC 组队
        case 'ctm_pk_team_npc':
            $mode = 1;
            $o_pet_id = value::get_game_user_value('pk.map_pet.id', $user_id);
            break;
        //玩家
        case 'ctm_pk_user':
            $mode = 4;
            $tpzgl = 300;
            $o_pet_id = value::get_game_user_value('pk.now_pet.id', $o_user_id);
            break;
    }
    //己方逃跑
    $next_taopao = value::get_user_value('pk.next_taopao', $user_id, false);
    if ($next_taopao) {
        //删除逃跑操作
        if (mt_rand(1, 100) <= 10) {
            e69($mode, $user_id, $o_user_id);
            return;
        } else {
            skill::add_skill_chat(value::get_game_user_value('name', $user_id) . '逃跑失败!', $user_id, 0);
            value::set_user_value('pk.next_taopao', 0, $user_id);
        }
        //与野怪战斗 清除灵活 避免误杀
        if ($mode < 3) {
            $u_pk_minjie = 0;
            value::set_pet_value2('pk.minjie', 0, $u_pet_id);
            $can_use_skill = false;
        }
    }
    //是否系统自动战斗
    if ($is_auto && $mode < 3) {
        return;
    }
    //组队NPC 玩家PK 自动战斗
    if ($mode > 2) {
        //是否自动战斗
        if ($is_auto) {
            //没有敌方宠物
            if ((!$o_pet_id && value::get_game_user_value('is_dead', $user_id)) || (!$u_pet_id && value::get_game_user_value('is_dead', $o_user_id))) {
                return;
            }
            //战斗回合延迟
            $now_time = time();
            $u_huihe_time = value::get_user_value('pk.huihe.time', $user_id, false);
            if ($now_time > $u_huihe_time + 2) {
                value::set_user_value('pk.huihe.time', $now_time, $user_id);
                value::set_user_value('pk.huihe.time', $now_time, $o_user_id);
            } else {
                return;
            }
        } else {
            //玩家查看战斗
            if ($pk_ctm != 'ctm_map') {
                e0();
            } else {
                e137();
            }
            return;
        }
    }
    //获取己方宠物属性
    $sql = "SELECT `name`,`max_hp`,`pugong`,`minjie`,`ts_mb`,`ts_xx`,`ts_zd`,`texing`,`zhuansheng` FROM `game_pet` WHERE `id`={$u_pet_id} LIMIT 1";
    $result = sql($sql);
    list($u_pet_name, $u_pet_max_hp, $u_pet_max_sh, $u_pet_minjie, $u_pet_ts_mb, $u_pet_ts_xx, $u_pet_ts_zd, $u_pet_texing, $u_pet_zhuansheng) = $result->fetch_row();
    //忠诚度 装备加成
    //HP
    $u_pet_maxhp = pet::get_max_hp($u_pet_id);
    //获取敌方宠物属性
    $sql = "SELECT `name`,`lvl`,`ts_mb`,`ts_xx`,`ts_zd`,`max_hp`,`pugong`,`minjie`,`texing`,`zhuansheng` FROM `game_pet` WHERE `id`={$o_pet_id} LIMIT 1";
    $result = sql($sql);
    list($o_pet_name, $o_pet_lvl, $o_pet_ts_mb, $o_pet_ts_xx, $o_pet_ts_zd, $o_pet_max_hp, $o_pet_max_sh, $o_pet_minjie, $o_pet_texing, $o_pet_zhuansheng) = $result->fetch_row();
    //忠诚度 装备加成
    //HP
    $o_pet_maxhp = pet::get_max_hp($o_pet_id);
    //效果触发数组
    $pk_xgcf_arr = array("ap", "at", "bp", "bt", "au", "bu");
    shuffle($pk_xgcf_arr);
    //装备效果触发
    foreach ($pk_xgcf_arr as $xgcf_v) {
        switch ($xgcf_v) {
            //己方玩家攻击
            case "au":
                if (!user::get_game_user('is_dead', $user_id)) {
                    $uSkillId = $u->get('next.skill.id');
                    if (!$uSkillId) {
                        $uSkillId = user_skill::get_moren_skill($user_id);
                    }
                    if (!$uSkillId) {
                        $uSkillId = array_rand(user_skill::get_skill_arr(), 1);
                    }
                    if (!$uSkillId) {
                        $uSkillId = 1;
                    }
                    //装备磨损     
                    $hf_jc = equip::get_user_equip_jc('zb_hf', $user_id);
                    $dy_jc = equip::get_user_equip_jc('zb_dy', $user_id);
                    if ($hf_jc > 0 || $dy_jc > 0) {
                        pet::prop_mosun2($user_id, -1, 0);
                    }
                    pet::prop_mosun1($user_id, -1, 0);
                    $next_item_id6 = 0;
                    $next_item_id6 = value::get_user_value('pk.next_item.id6', $user_id);
                    if ($next_item_id6 < 1) {
                        user_skill::use_skill($uSkillId, $user_id, $o_user_id, $o_pet_id, $mode);
                    }
                    value::set_user_value('pk.next_item.id6', 0, $user_id);
                }
                break;
            //敌方玩家攻击
            case "bu":
                if ($o_user_id && !user::get_game_user('is_dead', $o_user_id)) {
                    $oSkillId = $o->get('next.skill.id');
                    if (!$oSkillId) {
                        $oSkillId = user_skill::get_moren_skill($o_user_id);
                    }
                    if (!$oSkillId) {
                        $oSkillId = array_rand(user_skill::get_skill_arr($o_user_id), 1);
                    }
                    if (!$oSkillId) {
                        $oSkillId = 1;
                    }
                    user_skill::use_skill($oSkillId, $o_user_id, $user_id, $u_pet_id, $mode);
                }
                break;
            //己方宠物装备触发
            case "ap":
                skill::pet_use_prop($u_pet_id, $o_pet_id);
                break;
            //己方宠物天赋触发
            case "at":
                if (!value::get_pet_value($u_pet_id, 'is_dead') && !value::get_pet_value($o_pet_id, 'is_dead') && $u_pet_id && $o_pet_id) {
                    if (!value::get_pet_value($o_pet_id, 'is_dead')) {
                        if (mt_rand(0, 100) < $u_pet_ts_mb) {
                            value::set_pet_value2('zd_mb', 2, $o_pet_id);
                            skill::add_skill_chat($o_pet_name . '被麻痹了', $user_id, $o_user_id);
                        }
                        if (mt_rand(0, 100) < $u_pet_ts_xx) {
                            $fy_hp = (int)($u_pet_max_sh / 5);
                            value::add_pet_value($u_pet_id, 1, $fy_hp, false);
                            skill::add_skill_chat($u_pet_name . '的血量吸血了' . $fy_hp . '点。', $user_id, $o_user_id);
                        }
                        if (mt_rand(0, 100) < $u_pet_ts_zd) {
                            $zdhp = (int)($u_pet_max_sh / 10);
                            value::set_pet_value2('zd_zd', 3, $o_pet_id);
                            value::set_pet_value2('zd_zd_hp', $zdhp, $o_pet_id);
                        }
                    }
                }
                break;
            //敌方宠物装备触发
            case "bp":
                skill::pet_use_prop($o_pet_id, $u_pet_id);
                break;
            //敌方宠物天赋触发
            case "bt":
                if (!value::get_pet_value($u_pet_id, 'is_dead') && !value::get_pet_value($o_pet_id, 'is_dead') && $u_pet_id && $o_pet_id) {
                    if (!value::get_pet_value($o_pet_id, 'is_dead')) {
                        if (mt_rand(0, 100) < $o_pet_ts_mb) {
                            value::set_pet_value2('zd_mb', 2, $u_pet_id);
                            skill::add_skill_chat($u_pet_name . '被麻痹了', $o_user_id, $user_id);
                        }
                        if (mt_rand(0, 100) < $o_pet_ts_xx) {
                            $fy_hp = (int)($o_pet_max_sh / 5);
                            value::add_pet_value($o_pet_id, 1, $fy_hp, false);
                            skill::add_skill_chat($o_pet_name . '的血量吸血了' . $fy_hp . '点。', $o_user_id, $user_id);
                        }
                        if (mt_rand(0, 100) < $o_pet_ts_zd) {
                            $zdhp = (int)($o_pet_max_sh / 10);
                            value::set_pet_value2('zd_zd', 3, $u_pet_id);
                            value::set_pet_value2('zd_zd_hp', $zdhp, $u_pet_id);
                        }
                    }
                }
                break;
        }
    }
    //宠物停止技能
    $u_pet_zd_tz = value::get_pet_value2('zd_tz', $u_pet_id);
    if ($u_pet_zd_tz > 0) {
        skill::add_skill_chat($u_pet_name . '被眩晕了', $user_id, $o_user_id);
    }
    $o_pet_zd_tz = value::get_pet_value2('zd_tz', $o_pet_id);
    if ($o_pet_zd_tz > 0) {
        skill::add_skill_chat($o_pet_name . '被眩晕了', $user_id, $o_user_id);
    }
    //宠物中毒
    $u_pet_zd_zd = value::get_pet_value2('zd_zd', $u_pet_id);
    if ($u_pet_zd_zd > 0) {
        $zdhp = (int)($u_pet_max_sh / 10);
        $u_pet_zd_zd_hp = value::get_pet_value2('zd_zd', $u_pet_id);
        value::add_pet_value($u_pet_id, 1, -1 * $u_pet_zd_zd_hp, false);
        skill::add_skill_chat($u_pet_name . '中毒了,减血' . $u_pet_zd_zd_hp . '点。', $user_id, $o_user_id);
    }
    $o_pet_zd_zd = value::get_pet_value2('zd_zd', $o_pet_id);
    if ($o_pet_zd_zd > 0) {
        $zdhp = (int)($u_pet_max_sh / 10);
        $o_pet_zd_zd_hp = value::get_pet_value2('zd_zd', $o_pet_id);
        value::add_pet_value($o_pet_id, 1, -1 * $o_pet_zd_zd_hp, false);
        skill::add_skill_chat($o_pet_name . '中毒了,减血' . $o_pet_zd_zd_hp . '点。', $user_id, $o_user_id);
    }
    //回天效果触发
    //己方
    if (value::get_pet_value2('pk.jiacheng.zaisheng', $u_pet_id, false)) {
        //回天 每回合自动恢复部分生命
        $zs_hp = (int)($u_pet_maxhp / 10);
        value::add_pet_value($u_pet_id, 1, $zs_hp, false);
        skill::add_skill_chat($u_pet_name . '的血量回天了' . $zs_hp . '点。', $user_id, $o_user_id);
    }
    //敌方
    if (value::get_pet_value2('pk.jiacheng.zaisheng', $o_pet_id, false)) {
        //回天 每回合自动恢复部分生命
        $zs_hp = (int)($o_pet_maxhp / 10);
        value::add_pet_value($o_pet_id, 1, $zs_hp, false);
        skill::add_skill_chat($o_pet_name . '的血量回天了' . $zs_hp . '点。', $o_user_id, $user_id);
    }
    //获取宠物HP
    $u_pet_hp = (int)value::get_pet_value($u_pet_id, 'hp');
    $o_pet_hp = (int)value::get_pet_value($o_pet_id, 'hp');
    //获取敌我宠物所使用技能ID
    $o_skill_id = 0;
    //己方使用技能ID
    //下回合技能
    $skill_id = value::get_pet_value2('pk.next_skill.id', $u_pet_id, false);
    //没有下回合技能 使用默认技能
    if (!$skill_id) {
        $skill_id = value::get_pet_value2('skill_moren.id', $u_pet_id, false);
    }
    //没有默认技能 使用随机技能
    if (!$skill_id) {
        $obj = new game_pet_object($u_pet_id);
        $result = $obj->aget("skill.*.id");
        $skill_id = $result[array_rand($result, 1)];
    }
    //敌方使用技能ID
    if ($mode < 4) {
        //野生宠物技能
        $o_pet_zzid = value::get_pet_value($o_pet_id, 'pet_id');
        $study_lvl = value::getvalue('pet', 'study_lvl', 'id', $o_pet_zzid);
        $can_study_fashu = (int)($o_pet_lvl / $study_lvl + 1);
        $can_study_fashu = $can_study_fashu > 10 ? 10 : $can_study_fashu;
        $can_study_count = $can_study_fashu > 4 ? 4 : $can_study_fashu;
        //读取种族技能
        $o_p_study_skill_str = value::getvalue('pet', 'study_skill', 'id', $o_pet_zzid);
        $o_p_study_skill_arr = explode(',', $o_p_study_skill_str);
        //设置野将技能ID
        //是否有前置技能准备中
        $obj = new game_pet_object($o_pet_id);
        $result = $obj->aget("pk.skill.*.qianzhi");
        foreach ($result as $k => $v) {
            $o_qianzhi_skill_str = $k;
            break;
        }
        if ($o_qianzhi_skill_str) {
            $o_qianzhi_skill_arr = explode('.', $o_qianzhi_skill_str);
            $o_skill_id = $o_qianzhi_skill_arr[4];
        }
        //随机技能
        if (!$o_skill_id) {
            $o_skill_id = $o_p_study_skill_arr[$can_study_fashu - mt_rand(1, $can_study_count)];
        }
        if (!$o_skill_id) {
            $o_skill_id = 1;
        }
    } else {
        //敌方玩家宠物技能
        //下回合技能
        $o_skill_id = value::get_pet_value2('pk.next_skill.id', $o_pet_id, false);
        //没有下回合技能 使用默认技能
        if (!$o_skill_id) {
            $o_skill_id = value::get_pet_value2('skill_moren.id', $o_pet_id, false);
        }
        //没有默认技能 使用随机技能
        if (!$o_skill_id) {
            $obj = new game_pet_object($o_pet_id);
            $result = $obj->aget("skill.*.id");
            $o_skill_id = $result[array_rand($result, 1)];
        }
    }
    //己方
    //灵活 装备修正
    $u_pet_minjie += pet::get_liuwei_jiacheng($u_pet_id, 'minjie');
    //灵活 技能加成修正
    $u_pet_minjie *= (skill::get_pet_jiacheng($u_pet_id, 'minjie') / 100 + 1);
    $u_pet_minjie += mt_rand(1, 3);
    //敌方
    //灵活 装备修正
    $o_pet_minjie += pet::get_liuwei_jiacheng($o_pet_id, 'minjie');
    //灵活 技能加成修正
    $o_pet_minjie *= (skill::get_pet_jiacheng($o_pet_id, 'minjie') / 100 + 1);
    $o_pet_minjie += mt_rand(1, 3);
    //宠物存活
    if ($u_pet_hp && $o_pet_hp) {
        //宠物灵活先手决定
        $min_minjie = (int)($u_pet_minjie <= $o_pet_minjie ? $u_pet_minjie : $o_pet_minjie);
        $min_minjie = $min_minjie < 1 ? 1 : $min_minjie;
        //根据PK模式 决定PK灵活 (野怪PK 每回合仅能1招)
        if ($mode > 2) {
            if ($u_pet_minjie >= $o_pet_minjie) {
                if ($u_pet_minjie / 2 > $o_pet_minjie) {
                    $u_pet_minjie = $o_pet_minjie * 2;
                }
            } else {
                if ($o_pet_minjie / 2 > $u_pet_minjie) {
                    $o_pet_minjie = $u_pet_minjie * 2;
                }
            }
            $u_pk_minjie = value::add_pet_value2('pk.minjie', $u_pet_minjie, $u_pet_id);
            $o_pk_minjie = value::add_pet_value2('pk.minjie', $o_pet_minjie, $o_pet_id);
        } else {
            if ($u_pet_minjie <= $o_pet_minjie) {
                $u_pk_minjie = value::add_pet_value2('pk.minjie', $min_minjie, $u_pet_id);
                $o_pk_minjie = value::add_pet_value2('pk.minjie', $min_minjie + 1, $o_pet_id);
            } else {
                $u_pk_minjie = value::add_pet_value2('pk.minjie', $min_minjie + 1, $u_pet_id);
                $o_pk_minjie = value::add_pet_value2('pk.minjie', $min_minjie, $o_pet_id);
            }
        }
        //本回合使用宠物技能
        while ($u_pk_minjie >= $min_minjie || $o_pk_minjie >= $min_minjie) {
            //是否可使用技能
            $can_use_skill = true;
            //开始宠物战斗操作
            if ($u_pk_minjie >= $o_pk_minjie) {
                //己方更换宠物
                $next_pet_id = value::get_user_value('pk.next_pet.id', $user_id, false);
                if ($next_pet_id) {
                    $can_swap_pet = true;
                    //删除交换宠物操作
                    value::set_user_value('pk.next_pet.id', 0, $user_id);
                    //束缚状态
                    if (value::get_pet_value($u_pet_id, 'zhuangtai') == 9) {
                        $can_swap_pet = false;
                        skill::add_skill_chat($u_pet_name . '被束缚了,无法交换宠物。', $user_id, $o_user_id);
                    }
                    //金刚束法
                    if (value::get_pet_value2('pk.jnxgzt.jgsf', $u_pet_id, false)) {
                        $can_swap_pet = false;
                        skill::add_skill_chat($u_pet_name . '被金刚束法了,无法交换宠物。', $user_id, $o_user_id);
                    }
                    //开始交换
                    if ($can_swap_pet) {
                        //交换宠物
                        skill::swap_pet($u_pet_id, $next_pet_id, $o_user_id);
                        //设置己方宠物ID
                        $u_pet_id = $next_pet_id;
                        //无法使用技能 PK灵活清零
                        $can_use_skill = false;
                        $u_pk_minjie = 0;
                    }
                }
                //己方使用物品
                $next_item_id = value::get_user_value('pk.next_item.id', $user_id, false);
                if ($next_item_id) {
                    //删除使用药品操作
                    value::set_user_value('pk.next_item.id', 0, $user_id);
                    //使用物品事件
                    if (!skill::use_item($u_pet_id, $next_item_id, $o_pet_id)) {
                        return;
                    }
                    //无法使用技能
                    $can_use_skill = false;
                    //与野怪战斗 清除灵活 避免误杀
                    if ($mode < 3) {
                        $u_pk_minjie = 0;
                        value::set_pet_value2('pk.minjie', 0, $u_pet_id);
                    }
                }
                //己方宠物影响技能异常状态效果触发
                if ($can_use_skill) {
                    $can_use_skill = skill::yczt_can_use_skill($u_pet_id, $o_pet_id, $skill_id, value::get_pet_value($u_pet_id, 'zhuangtai'));
                }
                if (value::get_pet_value($u_pet_id, 'is_dead') || value::get_pet_value($o_pet_id, 'is_dead') || value::get_pet_value2('zd_tz', $u_pet_id)) {
                    $can_use_skill = false;
                }
                //使用技能
                if ($can_use_skill) {
                    //使用攻击技能
                    skill::use_skill($u_pet_id, $o_pet_id, $skill_id);
                    //设置下回合技能
                    value::set_pet_value2('pk.next_skill.id', $skill_id, $u_pet_id);
                }
                //更新己方宠物灵活
                if ($u_pk_minjie) {
                    $u_pk_minjie = value::add_pet_value2('pk.minjie', -1 * $min_minjie, $u_pet_id);
                }
                //更新敌方宠物血量
                $pet_hp = (int)value::get_pet_value($o_pet_id, 'hp');
            } else {
                if ($o_user_id) {
                    //敌方更换宠物
                    $next_pet_id = value::get_user_value('pk.next_pet.id', $o_user_id, false);
                    if ($next_pet_id) {
                        $can_swap_pet = true;
                        //删除交换宠物操作
                        value::set_user_value('pk.next_pet.id', 0, $o_user_id);
                        //束缚状态
                        if (value::get_pet_value($o_pet_id, 'zhuangtai') == 9) {
                            $can_swap_pet = false;
                            skill::add_skill_chat($o_pet_name . '被束缚了,无法交换宠物。', $o_user_id, $user_id);
                        }
                        //金刚束法
                        if (value::get_pet_value2('pk.jnxgzt.jgsf', $o_pet_id, false)) {
                            $can_swap_pet = false;
                            skill::add_skill_chat($o_pet_name . '被金刚束法了,无法交换宠物。', $o_user_id, $user_id);
                        }
                        //开始交换
                        if ($can_swap_pet) {
                            //交换宠物
                            skill::swap_pet($o_pet_id, $next_pet_id, $user_id);
                            //设置敌方宠物ID
                            $o_pet_id = $next_pet_id;
                            //无法使用技能 PK灵活清零
                            $can_use_skill = false;
                            $o_pk_minjie = 0;
                        }
                    }
                    //敌方使用物品
                    $next_item_id = value::get_user_value('pk.next_item.id', $o_user_id, false);
                    if ($next_item_id) {
                        //删除使用药品操作
                        value::set_user_value('pk.next_item.id', 0, $o_user_id);
                        //使用物品事件
                        if (!skill::use_item($o_pet_id, $next_item_id, $u_pet_id)) {
                            return;
                        }
                        //无法使用技能
                        $can_use_skill = false;
                    }
                }
                //敌方宠物影响技能异常状态效果触发
                if ($can_use_skill) {
                    $can_use_skill = skill::yczt_can_use_skill($o_pet_id, $u_pet_id, $o_skill_id, value::get_pet_value($o_pet_id, 'zhuangtai'));
                }
                //使用技能
                if (value::get_pet_value($u_pet_id, 'is_dead') || value::get_pet_value($o_pet_id, 'is_dead')  || value::get_pet_value2('zd_tz', $o_pet_id)) {
                    $can_use_skill = false;
                }
                if ($can_use_skill) {
                    //使用技能
                    skill::use_skill($o_pet_id, $u_pet_id, $o_skill_id);
                    //设置下回合技能
                    value::set_pet_value2('pk.next_skill.id', $o_skill_id, $o_pet_id);
                }
                //更新敌方宠物灵活
                if ($o_pk_minjie) {
                    $o_pk_minjie = value::add_pet_value2('pk.minjie', -1 * $min_minjie, $o_pet_id);
                }
                //更新己方宠物血量
                $pet_hp = (int)value::get_pet_value($u_pet_id, 'hp');
            }
            //是否有任意宠物死亡 回合结束
            if (!$pet_hp) {
                break;
            }
        }
    }
     //玩家补天回血回蓝
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_bt.time');
    $wj_bt_hp = value::get_user_value('wj_bt_hp');
    $wj_bt_mp = value::get_user_value('wj_bt_mp');
    if ($mianzhan_time > $now_time && !value::get_game_user_value('is_dead', $user_id) && $mode != 4) {
        value::add_game_user_value('hp', $wj_bt_hp);
        value::add_game_user_value('mp', $wj_bt_mp);
    }
    //回合结束
    //双方宠物是否PK判定
    value::set_pet_value($u_pet_id, 'is_pk', 1);
    value::set_pet_value($o_pet_id, 'is_pk', 1);
    $mp = value::get_game_user_value('mp', $user_id);
    $max_mp = value::get_game_user_value('max_mp', $user_id);
    $hp = value::get_game_user_value('hp', $user_id);
    $max_hp = value::get_game_user_value('max_hp', $user_id);
    //回合中毒
    $zd_zd_hp = value::get_user_value('zd_zd_hp', $user_id);
    $zd_zd1 = value::get_user_value('zd_zd', $user_id);
    $zd_hp = value::get_game_user_value('hp', $user_id);
    $zd_name = value::get_game_user_value('name', $user_id);
    if ($zd_zd1 > 0 && $zd_hp > 0 && !value::get_game_user_value('is_dead', $user_id)) {
        value::add_game_user_value('hp', -1 * $zd_zd_hp, $user_id);
        skill::add_skill_chat($zd_name . '中毒了,减血' . $zd_zd_hp . '点', $user_id, $o_user_id);
        value::add_user_value('zd_zd', -1, $user_id);
    }

    //回合减技能祝福次数
    value::set_user_value('zd_tz', 0, $user_id);
    $ds_fy = value::get_user_value('ds_fy', $user_id);
    if ($ds_fy > 0) {
        value::add_user_value('ds_fy', -1, $user_id);
    }
    $ds_hd = value::get_user_value('ds_hd', $user_id);
    if ($ds_hd > 0) {
        value::add_user_value('ds_hd', -1, $user_id);
    }
    $zd_ds_qm = value::get_user_value('zd_ds_qm', $user_id);
    if ($zd_ds_qm > 0) {
        value::add_user_value('zd_ds_qm', -1, $user_id);
    }
    $zd_fs_hd = value::get_user_value('zd_fs_hd', $user_id);
    if ($zd_fs_hd > 0) {
        value::add_user_value('zd_fs_hd', -1, $user_id);
    }
    $zd_jn_6 = value::get_user_value('zd_jn_6', $user_id);
    if ($zd_jn_6 > 0) {
        value::add_user_value('zd_jn_6', -1, $user_id);
    }
    if ($zd_jn_6 < 1) {
        value::set_user_value('jn_mz', 0, $user_id);
    }
    $dy_zd = value::get_user_value('dy_zd', $user_id);
    if ($dy_zd > 0) {
        value::add_user_value('dy_zd', -1, $user_id);
    }
    $zd_mb = value::get_user_value('zd_mb', $user_id);
    if ($zd_mb > 0) {
        value::add_user_value('zd_mb', -1, $user_id);
    }
    $u_pet_zd_zd = value::get_pet_value2('zd_zd', $u_pet_id);
    if ($u_pet_zd_zd > 0) {
        value::add_pet_value2('zd_zd', -1, $u_pet_id);
    }
    $o_pet_zd_zd = value::get_pet_value2('zd_zd', $o_pet_id);
    if ($o_pet_zd_zd > 0) {
        value::add_pet_value2('zd_zd', -1, $o_pet_id);
    }
    $u_pet_dy_zd = value::get_pet_value2('dy_zd', $u_pet_id);
    if ($u_pet_dy_zd > 0) {
        value::add_pet_value2('dy_zd', -1, $u_pet_id);
    }
    $o_pet_dy_zd = value::get_pet_value2('dy_zd', $o_pet_id);
    if ($o_pet_dy_zd > 0) {
        value::add_pet_value2('dy_zd', -1, $o_pet_id);
    }
    $u_pet_zd_mb = value::get_pet_value2('zd_mb', $u_pet_id);
    if ($u_pet_zd_mb > 0) {
        value::add_pet_value2('zd_mb', -1, $u_pet_id);
    }
    $o_pet_zd_mb = value::get_pet_value2('zd_mb', $o_pet_id);
    if ($o_pet_zd_mb > 0) {
        value::add_pet_value2('zd_mb', -1, $o_pet_id);
    }

    $u_pet_zd_tz = value::get_pet_value2('zd_tz', $u_pet_id);
    if ($u_pet_zd_tz > 0) {
        value::add_pet_value2('zd_tz', -1, $u_pet_id);
    }
    $o_pet_zd_tz = value::get_pet_value2('zd_tz', $o_pet_id);
    if ($o_pet_zd_tz > 0) {
        value::add_pet_value2('zd_tz', -1, $o_pet_id);
    }

    if ($hp > $max_hp) {
        value::set_game_user_value('hp', $max_hp, $user_id);
    }
    if ($mp > $max_mp) {
        value::set_game_user_value('mp', $max_mp, $user_id);
    }
    //记录战斗回合
    value::add_user_value('pk.huihe', 1, $user_id);
    if ($o_user_id) {
        value::add_user_value('pk.huihe', 1, $o_user_id);
    }
    //技能效果减少1回合
    //六维加成
    $obj = new game_pet_object($u_pet_id);
    $obj->aincrby("pk.jiacheng.*", -1);
    $obj = new game_pet_object($o_pet_id);
    $obj->aincrby("pk.jiacheng.*", -1);
    //金刚束法
    if (value::get_pet_value2('pk.jnxgzt.jgsf', $u_pet_id, false)) {
        value::add_pet_value2('pk.jnxgzt.jgsf', -1, $u_pet_id);
    }
    if (value::get_pet_value2('pk.jnxgzt.jgsf', $o_pet_id, false)) {
        value::add_pet_value2('pk.jnxgzt.jgsf', -1, $o_pet_id);
    }
    //获取双方宠物HP
    $u_pet_hp = (int)value::get_pet_value($u_pet_id, 'hp');
    $o_pet_hp = (int)value::get_pet_value($o_pet_id, 'hp');
    value::set_pet_value($o_pet_id, 'zhuangtai', 0);
    value::set_pet_value($u_pet_id, 'zhuangtai', 0);
    //玩家死亡
    $u_sw_hp = value::get_game_user_value('hp', $user_id);
    $u_sw_name = value::get_game_user_value('name', $user_id);
    $o_sw_hp = value::get_game_user_value('hp', $o_user_id);
    $o_sw_name = value::get_game_user_value('name', $o_user_id);
    if ($u_sw_hp < 1) {
        value::set_game_user_value('is_dead', 1, $user_id);
    }
    if ($o_sw_hp < 1) {
        value::set_game_user_value('is_dead', 1, $o_user_id);
    }
    if ($u_pet_hp < 1) {
        value::set_pet_value($u_pet_id, 'is_dead', 1);
    }
    if ($o_pet_hp < 1) {
        value::set_pet_value($o_pet_id, 'is_dead', 1);
    }
    //己方宠物死亡
    $u_change_ok = false;
    if (!$u_pet_id && !$o_pet_id && $u_sw_hp < 1 && $mode == 4) {
        e89(4, 0, $user_id);
        skill::add_skill_chat("你打败了{$u_sw_name}<br>你获得了胜利。", $o_user_id, 0, true);
        e68(4, 0, 0, $o_user_id);
    } else {
        if ((!$u_pet_id && $u_sw_hp < 1) || ($u_pet_hp < 1 && $u_sw_hp < 1)) {
            value::set_pet_value($u_pet_id, 'is_dead', 1);
            //降低忠诚度
            value::add_pet_value($u_pet_id, 3, -20, false);
            //己方玩家 死亡换将
            $u_change_ok = skill::dead_change_pet($mode, $u_pet_id, $o_pet_id);
            if (!$u_change_ok) {
                return;
            }
        }
    }
    //敌方宠物死亡
    $o_change_ok = false;
    if (!$u_pet_id && !$o_pet_id && $o_sw_hp < 1 && $mode == 4) {
        e89(4, 0, $o_user_id);
        skill::add_skill_chat("你打败了{$o_sw_name}<br>你获得了胜利。", $user_id, 0, true);
        e68(4, 0, 0, $user_id);
    } else {
        if ((!$o_pet_id && $o_sw_hp < 1) || ($o_pet_hp < 1 && $o_sw_hp < 1)) {
            value::set_pet_value($o_pet_id, 'is_dead', 1);
            //敌方玩家 死亡换将
            if ($mode == 4) {
                //降低忠诚度
                value::add_pet_value($o_pet_id, 3, -20, false);
                $o_change_ok = skill::dead_change_pet($mode, $o_pet_id, $u_pet_id);
                if (!$o_change_ok) {
                    return;
                }
            }
        }
    }
    //NPC死亡换将
    if ($mode > 1 && $mode < 4) {
        if (value::get_pet_value($o_pet_id, 'is_dead')) {
            skill::add_skill_chat($o_npc_name . '的' . $o_pet_name . '战死了', $user_id, $o_user_id);
            if ($mode == 2) {
                $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$o_npc_id} AND `enemy_user`={$user_id} AND `is_dead`=0 ORDER BY `id` ASC LIMIT 1";
            } else if ($mode == 3) {
                $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$o_npc_id} AND `team_id`={$u_team_id} AND `is_dead`=0 ORDER BY `id` ASC LIMIT 1";
            }
            $result = sql($sql);
            list($o_new_pet_id) = $result->fetch_row();
            if ($o_new_pet_id) {
                skill::add_skill_chat($o_npc_name . '的' . value::get_pet_value($o_new_pet_id, 'name') . '上场。', $user_id, $o_user_id);
                $o_change_ok = true;
            } else {
                //组队挑战NPC
                if ($mode == 3) {
                    e68(3, 0, $o_npc_id, $user_id);
                    return;
                } else if ($mode == 2) {
                    e68(2, 0, $o_npc_id, $user_id);
                    return;
                }
            }
        }
    }
    //人鬼同途
    if (value::get_pet_value2('pk.jnxgzt.rgtt', $u_pet_id, false) == $o_pet_id && $o_change_ok && value::get_pet_value($o_pet_id, 'is_dead')) {
        //输出提示
        skill::add_skill_chat($u_pet_name . '与' . $o_pet_name . '共赴黄泉。', $o_user_id, $user_id);
        //设置HP
        value::set_pet_value($u_pet_id, 'hp', '0');
        //设置死亡
        value::set_pet_value($u_pet_id, 'is_dead', 1);
        //降低忠诚度
        value::add_pet_value($u_pet_id, 3, -20, false);
        //死亡更换宠物
        if (!skill::dead_change_pet($mode, $u_pet_id, $o_pet_id, $user_id, $o_user_id)) {
            return;
        }
    }
    //野怪 单人NPC
    if ($mode < 4) {
        //战斗胜利
        if ($o_pet_hp < 1 && $mode == 1) {
            e68(1, $o_pet_id);
            return;
        }
        //返回模板
        e0();
    }
}

//宠物 查看技能
function e83($oid, $step = 0, $s_id = 0)
{
    if (!$step) {
        $zhuansheng = value::get_pet_value($oid, 'zhuansheng');
        echo '已经学会的技能:';
        br();
        $moren_skill_id = value::get_pet_value2('skill_moren.id', $oid, false);
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $oid, false)) {
            $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
            $max_pp *= $zhuansheng ? 1.5 : 1;
            $max_pp = (int)$max_pp;
            echo "[" . value::getvalue('skill', 'shuxing', 'id', $skill_id) . "]";
            if ($moren_skill_id == $skill_id) {
                echo "★";
            }
            cmd::addcmd('e83,' . $oid . ',1,' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
            echo "(" . value::get_pet_value2('skill.' . $skill_id . '.pp', $oid) . "/" . $max_pp . ")" . skill::get_skill_leixing($skill_id);
            br();
            $i++;
        }
        cmd::addcmd('e62', '返回上级');
        return;
    } else if ($step == 1) {
        echo '[' . value::getvalue('skill', 'name', 'id', $s_id) . ']';
        br();
        echo skill::get_skill_desc($s_id);
        br();
        echo '威力:' . value::getvalue('skill', 'weili', 'id', $s_id) . ' 命中:' . value::getvalue('skill', 'mingzhong', 'id', $s_id);
        br();
        if (value::get_skill_value($s_id, 'in_map_use')) {
            cmd::addcmd('e83,' . $oid . ',3,' . $s_id, '使用' . value::get_skill_value($s_id, 'name') . '技能');
            br();
        }
        if (value::get_skill_value($s_id, 'leixing') < 3) {
            cmd::addcmd('e83,' . $oid . ',2,' . $s_id, '设为默认技能');
            br();
        }
    } else if ($step == 2) {
        value::set_pet_value2('skill_moren.id', $s_id, $oid);
        echo '你把[' . value::get_skill_value($s_id, 'name') . ']设置为' . value::get_pet_value($oid, 'name') . '的默认技能。';
        br();
    } else if ($step == 3) {
        //地图 快捷技能
        $ok = true;
        $pet_name = value::get_pet_value($oid, 'name');
        if (!$pet_name) {
            $pet_name = "宠物";
        }
        if (!user::have_pet(0, $oid)) {
            echo "你已经没有这只{$pet_name}了。";
            br();
            $ok = false;
        }
        if (value::get_pet_value($oid, 'master_mode') != 1 && $ok) {
            echo "你身上没有这只{$pet_name}了。";
            br();
            $ok = false;
        }
        if (value::get_pet_value($oid, 'is_dead') && $ok) {
            echo "你的{$pet_name}已经死亡,无法使用技能。";
            br();
            $ok = false;
        }
        if (!skill::pet_have_skill($oid, $s_id) && $ok) {
            echo "你的{$pet_name}没有这个技能了。";
            br();
            $ok = false;
        }
        if ($ok) {
            $in_map_id = value::get_game_user_value('in_map_id');
            switch ($s_id) {
                case 166:
                    value::set_user_value('shentizhuangtai', 2);
                    echo "你心无旁骛,元神出窍,浑身轻盈,魂魄可以游荡地府。";
                    br();
                    break;
                case 168:
                    value::set_user_value('shentizhuangtai', 5);
                    echo "你集中精力,聚力于心,钢筋铁骨,可以冲破一切障碍。";
                    br();
                    break;
                case 169:
                    value::set_user_value('shentizhuangtai', 6);
                    echo "你脚下聚力,蜻蜓点水,一跃飞天,可以跃上空中石桥。";
                    br();
                    break;
                case 170:
                    value::set_user_value('shentizhuangtai', 1);
                    echo "你屏住呼吸,全身放松,如鱼得水,想要遨游江河湖海。";
                    br();
                    break;
                case 171:
                    if (value::get_map_value($in_map_id, 'is_pk')) {
                        $sql = "SELECT `id` FROM `game_pet` WHERE `map_id`={$in_map_id} AND `is_pk`=0 AND `master_id`=0 AND `npc_id`=0 AND `master_mode`!=8 ORDER BY RAND() LIMIT 1";
                        $result = sql($sql);
                        list($pet_id) = $result->fetch_row();
                        if ($pet_id) {
                            e48($pet_id);
                            return;
                        } else {
                            echo "没有找到可以挑战的宠物。";
                            br();
                        }
                    } else {
                        echo "这里不能打架。";
                        br();
                    }
                    break;
                case 172:
                    value::set_user_value('shentizhuangtai', 3);
                    echo "你暗念避水口诀,下东海,入龙宫,如探囊取物。";
                    br();
                    break;
                case 173:
                    value::set_user_value('shentizhuangtai', 4);
                    echo "你念动真言,一个筋斗十万八千里,腾云驾雾,遨游天宫。";
                    br();
                    break;
                case 174:
                    if (!value::get_map_value($in_map_id, 'is_jianyu')) {
                        if (user::get('pkjjzt')) {
                            echo "竞技比赛即将开始,你无法离开竞技场!";
                            br();
                            break;
                        }
                        e20(1);
                        return;
                    } else {
                        echo "监狱无法使用传送。";
                        br();
                    }
                    break;
            }
        }
        e5();
        return;
    }
    cmd::addcmd('e83,' . $oid, '返回上级');
}

//宠物 查看技能
function e831($oid, $step = 0, $s_id = 0)
{
    if (!$step) {
        $zhuansheng = value::get_pet_value($oid, 'zhuansheng');
        echo '技能:';
        $moren_skill_id = value::get_pet_value2('skill_moren.id', $oid, false);
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $oid, false)) {
            $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
            $max_pp *= $zhuansheng ? 1.5 : 1;
            $max_pp = (int)$max_pp;
            cmd::addcmd('e831,' . $oid . ',1,' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
            echo ",";
            $i++;
        }
        echo '';
        return;
    } else if ($step == 1) {
        echo '[' . value::getvalue('skill', 'name', 'id', $s_id) . ']';
        br();
        echo '威力:' . value::getvalue('skill', 'weili', 'id', $s_id) . ' 命中:' . value::getvalue('skill', 'mingzhong', 'id', $s_id);
        br();
    }
    cmd::addcmd('e621', '返回上级');
}

//宠物 学习技能
function e84($pet_id, $skill_id, $cnum = -1, $show = true, $need_money = false)
{
    $from_list = value::get_user_value('study_skill_from');
    skill::study_skill($pet_id, $skill_id, $cnum, $show, $need_money);
    if ($from_list == 1) {
        cmd::addcmd('e40,0,1', '返回上级');
    } else if ($from_list == 2) {
        cmd::addcmd('e62', '返回上级');
    }
}

//宠物 可学习技能
function e85($pet_id)
{
    //判断宠物归属
    if (!user::have_pet(0, $pet_id)) {
        echo "该宠物已经不属于你了。";
        br();
        return;
    }
    //宠物是否死亡
    if (value::get_pet_value($pet_id, 'is_dead')) {
        echo "宠物已死亡,无法学习技能。";
        br();
        cmd::addcmd('e62', '返回上级');
        return;
    }
    //查看宠物技能列表
    $lvl = value::get_pet_value($pet_id, 'lvl');
    //转生+1 计算金钱
    $zhuansheng = value::get_pet_value($pet_id, 'zhuansheng') + 1;
    $zzid = value::get_pet_value($pet_id, 'pet_id');
    $study_lvl = value::getvalue('pet', 'study_lvl', 'id', $zzid);
    $can_study_fashu = (int)($lvl / $study_lvl + 1);
    $can_study_fashu = $can_study_fashu > 10 ? 10 : $can_study_fashu;
    //读取种族技能
    $p_study_skill_str = value::getvalue('pet', 'study_skill', 'id', $zzid);
    $p_study_skill_arr = explode(',', $p_study_skill_str);
    //学习技能
    echo '可学习技能列表:';
    br();
    for ($i = 0; $i < $can_study_fashu; $i++) {
        if (!skill::pet_have_skill($pet_id, $p_study_skill_arr[$i]) && $p_study_skill_arr[$i]) {
            if ($i != $can_study_fashu - 1) {
                $cmdstr = 'e84,' . $pet_id . ',' . ($p_study_skill_arr[$i]) . ',-1,true,true';
                $houzhui = "(" . ($lvl * 10 * $zhuansheng) . "金币)";
            } else {
                $cmdstr = 'e84,' . $pet_id . ',' . ($p_study_skill_arr[$i]);
                $houzhui = "(免费)";
            }
            cmd::addcmd($cmdstr, value::getvalue('skill', 'name', 'id', $p_study_skill_arr[$i]));
            echo $houzhui;
            br();
            echo '描述:' . skill::get_skill_desc($p_study_skill_arr[$i]);
            br();
            echo '属性:' . value::getvalue('skill', 'shuxing', 'id', $p_study_skill_arr[$i]) . ' 类型:' . skill::get_skill_leixing($p_study_skill_arr[$i]);
            br();
            echo '威力:' . value::getvalue('skill', 'weili', 'id', $p_study_skill_arr[$i]) . ' 命中:' . value::getvalue('skill', 'mingzhong', 'id', $p_study_skill_arr[$i]);
            br();
            echo '使用次数:' . value::get_skill_value($p_study_skill_arr[$i], 'pp') . 'PP';
            br();
        }
    }
    if (value::get_user_value('game_master', 0, false) && !value::get_user_value('kg.xssjxt')) {
        echo '[技能系统]';
        br();
        $result = sql("SELECT COUNT(`id`) FROM `skill` WHERE 1");
        list($skill_count) = $result->fetch_row();
        for ($i = 1; $i <= $skill_count; $i++) {
            echo $i . '.';
            $cmdstr = 'e84,' . $pet_id . ',' . ($i);
            $houzhui = "(免费)";
            cmd::addcmd($cmdstr, value::getvalue('skill', 'name', 'id', $i));
            echo $houzhui;
            br();
        }
    }
    cmd::addcmd('e62', '返回上级');
}

//宠物 使用回复PP药品
function e86($pet_id, $item_id, $step = 0, $add_skill_id = 0)
{
    //判断宠物归属
    if (!user::have_pet(0, $pet_id)) {
        echo "该宠物已经不属于你了。";
        br();
        return;
    }
    //宠物是否死亡
    if (value::get_pet_value($pet_id, 'is_dead')) {
        echo "宠物已死亡,无法喂食药品。";
        br();
        cmd::addcmd('e62', '返回上级');
        return;
    }
    if (!$step) {
        $zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
        echo '想要给哪个技能加次数:';
        br();
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $pet_id, false)) {
            $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
            $max_pp *= $zhuansheng > 0 ? 1.5 : 1;
            $max_pp = (int)$max_pp;
            cmd::addcmd('e86,' . $pet_id . ',' . $item_id . ',1,' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
            echo "(" . value::get_pet_value2('skill.' . $skill_id . '.pp', $pet_id) . "/" . $max_pp . ")";
            br();
            $i++;
        }
    } else {
        $pp_count = 0;
        if (item::lose_item($item_id, 1)) {
            switch ($item_id) {
                case 47:
                    $pp_count = 5;
                    break;
                case 48:
                    $pp_count = 10;
                    break;
                case 49:
                    $pp_count = 20;
                    break;
                case 50:
                    $pp_count = 40;
                    break;
            }
            $max_pp = value::getvalue('skill', 'pp', 'id', $add_skill_id);
            $max_pp = (int)$max_pp;
            $now_pp = value::add_pet_value2('skill.' . $add_skill_id . '.pp', $pp_count, $pet_id);
            if ($now_pp > $max_pp) {
                value::set_pet_value2('skill.' . $add_skill_id . '.pp', $max_pp, $pet_id);
            }
            echo value::getvalue('skill', 'name', 'id', $add_skill_id) . '的技能恢复了。';
            br();
            cmd::addcmd('e40,' . $pet_id, '返回上级');
        }
    }
}

//宠物 使用秘籍事件
function e87($pet_id, $item_id)
{
    if (item::get_item($item_id)) {
        $p_lvl = value::get_pet_value($pet_id, 'lvl');
        $p_name = value::get_pet_value($pet_id, 'name');
        $i_name = value::get_item_value($item_id, 'name');
        $need_lvl = 0;
        $skill_id = 0;
        switch ($item_id) {
            //飞踢
            case 28:
                $need_lvl = 5;
                $skill_id = 167;
                break;
            //冲锋
            case 54:
                $need_lvl = 10;
                $skill_id = 168;
                break;
            //跳跃
            case 55:
                $need_lvl = 20;
                $skill_id = 169;
                break;
            //凫水
            case 56:
                $need_lvl = 30;
                $skill_id = 170;
                break;
            //出窍
            case 57:
                $need_lvl = 40;
                $skill_id = 166;
                break;
            //预感
            case 58:
                $need_lvl = 50;
                $skill_id = 171;
                break;
            //潜水
            case 59:
                $need_lvl = 60;
                $skill_id = 172;
                break;
            //筋斗云
            case 60:
                $need_lvl = 70;
                $skill_id = 173;
                break;
            //传送
            case 61:
                $need_lvl = 80;
                $skill_id = 174;
                break;
        }
        if ($skill_id && $p_lvl >= $need_lvl) {
            skill::study_skill($pet_id, $skill_id);
        } else {
            echo "这本{$i_name}对你的{$p_name}来说太深奥了。";
            br();
        }
    } else {
        echo "你身上没有此物品了。";
        br();
    }
}

//npc 是否被拦路
function e88($new_map_id, $old_map_id, $direction)
{
    $user_id = uid();
    $npc_id = 0;
    $lanlu_npc_arr = config::getConfigByName("lanlu");
    foreach ($lanlu_npc_arr as $omid => $vr) {
        if ($old_map_id == $omid) {
            foreach ($vr['direction_arr'] as $d) {
                if ($d == $direction) {
                    $npc_id = $vr['npc_id'];
                    break;
                }
            }
        }
    }
    if ($npc_id && !value::get_user_value('map.lanlu.' . $npc_id)) {
        //己方出战宠物设置
        $pet_ok = false;
        $pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($pet_arr as $pet_id) {
            $is_dead = value::get_pet_value($pet_id, 'is_dead');
            if (!$is_dead) {
                $pet_ok = true;
                break;
            }
        }
        $new_map_name = value::get_map_value($new_map_id, 'name');
        $npc_name = value::get_npc_value($npc_id, 'name');
        echo "你正朝{$new_map_name}走去,{$npc_name}走过来拦住了你的去路!";
        br();
        if ($pet_ok) {
            cmd::addcmd("e10,{$npc_id}", "挑战{$npc_name}");
        } else {
            $map_id = value::get_user_value('cs_map', $user_id);
            $map_name = value::get_map_value($map_id, 'name', $user_id);
            value::set_game_user_value('in_map_id', $map_id, $user_id);
            echo "你的身上没有可以战斗的宠物了!<br>你回到了{$map_name}<br>快去治疗宠物吧!";
        }
        return true;
    } else {
        return false;
    }
}

//战斗 玩家战败事件
function e89($mode, $pet_id = 0, $user_id = 0)
{
    //获取用户信息
    if (!$user_id) {
        $user_id = uid();
    }
    if ($mode > 2) {
        value::set_user_value('is_pk_settlement_doing', 1, $user_id);
        value::set_user_value('pk_mode', $mode, $user_id);
        cmd::delallcmd($user_id);
    }
    //返回地图模板
    value::set_game_user_value('in_ctm', 'ctm_map', $user_id);
    //获取用户信息
    $user_name = value::get_game_user_value('name', $user_id);
    $o_user_id = value::get_game_user_value('pk.user.id', $user_id);
    $o_user_name = value::get_game_user_value('name', $o_user_id);
    //获取NPC信息
    $o_npc_id = value::get_pet_value($pet_id, 'npc_id');
    //返回地图id
    $hongming = value::get_user_value('hongming', $user_id);
    if ($hongming < 10) {
        $return_map_id = 1;
    } else{
        $return_map_id = 5360;
    }
    if ($mode == 1) {
        //挑战野怪战败
        skill::add_skill_chat('你被' . value::get_pet_value($pet_id, 'name') . '打败了！', $user_id, 0);
    } else if ($mode > 1 && $mode < 4) {
        //挑战NPC战败
        skill::add_skill_chat('你被' . value::get_npc_value($o_npc_id, 'name') . '打败了！', $user_id, 0);
    }
    //宠物装备磨损
    $pet_arr = array();
    $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `is_pk`=1";
    $result = sql($sql);
    while (list($oid) = $result->fetch_row()) {
        array_push($pet_arr, $oid);
    }
    $pet_count = count($pet_arr);
    for ($i = 0; $i < $pet_count; $i++) {
        pet::prop_mosun($pet_arr[$i], -5, $mode, false);
    }
    //玩家失去金币
    $lose_money = 0;
    $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
    $u_ts_pk = value::get_map_value($u_in_map_id, 'ts_pk');
    if ($mode == 4 && $u_ts_pk < 1) {
        //金钱
        $lose_money = (int)(value::get_user_value('money', $user_id) * 0.3);
        item::add_money(-1 * $lose_money, $user_id, false);
        skill::add_skill_chat("你失去了{$lose_money}个金币", $user_id, 0);
        $hongming = value::get_user_value('hongming', $user_id);
        $hy_lvl = value::get_user_value('hy_lvl', $user_id);
        value::add_user_value('pk_sw_cs', 1, $user_id);
        $pk_sw_cs = value::get_user_value('pk_sw_cs', $user_id);
        $pk_sj = mt_rand(1, 100);
        $pk_sj = $pk_sw_cs * 10 + 10;
        if ($hongming > 0 && $pk_sj < $pk_sj) {
            $sql = "SELECT `id` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=5 ORDER BY LENGTH(`name`) ASC";
            $result = sql($sql);
            while (list($game_prop_id) = $result->fetch_row()) {
                $user_num = value::get_game_prop_value($game_prop_id, 'user_num');
                $sj101 = mt_rand(1, 10);
                if (!value::get_prop_value($game_prop_id, 'is_budiao') && $user_num == 5 && $sj101 == 1) {
                    $name = value::get_game_user_value('name', $user_id);
                    $prop_name = value::get_game_prop_value($game_prop_id, 'name');
                    value::set_game_prop_value($game_prop_id, 'user_id', '0');
                    value::set_game_prop_value($game_prop_id, 'user_num', '0');
                    $in_map_id = value::get_game_user_value('in_map_id');
                    prop::map_get_prop($in_map_id, $game_prop_id);
                    echo "{$name}的{$prop_name}掉到了地上<br>";
                }
            }
        } else {
            $sql = "SELECT `id` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=5 ORDER BY LENGTH(`name`) ASC";
            $result = sql($sql);
            while (list($game_prop_id) = $result->fetch_row()) {
                $sj10 = mt_rand(1, 100);
                if ($sj10 < 10) {
                    $sj101 = mt_rand(1, 10);
                    $user_num = value::get_game_prop_value($game_prop_id, 'user_num');
                    if (!value::get_prop_value($game_prop_id, 'is_budiao') && $user_num == 5 && $sj101 == 1) {
                        $name = value::get_game_user_value('name', $user_id);
                        $prop_name = value::get_game_prop_value($game_prop_id, 'name');
                        value::set_game_prop_value($game_prop_id, 'user_id', '0');
                        value::set_game_prop_value($game_prop_id, 'user_num', '0');
                        $in_map_id = value::get_game_user_value('in_map_id');
                        prop::map_get_prop($in_map_id, $game_prop_id);
                        echo "{$name}的{$prop_name}掉到了地上<br>";
                    }
                }
            }
        }
        $pk_sw_cs = value::get_user_value('pk_sw_cs', $user_id);
        if ($pk_sw_cs > 9) {
            value::set_user_value('pk_sw_cs', 0, $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+4hour"));
            value::set_user_value('mianzhan.time', $new_mianzhan_time, $user_id);
        }
    }
    //玩家PK
    $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
    $u_ts_pk = value::get_map_value($u_in_map_id, 'ts_pk');
    if ($mode == 4 && $u_ts_pk < 1) {
        //己方玩家
        //提示
        $sports_id = value::get_user_value('pkjjid', $user_id);
        if ($sports_id) {
            sports::out_of_sports($sports_id, $o_user_id);
        }
        $wj_sw_sj = mt_rand(1, 100);
        $wj_sw_sjPK = (int)value::get_user_value('hongming');
        if ($wj_sw_sj < 10 || $wj_sw_sjPK > 0) {
            value::set_user_value('is_wj_sw', 1, $user_id);
        }
        skill::add_skill_chat("你被" . $o_user_name . "打败了!", $user_id, 0);
        //悬赏
        $xuanshang = value::get_game_user_value('xuanshang', $user_id);
        $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
        $u_ts_pk = value::get_map_value($u_in_map_id, 'ts_pk');
        if ($xuanshang) {
            //己方
            //悬红 地图 狱中常客 红名
            $max_hongming = 2880;
            $lose_money += $xuanshang;
            $add_hongmingdian = $xuanshang / 9000;
            if ($u_ts_pk < 1) {
                $hongming = value::get_user_value('hongming', $user_id);
            }
            if ($hongming < 10) {
                $return_map_id = 1;
            } else{
                $return_map_id = 5360;
            }
            value::set_game_user_value('xuanshang', 0, $user_id);
            value::add_user_value('yzckshu', 1, $user_id);
            value::set_user_value('last_hongming_time', time(), $user_id);
            $map_name1 = value::get_map_value($return_map_id, 'name');
            skill::add_skill_chat("你被{$o_user_name}送进了{$map_name1}。", $user_id, 0, true);
            //敌方
            //赏金杀手
            value::add_user_value('sjssshu', 1, $o_user_id);
            skill::add_skill_chat("你将{$user_name}送进了监狱。", $o_user_id, 0, true);
            //广播
            c_add_guangbo("{$o_user_name}将{$user_name}送进了{$map_name1},斩获了{$xuanshang}个金币!");
        } else {
            $map_id = value::get_user_value('cs_map', $user_id);
            $map_name = value::get_map_value($map_id, 'name', $user_id);
            skill::add_skill_chat("你回到了" . $map_name, $user_id, 0);
        }
        //敌方玩家
        //金钱
        item::add_money($lose_money, $o_user_id, false);
        skill::add_skill_chat("你获得了{$lose_money}个金币", $o_user_id, 0);
        //增加失败数
        value::add_user_value('shibaishu', 1, $user_id);
        //加入仇人列表
        $sql = "SELECT `id` FROM `game_user_value` WHERE `userid`={$user_id} AND `valuename`='{$user_id}.chouren' AND `value`='" . $o_user_id . "' LIMIT 1";
        $result = sql($sql);
        list($value_id) = $result->fetch_row();
        if (!$value_id && $o_user_id) {
            value::insert_user_value('chouren', $o_user_id, $user_id);
        }
        //帮派
        $union_id = user::get_union($user_id);
        $o_union_id = user::get_union($o_user_id);
        if ($union_id && $o_union_id && $union_id != $o_union_id) {
            //地图 帮派 职位名称
            $in_map_id = value::get_game_user_value("in_map_id", $user_id);
            $in_map_name = value::get_map_value($in_map_id, 'name');
            $union_name = union::get_name($union_id);
            $o_union_name = union::get_name($o_union_id);
            $touxian = user::get_union_lvl_name($user_id);
            $o_touxian = user::get_union_lvl_name($o_user_id);
            c_add_guangbo("{$o_union_name}的{$o_touxian}{$o_user_name}在{$in_map_name}将{$union_name}的{$touxian}{$user_name}击杀!");
        }
        if ($union_id && $o_user_id) {
            $sql = "SELECT `id` FROM `game_union_value` WHERE `union_id`={$union_id} AND `valuename`='chouren' AND `value`='{$o_user_id}' LIMIT 1";
            $result = sql($sql);
            list($value_id) = $result->fetch_row();
            if (!$value_id) {
                union::insert($union_id, 'chouren', $o_user_id);
            }
            union::add($union_id, 'chouren.' . $o_user_id, 1);
        }
    }
    //返回地图
    value::set_game_user_value('in_map_id', $return_map_id, $user_id);
    //战斗结果
    if ($mode < 3) {
        //野怪 单人NPC
        $map_id = value::get_user_value('cs_map', $user_id);
        $map_name = value::get_map_value($map_id, 'name', $user_id);
        e137();
    } else {
        //组队NPC
        if ($mode == 3) {
            $return_map_name = value::get_map_value($return_map_id, 'name');
            skill::add_skill_chat("你回到了{$return_map_name}。", $user_id, 0, true);
        }
        //战斗结算完成
        value::set_user_value('is_pk_settlement_doing', 2, $user_id);
    }
    //设置PK属性
    value::set_user_value("pk_win_money", 0, $user_id);
    value::set_user_value("pk_win_exp", 0, $user_id);
    //玩家退出战斗
    user::exit_pk($user_id);
}

//角色 获取宠物称号事件
function e90($pet_id, $pet_lvl = 101)
{
    $user_id = uid();
    $result = sql("SELECT `id` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `pet_id`={$pet_id} AND `lvl`>=" . $pet_lvl . " LIMIT 1");
    if (list($id) = $result->fetch_row()) {
        return true;
    } else {
        return false;
    }
}

//战斗 交换宠物事件
function e91($step = 0, $pet_id = 0)
{
    $user_id = uid();
    $pk_now_pet_id = value::get_game_user_value('pk.now_pet.id', $user_id);
    //开始操作
    if (!$step) {
        echo '我请选择需要交换的宠物:';
        br();
        $can_swap_count = 0;
        $sql = "SELECT `id`,`name`,`lvl`,`nick_name` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=1 AND `is_dead`=0 AND `id`!={$pk_now_pet_id}";
        $result = sql($sql);
        while (list($oid, $oname, $olvl, $onick_name) = $result->fetch_row()) {
            cmd::addcmd('e91,1,' . $oid, ($onick_name ? "({$onick_name})" : "") . $oname . '(' . $olvl . '级)');
            br();
            $can_swap_count++;
        }
        if (!$can_swap_count) {
            echo '没有可以交换的宠物了!';
            br();
        }
        cmd::addcmd('e0', '返回上级');
        cmd::set_show_return_game(false);
    } else {
        //清除使用药品 逃跑操作
        value::set_user_value('pk.next_item.id', 0, $user_id);
        value::set_user_value('pk.next_taopao', 0, $user_id);
        //设置交换宠物
        value::set_user_value('pk.next_pet.id', $pet_id, $user_id);
        e82();
    }
}

//战斗使用物品事件
function e92($step = 0, $item_id = 0, $skill_id = 0) 
{
    $user_id = uid();
    if (!$step) {
        echo '请选择需要的物品:';
        br();
        $item_count = 0;
        $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
        $result = sql($sql);
        while (list($id, $count) = $result->fetch_row()) {
            if ($count) {
                $id = explode('.', $id);
                $item_id = $id[2];
                if (value::getvalue('item', 'is_pk_use', 'id', $item_id) && value::getvalue('item', 'is_pet_use', 'id', $item_id)) {
                    $name = value::getvalue('item', 'name', 'id', $item_id);
                    $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
                    cmd::addcmd('e92,1,' . $item_id, $name . "x" . $count . $liangci);
                    br();
                }
                $item_count++;
            }
        }
        if (!$item_count) {
            echo '没有可以使用的物品了!';
            br();
        }
        cmd::addcmd('e0', '返回上级');
        cmd::set_show_return_game(false);
    } else if ($step == 1) {
        //补血药品 招降符咒 状态恢复药品
        if ($item_id > 1 && $item_id < 7) {
            //清除交换宠物 逃跑操作
            value::set_user_value('pk.next_pet.id', 0, $user_id);
            value::set_user_value('pk.next_taopao', 0, $user_id);
            //设置下回合使用药品
            value::set_user_value('pk.next_item.id', $item_id, $user_id);
            e82();
            return;
        }
        //PP药品
        if ($item_id > 46 && $item_id < 51) {
            $pk_now_pet_id = value::get_game_user_value('pk.now_pet.id', $user_id);
            $zhuansheng = value::get_pet_value($pk_now_pet_id, 'zhuansheng');
            $obj = new game_pet_object($pk_now_pet_id);
            $result = $obj->aget("skill.*.id");
            while ($skill_id = array_shift($result)) {
                $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
                $max_pp *= $zhuansheng > 0 ? 1.5 : 1;
                $max_pp = (int)$max_pp;
                echo "[" . value::getvalue('skill', 'shuxing', 'id', $skill_id) . "]";
                cmd::addcmd('e92,2,' . $item_id . ',' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
                echo "(" . value::get_pet_value2('skill.' . $skill_id . '.pp', $pk_now_pet_id) . "/" . $max_pp . ")" . skill::get_skill_leixing($skill_id);
                br();
            }
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        }
    } else if ($step == 2) {
        //清除交换宠物 逃跑操作
        value::set_user_value('pk.next_pet.id', 0, $user_id);
        value::set_user_value('pk.next_taopao', 0, $user_id);
        //设置下回合使用PP药品
        value::set_user_value('pk.next_item.id', $item_id, $user_id);
        e82();
        return;
    }
}

//战斗 逃跑事件
function e93()
{
    $user_id = uid();
    $can_taopao = true;
    //是否副本
    $to_map = value::get_game_user_value('in_map_id', $user_id);
    $in_fuben = value::get_map_value($to_map, "is_duorenfuben") || value::get_map_value($to_map, "is_danrenfuben") ? true : false;
    if ($in_fuben) {
        $can_taopao = false;
        skill::add_skill_chat("副本之中无法逃跑!", $user_id);
    }
    //是否阎王
    if (value::get_npc_value(value::get_game_user_value('pk.npc.id', $user_id), 'is_yanwang')) {
        $can_taopao = false;
        skill::add_skill_chat("小子,你把我这里当菜园,想来就来想走就走了吗?", $user_id);
    }
    //可以逃跑
    if ($can_taopao) {
        //清除交换宠物 使用药品操作
        value::set_user_value('pk.next_pet.id', 0, $user_id);
        value::set_user_value('pk.next_item.id', 0, $user_id);
        //设置下回合逃跑
        value::set_user_value('pk.next_taopao', 1, $user_id);
        value::set_user_value('zd_tz', 1, $user_id);
    }
    e82();
}

//战斗 选择技能
function e94($step, $pet_id, $use_skill_id)
{
    $user_id = uid();
    $pk_now_pet_id = value::get_game_user_value('pk.now_pet.id', $user_id);
    if ($pet_id == $pk_now_pet_id) {
        $pet_name = value::get_pet_value($pk_now_pet_id, 'name');
        if ($step == 0) {
            echo '请选择要使用的技能:';
            br();
            $zhuansheng = value::get_pet_value($pk_now_pet_id, 'zhuansheng');
            $obj = new game_pet_object($pk_now_pet_id);
            $result = $obj->aget("skill.*.id");
            while ($skill_id = array_shift($result)) {
                $max_pp = value::get_skill_value($skill_id, 'pp');
                //转生增加可使用PP
                $max_pp *= $zhuansheng > 0 ? 1.5 : 1;
                //PP取整
                $max_pp = (int)$max_pp;
                echo "[" . value::get_skill_value($skill_id, 'shuxing') . "]";
                cmd::addcmd('e94,7,' . $pet_id . ',' . $skill_id, value::get_skill_value($skill_id, 'name'));
                echo "(" . value::get_pet_value2('skill.' . $skill_id . '.pp', $pk_now_pet_id) . "/" . $max_pp . ")" . skill::get_skill_leixing($skill_id);
                br();
            }
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        } else if ($step == 1) {
            echo '请选择要使用的技能:';
            br();
            $zhuansheng = value::get_pet_value($pk_now_pet_id, 'zhuansheng');
            $obj = new game_pet_object($pk_now_pet_id);
            $result = $obj->aget("skill.*.id");
            while ($skill_id = array_shift($result)) {
                $max_pp = value::get_skill_value($skill_id, 'pp');
                //转生增加可使用PP
                $max_pp *= $zhuansheng > 0 ? 1.5 : 1;
                //PP取整
                $max_pp = (int)$max_pp;
                echo "[" . value::get_skill_value($skill_id, 'shuxing') . "]";
                cmd::addcmd('e94,4,' . $pet_id . ',' . $skill_id, value::get_skill_value($skill_id, 'name'));
                echo "(" . value::get_pet_value2('skill.' . $skill_id . '.pp', $pk_now_pet_id) . "/" . $max_pp . ")" . skill::get_skill_leixing($skill_id);
                br();
            }
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        } else if ($step == 2) {
            echo '请选择要使用的技能:';
            br();
            $zhuansheng = value::get_pet_value($pk_now_pet_id, 'zhuansheng');
            $obj = new game_pet_object($pk_now_pet_id);
            $result = $obj->aget("skill.*.id");
            while ($skill_id = array_shift($result)) {
                $max_pp = value::get_skill_value($skill_id, 'pp');
                //转生增加可使用PP
                $max_pp *= $zhuansheng > 0 ? 1.5 : 1;
                //PP取整
                $max_pp = (int)$max_pp;
                echo "[" . value::get_skill_value($skill_id, 'shuxing') . "]";
                cmd::addcmd('e94,5,' . $pet_id . ',' . $skill_id, value::get_skill_value($skill_id, 'name'));
                echo "(" . value::get_pet_value2('skill.' . $skill_id . '.pp', $pk_now_pet_id) . "/" . $max_pp . ")" . skill::get_skill_leixing($skill_id);
                br();
            }
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        } else if ($step == 3) {
            echo '请选择要使用的技能:';
            br();
            $zhuansheng = value::get_pet_value($pk_now_pet_id, 'zhuansheng');
            $obj = new game_pet_object($pk_now_pet_id);
            $result = $obj->aget("skill.*.id");
            while ($skill_id = array_shift($result)) {
                $max_pp = value::get_skill_value($skill_id, 'pp');
                //转生增加可使用PP
                $max_pp *= $zhuansheng > 0 ? 1.5 : 1;
                //PP取整
                $max_pp = (int)$max_pp;
                echo "[" . value::get_skill_value($skill_id, 'shuxing') . "]";
                cmd::addcmd('e94,6,' . $pet_id . ',' . $skill_id, value::get_skill_value($skill_id, 'name'));
                echo "(" . value::get_pet_value2('skill.' . $skill_id . '.pp', $pk_now_pet_id) . "/" . $max_pp . ")" . skill::get_skill_leixing($skill_id);
                br();
            }
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        } else if ($step == 4) {
            //宠物是否拥有此技能
            if (skill::pet_have_skill($pk_now_pet_id, $use_skill_id)) {
                $can_change_skill = true;
                //金刚束法
                if (value::get_pet_value2('pk.jnxgzt.jgsf', $pk_now_pet_id, false) && $use_skill_id != value::get_pet_value2('pk.next_skill.id', $pk_now_pet_id, false)) {
                    $can_change_skill = false;
                    skill::add_skill_chat($pet_name . '被金刚束法了,无法更换技能。', $user_id, 0);
                }
                //更换技能
                if ($can_change_skill) {
                    value::set_pet_value2('pk.next_skill.id1', $use_skill_id, $pk_now_pet_id);
                    value::set_pet_value2('pk.next_skill.id', $use_skill_id, $pk_now_pet_id);
                }
            }
            e82();
        } else if ($step == 5) {
            //宠物是否拥有此技能
            if (skill::pet_have_skill($pk_now_pet_id, $use_skill_id)) {
                $can_change_skill = true;
                //金刚束法
                if (value::get_pet_value2('pk.jnxgzt.jgsf', $pk_now_pet_id, false) && $use_skill_id != value::get_pet_value2('pk.next_skill.id', $pk_now_pet_id, false)) {
                    $can_change_skill = false;
                    skill::add_skill_chat($pet_name . '被金刚束法了,无法更换技能。', $user_id, 0);
                }
                //更换技能
                if ($can_change_skill) {
                    value::set_pet_value2('pk.next_skill.id2', $use_skill_id, $pk_now_pet_id);
                    value::set_pet_value2('pk.next_skill.id', $use_skill_id, $pk_now_pet_id);
                }
            }
            e82();
        } else if ($step == 6) {
            //宠物是否拥有此技能
            if (skill::pet_have_skill($pk_now_pet_id, $use_skill_id)) {
                $can_change_skill = true;
                //金刚束法
                if (value::get_pet_value2('pk.jnxgzt.jgsf', $pk_now_pet_id, false) && $use_skill_id != value::get_pet_value2('pk.next_skill.id', $pk_now_pet_id, false)) {
                    $can_change_skill = false;
                    skill::add_skill_chat($pet_name . '被金刚束法了,无法更换技能。', $user_id, 0);
                }
                //更换技能
                if ($can_change_skill) {
                    value::set_pet_value2('pk.next_skill.id3', $use_skill_id, $pk_now_pet_id);
                    value::set_pet_value2('pk.next_skill.id', $use_skill_id, $pk_now_pet_id);
                }
            }
            e82();
        } else if ($step == 7) {
            //宠物是否拥有此技能
            if (skill::pet_have_skill($pk_now_pet_id, $use_skill_id)) {
                $can_change_skill = true;
                //金刚束法
                if (value::get_pet_value2('pk.jnxgzt.jgsf', $pk_now_pet_id, false) && $use_skill_id != value::get_pet_value2('pk.next_skill.id', $pk_now_pet_id, false)) {
                    $can_change_skill = false;
                    skill::add_skill_chat($pet_name . '被金刚束法了,无法更换技能。', $user_id, 0);
                }
                //更换技能
                if ($can_change_skill) {
                    value::set_pet_value2('pk.next_skill.id', $use_skill_id, $pk_now_pet_id);
                }
            }
            e82();
        }
    } else {
        e82();
    }
}

//战斗 选择技能
function jn_e94($step, $pet_id)
{
    $user_id = uid();
    if ($step == 7) {
        //宠物是否拥有此技能
        value::set_pet_value2('pk.next_skill.id1', '', $pet_id);
        jn_e96();
    } else if ($step == 8) {
        //宠物是否拥有此技能
        value::set_pet_value2('pk.next_skill.id2', '', $pet_id);
        jn_e96();
    } else if ($step == 9) {
        //宠物是否拥有此技能
        value::set_pet_value2('pk.next_skill.id3', '', $pet_id);
        jn_e96();
    }
}

//选项 设置快捷物品
function e95($kj_num = 0, $item_id = 0, $step = 0, $mode = 0)
{
    $user_id = uid();
    if (!$step) {
        echo '请设置快捷物品:';
        br();
        $sql = "SELECT `valuename` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%' AND `value`!=0";
        $result = sql($sql);
        $item_count = 0;
        while (list($id) = $result->fetch_row()) {
            $id = explode('.', $id);
            if (value::get_item_value($id[2], 'is_pk_use') && value::get_item_value($id[2], 'is_pet_use')) {
                $name = value::getvalue('item', 'name', 'id', $id[2]);
                cmd::addcmd("e95,{$kj_num},{$id[2]},1," . $mode, $name);
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "你身上什么东西都没有。";
            br();
        }
        if (!$mode) {
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        } else {
            cmd::addcmd('e96', '返回上级');
        }
    } else {
        value::set_user_value("kjwp.{$kj_num}.id", $item_id);
        if (!$mode) {
            e0();
        } else {
            e96();
        }
    }
}

//选项 设置快捷功能
function e96()
{
    $user_id = uid();
    //快捷物品
    echo "[战斗物品快捷设置]";
    br();
    for ($i = 0; $i < 3; $i++) {
        $kjwp_id = value::get_user_value('kjwp.' . $i . '.id', $user_id, false);
        echo '玩家物品键' . ($i + 1) . ":";
        if ($kjwp_id) {
            echo value::get_item_value($kjwp_id, 'name') . " ";
            cmd::addcmd("jn_e95,{$i},0,0,1", '设置');
            echo ' ';
            cmd::addcmd("jn_e95,{$i},0,1,1", '清除');
        } else {
            cmd::addcmd("jn_e95,{$i},0,0,1", '未定义');
        }
        br();
    }
    for ($i = 3; $i < 7; $i++) {
        $kjwp_id = value::get_user_value('kjwp.' . $i . '.id', $user_id, false);
        echo '宠物物品键' . ($i + 1) . ":";
        if ($kjwp_id) {
            echo value::get_item_value($kjwp_id, 'name') . " ";
            cmd::addcmd("jn_e95,{$i},0,0,1", '设置');
            echo ' ';
            cmd::addcmd("jn_e95,{$i},0,1,1", '清除');
        } else {
            cmd::addcmd("jn_e95,{$i},0,0,1", '未定义');
        }
        br();
    }
    //快捷技能
    echo "[战斗技能快捷设置]";
    br();
    $u = new game_user_object($user_id);
    $uSkillMorenId1 = $u->get('next.skill.id1');
    $uSkillMorenId2 = $u->get('next.skill.id2');
    $uSkillMorenId3 = $u->get('next.skill.id3');
    echo '玩家技能键1:';
    echo value::get_skill_value($uSkillMorenId1, 'name') . " ";
    if (!$uSkillMorenId1) {
        cmd::addcmd('jn_e10014,1', '未定义');
    }
    if ($uSkillMorenId1) {
        cmd::addcmd('jn_e10014,1', '设置');
    }
    echo ' ';
    if ($uSkillMorenId1) {
        cmd::addcmd('e10016,1', '清除');
    }
    br();
    echo '玩家技能键2:';
    echo value::get_skill_value($uSkillMorenId2, 'name') . " ";
    if (!$uSkillMorenId2) {
        cmd::addcmd('jn_e10014,2', '未定义');
    }
    if ($uSkillMorenId2) {
        cmd::addcmd('jn_e10014,2', '设置');
    }
    echo ' ';
    if ($uSkillMorenId2) {
        cmd::addcmd('e10016,2', '清除');
    }
    br();
    echo '玩家技能键3:';
    echo value::get_skill_value($uSkillMorenId3, 'name') . " ";
    if (!$uSkillMorenId3) {
        cmd::addcmd('jn_e10014,3', '未定义');
    }
    if ($uSkillMorenId3) {
        cmd::addcmd('jn_e10014,3', '设置');
    }
    echo ' ';
    if ($uSkillMorenId3) {
        cmd::addcmd('e10016,3', '清除');
    }
    br();
    $u_pet_id = value::get_game_user_value('pk.now_pet.id', $user_id);
    $u_next_skill_id1 = value::get_pet_value2('pk.next_skill.id1', $u_pet_id);
    $u_next_skill_id2 = value::get_pet_value2('pk.next_skill.id2', $u_pet_id);
    $u_next_skill_id3 = value::get_pet_value2('pk.next_skill.id3', $u_pet_id);
    echo '宠物技能键1:';
    echo value::get_skill_value($u_next_skill_id1, 'name') . " ";
    echo ' ';
    cmd::addcmd('jn_e94,7,' . $u_pet_id, '清除');
    br();
    echo '宠物技能键2:';
    echo value::get_skill_value($u_next_skill_id2, 'name') . " ";
    echo ' ';
    cmd::addcmd('jn_e94,8,' . $u_pet_id, '清除');
    br();
    echo '宠物技能键3:';
    echo value::get_skill_value($u_next_skill_id3, 'name') . " ";
    echo ' ';
    cmd::addcmd('jn_e94,9,' . $u_pet_id, '清除');
    br();
    cmd::addcmd('e0', '返回上级');
    cmd::set_show_return_game(false);
}

//选项 设置快捷物品
function jn_e95($kj_num = 0, $item_id = 0, $step = 0, $mode = 0)
{
    $user_id = uid();
    if (!$step) {
        echo '请设置快捷物品:';
        br();
        $sql = "SELECT `valuename` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%' AND `value`!=0";
        $result = sql($sql);
        $item_count = 0;
        while (list($id) = $result->fetch_row()) {
            $id = explode('.', $id);
            if (value::get_item_value($id[2], 'is_pk_use')) {
                $name = value::getvalue('item', 'name', 'id', $id[2]);
                cmd::addcmd("jn_e95,{$kj_num},{$id[2]},1," . $mode, $name);
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "你身上什么东西都没有。";
            br();
        }
        if (!$mode) {
            cmd::addcmd('e82', '返回上级');
            cmd::set_show_return_game(false);
        } else {
            cmd::addcmd('jn_e96', '返回上级');
        }
    } else {
        value::set_user_value("kjwp.{$kj_num}.id", $item_id);
        if (!$mode) {
            e82();
        } else {
            jn_e96();
        }
    }
}

//选项 设置快捷功能
function jn_e96()
{
    $user_id = uid();
    //快捷物品
    echo "[战斗物品快捷设置]";
    br();
    for ($i = 0; $i < 3; $i++) {
        $kjwp_id = value::get_user_value('kjwp.' . $i . '.id', $user_id, false);
        echo '玩家物品键' . ($i + 1) . ":";
        if ($kjwp_id) {
            echo value::get_item_value($kjwp_id, 'name') . " ";
            cmd::addcmd("jn_e95,{$i},0,0,1", '设置');
            echo ' ';
            cmd::addcmd("jn_e95,{$i},0,1,1", '清除');
        } else {
            cmd::addcmd("jn_e95,{$i},0,0,1", '未定义');
        }
        br();
    }
    for ($i = 3; $i < 7; $i++) {
        $kjwp_id = value::get_user_value('kjwp.' . $i . '.id', $user_id, false);
        echo '宠物物品键' . ($i + 1) . ":";
        if ($kjwp_id) {
            echo value::get_item_value($kjwp_id, 'name') . " ";
            cmd::addcmd("jn_e95,{$i},0,0,1", '设置');
            echo ' ';
            cmd::addcmd("jn_e95,{$i},0,1,1", '清除');
        } else {
            cmd::addcmd("jn_e95,{$i},0,0,1", '未定义');
        }
        br();
    }
    //快捷技能
    echo "[战斗技能快捷设置]";
    br();
    $u = new game_user_object($user_id);
    $uSkillMorenId1 = $u->get('next.skill.id1');
    $uSkillMorenId2 = $u->get('next.skill.id2');
    $uSkillMorenId3 = $u->get('next.skill.id3');
    echo '玩家技能键1:';
    echo value::get_skill_value($uSkillMorenId1, 'name') . " ";
    if (!$uSkillMorenId1) {
        cmd::addcmd('jn_e10014,1', '未定义');
    }
    if ($uSkillMorenId1) {
        cmd::addcmd('jn_e10014,1', '设置');
    }
    echo ' ';
    if ($uSkillMorenId1) {
        cmd::addcmd('e10016,1', '清除');
    }
    br();
    echo '玩家技能键2:';
    echo value::get_skill_value($uSkillMorenId2, 'name') . " ";
    if (!$uSkillMorenId2) {
        cmd::addcmd('jn_e10014,2', '未定义');
    }
    if ($uSkillMorenId2) {
        cmd::addcmd('jn_e10014,2', '设置');
    }
    echo ' ';
    if ($uSkillMorenId2) {
        cmd::addcmd('e10016,2', '清除');
    }
    br();
    echo '玩家技能键3:';
    echo value::get_skill_value($uSkillMorenId3, 'name') . " ";
    if (!$uSkillMorenId3) {
        cmd::addcmd('jn_e10014,3', '未定义');
    }
    if ($uSkillMorenId3) {
        cmd::addcmd('jn_e10014,3', '设置');
    }
    echo ' ';
    if ($uSkillMorenId3) {
        cmd::addcmd('e10016,3', '清除');
    }
    br();
    $u_pet_id = value::get_game_user_value('pk.now_pet.id', $user_id);
    $u_next_skill_id1 = value::get_pet_value2('pk.next_skill.id1', $u_pet_id);
    $u_next_skill_id2 = value::get_pet_value2('pk.next_skill.id2', $u_pet_id);
    $u_next_skill_id3 = value::get_pet_value2('pk.next_skill.id3', $u_pet_id);
    echo '宠物技能键1:';
    echo value::get_skill_value($u_next_skill_id1, 'name') . " ";
    echo ' ';
    cmd::addcmd('jn_e94,7,' . $u_pet_id, '清除');
    br();
    echo '宠物技能键2:';
    echo value::get_skill_value($u_next_skill_id2, 'name') . " ";
    echo ' ';
    cmd::addcmd('jn_e94,8,' . $u_pet_id, '清除');
    br();
    echo '宠物技能键3:';
    echo value::get_skill_value($u_next_skill_id3, 'name') . " ";
    echo ' ';
    cmd::addcmd('jn_e94,9,' . $u_pet_id, '清除');
    br();
    cmd::addcmd('e82', '返回上级');
    cmd::set_show_return_game(false);
}
//宠物袋 炼化宠物
function e97($pet_id, $step = 0)
{
    $user_id = uid();
    $sql = "SELECT `pet_id`,`name`,`lvl`,`xingge` FROM `game_pet` WHERE `id`={$pet_id} LIMIT 1";
    $result = sql($sql);
    list($zzid, $name, $lvl, $xingge) = $result->fetch_row();
    $shuxing = value::getvalue('pet', 'shuxing', 'id', $zzid);
    $pet_star = value::getvalue('pet', 'star', 'id', $zzid);
    if (!$step) {
        echo "{$name}({$lvl}级)<br>性格:" . pet::get_xingge($xingge) . "<br>属性:" . $shuxing . "";
        br();
        cmd::addcmd('e97,' . $pet_id . ',1', '炼化宠物');
        br();
    } else if ($step == 1) {
        $cmd = cmd::addcmd('e97,' . $pet_id . ',2', '炼化', false);
        $lianhua_moren_jinqian = value::get_user_value('lianhua_moren_jinqian');
        if (!$lianhua_moren_jinqian) {
            $lianhua_moren_jinqian = 1;
        }
        echo <<<lianhuaform
你要花多少金币炼化?(1-10000)<br>
<form action="game.php?cmd=$cmd" method="post" name="lianhua_form">
    <input type="text" name="money" maxlength="5" value="{$lianhua_moren_jinqian}">
    <br>
    <input type="submit"  value="确定炼化" name="炼化">
</form>
lianhuaform;
        cmd::addcmd('e97,' . $pet_id, '返回上级');
        return;
    } else if ($step == 2) {
        $money = (int)value::real_escape_string($_POST['money']);
        if ($money < 1 || $money > 10000) {
            echo "金币输入有误,请重新输入。";
            br();
            e97($pet_id, 1);
            return;
        } else {
            value::set_user_value('lianhua_moren_jinqian', $money);
        }
        $today = date("Y-m-d");
        $lianhua_day = value::get_user_value("lianhua.day", $user_id);
        if ($today != $lianhua_day) {
            value::set_user_value("lianhua.day", $today, $user_id);
            value::set_user_value("lianhua.today.counts", 0, $user_id);
        }
        if (value::get_user_value("lianhua.today.counts", $user_id) <= 100) {
            value::add_user_value("lianhua.today.counts", 1, $user_id);
            $beibaofuzhong = user::get_fuzhong();
            $beibaorongliang = user::get_rongliang();
            if ($beibaofuzhong < $beibaorongliang) {
                if (item::add_money(-1 * $money)) {
                    //宠物熟练度
                    $lianyao_shulian = (int)($pet_star * $lvl / 100);
                    $lianyao_shulian = $lianyao_shulian < 1 ? 1 : $lianyao_shulian;
                    //金钱概率
                    $moneygl = (int)($money / 1000);
                    $moneygl = $moneygl < 1 ? 1 : $moneygl;
                    //炼妖熟练度 炼化概率
                    $lhsl = (int)value::get_user_value('lianyao.shulian');
                    $lhgl = 500;
                    if (mt_rand(1, $lhgl) <= $lhsl && mt_rand(1, 10) <= $moneygl) {
                        if (mt_rand(1, 10) > 1) {
                            $t_shuxing = explode(' ', $shuxing);
                            $zhushuxing = $t_shuxing[0];
                            $lw_name = '';
                            $pinzhi = "";
                            if (strstr($zhushuxing, '金') || strstr($zhushuxing, '人')) {
                                $mode = 2;
                                $lw_name = 'pugong';
                            }
                            if (strstr($zhushuxing, '木') || strstr($zhushuxing, '仙')) {
                                $mode = 2;
                                $lw_name = 'pufang';
                            }
                            if (strstr($zhushuxing, '水') || strstr($zhushuxing, '妖')) {
                                $mode = 2;
                                $lw_name = 'tegong';
                            }
                            if (strstr($zhushuxing, '火') || strstr($zhushuxing, '风')) {
                                $mode = 2;
                                $lw_name = 'tefang';
                            }
                            if (strstr($zhushuxing, '土') || strstr($zhushuxing, '雷')) {
                                $mode = 2;
                                $lw_name = 'hp';
                            }
                            if (strstr($zhushuxing, '动')) {
                                $mode = 2;
                                $lw_name = 'minjie';
                            }
                            if (strstr($zhushuxing, '日') || strstr($zhushuxing, '月')) {
                                $mode = 3;
                            }
                            //随机装备
                            $sql = "SELECT `id` FROM `prop` WHERE `leixing`={$mode}";
                            if ($lw_name) {
                                $sql .= " AND `{$lw_name}`>0";
                            }
                            //装备品质
                            $star = (int)($pet_star * $lvl / 100);
                            $star = $star <= 1 ? 1 : $star;
                            $star = $star >= 5 ? 5 : $star;
                            $star = mt_rand(1, $star);
                            //装备星级
                            $prop_star = (int)($pet_star * $lvl / 75);
                            $prop_star = $prop_star <= 1 ? 1 : $prop_star;
                            $prop_star = $prop_star >= 8 ? 8 : $prop_star;
                            $prop_star = mt_rand(1, $prop_star);
                            if ($mode == 2) {
                                $sql .= " AND `star`={$prop_star}";
                            }
                            $sql .= " ORDER BY RAND() LIMIT 1";
                            //生成装备
                            $result = sql($sql);
                            list($prop_id) = $result->fetch_row();
                            $prop_name = value::get_prop_value($prop_id, 'name');
                            $liangci = value::get_prop_value($prop_id, 'liangci');
                            $new_prop_id = prop::new_prop($prop_id, 0, $star);
                            echo "{$name}化作一缕青烟,留下了1{$liangci}{$prop_name}。";
                            prop::user_get_prop($new_prop_id, 0, 1, false, true);
                            switch ($star) {
                                case 1:
                                    $pinzhi = '残品';
                                    break;
                                case 2:
                                    $pinzhi = '次品';
                                    break;
                                case 3:
                                    $pinzhi = '正品';
                                    break;
                                case 4:
                                    $pinzhi = '优品';
                                    break;
                                case 5:
                                    $pinzhi = '极品';
                                    break;
                            }
                            if (($mode == 2 && $prop_star > 4) || ($mode == 3 && $star > 3)) {
                                c_add_guangbo(value::get_game_user_value('name') . "炼化{$name},得到了1{$liangci}{$pinzhi}{$prop_name}。");
                            }
                            value::add_user_value('mssjshu', '1');
                            value::add_user_value('lianyao.shulian', $lianyao_shulian * 2);
                        } else {
                            $item_id = mt_rand(62, 74);
                            $item_name = value::get_item_value($item_id, 'name');
                            $item_liangci = value::get_item_value($item_id, 'liangci');
                            item::add_item($item_id, 1, false);
                            echo "{$name}化作一缕青烟,留下了1{$item_liangci}{$item_name}。";
                            c_add_guangbo(value::get_game_user_value('name') . "炼化{$name},得到了1{$item_liangci}{$item_name}。");
                            value::add_user_value('mssjshu', '1');
                            value::add_user_value('lianyao.shulian', $lianyao_shulian * 2);
                        }
                    } else {
                        echo "{$name}化作一缕青烟,什么都没有留下。";
                        value::add_user_value('lianyao.shulian', $lianyao_shulian);
                    }
                    pet::del_pet($pet_id);
                    br();
                }
            } else {
                echo "背包已满,请先清理背包。";
                br();
            }
        } else {
            echo "每日炼化次数已使用完。";
            br();
        }
    }
    cmd::addcmd('e77', '返回上级');
}

//角色 查看道具事件 0背包 1地上 2装配 3仓库
function e98($prop_id, $mode = 0, $yeshu = 0)
{
    prop::show_prop($prop_id, $mode);
    if (!$mode) {
        cmd::addcmd('e40,0,0,' . $yeshu, '返回上级');
    } else if ($mode == 1) {
        cmd::addcmd('e58', '返回上级');
    } else if ($mode == 2) {
        cmd::addcmd('e62', '返回上级');
    } else if ($mode == 3) {
        cmd::addcmd('e30,0,0,' . $yeshu, '返回上级');
    }
}

//角色 查看道具事件 0背包 1地上 2装配 3仓库
function e981($prop_id, $mode = 0, $yeshu = 0)
{
    prop::show_prop($prop_id, $mode);
    cmd::addcmd('e621', '返回上级');
}

//角色 失去道具
function e99($prop_id, $mode = 0, $step = 0)
{
    prop::user_lose_prop($prop_id, $mode, $step);
    if (!$step) {
        $cmd_str = "";
        if (!$mode) {
            $cmd_str = '丢弃';
        } else if ($mode == 1) {
            $cmd_str = '销毁';
        }
        cmd::addcmd('e99,' . $prop_id . ',' . $mode . ',1', '确定' . $cmd_str);
        br();
        cmd::addcmd('e98,' . $prop_id, '返回上级');
    } else {
        e40();
    }
}

//角色 捡起道具
function e100($prop_id)
{
    $map_id = value::get_game_user_value('in_map_id');
    if (prop::map_have_prop($prop_id, $map_id)) {
        if (prop::user_get_prop($prop_id, 0, 1)) {
            if (value::get_game_prop_value($prop_id, 'is_guangbo')) {
                value::set_game_prop_value($prop_id, 'is_guangbo', 0);
                c_add_guangbo(value::get_game_user_value('name') . "在" . value::get_map_value($map_id, 'name') . "获得了1" . value::get_game_prop_zz_value($prop_id, 'liangci') . value::get_game_prop_value($prop_id, 'name') . "!");
            }
            c_log('e100()', value::get_game_user_value('name') . "(id:" . uid() . ")在" . value::get_map_value($map_id, 'name') . "事件{e100}获得了1" . value::get_game_prop_zz_value($prop_id, 'liangci') . value::get_game_prop_value($prop_id, 'name') . "\r\n");
        }
        e5();
    } else {
        echo '这件物品已经不在这里了。';
        br();
        e5();
    }
}

//角色 使用道具
function e101($prop_id = 0, $pet_id = 0, $user_id = 0, $mode = 0)
{
    if (!prop::user_use_prop($prop_id, $pet_id, $user_id)) {
        cmd::addcmd('e98,' . $prop_id, '返回上级');
    } else {
        if (!$mode) {
            cmd::addcmd('e40', '返回上级');
        } else {
            cmd::addcmd('e62', '返回上级');
        }
    }
}

//角色 装配道具
function e102($pet_id, $prop_id = 0)
{
    $user_id = uid();
    if (!$prop_id) {
        echo "你想要装配什么道具?";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`name`,`prop_id` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1";
        $result = sql($sql);
        while (list($game_prop_id, $name, $prop_id) = $result->fetch_row()) {
            $leixing = value::get_prop_value($prop_id, 'leixing');
            if ($leixing > 1 && $leixing < 4) {
                cmd::addcmd('e102,' . $pet_id . ',' . $game_prop_id, "装配" . $name);
                br();
                prop::show_prop($game_prop_id, 6, false);
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "没有可以装配的道具。";
            br();
        }
    } else {
        prop::user_use_prop($prop_id, $pet_id);
    }
    cmd::addcmd('e62', '返回上级');
}

//宠物 卸下装备
function e103($prop_id)
{
    $user_id = uid();
    $pet_id = value::get_game_prop_value($prop_id, 'pet_id');
    $matster_id = value::get_pet_value($pet_id, 'master_id');
    if ($matster_id == $user_id) {
        prop::pet_lose_prop($prop_id, $pet_id);
        prop::user_get_prop($prop_id, 0, 1, false, true);
        cmd::addcmd('e62', '返回上级');
    } else {
        echo '你没有这只宠物!';
        br();
        cmd::addcmd('e621', '返回上级');
        return;
    }
}

//宠物 设置昵称
function e104($pet_id, $mode = 0)
{
    $nick_name = value::real_escape_string($_POST['nick_name']);
    $old_nick_name = value::get_pet_value($pet_id, 'nick_name');
    if (!$mode) {
        $cmd = cmd::addcmd('e104,' . $pet_id . ',1', '提交', false);
        echo "<form action='game.php?cmd=" . $cmd . "' method='post'><span>请输入昵称(4字内):</span><br/><input type='text' name='nick_name'><input type='submit' 'name'='设置' value='设置'></form>";
        if ($old_nick_name) {
            cmd::addcmd('e104,' . $pet_id . ',2', '清除昵称');
            br();
        }
    } else if ($mode == 1) {
        if (user::have_pet(0, $pet_id)) {
            if (c_check_str($nick_name) || !$nick_name) {
                value::set_pet_value($pet_id, 'nick_name', $nick_name);
                echo '设置成功!';
                br();
            } else {
                echo '昵称无法使用!';
                br();
            }
        } else {
            echo '你已经没有这只宠物了!';
            br();
            return;
        }
    } else if ($mode == 2) {
        if (user::have_pet(0, $pet_id)) {
            value::set_pet_value($pet_id, 'nick_name', "");
            echo '清除成功!';
            br();
        } else {
            echo '你已经没有这只宠物了!';
            br();
            return;
        }
    }
    cmd::addcmd('e62', '返回上级');
}

//角色 师徒关系
function e105($mode = 0, $step = 0, $tudi_id = 0)
{
    $is_return = true;
    $uid = uid();
    $uname = value::get_game_user_value('name');
    $shifu_id = value::get_game_user_value('shifu.id');
    $shifu_name = value::get_game_user_value('name', $shifu_id);
    $is_chushi = value::get_game_user_value('is_chushi');
    $zhangshu = user::get_zhang_count();
    if (!$mode) {
        if (!$is_chushi) {
            if ($shifu_id) {
                cmd::addcmd('e105,1', '我的师门');
                br();
                cmd::addcmd('e105,2', '我要出师');
                br();
                cmd::addcmd('e105,3', '叛出师门');
            } else {
                cmd::addcmd('e105,4', '我要拜师');
                if ($zhangshu >= 8) {
                    br();
                    cmd::addcmd('e105,6', '我要收徒');
                }
            }
        } else {
            cmd::addcmd('e105,5', '我的徒儿');
            br();
            cmd::addcmd('e105,6', '我要收徒');
        }
    } elseif ($mode == 1) {
        echo "师父:";
        if (value::get_game_user_value('is_online', $shifu_id)) {
            cmd::addcmd('e12,' . $shifu_id . ',7', $shifu_name);
        } else {
            echo $shifu_name;
        }
        br();
        echo "    ---";
        br();
        $sql = "SELECT `id`,`name`,`is_online` FROM `game_user` WHERE `shifu.id`={$shifu_id} ORDER BY `baishi.time` ASC LIMIT 0,20";
        $result = sql($sql);
        while (list($oid, $oname, $o_is_online) = $result->fetch_row()) {
            $o_shimen_name = user::get_shimen_nick_name($oid);
            echo $o_shimen_name . ":";
            if ($o_is_online) {
                cmd::addcmd('e12,' . $oid . ',7', $oname);
            } else {
                echo $oname;
            }
            user::showVipLogo($oid, true);
            br();
        }
        echo "    ---";
    } elseif ($mode == 2) {
        if ($zhangshu < 8) {
            echo "你必须拿到8个生肖徽章才可以出师!";
        } else {
            if (!$step) {
                echo "你确认出师之后就无法再拜师了,你确定要出师吗?";
                br();
                cmd::addcmd('e105,2,1', '确定出师');
            } else {
                user::chushi();
            }
        }
    } elseif ($mode == 3) {
        if (!$step) {
            echo "你确认要叛出师门,从此与{$shifu_name}恩断义绝吗?";
            br();
            cmd::addcmd('e105,3,1', '确定叛师(5000金币)');
        } else {
            if (item::add_money(-5000)) {
                echo "你与{$shifu_name}恩断义绝,从此江湖再见!";
                c_add_xiaoxi("{$uname}叛出师门,与你恩断义绝,从此江湖再见!", 0, $uid, $shifu_id);
                value::set_game_user_value('shifu.id', 0);
            } else {
                cmd::addcmd('e105', '返回上级');
                br();
                return;
            }
        }
    } elseif ($mode == 4) {
        echo "在传奇的世界中,遇见一些名动江湖的玩家,即可点击拜师来找一个师父,在他的带领下探索传奇的奇幻世界,在你成长的同时,二人都可以得到丰厚的师徒奖励。";
        br();
        cmd::addcmd("e217", "一键拜师");
    } elseif ($mode == 5) {
        echo "{$uname}的门下<br>    ---";
        br();
        $ocount = 0;
        $sql = "SELECT `id`,`name`,`is_online` FROM `game_user` WHERE `shifu.id`={$uid} ORDER BY `baishi.time` ASC LIMIT 0,20";
        $result = sql($sql);
        while (list($oid, $oname, $o_is_online) = $result->fetch_row()) {
            $ocount++;
            $o_shimen_name = user::get_shimen_nick_name($oid);
            echo $o_shimen_name . ":";
            if ($o_is_online) {
                cmd::addcmd('e12,' . $oid . ',7', $oname);
            } else {
                echo $oname;
            }
            user::showVipLogo($oid, true);
            echo " ";
            cmd::addcmd('e105,7,0,' . $oid, '踢出');
            br();
        }
        if (!$ocount) {
            echo "你还没有收过徒弟。";
            br();
        }
        echo "    ---";
    } elseif ($mode == 6) {
        if ($is_chushi) {
            if (!$step) {
                echo "你确定要花费1000金币发送收徒广告吗?";
                br();
                cmd::addcmd('e105,6,1', '发送广告');
            } else {
                if (time() > (value::get_user_value('shoutuguanggao.time') + 5)) {
                    if (item::add_money(-1000)) {
                        value::set_user_value('shoutuguanggao.time', time(), $uid);
                        echo "你的收徒广告已经发出,请静候佳音!";
                        c_add_guangbo("{$uname}昭告天下,广收门徒,有意者请速来拜师!", $uid, 2);
                    } else {
                        cmd::addcmd('e105', '返回上级');
                        br();
                        return;
                    }
                } else {
                    echo "你的收徒广告太频繁了,请稍后再发!";
                }
            }
        } else {
            if (!$step) {
                echo "你确定要自学出师吗?";
                br();
                cmd::addcmd('e105,6,1', '自学出师');
            } else {
                $user_name = value::get_game_user_value('name');
                item::add_money(10000);
                prop::user_get_prop(prop::new_prop(57, 0, 3), 0, 1, true, true);
                echo "你成功自学出师,开始遨游传奇,探索五行!";
                c_add_guangbo("惊天地,泣鬼神,{$user_name}自学成才,开始遨游传奇,探索五行!");
                value::set_game_user_value('shifu.id', 0);
                value::set_game_user_value('is_chushi', 1);
            }
        }
    } elseif ($mode == 7) {
        $is_return = false;
        $tudi_name = value::get_game_user_value('name', $tudi_id);
        if (!$step) {
            echo "你确定要把{$tudi_name}逐出师门吗?";
            br();
            cmd::addcmd('e105,7,1,' . $tudi_id . '', '确定逐出');
        } else {
            echo "你把{$tudi_name}逐出师门,从此恩断义绝,江湖再见!";
            c_add_xiaoxi("你被{$uname}逐出师门,从此恩断义绝,江湖再见!", 0, $uid, $tudi_id);
            value::set_game_user_value('shifu.id', 0, $tudi_id);
        }
        br();
        cmd::addcmd('e105,5', '返回上级');
    }
    if ($is_return) {
        if ($mode) {
            br();
            cmd::addcmd('e105', '返回上级');
        } else {
            br();
            cmd::addcmd('e0', '返回上级');
        }
    }
}

//帮派 帮派相关
function e106()
{
    cmd::addcmd('e106', '帮派');
    echo "<< 帮派功能";
    br();
    echo "-";
    br();
    cmd::addcmd('e176', '帮派排行');
    br();
    if (value::get_game_user_value('gonghui.id')) {
        cmd::addcmd('e177', '我的帮派');
        br();
        if (value::get_game_user_value('is_bbs_banzhu') || value::get_user_value('game_master')) {
            cmd::addcmd('e178', '审批帮派');
            br();
        }
    } else {
        cmd::addcmd('e178', '预备帮派');
        br();
        cmd::addcmd('e179', '创建帮派');
        br();
    }
    echo "-";
    br();
    cmd::addcmd('e0', '返回上级');
}
//组队 天地合一系列
function tdhy_e107($team_id)
{
    $uid = uid();
    $team_id = team::get_user_team($uid);
    $ts_jz12 = equip::get_user_equip_jc('ts_jz12');
    $captain_user_id = team::get_team_captain_user_id($team_id);
    $team_user_name = value::get_game_user_value('name', $captain_user_id);
    $user_name = value::get_game_user_value('name', $uid);
    $in_map_id = value::get_game_user_value('in_map_id', $uid);
    if ($ts_jz12 > 5) {
        if ($captain_user_id == $uid) {
            $captain_user_id = team::get_team_captain_user_id($team_id);
            $team_user_name = value::get_game_user_value('name', $captain_user_id);
            $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
            $result = sql($sql);
            while (list($oid) = $result->fetch_row()) {
                if ($captain_user_id != $oid) {
                    value::set_game_user_value('in_map_id', $in_map_id, $oid);
                    c_add_xiaoxi("{$user_name}使用@天地合一传把你送到队长身边!", 17, $uid, $captain_user_id, 0, 1);
                }
            }
        } else {
            echo "你还不是小队队长!";
        }
    } else {
        echo "你没有集齐天地合一套无法使用功能!";
    }
    br();
}

//组队 组队相关
function e107()
{
    $uid = uid();
    $item_count = 0;
    echo "[我的队友]";
    br();
    echo "-";
    br();
    $dy_exp = 0;
    $dy_exp1 = 0;
    $team_id = team::get_user_team($uid);
    if ($team_id) {
        $captain_user_id = team::get_team_captain_user_id($team_id);
        $team_user_name = value::get_game_user_value('name', $captain_user_id);
        echo "{$team_user_name}的小队:";
        br();
        $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
        $result = sql($sql);
        while (list($oid) = $result->fetch_row()) {
            $item_count ++;
            echo $item_count . ". ";
            if ($captain_user_id == $oid) {
                echo "★";
            }
            $dy_exp += 3;
            $dy_exp1 += 20;
            $o_name = value::get_game_user_value('name', $oid);
            $o_map_id = value::get_game_user_value('in_map_id', $oid);
            $o_map_name = value::get_map_value($o_map_id, 'name');
            cmd::addcmd('e12,' . $oid . ',11', $o_name);
            echo "({$o_map_name})";
            if ($captain_user_id == $uid && $uid != $oid) {
                echo " ";
                cmd::addcmd('e145,' . $oid, '踢出');
            }
            echo " ";
            cmd::addcmd('tdhy_e107,' . $team_id, '@天地合一');
            br();
        }
        cmd::addcmd('e36,5', '组队聊天');
        br();
        cmd::addcmd('e146', '退出小队');
        br();
        echo "<span style=color:green>经验：同地图小队获得{$dy_exp1}%经验打怪分成</span>";
        br();
        echo "<span style=color:green>生命.魔法.攻击.防御：小队获得{$dy_exp}%加成</span>";
    } else {
        echo "你暂时还没有加入小队!";
    }
    br();
    echo "-";
    br();
    cmd::addcmd('qt_e107', "组队大厅");
}

function qt_e107()
{
    echo "[组队大厅]";
    br();
    echo "-";
    br();
    $item_count = 0;
    $sql = "SELECT `id`,`captain_user_id` FROM `game_team` WHERE `id`>0";
    $result = sql($sql);
    while (list($oid, $captain_user_id) = $result->fetch_row()) {
        $item_count ++;
        if ($oid) {
            echo $item_count . ". ";
            $team_user_name = value::get_game_user_value('name', $captain_user_id);
            cmd::addcmd('qt_e107_1,' . $oid, $team_user_name . "的小队");
            br();
        } else {
            echo "暂时还没有其它小队!";
            br();
        }
    }
    echo "-";
}

function qt_e107_1($team_id)
{
    echo "[组队大厅]";
    br();
    echo "-";
    br();
    if ($team_id) {
        $captain_user_id = team::get_team_captain_user_id($team_id);
        $team_user_name = value::get_game_user_value('name', $captain_user_id);
        echo "{$team_user_name}的小队:";
        br();
        $item_count = 0;
        $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
        $result = sql($sql);
        while (list($oid) = $result->fetch_row()) {
            $item_count ++;
            echo $item_count . ". ";
            if ($captain_user_id == $oid) {
                $o_dw_id = $oid;
                echo "★";
            }
            $o_name = value::get_game_user_value('name', $oid);
            $o_map_id = value::get_game_user_value('in_map_id', $oid);
            $o_map_name = value::get_map_value($o_map_id, 'name');
            cmd::addcmd('e12,' . $oid . ',11', $o_name);
            echo "({$o_map_name})";
            br();
        }
    } else {
        echo "你暂时还没有加入小队!";
    }
    echo "-";
    br();
    cmd::addcmd('e144,' . $o_dw_id . ',1', '加入小队');
}

//任务 任务列表
function e108()
{
    show_task(2);
}

//任务 任务列表
function zd_xszd($zd_xszd)
{
    $user_id = uid();
    if ($zd_xszd = 0) {
        value::set_user_value('zd_xszd', 0, $user_id);
    }
    if ($zd_xszd = 1) {
        value::set_user_value('zd_xszd', 1, $user_id);
    }
    e82();
}
//角色 查看所获荣誉
function e109($user_id = 0)
{
    echo "[所获称号]";
    br();
    echo "-";
    br();
    if (!$user_id) {
        $user_id = uid();
    }
    $count = 0;
    if (value::get_user_value('nick_name', $user_id, false)) {
        echo "[所获称号]";
        br();
        $sql = "SELECT `value`  FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.nick_name' ORDER BY LENGTH(`value`),`time`";
        $result = sql($sql);
        while (list($nick_name) = $result->fetch_row()) {
            $count++;
            cmd::addcmd('e54,' . $nick_name . ',0,1,1', $nick_name);
            br();
        }
    }
    $huizhang_str = "";
    for ($i = 30; $i < 42; $i++) {
        if (item::get_item($i, $user_id)) {
            $count++;
            $huizhang_str .= value::get_item_value($i, 'name') . "<br>";
        }
    }
    if ($huizhang_str) {
        $huizhang_str = '[所获徽章]<br>' . $huizhang_str;
        echo $huizhang_str;
    }
    if (!$count) {
        echo "人家还是个不知名的玩家。";
        br();
    }
    ch_chsx();
    $ch_sx_gj = value::get_user_value('ch_sx_gj', $user_id);
    $ch_sx_fy = value::get_user_value('ch_sx_fy', $user_id);
    $ch_sx_hp = value::get_user_value('ch_sx_hp', $user_id);
    echo "-";
    br();
    echo "生效称号属性：";
    br();
    echo "攻击：" . $ch_sx_gj;
    br();
    echo "防御：" . $ch_sx_fy;
    br();
    echo "生命：" . $ch_sx_hp;
    br();
    echo "-";
    br();
    cmd::addcmd('e12', '返回上级');
}

//游戏安全事件
function e110()
{
}

//宠物 特殊进化道具
function e111($pet_id, $item_id)
{
    $pet_name = value::get_pet_value($pet_id, 'name');
    $pet_zz_id = value::get_pet_value($pet_id, 'pet_id');
    $pet_max_lvl = value::get_pet_value($pet_id, 'max_lvl');
    $pet_zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
    $item_name = value::get_item_value($item_id, 'name');
    $jh_pet_id = 0;
    $jh_pet_lvl = 30;
    if (!$pet_zhuansheng) {
        if (!pet::is_yesheng($pet_id)) {
            if (item::get_item($item_id)) {
                item::lose_item($item_id, 1);
                $use_success = false;
                switch ($item_id) {
                    //寒冰铁 金
                    case 62:
                        switch ($pet_zz_id) {
                            //步兵先锋 黄盖
                            case 18:
                                $jh_pet_id = 122;
                                break;
                            //水兵先锋 臧霸
                            case 33:
                                $jh_pet_id = 127;
                                break;
                            //少年张辽 乐进
                            case 69:
                                $jh_pet_id = 116;
                                break;
                            default:
                                break;
                        }
                        break;
                    //紫檀木 木
                    case 63:
                        switch ($pet_zz_id) {
                            //步兵先锋 少年周瑜
                            case 18:
                                $jh_pet_id = 121;
                                break;
                            //枪兵先锋 虎卫
                            case 44:
                                $jh_pet_id = 111;
                                break;
                            //藤甲先锋 少年张飞
                            case 51:
                                $jh_pet_id = 126;
                                break;
                            //少年庞德 少年典韦
                            case 57:
                                $jh_pet_id = 132;
                                break;
                            default:
                                break;
                        }
                        break;
                    //琉璃水 水
                    case 64:
                        switch ($pet_zz_id) {
                            //步兵先锋 文聘
                            case 18:
                                $jh_pet_id = 120;
                                break;
                            //少年庞德 张任
                            case 57:
                                $jh_pet_id = 136;
                                break;
                            default:
                                break;
                        }
                        break;
                    //红炎火 火
                    case 65:
                        switch ($pet_zz_id) {
                            //步兵先锋 无当飞军
                            case 18:
                                $jh_pet_id = 106;
                                break;
                            //藤甲先锋 先登死士
                            case 51:
                                $jh_pet_id = 105;
                                break;
                            //少年庞德 丁奉
                            case 57:
                                $jh_pet_id = 118;
                                break;
                            //少年甘宁 夏侯霸
                            case 63:
                                $jh_pet_id = 135;
                                break;
                            default:
                                break;
                        }
                        break;
                    //抛沙尘 土
                    case 66:
                        switch ($pet_zz_id) {
                            //少年高顺 少年黄忠
                            case 15:
                                $jh_pet_id = 123;
                                break;
                            //步兵先锋 少年许褚
                            case 18:
                                $jh_pet_id = 119;
                                break;
                            //藤甲先锋 少年马超
                            case 51:
                                $jh_pet_id = 128;
                                break;
                            //少年夏侯惇 少年关羽
                            case 89:
                                $jh_pet_id = 133;
                                break;
                            default:
                                break;
                        }
                        break;
                    //风之石 风
                    case 67:
                        switch ($pet_zz_id) {
                            default:
                                break;
                        }
                        break;
                    //雷之石 雷
                    case 68:
                        switch ($pet_zz_id) {
                            //少年张松 西凉铁骑
                            case 92:
                                $jh_pet_id = 103;
                                break;
                            default:
                                break;
                        }
                        break;
                    //日之石 日
                    case 69:
                        switch ($pet_zz_id) {
                            //少年高顺 阎圃
                            case 15:
                                $jh_pet_id = 124;
                                break;
                            //骑兵先锋 郭淮
                            case 21:
                                $jh_pet_id = 117;
                                break;
                            //藤甲先锋 阚泽
                            case 51:
                                $jh_pet_id = 129;
                                break;
                            //少年夏侯惇 刘巴
                            case 89:
                                $jh_pet_id = 134;
                                break;
                            default:
                                break;
                        }
                        break;
                    //月之石 月
                    case 70:
                        switch ($pet_zz_id) {
                            //藤甲先锋 郭图
                            case 51:
                                $jh_pet_id = 130;
                                break;
                            //少年马良 逢纪
                            case 60:
                                $jh_pet_id = 125;
                                break;
                            default:
                                break;
                        }
                        break;
                    //人之书 人
                    case 71:
                        switch ($pet_zz_id) {
                            default:
                                break;
                        }
                        break;
                    //仙之书 仙
                    case 72:
                        switch ($pet_zz_id) {
                            default:
                                break;
                        }
                        break;
                    //妖之书 妖
                    case 73:
                        switch ($pet_zz_id) {
                            //藤甲先锋 文丑
                            case 51:
                                $jh_pet_id = 102;
                                break;
                            //少年太史慈 颜良
                            case 54:
                                $jh_pet_id = 101;
                                break;
                            default:
                                break;
                        }
                        break;
                    //神动草 动
                    case 74:
                        switch ($pet_zz_id) {
                            //蔡琰 陷阵步兵
                            case 26:
                                $jh_pet_id = 100;
                                break;
                            //虎豹骑斥候 虎豹骑先锋
                            case 73:
                                $jh_pet_id = 99;
                                break;
                            default:
                                break;
                        }
                        break;
                }
                if ($jh_pet_id && value::get_pet_value($pet_id, 'lvl') == $jh_pet_lvl) {
                    $use_success = true;
                }
                if ($use_success) {
                    e79($pet_id, $jh_pet_id, true, true);
                    return;
                } else {
                    echo "你的{$pet_name}服下了{$item_name},没有发生任何变化!";
                    br();
                }
            } else {
                echo "你身上没有此物品了。";
                br();
            }
        } else {
            echo "你的野生{$pet_name}无法服用{$item_name}。";
            br();
        }
    } else {
        echo "你的{$pet_name}已经转生,无法服用{$item_name}。";
        br();
    }
}

//物品 龙蜒草使用事件
function e112($pet_id, $item_id)
{
    if (item::lose_item($item_id, 1)) {
        $name = value::get_pet_value($pet_id, 'name');
        $zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $pet_id, false)) {
            $max_pp = value::getvalue('skill', 'pp', 'id', $skill_id);
            $max_pp *= $zhuansheng ? 1.5 : 1;
            $max_pp = (int)$max_pp;
            value::set_pet_value2('skill.' . $skill_id . '.pp', $max_pp, $pet_id);
            $i++;
        }
        echo "{$name}的技能PP恢复了。";
        br();
    } else {
        echo "你身上没有此物品了。";
        br();
    }
}

//宠物相关 合成袋
function e113($step = 0, $pet1_id = 0, $pet2_id = 0, $new_pet_id = 0, $baoshi_id = 0)
{
    $user_id = uid();
    if (!$step) {
        cmd::addcmd("e113,1", "开始合成");
        br();
        cmd::addcmd("e113,-1", "合成帮助");
    } else if ($step == 1) {
        echo "请选择宠物妈妈:";
        $pet_count = 0;
        $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`=$user_id AND `master_mode`=1 AND `sex`='雌' LIMIT 5";
        $rs = sql($sql);
        while (list($pet1_id) = $rs->fetch_row()) {
            br();
            $pet_count++;
            $pet_nick_name = value::getvalue('game_pet', 'nick_name', 'id', $pet1_id);
            $pet_name = value::getvalue('game_pet', 'name', 'id', $pet1_id);
            $pet_lvl = value::getvalue('game_pet', 'lvl', 'id', $pet1_id);
            $pet_is_dead = value::getvalue('game_pet', 'is_dead', 'id', $pet1_id);
            cmd::addcmd("e113,2,$pet1_id", ($pet_nick_name ? "({$pet_nick_name})" : "") . $pet_name . '(' . $pet_lvl . '级)');
            echo $pet_is_dead ? "(已死亡)" : "";
        }
        if (!$pet_count) {
            echo "<br>没有找到宠物妈妈,无法合成。";
        }
    } else if ($step == 2) {
        //错误语句
        $error = "";
        //判断宠物妈妈是否符合条件
        $pet1_ok = true;
        if (pet::is_yesheng($pet1_id)) {
            $pet1_ok = false;
            $error = "宠物妈妈还是野生宠物,无法合成。";
        } else if (pet::get($pet1_id, 'is_dead')) {
            $pet1_ok = false;
            $error = "宠物妈妈已经死亡,无法合成。";
        } else if (pet::get($pet1_id, 'hechongcishu') < 1) {
            $pet1_ok = false;
            $error = "宠物妈妈没有合成次数,无法合成。";
        } else if (pet::get($pet1_id, 'lvl') < pet::get_zz($pet1_id, 'star') * 20) {
            $pet1_ok = false;
            $error = "宠物妈妈等级不够,无法合成。";
        }
        if ($pet1_ok) {
            echo "请选择宠物爸爸:";
            $pet_count = 0;
            $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`=$user_id AND `master_mode`=1 AND `sex`='雄' LIMIT 5";
            $rs = sql($sql);
            while (list($pet2_id) = $rs->fetch_row()) {
                br();
                $pet_count++;
                $pet_nick_name = value::getvalue('game_pet', 'nick_name', 'id', $pet2_id);
                $pet_name = value::getvalue('game_pet', 'name', 'id', $pet2_id);
                $pet_lvl = value::getvalue('game_pet', 'lvl', 'id', $pet2_id);
                $pet_is_dead = value::getvalue('game_pet', 'is_dead', 'id', $pet2_id);
                cmd::addcmd("e113,3,$pet1_id,$pet2_id", ($pet_nick_name ? "({$pet_nick_name})" : "") . $pet_name . '(' . $pet_lvl . '级)');
                echo $pet_is_dead ? "(已死亡)" : "";
            }
            if (!$pet_count) {
                echo "<br>没有找到宠物爸爸,野生宠物无法合成。";
            }
        } else {
            echo $error;
        }
    } else if ($step == 3) {
        //错误语句
        $error = "";
        //判断宠物爸爸是否符合条件
        $pet1_zz_id = pet::get($pet1_id, 'pet_id');
        $pet2_zz_id = pet::get($pet2_id, 'pet_id');
        //是否合成新将ID
        if ($pet1_zz_id == $pet2_zz_id) {
            $new_pet_id = $pet1_zz_id;
        } else {
            $new_pet_id = pet::get_hechengchongwu($pet1_zz_id, $pet2_zz_id);
        }
        $pet2_ok = true;
        if (pet::is_yesheng($pet2_id)) {
            $pet2_ok = false;
            $error = "宠物爸爸还是野生宠物,无法合成。";
        } else if (pet::get($pet2_id, 'is_dead')) {
            $pet2_ok = false;
            $error = "宠物爸爸已经死亡,无法合成。";
        } else if (pet::get($pet2_id, 'lvl') < pet::get_zz($pet2_id, 'star') * 20) {
            $pet2_ok = false;
            $error = "宠物爸爸等级不够,无法合成。";
        } else if ($pet1_zz_id != $pet2_zz_id && !$new_pet_id) {
            $pet2_ok = false;
            $pet1_name = pet::get($pet1_id, 'name');
            $pet2_name = pet::get($pet2_id, 'name');
            $error = "{$pet1_name}与{$pet2_name}无法合成。";
        }
        if ($pet2_ok) {
            echo "请选择合成宝石提高几率:";
            br();
            $baoshi_arr = array(22, 23, 24, 25);
            foreach ($baoshi_arr as $baoshi_id) {
                $baoshi_name = value::get_item_value($baoshi_id, 'name');
                $baoshi_count = item::get_item($baoshi_id, $user_id);
                if ($baoshi_count) {
                    cmd::addcmd("e113,4,$pet1_id,$pet2_id,$new_pet_id,$baoshi_id", $baoshi_name . "x" . $baoshi_count . "颗");
                    br();
                }
            }
            cmd::addcmd("e113,4,$pet1_id,$pet2_id,$new_pet_id,0", "不使用宝石");
        } else {
            echo $error;
        }
    } else if ($step == 4) {
        //合成新将ID
        $pet1_zz_id = pet::get($pet1_id, 'pet_id');
        $pet2_zz_id = pet::get($pet2_id, 'pet_id');
        if ($pet1_zz_id == $pet2_zz_id) {
            $new_pet_id = $pet1_zz_id;
        } else {
            $new_pet_id = pet::get_hechengchongwu($pet1_zz_id, $pet2_zz_id);
        }
        //输出成功率语句与确认语句
        $desc = "";
        //默认合成率
        $defult_chenggonglv = 60;
        $defult_chenggonglv = $defult_chenggonglv - value::getvalue('pet', 'exp', 'id', $new_pet_id) + 40;
        $defult_chenggonglv = $defult_chenggonglv > 60 ? 60 : $defult_chenggonglv;
        $defult_chenggonglv = $defult_chenggonglv < 30 ? 30 : $defult_chenggonglv;
        $baoshi_chenggonglv_arr = array(22 => 5, 23 => 10, 24 => 15, 25 => 20);
        if ($baoshi_id) {
            $baoshi_name = value::get_item_value($baoshi_id, 'name');
            $desc = "使用{$baoshi_name}的";
            $chenggonglv = $defult_chenggonglv + $baoshi_chenggonglv_arr[$baoshi_id];
        } else {
            $chenggonglv = $defult_chenggonglv;
        }
        $pet1_name = pet::get($pet1_id, 'name');
        $pet2_name = pet::get($pet2_id, 'name');
        echo "{$pet1_name}与{$pet2_name}{$desc}合成几率为{$chenggonglv}%,你确定要合成吗?";
        br();
        cmd::addcmd("e113,5,$pet1_id,$pet2_id,$new_pet_id,$baoshi_id", "确定合成");
    } else if ($step == 5) {
        //开始合成
        //判断宝石是否存在
        if (item::get_item($baoshi_id, $user_id) || !$baoshi_id) {
            $defult_chenggonglv = 60;
            $defult_chenggonglv = $defult_chenggonglv - value::getvalue('pet', 'exp', 'id', $new_pet_id) + 40;
            $defult_chenggonglv = $defult_chenggonglv > 60 ? 60 : $defult_chenggonglv;
            $defult_chenggonglv = $defult_chenggonglv < 30 ? 30 : $defult_chenggonglv;
            $baoshi_chenggonglv_arr = array(22 => 5, 23 => 10, 24 => 15, 25 => 20);
            $pet1_name = pet::get($pet1_id, 'name');
            $pet2_name = pet::get($pet2_id, 'name');
            if ($baoshi_id) {
                item::lose_item($baoshi_id, 1, true, $user_id);
                $chenggonglv = $defult_chenggonglv + $baoshi_chenggonglv_arr[$baoshi_id];
            } else {
                $chenggonglv = $defult_chenggonglv;
            }
            value::add_pet_value($pet1_id, 'hechongcishu', -1, false, 1);
            //echo "成功率:$chenggonglv%";br();
            if (mt_rand(1, 100) < $chenggonglv) {
                //新宠物初经
                $new_pet_chujing = value::getvalue('pet', 'exp', 'id', $new_pet_id);
                //获取种族ID 初经 星级
                $pet1_zz_id = pet::get_zz($pet1_id, 'id');
                $pet1_zz_star = pet::get_zz($pet1_id, 'star');
                $pet1_zz_exp = pet::get_zz($pet1_id, 'exp');
                $pet1_zz_bili = $pet1_zz_exp * $pet1_zz_star * (pet::get_zz($pet1_id, 'is_shengshou') ? 5 : 1) * (pet::get_zz($pet1_id, 'is_xiongshou') ? 5 : 1);
                $pet2_zz_id = pet::get_zz($pet2_id, 'id');
                $pet2_zz_star = pet::get_zz($pet2_id, 'star');
                $pet2_zz_exp = pet::get_zz($pet2_id, 'exp');
                $pet2_zz_bili = $pet2_zz_exp * $pet2_zz_star * (pet::get_zz($pet2_id, 'is_shengshou') ? 5 : 1) * (pet::get_zz($pet2_id, 'is_xiongshou') ? 5 : 1);
                //获取宠物父母性格 天赋 转生
                $pet1_xingge = pet::get($pet1_id, 'xingge');
                $pet1_texing = pet::get($pet1_id, 'texing');
                $pet1_zhuansheng = pet::get($pet1_id, 'zhuansheng');
                $pet2_xingge = pet::get($pet2_id, 'xingge');
                $pet2_texing = pet::get($pet2_id, 'texing');
                $pet2_zhuansheng = pet::get($pet2_id, 'zhuansheng');
                //随机父母性格
                //$xingge_jilv = $pet1_zz_bili * 5 + $pet2_zz_bili * 5;
                //echo "性格:".($pet1_zz_bili*5)."/{$xingge_jilv}";br();
                //$new_pet_xingge = mt_rand(1, $xingge_jilv) < $pet1_zz_bili * 5 ? $pet1_xingge : $pet2_xingge;
                $new_pet_xingge = mt_rand(1, 2) == 1 ? $pet1_xingge : $pet2_xingge;
                //随机父母天赋
                $texing_jilv = $pet1_zz_bili * 8 + $pet2_zz_bili * 2;
                //echo "天赋:".($pet1_zz_bili*8)."/{$texing_jilv}";br();
                $pet1_texing_ok = pet::zz_have_texing($new_pet_id, $pet1_texing);
                $pet2_texing_ok = pet::zz_have_texing($new_pet_id, $pet2_texing);
                if ($pet1_texing_ok && $pet2_texing_ok) {
                    $new_pet_texing = mt_rand(1, $texing_jilv) < $pet1_zz_bili * 8 ? $pet1_texing : $pet2_texing;
                } else if ($pet1_texing_ok) {
                    $new_pet_texing = $pet1_texing;
                } else if ($pet2_texing_ok) {
                    $new_pet_texing = $pet2_texing;
                } else {
                    $new_pet_texing = mt_rand(1, $texing_jilv) < $pet1_zz_bili * 8 ? $pet1_texing : $pet2_texing;
                }
                //转生次数 相同宠物初经提升
                $pet1_zhuansheng += $pet2_zhuansheng + 1;
                if ($pet1_zz_id == $pet2_zz_id) {
                    $new_pet_chujing *= (1 + $pet1_zhuansheng * 0.02);
                }
                //生蛋
                $new_egg_id = prop::new_pet_egg($new_pet_id, $new_pet_xingge, $new_pet_texing, "雄", $new_pet_chujing, $pet2_name, $pet1_name);
                $new_egg_name = value::get_game_prop_value($new_egg_id, 'name');
                $new_egg_pet_id = value::get_game_prop_value($new_egg_id, 'pet_id');
                //输出提示
                echo "{$pet2_name}与{$pet1_name}之间发出了强烈的光芒,你获得了一颗{$new_egg_name}!";
                prop::user_get_prop($new_egg_id, $user_id, 1, false, true);
                //转生奖励
                list($pet1_hp, $pet1_pg, $pet1_pf, $pet1_tg, $pet1_tf, $pet1_mj) = pet::mget($pet1_id, array("max_hp", "pugong", "pufang", "tegong", "tefang", "minjie"));
                list($pet2_hp, $pet2_pg, $pet2_pf, $pet2_tg, $pet2_tf, $pet2_mj) = pet::mget($pet2_id, array("max_hp", "pugong", "pufang", "tegong", "tefang", "minjie"));
                //父母六维
                $pet1_hp += $pet2_hp;
                $pet1_hp *= 1.5;
                $pet1_pg += $pet2_pg;
                $pet1_pf += $pet2_pf;
                $pet1_tg += $pet2_tg;
                $pet1_tf += $pet2_tf;
                $pet1_mj += $pet2_mj;
                $pet1_mj /= 1.5;
                //奖励六维
                $pet1_hp *= $pet1_zhuansheng * 0.0025;
                $pet1_pg *= $pet1_zhuansheng * 0.0025;
                $pet1_pf *= $pet1_zhuansheng * 0.0025;
                $pet1_tg *= $pet1_zhuansheng * 0.0025;
                $pet1_tf *= $pet1_zhuansheng * 0.0025;
                $pet1_mj *= $pet1_zhuansheng * 0.0025;
                $max_yy_jiacheng = value::get_system_value("is_qiangyaotai_open") ? 50 : 30;
                value::set_pet_value2('yuyao.jiacheng.hp', $pet1_hp < $max_yy_jiacheng ? $pet1_hp : $max_yy_jiacheng, $new_egg_pet_id);
                value::set_pet_value2('yuyao.jiacheng.pugong', $pet1_pg < $max_yy_jiacheng ? $pet1_pg : $max_yy_jiacheng, $new_egg_pet_id);
                value::set_pet_value2('yuyao.jiacheng.pufang', $pet1_pf < $max_yy_jiacheng ? $pet1_pf : $max_yy_jiacheng, $new_egg_pet_id);
                value::set_pet_value2('yuyao.jiacheng.tegong', $pet1_tg < $max_yy_jiacheng ? $pet1_tg : $max_yy_jiacheng, $new_egg_pet_id);
                value::set_pet_value2('yuyao.jiacheng.tefang', $pet1_tf < $max_yy_jiacheng ? $pet1_tf : $max_yy_jiacheng, $new_egg_pet_id);
                value::set_pet_value2('yuyao.jiacheng.minjie', $pet1_mj < $max_yy_jiacheng ? $pet1_mj : $max_yy_jiacheng, $new_egg_pet_id);

            } else {
                echo "{$pet1_name}与{$pet2_name}之间光芒黯淡了,合成失败!";
            }
        } else {
            echo "宝石不够,无法合成。";
        }
    } else if ($step == -1) {
        echo "个只宠物可以通过合成生下宠物卡,野生宠物或死亡状态的宠物无法参与合成,通过合成公式可以合成强力的合成宠物,为了成为强大的玩家去探索吧。";
    }
    br();
    if (!$step) {
        cmd::addcmd('e76', '返回上级');
    } else {
        cmd::addcmd('e113', '返回上级');
    }
}

//宠物相关 孵化巢
function e114()
{
    $user_id = uid();
    $sql = "SELECT `id` FROM `game_prop` WHERE `user_id`=$user_id AND `user_num`=4 LIMIT 1";
    $result = sql($sql);
    list($have_egg_id) = $result->fetch_row();
    if ($have_egg_id) {
        //提示
        echo "正在孵化中...";
        br();
        //刷新孵化度
        $now_time = time();
        $pet_id = value::get_game_prop_value($have_egg_id, 'pet_id');
        $last_fuhua_time = value::get_pet_value2('last.fuhua.time', $pet_id);
        if ($last_fuhua_time) {
            value::add_pet_value($pet_id, 'fuhuadu', $now_time - $last_fuhua_time, false, 1);
        }
        value::set_pet_value2('last.fuhua.time', $now_time, $pet_id);
        prop::show_prop($have_egg_id, 9);
    } else {
        echo "你的孵化巢里没有宠物卡。";
        br();
    }
    cmd::addcmd('e76', '返回上级');
}

//宠物相关 育将袋
function e115()
{
    $user_id = uid();
    $yuyaofuzhong = user::get_fuzhong(4);
    $yuyaorongliang = user::get_rongliang(4);
    $sql = "SELECT `id`,`name` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=5 ORDER BY `id` ASC";
    $result = sql($sql);
    echo "宠物容量:{$yuyaofuzhong}/{$yuyaorongliang}";
    br();
    while (list($oid, $oname) = $result->fetch_row()) {
        //刷新成长度
        pet::refresh_chengzhangdu($oid);
        //获取成长度
        $ochengzhangdu = pet::get_chengzhangdu($oid);
        cmd:: addcmd('e153,' . $oid, $oname);
        echo "(成长度:{$ochengzhangdu}%) ";
        if ($ochengzhangdu > 99) {
            cmd::addcmd('e155,' . $oid, '取出');
        }
        br();
    }
    if (!$yuyaofuzhong) {
        echo '你的育将袋里没有宠物。';
        br();
    }
    cmd::addcmd('e76', '返回上级');
}

//角色 结婚祝福
function e116($chat_id)
{
    $sql = "SELECT `uid` FROM `game_chat` WHERE `id` ={$chat_id} LIMIT 1";
    $result = sql($sql);
    list($oid) = $result->fetch_row();
    if ($oid) {
        $bl_id = value::get_user_value('bl.id', $oid);
        if ($bl_id) {
            $uname = value::get_game_user_value('name');
            c_add_xiaoxi("恭喜你收到{$uname}的新婚祝福!", 0, 0, $oid);
            c_add_xiaoxi("恭喜你收到{$uname}的新婚祝福!", 0, 0, $bl_id);
            echo value::get_game_user_value('name', $oid) . '与' . value::get_game_user_value('name', $bl_id) . '已经收到你的结婚祝福!';
        } else {
            echo "谢谢你送上的新婚祝福!";
        }
    } else {
        echo "谢谢你送上的新婚祝福!";
    }
}

//角色 赠送宠物事件
function e117($step = 0, $pet_id = 0)
{
    $uid = uid();
    $uname = value::get_game_user_value('name');
    if (!$step) {
        $bl_hour = user::get_bl_hun($uid, 1);
        $pet_count = 0;
        if ($bl_hour > 50) {
            $add_sql = "";
            if ($bl_hour >= 50 && $bl_hour < 100) {
                $add_sql = 'AND `zhuansheng`<1;';
            } else if ($bl_hour >= 100 && $bl_hour < 200) {
                $add_sql = 'AND `zhuansheng`<2;';
            } else if ($bl_hour >= 200 && $bl_hour < 500) {
                $add_sql = 'AND `zhuansheng`<3;';
            }
            $sql = "SELECT `id` FROM `game_pet` WHERE `master_id` ={$uid} AND `master_mode`=1 " . $add_sql;
            $result = sql($sql);
            while (list($pet_id) = $result->fetch_row()) {
                $onick_name = value::get_pet_value($pet_id, 'nick_name');
                $name = value::get_pet_value($pet_id, 'name');
                $lvl = value::get_pet_value($pet_id, 'lvl');
                cmd::addcmd('e117,1,' . $pet_id, ($onick_name ? "({$onick_name})" : "") . $name . "(" . $lvl . "级)");
                br();
                $pet_count++;
            }
            if (!$pet_count) {
                echo '三生石前,彼岸花开。<br>木婚/陶婚/银婚/金婚分别可以赠送普通/一转/二转/三转宠物给您的伴侣哦!';
                br();
            }
        } else {
            echo "三生石前,彼岸花开。<br>木婚/陶婚/银婚/金婚分别可以赠送普通/一转/二转/三转宠物给您的伴侣哦!";
            br();
        }
    } else if ($step == 1) {
        $name = value::get_pet_value($pet_id, 'name');
        $lvl = value::get_pet_value($pet_id, 'lvl');
        $oid = value::get_user_value('bl.id');
        $oname = value::get_game_user_value('name', $oid);
        echo "你确定赠送这只{$lvl}级的{$name}给{$oname}吗?";
        br();
        cmd::addcmd('e117,2,' . $pet_id, '确定赠送');
        br();
        cmd::addcmd('e117', '返回上级');
        return;
    } else if ($step == 2) {
        $name = value::get_pet_value($pet_id, 'name');
        $lvl = value::get_pet_value($pet_id, 'lvl');
        $oid = value::get_user_value('bl.id');
        $oname = value::get_game_user_value('name', $oid);
        $bl_id = value::get_user_value('bl.id', $oid);
        $bl_mode = value::get_user_value('bl.mode', $oid);
        $is_online = value::get_game_user_value('is_online', $oid);
        $is_pk = value::get_game_user_value('is_pk', $oid);
        if ($is_online) {
            if (!$is_pk) {
                if ($uid == $bl_id && value::get_game_user_value('in_map_id') == value::get_game_user_value('in_map_id', $oid) && $bl_mode == 2) {
                    if (pet::user_lose_pet($uid, $pet_id, 1)) {
                        prop::pet_lose_all_prop($pet_id);
                        if (pet::user_get_pet($oid, $pet_id, 1, false)) {
                            c_add_xiaoxi($uname . "赠送了1只{$lvl}级的" . $name . "给你。", 0, $uid, $oid);
                        } else {
                            pet::user_get_pet($oid, $pet_id, 2);
                            c_add_xiaoxi($uname . "赠送给你的1只{$lvl}级的" . $name . '存入了仓库。', 0, $uid, $oid);
                        }
                        echo "你成功的赠送了1只{$lvl}级的{$name}给{$oname}。";
                        br();
                    }
                } else {
                    echo '你们必须在相同地点才能赠送。';
                    br();
                }
            } else {
                echo "对方战斗中,无法赠送宠物。";
                br();
            }
        } else {
            echo "对方已离线,无法赠送宠物。";
            br();
        }
    }
    cmd::addcmd('e12', '返回上级');
}

//角色 拜师事件
function e118($oid)
{
    $can_baishi = true;
    //获取自身状态
    //师傅ID 是否出师
    $u_shifu_id = value::get_game_user_value('shifu.id');
    $u_is_chushi = value::get_game_user_value('is_chushi');
    if ($u_shifu_id) {
        echo "你已经有一位名师了,无法拜师!";
        $can_baishi = false;
    }
    if ($u_is_chushi && $can_baishi) {
        echo "你已经出师了,无需再拜师了!";
        $can_baishi = false;
    }
    //获取对方状态
    //对方是否出师 获取章数
    $o_lvl = value::get_game_user_value('lvl', $oid);
    $uid = uid();
    $u_lvl = value::get_game_user_value('lvl', $uid);
    $o_zhangshu = user::get_zhang_count($oid);
    if ($o_lvl < 31 && $can_baishi) {
        echo "对方还没有30级,无法拜师!";
        $can_baishi = false;
    }
    if ($u_lvl > 30 && $can_baishi) {
        echo "你的等级超过30级了,无法拜师!";
        $can_baishi = false;
    }
    //获取结果
    if ($can_baishi) {
        echo "拜师请求已发出,请静候佳音!";
        c_add_bsqq($oid);
    }
    br();
    cmd::addcmd('e12', '返回上级');
}

//宠物 转生事件
function e119($pet_id, $item_id, $step = 0)
{
    $item_name = value::get_item_value($item_id, 'name');
    //判断宠物归属
    if (!user::have_pet(0, $pet_id)) {
        echo "该宠物已经不属于你了。";
        br();
        return;
    }
    $name = value::get_pet_value($pet_id, 'name');
    //宠物是否死亡
    if (value::get_pet_value($pet_id, 'is_dead')) {
        echo "宠物已死亡,无法喂食{$item_name}。";
        br();
        cmd::addcmd('e62', '返回上级');
        return;
    }
    //转生操作
    $can_zhuansheng = false;
    $zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
    $lvl = value::get_pet_value($pet_id, 'lvl');
    $max_lvl = value::get_pet_value($pet_id, 'max_lvl');
    if (!pet::is_yesheng($pet_id)) {
        if ($lvl > 100) {
            if ($item_id == 97) {
                if (!$zhuansheng) {
                    $can_zhuansheng = true;
                } else {
                    echo "你的{$name}必须未转生才能一转!";
                    br();
                }
            }
            if ($item_id == 98) {
                if ($zhuansheng == 1) {
                    $can_zhuansheng = true;
                } else {
                    echo "你的{$name}必须一转才能二转!";
                    br();
                }
            }
            if ($item_id == 99) {
                if ($zhuansheng == 2) {
                    $can_zhuansheng = true;
                } else {
                    if ($zhuansheng > 2) {
                        echo "你的{$name}无法再转生了!";
                        br();
                    } else {
                        echo "你的{$name}必须二转才能三转!";
                        br();
                    }
                }
            }
        } else {
            echo "宠物等级高于100级才可以转生!";
            br();
        }
    } else {
        echo "野生宠物无法转生!";
        br();
    }
    if ($can_zhuansheng) {
        //开始操作
        if ($step) {
            if (item::lose_item($item_id, 1)) {
                //获取等级 种族ID 性格
                $lvl = value::get_pet_value($pet_id, 'lvl') - 1;
                $zzid = value::get_pet_value($pet_id, 'pet_id');
                $xingge = value::get_pet_value($pet_id, 'xingge');
                //转生奖励六维
                $sql = "SELECT `max_hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`sex` FROM `game_pet` WHERE `id` ={$pet_id} LIMIT 1";
                $result = sql($sql);
                list($jlhp, $jlpg, $jlpf, $jltg, $jltf, $jlmj, $jlsex) = $result->fetch_row();
                $jl_sx = 0;
                $jl_zscs = 0;
                $jl_name = "";
                $jl_sxd = 0;
                $jl_hechongcishu = 0;
                switch ($item_id) {
                    case 97:
                        $jl_zscs = 1;
                        $jl_sx = 0.1;
                        $jl_name = "一转";
                        $jl_sxd = 15;
                        $jl_hechongcishu = 0.25;
                        break;
                    case 98:
                        $jl_zscs = 2;
                        $jl_sx = 0.1;
                        $jl_name = "二转";
                        $jl_sxd = 30;
                        $jl_hechongcishu = 0.25;
                        break;
                    case 99:
                        $jl_zscs = 3;
                        $jl_sx = 0.1;
                        $jl_name = "三转";
                        $jl_sxd = 45;
                        $jl_hechongcishu = 0.5;
                        break;
                }
                $jlhp *= $jl_sx;
                $jlpg *= $jl_sx;
                $jlpf *= $jl_sx;
                $jltg *= $jl_sx;
                $jltf *= $jl_sx;
                $jlmj *= $jl_sx;
                //获取种族六维
                $sql = "SELECT `hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`name`,`hechongcishu` FROM `pet` WHERE `id` ={$zzid} LIMIT 1";
                $result = sql($sql);
                list($zzhp, $zzpg, $zzpf, $zztg, $zztf, $zzmj, $zzname, $zzhechongcishu) = $result->fetch_row();
                $zz_max_hp = $zzhp * $lvl;
                $zz_pugong = $zzpg * $lvl;
                $zz_pufang = $zzpf * $lvl;
                $zz_tegong = $zztg * $lvl;
                $zz_tefang = $zztf * $lvl;
                $zz_minjie = $zzmj * $lvl;
                $zsname = $jl_name . '-' . $zzname . ($jlsex == '雄' ? '' : ' ');
                //修正宠物种族数据
                if ($xingge < 5) {
                    //孤独 固执 纯洁 无畏 +攻击
                    $zz_pugong *= 1.1;
                } else if ($xingge < 9) {
                    //凶猛 潇洒 敏捷 悠闲 +防御
                    $zz_pufang *= 1.1;
                } else if ($xingge < 13) {
                    //保守 坚强 马虎 冷静 +魔攻
                    $zz_tegong *= 1.1;
                } else if ($xingge < 17) {
                    //深沉 平庸 精明 狂妄 +魔防
                    $zz_tefang *= 1.1;
                } else if ($xingge < 21) {
                    //迟缓 急躁 稳健 天真 +灵活
                    $zz_minjie *= 1.1;
                }
                if ($xingge == 5 || $xingge == 9 || $xingge == 13 || $xingge == 17) {
                    //凶猛 保守 深沉 迟缓 -攻击
                    $zz_pugong *= 0.9;
                }
                if ($xingge == 1 || $xingge == 10 || $xingge == 14 || $xingge == 18) {
                    //孤独 坚强 平庸 急躁 -防御
                    $zz_pufang *= 0.9;
                }
                if ($xingge == 2 || $xingge == 6 || $xingge == 15 || $xingge == 19) {
                    //固执 潇洒 精明 稳健 -魔攻
                    $zz_tegong *= 0.9;
                }
                if ($xingge == 3 || $xingge == 7 || $xingge == 11 || $xingge == 20) {
                    //纯洁 敏捷 马虎 天真 -魔防
                    $zz_tefang *= 0.9;
                }
                if ($xingge == 4 || $xingge == 8 || $xingge == 12 || $xingge == 16) {
                    //无畏 悠闲 冷静 狂妄 -灵活
                    $zz_minjie *= 0.9;
                }
                //获取属性加点
                $sxd_max_hp = value::get_pet_value2('sxd.max_hp', $pet_id, false) * 3;
                $sxd_pugong = value::get_pet_value2('sxd.pugong', $pet_id, false);
                $sxd_pufang = value::get_pet_value2('sxd.pufang', $pet_id, false);
                $sxd_tegong = value::get_pet_value2('sxd.tegong', $pet_id, false);
                $sxd_tefang = value::get_pet_value2('sxd.tefang', $pet_id, false);
                $sxd_minjie = value::get_pet_value2('sxd.minjie', $pet_id, false) * 0.5;
                //设置宠物属性
                //等级 最大等级 经验 最大经验 属性点 名字 合成次数
                value::set_pet_value($pet_id, 'zhuansheng', $jl_zscs);
                value::set_pet_value($pet_id, 'lvl', '1');
                if (value::get_pet_value($pet_id, 'max_lvl') < 120 || (value::get_pet_value($pet_id, 'max_lvl') > 120 && value::get_pet_value($pet_id, 'zhuansheng') < 3)) {
                    value::set_pet_value($pet_id, 'max_lvl', '120');
                }
                value::set_pet_value($pet_id, 'exp', '0');
                $chujing = value::get_pet_value($pet_id, 'chujing') * 1.3;
                $chujing = (int)$chujing;
                value::set_pet_value($pet_id, 'chujing', $chujing);
                value::set_pet_value($pet_id, 'max_exp', $chujing);
                value::set_pet_value($pet_id, 'shuxingdian', $jl_sxd);
                value::set_pet_value($pet_id, 'name', $zsname);
                if (value::get_pet_value($pet_id, 'sex') == '雌') {
                    value::add_pet_value($pet_id, 'hechongcishu', (int)($zzhechongcishu * $jl_hechongcishu), 0, 1);
                }
                //初始宠物六维
                $max_hp = value::add_pet_value($pet_id, 'max_hp', -1 * ($zz_max_hp + $sxd_max_hp) + $jlhp, 0, 1);
                if ($max_hp < 0) {
                    $max_hp = 1;
                }
                value::set_pet_value($pet_id, 'max_hp', $max_hp);
                value::set_pet_value($pet_id, 'hp', $max_hp);
                if (value::add_pet_value($pet_id, 'pugong', -1 * ($zz_pugong + $sxd_pugong) + $jlpg, 0, 1) < 0) {
                    value::set_pet_value($pet_id, 'pugong', 1);
                }
                if (value::add_pet_value($pet_id, 'pufang', -1 * ($zz_pufang + $sxd_pufang) + $jlpf, 0, 1) < 0) {
                    value::set_pet_value($pet_id, 'pufang', 1);
                }
                if (value::add_pet_value($pet_id, 'tegong', -1 * ($zz_tegong + $sxd_tegong) + $jltg, 0, 1) < 0) {
                    value::set_pet_value($pet_id, 'tegong', 1);
                }
                if (value::add_pet_value($pet_id, 'tefang', -1 * ($zz_tefang + $sxd_tefang) + $jltf, 0, 1) < 0) {
                    value::set_pet_value($pet_id, 'tefang', 1);
                }
                if (value::add_pet_value($pet_id, 'minjie', -1 * ($zz_minjie + $sxd_minjie) + $jlmj, 0, 1) < 0) {
                    value::set_pet_value($pet_id, 'minjie', 1);
                }
                //删除属性加点记录
                $obj = new game_pet_object($pet_id);
                $obj->adel("sxd.*");
                //删除宠物技能 学习初始技能
                $obj = new game_pet_object($pet_id);
                $obj->adel("*skill*");
                //读取种族技能
                $p_study_skill_str = value::getvalue('pet', 'study_skill', 'id', $zzid);
                $p_study_skill_arr = explode(',', $p_study_skill_str);
                skill::study_skill($pet_id, $p_study_skill_arr[0], 0, false);
                //输出提示
                echo '你的' . $name . '服下了' . $item_name . ',成功转生为' . $zsname . '。';
                br();
                c_add_guangbo(value::get_game_user_value('name') . "的{$name}服下{$item_name}成功转生为{$zsname}!");
                cmd::addcmd('e62,' . $pet_id, '返回上级');
            }
        } else {
            echo "服下{$item_name}后你的" . $name . "将转生并降为1级,确定要使用{$item_name}吗?";
            br();
            cmd::addcmd('e119,' . $pet_id . ',' . $item_id . ',1', '确定使用');
            br();
        }
    }
}

//角色 查看拜师详情
function e120($chat_id)
{
    $sql = "SELECT `uid` FROM `game_chat` WHERE `id` ={$chat_id} LIMIT 1";
    $result = sql($sql);
    list($oid) = $result->fetch_row();
    if ($oid) {
        e12($oid);
        return;
    } else {
        echo "拜师请求已经过期!";
    }
}

//系统 宠物六维
function e121($step = 0)
{
    if (!$step) {
        $cmd = cmd::addcmd('e121,1', '查询经验', false);
        echo <<<form
<form action="game.php?cmd={$cmd}" method="post">
请输入宠物初经与等级:
<br>
初经:
<br>
<input type="text" name="exp">
<br>
等级:
<br>
<input type="text" name="lvl">
<br>
<input type="submit" value="查询经验">
</form>
form;
        cmd::set_return_game_br(false);
    } else {
        $chujing = value::real_escape_string($_POST['exp']);
        $lvl = value::real_escape_string($_POST['lvl']);
        $exp = 0;
        if ($chujing && $lvl) {
            $max_exp = $chujing;
            for ($i = 1; $i < $lvl; $i++) {
                $exp = $max_exp;
                $max_exp = $max_exp + $chujing * $i * $i / 4;
                echo "等级:" . $i . "<br>" . (int)$exp . "/" . (int)$max_exp . "";
                br();
            }
        }
        echo "六维系统:";
        $sql = "SELECT `name`,`hp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie` FROM `pet` WHERE 1";
        $result = sql($sql);
        while (list($name, $hp, $pugong, $pufang, $tegong, $tefang, $minjie) = $result->fetch_row()) {
            if ($hp) {
                echo "<br><span style='color:#ff0000;'>" . $name . "</span>";
                br();
                echo "六维总和:" . sprintf("%.2f", (($hp / 2 + $pugong + $pufang + $tegong + $tefang) * $minjie)) . "";
                br();
                echo "HP:" . $hp . "";
                br();
                echo "普通:" . (int)($hp * 120) . " ";
                echo "一转:" . (int)($hp * 120 * 1.1) . " ";
                echo "二转:" . (int)($hp * 120 * 1.1 * 0.2 + $hp * 120) . " ";
                echo "三转:" . (int)(($hp * 120 * 1.1 * 0.2 + $hp * 120) * 0.3 + $hp * 120) . "";
                br();
                echo "属性点:(+90) 忠诚度(+60)";
                br();
                echo "攻击:" . $pugong . "";
                br();
                echo "普通:" . (int)($pugong * 120) . " ";
                echo "一转:" . (int)($pugong * 120 * 1.1) . " ";
                echo "二转:" . (int)($pugong * 120 * 1.1 * 0.2 + $pugong * 120) . " ";
                echo "三转:" . (int)(($pugong * 120 * 1.1 * 0.2 + $pugong * 120) * 0.3 + $pugong * 120) . "";
                br();
                echo "属性点:(+30) 忠诚度(+60)";
                br();
                echo "防御:" . $pufang . "";
                br();
                echo "普通:" . (int)($pufang * 120) . " ";
                echo "一转:" . (int)($pufang * 120 * 1.1) . " ";
                echo "二转:" . (int)($pufang * 120 * 1.1 * 0.2 + $pufang * 120) . " ";
                echo "三转:" . (int)(($pufang * 120 * 1.1 * 0.2 + $pufang * 120) * 0.3 + $pufang * 120) . "";
                br();
                echo "属性点:(+30) 忠诚度(+60)";
                br();
                echo "魔攻:" . $tegong . "";
                br();
                echo "普通:" . (int)($tegong * 120) . " ";
                echo "一转:" . (int)($tegong * 120 * 1.1) . " ";
                echo "二转:" . (int)($tegong * 120 * 1.1 * 0.2 + $tegong * 120) . " ";
                echo "三转:" . (int)(($tegong * 120 * 1.1 * 0.2 + $tegong * 120) * 0.3 + $tegong * 120) . "";
                br();
                echo "属性点:(+30) 忠诚度(+60)";
                br();
                echo "魔防:" . $tefang . "";
                br();
                echo "普通:" . (int)($tefang * 120) . " ";
                echo "一转:" . (int)($tefang * 120 * 1.1) . " ";
                echo "二转:" . (int)($tefang * 120 * 1.1 * 0.2 + $tefang * 120) . " ";
                echo "三转:" . (int)(($tefang * 120 * 1.1 * 0.2 + $tefang * 120) * 0.3 + $tefang * 120) . "";
                br();
                echo "属性点:(+30) 忠诚度(+60)";
                br();
                echo "灵活:" . $minjie . "";
                br();
                echo "普通:" . (int)($minjie * 120) . " ";
                echo "一转:" . (int)($minjie * 120 * 1.1) . " ";
                echo "二转:" . (int)($minjie * 120 * 1.1 * 0.2 + $minjie * 120) . " ";
                echo "三转:" . (int)(($minjie * 120 * 1.1 * 0.2 + $minjie * 120) * 0.3 + $minjie * 120) . "";
                br();
                echo "属性点:(+15) 忠诚度(+60)";
            }
        }
    }
}

//宠物黑市 我的宠物
function e122()
{
    $user_id = uid();
    $ocount = 0;
    $now_time = date("Y-m-d H:i:s");
    echo "客官,你的卖品如下:";
    br();
    $sql = "SELECT `id`,`name`,`lvl`,`nick_name`,`heishi_money`,`heishi_currency_type`,`heishi_time` FROM `game_pet` WHERE `master_id` ={$user_id} AND `master_mode`=7 ORDER BY `heishi_currency_type`,`heishi_money` ASC LIMIT 0,5";
    $result = sql($sql);
    while (list($oid, $oname, $olvl, $onick_name, $omoney, $ocurrency_type, $oheishi_time) = $result->fetch_row()) {
        $ocount++;
        cmd::addcmd('e124,' . $oid, ($onick_name ? "({$onick_name})" : "") . $olvl . '级' . $oname . '(' . $omoney . ($ocurrency_type == 1 ? '个金币' : '颗元宝') . ')');
        if ($now_time > $oheishi_time) {
            echo "[已过期]";
        }
        br();
    }
    if (!$ocount) {
        echo "你还没有寄售宠物。";
        br();
    }
    cmd::addcmd('e22', '返回上级');
}

//宠物黑市 寄售宠物
function e123($mode = 0, $pet_id = 0)
{
    $user_id = uid();
    if (!$mode) {
        echo "客官,你想要出售什么宠物呢:";
        br();
        $sql = "SELECT `id` FROM `game_pet` WHERE `master_id` ={$user_id} AND `master_mode`=1 AND `max_lvl`> 1 ORDER BY `lvl` ASC LIMIT 0,5";
        $result = sql($sql);
        while (list($oid) = $result->fetch_row()) {
            $is_dead = value::get_pet_value($oid, 'is_dead');
            $onick_name = value::get_pet_value($oid, 'nick_name');
            $name = value::get_pet_value($oid, 'name');
            $lvl = value::get_pet_value($oid, 'lvl');
            $zhuansheng = value::get_pet_value($oid, 'zhuansheng');
            if ($zhuansheng || $lvl > 4) {
                echo "★";
            }
            cmd::addcmd('e123,1,' . $oid, ($onick_name ? "({$onick_name})" : "") . $name . "(" . $lvl . "级)");
            echo($is_dead ? "(已死亡)" : "");
            br();
        }
        cmd::addcmd('e22', '返回上级');
    } else if ($mode == 1) {
        $is_dead = value::get_pet_value($pet_id, 'is_dead');
        if ($is_dead) {
            echo "宠物已经死亡,无法出售。";
            br();
            cmd::addcmd('e123', '返回上级');
            return;
        }
        $need_lingshi = false;
        $cmd = cmd::addcmd('e123,2,' . $pet_id, '出售', false);
        $zuidilingshi = 0;
        $pet_name = value::get_pet_value($pet_id, 'name');
        $pet_zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
        $pet_lvl = value::get_pet_value($pet_id, 'lvl');
        $xingge = value::get_pet_value($pet_id, 'xingge');
        $texing = value::get_pet_value($pet_id, 'texing');
        $xg_name = pet::get_xingge($xingge);
        $tx_name = pet::get_texing($texing, false);
        if ($pet_zhuansheng || $pet_lvl > 4) {
            $need_lingshi = true;
            $zuidilingshi = ($pet_zhuansheng + 1) * 500;
        }
        if (!$need_lingshi) {
            echo <<<buyform
你想为这只性格为{$xg_name},天赋为{$tx_name}的{$pet_name}标价多少?<br>
<form action="game.php?cmd={$cmd}" method="post" name="buy_form">
    <span>货币:</span>
    <select name="huobi" id="huobi" onchange="huobiChange(this[selectedIndex].value);">>
        <option value="1" selected="selected">金币</option>
        <option value="2">元宝</option>
    </select>
    <br>
    <span>价格:</span>
    <input type="text" name="money" maxlength="8" value="100" id="money">
    <br>
    <span>期限:</span>
    <select name="time">
        <option value="1">6小时 600金币</option>
        <option value="2">12小时 1200金币</option>
        <option value="3">18小时 1800金币</option>
        <option value="4">24小时 2400金币</option>
    </select>
    <br>
    <input type="submit"  value="确定出售" name="出售">
</form>
buyform;
        } else {
            echo <<<buyform
你想为这只性格为{$xg_name},天赋为{$tx_name}的{$pet_name}标价多少?<br>
<form action="game.php?cmd={$cmd}" method="post" name="buy_form">
    <span>货币:</span>
    <select name="huobi">
        <option value="1" selected="selected">金币</option>
        <option value="2">元宝</option>
    </select>
    <br>
    <span>价格:</span>
    <input type="text" name="money" maxlength="5" value="{$zuidilingshi}">
    <br>
    <span>期限:</span>
    <select name="time">
        <option value="1">6小时 600金币</option>
        <option value="2">12小时 1200金币</option>
        <option value="3">18小时 1800金币</option>
        <option value="4">24小时 2400金币</option>
    </select>
    <br>
    <input type="submit"  value="确定出售" name="出售">
</form>
buyform;
        }
        cmd::addcmd('e123', '返回上级');
        echo <<<javascript
<script>
    function huobiChange(sindex) {
        var money=document.getElementById('money');
        if (sindex == 2) {
            money.maxLength=5;
            if (money.value < 500) {
                money.value=500;
            }
        } else {
            money.maxLength=8;
            if (money.value < 100) {
                money.value=100;
            }
        }
    }
</script>
javascript;
    } else if ($mode == 2) {
        $post_ok = true;
        $huobi = (int)value::real_escape_string($_POST['huobi']);
        $money = (int)value::real_escape_string($_POST['money']);
        $time = (int)value::real_escape_string($_POST['time']);
        $heishi_time = 0;
        $zuidilingshi = 0;
        if ($money < 100 || $money > 100000000) {
            echo "价格输入错误,请重新输入!";
            br();
            $post_ok = false;
        }
        if ($time < 1 || $time > 4) {
            echo "期限选择错误,请重新选择!";
            br();
            $post_ok = false;
        } else {
            switch ($time) {
                case 1:
                    $heishi_time = date("Y-m-d H:i:s", strtotime("+6 hours"));
                    $heishi_need_money = 600;
                    break;
                case 2:
                    $heishi_time = date("Y-m-d H:i:s", strtotime("+12 hours"));
                    $heishi_need_money = 1200;
                    break;
                case 3:
                    $heishi_time = date("Y-m-d H:i:s", strtotime("+18 hours"));
                    $heishi_need_money = 1800;
                    break;
                case 4:
                    $heishi_time = date("Y-m-d H:i:s", strtotime("+24 hours"));
                    $heishi_need_money = 2400;
                    break;
            }
        }
        $huobi_miaoshu = "个金币";
        $pet_name = value::get_pet_value($pet_id, 'name');
        $pet_zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
        $pet_lvl = value::get_pet_value($pet_id, 'lvl');
        $xingge = value::get_pet_value($pet_id, 'xingge');
        $texing = value::get_pet_value($pet_id, 'texing');
        $xg_name = pet::get_xingge($xingge);
        $tx_name = pet::get_texing($texing, false);
        //是否转生或者高等级宠物
        if ($pet_zhuansheng || $pet_lvl > 4) {
            $zuidilingshi = ($pet_zhuansheng + 1) * 500;
            if ($huobi == 2) {
                $huobi_miaoshu = "颗元宝";
            } else {
                $huobi_miaoshu = "个金币";
            }
        } else {
            if ($huobi == 2) {
                $zuidilingshi = 500;
                $huobi_miaoshu = "颗元宝";
            } else {
                $zuidilingshi = 500;
                $huobi_miaoshu = "个金币";
            }
        }
        if ($huobi == 2) {
            if ($money < $zuidilingshi) {
                echo "低于最低价格,请重新输入!";
                br();
                $post_ok = false;
            }
            if ($money >= 100000) {
                echo "高于最高价格,请重新输入!";
                br();
                $post_ok = false;
            }
        }
        if ($post_ok) {
            $sql = "SELECT COUNT(*) FROM `game_pet` WHERE `master_id` ={$user_id}  AND `master_mode`=7";
            $result = sql($sql);
            list($heishi_count) = $result->fetch_row();
            $u_money = item::get_money();
            if ($heishi_count < 5) {
                if ($u_money > $heishi_need_money) {
                    if (pet::user_lose_pet($user_id, $pet_id, 7)) {
                        //期限金币
                        if (item::add_money(-1 * $heishi_need_money)) {
                            //卸下道具
                            prop::pet_lose_all_prop($pet_id);
                            //黑市价格 货币类型 下架时间
                            value::set_pet_value($pet_id, 'heishi_money', $money);
                            value::set_pet_value($pet_id, 'heishi_currency_type', $huobi);
                            value::set_pet_value($pet_id, 'heishi_time', $heishi_time);
                            //输出提示
                            echo "你成功把这只性格为{$xg_name},天赋为{$tx_name}的{$pet_name}放入黑市,售价为{$money}{$huobi_miaoshu}。";
                            //返回卖品
                            br();
                            cmd::addcmd('e122', '返回上级');
                            return;
                        }
                    }
                } else {
                    echo '抱歉,你的金币不足。';
                    br();
                }
                cmd::addcmd('e123,1,' . $pet_id, '返回上级');
            } else {
                echo "抱歉,你在黑市中出售的宠物上限已满!";
                br();
                cmd::addcmd('e22', '返回上级');
            }
        } else {
            cmd::addcmd('e123,1,' . $pet_id, '返回上级');
        }
    }
}

//宠物黑市 查看宠物
function e124($pet_id, $show_mode = 0, $yeshu = 0)
{
    $user_id = uid();
    //设置查看黑市宠物id
    value::set_user_value('hs_look_pet_id', $pet_id);
    //获取查看宠物来源模式
    $from_list = value::get_user_value('hs_look_mode');
    //宠物是否在黑市
    $master_mode = value::get_pet_value($pet_id, 'master_mode');
    if ($master_mode == 7) {
        //显示宠物
        pet::show_pet($pet_id, 1);
        //显示技能
        echo "技能:";
        $i = 0;
        while ($skill_id = value::get_pet_value2('skill.' . $i . '.id', $pet_id, false)) {
            if ($i) {
                echo ",", value::getvalue('skill', 'name', 'id', $skill_id);
            } else {
                echo value::getvalue('skill', 'name', 'id', $skill_id);
            }
            $i++;
        }
        br();
        //显示操作
        $o_heishi_guoqi = false;
        $o_heishi_money = value::get_pet_value($pet_id, 'heishi_money');
        $o_heishi_time = value::get_pet_value($pet_id, 'heishi_time');
        $ocurrency_type = value::get_pet_value($pet_id, 'heishi_currency_type');
        $o_shengyu_time = strtotime($o_heishi_time) - time();
        if ($o_shengyu_time > 0) {
            $o_shengyu_hour = (int)($o_shengyu_time / 3600);
            $o_shengyu_min = (int)($o_shengyu_time % 3600 / 60);
        } else {
            $o_heishi_guoqi = true;
        }
        $o_user_id = value::get_pet_value($pet_id, 'master_id');
        $o_user_name = value::get_game_user_value('name', $o_user_id);
        $o_is_online = value::get_game_user_value('is_online', $o_user_id);
        echo "售价:";
        echo "{$o_heishi_money}" . ($ocurrency_type == 1 ? "个金币" : "颗元宝");
        br();
        echo "剩余:";
        if (!$o_heishi_guoqi) {
            echo "{$o_shengyu_hour}小时{$o_shengyu_min}分钟";
        } else {
            echo "已过期";
        }
        br();
        if ($ocurrency_type == 2) {
            $pet_zzid = value::get_pet_value($pet_id, 'pet_id');
            $pet_star = value::getvalue('pet', 'star', 'id', $pet_zzid);
            $pet_lvl = value::get_pet_value($pet_id, 'lvl');
            $pet_zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
            $need_lyms = (int)($pet_star * (120 * $pet_zhuansheng + $pet_lvl) * 0.5);
            echo "要求:";
            echo "{$need_lyms}点练宠名声";
            br();
        }
        echo "卖家:";
        if ($o_is_online) {
            cmd::addcmd('e12,' . $o_user_id . ',9', $o_user_name);
        } else {
            echo $o_user_name;
        }
        br();
        if ($o_user_id == $user_id) {
            if (!$from_list) {
                if (!$o_heishi_guoqi) {
                    cmd::addcmd('e126,' . $pet_id, "黑市广告");
                } else {
                    cmd::addcmd('e127,' . $pet_id, '我要续期');
                }
                br();
                cmd::addcmd('e125,' . $pet_id, '取回宠物');
                br();
            }
        } else {
            if (!$o_heishi_guoqi) {
                cmd::addcmd('e128,' . $pet_id, '购买宠物');
                br();
            }
        }
    } else {
        echo "黑市里已经没有这只宠物了。";
        br();
    }
    //返回操作
    if (!$from_list) {
        cmd::addcmd("e22,{$show_mode},{$yeshu}", '返回上级');
    } else {
        cmd::addcmd('e0', '返回上级');
    }
}

//宠物黑市 取回宠物
function e125($pet_id)
{
    $user_id = uid();
    if (user::have_pet($user_id, $pet_id)) {
        if (pet::user_get_pet($user_id, $pet_id, 1, true)) {
            $pet_name = value::get_pet_value($pet_id, 'name');
            echo '你把' . $pet_name . '带在了身上。';
            br();
        }
    } else {
        echo "黑市里已经没有这只宠物了。";
        br();
    }
    cmd::addcmd('e22', '返回上级');
}

//宠物黑市 黑市广告
function e126($pet_id, $step = 0)
{
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    if (!$step) {
        echo "你确定要花费200金币发送黑市广告吗?";
        br();
        cmd::addcmd('e126,' . $pet_id . ',1', '发送广告');
    } else {
        if (time() > (value::get_user_value('shoutuguanggao.time') + 10)) {
            $pet_name = value::get_pet_value($pet_id, 'name');
            $pet_lvl = value::get_pet_value($pet_id, 'lvl');
            $xingge = value::get_pet_value($pet_id, 'xingge');
            $texing = value::get_pet_value($pet_id, 'texing');
            $xg_name = pet::get_xingge($xingge);
            $tx_name = pet::get_texing($texing, false);
            $heishi_money = value::get_pet_value($pet_id, 'heishi_money');
            $ocurrency_type = value::get_pet_value($pet_id, 'heishi_currency_type');
            $huobi_miaoshu = $ocurrency_type == 1 ? "个金币" : "颗元宝";
            if (item::add_money(-200)) {
                value::set_user_value('shoutuguanggao.time', time(), $user_id);
                echo "你的黑市广告已经发出,请静候佳音!";
                $miaoshu = "{$user_name}想用{$heishi_money}{$huobi_miaoshu}的价格出售1只性格为{$xg_name},天赋为{$tx_name}的{$pet_lvl}级{$pet_name}!";
                c_add_xiaoxi($miaoshu, 5, $user_id, $pet_id, 0, 1);
            }
        } else {
            echo "你的黑市广告太频繁了,请稍后再发!";
        }
    }
    br();
    cmd::addcmd('e124,' . $pet_id, '返回上级');
}

//宠物黑市 我要续期
function e127($pet_id, $step = 0)
{
    $user_id = uid();
    $pet_name = value::get_pet_value($pet_id, 'name');
    if (user::have_pet($user_id, $pet_id)) {
        if (!$step) {
            $cmd = cmd::addcmd('e127,' . $pet_id . ',1', '续期', false);
            echo <<<buyform
你想为这只{$pet_name}续期多久?<br>
<form action="game.php?cmd={$cmd}" method="post" name="buy_form">
    <span>期限:</span>
    <select name="time">
        <option value="1">6小时 600金币</option>
        <option value="2">12小时 1200金币</option>
        <option value="3">18小时 1800金币</option>
        <option value="4">24小时 2400金币</option>
    </select>
    <br>
    <input type="submit"  value="确定续期" name="续期">
</form>
buyform;
        } else {
            $heishi_time = (int)value::real_escape_string($_POST['time']);
            if ($heishi_time > 0 && $heishi_time < 5) {
                switch ($heishi_time) {
                    case 1:
                        $heishi_time = date("Y-m-d H:i:s", strtotime("+6 hours"));
                        $heishi_need_money = 600;
                        $heishi_xuqi_hour = 6;
                        break;
                    case 2:
                        $heishi_time = date("Y-m-d H:i:s", strtotime("+12 hours"));
                        $heishi_need_money = 1200;
                        $heishi_xuqi_hour = 12;
                        break;
                    case 3:
                        $heishi_time = date("Y-m-d H:i:s", strtotime("+18 hours"));
                        $heishi_need_money = 1800;
                        $heishi_xuqi_hour = 18;
                        break;
                    case 4:
                        $heishi_time = date("Y-m-d H:i:s", strtotime("+24 hours"));
                        $heishi_need_money = 2400;
                        $heishi_xuqi_hour = 24;
                        break;
                }
                if (item::add_money(-1 * $heishi_need_money)) {
                    value::set_pet_value($pet_id, 'heishi_time', $heishi_time);
                    echo "你成功把这只{$pet_name}续期{$heishi_xuqi_hour}小时!";
                    br();
                }
            }
        }
    } else {
        $from_list = value::get_user_value('hs_look_mode');
        echo "黑市里已经没有这只宠物了。";
        br();
        if (!$from_list) {
            cmd::addcmd('e22', '返回上级');
        } else {
            cmd::addcmd('e0', '返回上级');
        }
        return;
    }
    cmd::addcmd('e124,' . $pet_id, '返回上级');
}

//宠物黑市 我要购买
function e128($pet_id, $step = 0)
{
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $user_lvl = value::get_game_user_value('lvl') + 5;
    //获取查看宠物来源模式
    $from_list = value::get_user_value('hs_look_mode');
    //宠物是否在黑市
    $master_mode = value::get_pet_value($pet_id, 'master_mode');
    if ($master_mode == 7) {
        $pet_name = value::get_pet_value($pet_id, 'name');
        $pet_lvl = value::get_pet_value($pet_id, 'lvl');
        $xingge = value::get_pet_value($pet_id, 'xingge');
        $texing = value::get_pet_value($pet_id, 'texing');
        $xg_name = pet::get_xingge($xingge);
        $tx_name = pet::get_texing($texing, false);
        $heishi_money = value::get_pet_value($pet_id, 'heishi_money');
        $ocurrency_type = value::get_pet_value($pet_id, 'heishi_currency_type');
        $huobi_miaoshu = $ocurrency_type == 1 ? "个金币" : "颗元宝";
        if (!$step) {
            echo "你确定用{$heishi_money}{$huobi_miaoshu}购买这只性格为{$xg_name},天赋为{$tx_name}的{$pet_lvl}级{$pet_name}吗?";
            br();
            cmd::addcmd("e128,{$pet_id},1", '确定购买');
            br();
        } else {
            $sell_ok = false;
            //杂货铺金币
            $buy_money = value::get_user_value('zahuopu.money');
            //卖家获得金币、元宝
            $sell_money = 0;
            //卖家id
            $old_user_id = value::get_pet_value($pet_id, 'master_id');
            //金币交易模式
            if ($user_lvl >= $pet_lvl) {
                if ($ocurrency_type == 1) {
                    if ($buy_money >= $heishi_money) {
                        $sell_ok = true;
                        value::add_user_value('zahuopu.money', -$heishi_money);
                        $sell_money = (int)($heishi_money * 0.9);
                        value::add_user_value('zahuopu.money', $sell_money, $old_user_id);
                    } else {
                        echo "杂货铺里没有足够的金币了。";
                        br();
                    }
                } else {
                    //元宝交易模式
                    $pet_zzid = value::get_pet_value($pet_id, 'pet_id');
                    $pet_star = value::getvalue('pet', 'star', 'id', $pet_zzid);
                    $pet_zhuansheng = value::get_pet_value($pet_id, 'zhuansheng');
                    $need_lyms = (int)($pet_star * (120 * $pet_zhuansheng + $pet_lvl) * 0.5);
                    if (value::get_user_value('lianyaoms') >= 0) {
                        if (item::get_item(1, $user_id) >= $heishi_money) {
                            $sell_ok = true;
                            item::lose_item(1, $heishi_money);
                            $sell_money = (int)($heishi_money * 0.9);
                            item::add_item(1, $sell_money, false, $old_user_id);
                        } else {
                            echo "你身上没有足够的元宝了。";
                            br();
                        }
                    } else {
                        echo "你的练宠名声无法驯服这只{$pet_name}。";
                        br();
                    }
                }
                if ($sell_ok) {
                    if (pet::user_get_pet($user_id, $pet_id, 1, false)) {
                        echo '你获得了1只' . $pet_name . '。';
                        br();
                    } else {
                        pet::user_get_pet($user_id, $pet_id, 2);
                        echo $pet_name . '存入了仓库。';
                        br();
                    }
                    c_add_xiaoxi("{$user_name}购买了你在黑市里出售的1只{$pet_lvl}级{$pet_name},你获得了{$sell_money}{$huobi_miaoshu}。", 0, $user_id, $old_user_id);
                    if (!$from_list) {
                        cmd::addcmd('e22', '返回上级');
                    } else {
                        cmd::addcmd('e0', '返回上级');
                    }
                    return;
                }
            } else {
                echo "不能购买黑市等级大于玩家5级的宠物！";
                br();
            }
        }
    } else {
        echo "黑市里已经没有这只宠物了。";
        br();
        if (!$from_list) {
            cmd::addcmd('e22', '返回上级');
        } else {
            cmd::addcmd('e0', '返回上级');
        }
        return;
    }
    cmd::addcmd('e124,' . $pet_id, '返回上级');
}

//元宝商城 查看物品
function e129($item_id, $lb)
{
    $user_id = uid();
    $item_lingshi = value::get_item_value($item_id, 'lingshi');
    $hy_lvl = value::get_user_value('hy_lvl');
    if ($hy_lvl > 0) {
        if ($hy_lvl == 1) {
            $shop_sale = 0.9;
        }
        if ($hy_lvl == 2) {
            $shop_sale = 0.8;
        }
        if ($hy_lvl == 3) {
            $shop_sale = 0.7;
        }
    } else {
        $shop_sale = 1;
    }
    $item_lingshi *= $shop_sale;
    $item_lingshi = ceil($item_lingshi);
    $cmd = cmd::addcmd("e130," . $item_id . "," . $lb, '购买', false);
    ck_e41($item_id);
    echo <<<buyform
价格:{$item_lingshi}元宝<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="8" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
    cmd::addcmd('e31,' . $lb, '返回上级');
}

//元宝商城 购买物品
function e130($item_id, $lb)
{
    $buy_ok = true;
    $buy_count = (int)value::real_escape_string($_POST['count']);
    if ($buy_count > 0) {
        $item_lingshi = value::get_item_value($item_id, 'lingshi');
        $shop_sale = gstring::get("shop_sale");
        $hy_lvl = value::get_user_value('hy_lvl');
        if ($hy_lvl > 0) {
            if ($hy_lvl == 1) {
                $shop_sale = 0.9;
            }
            if ($hy_lvl == 2) {
                $shop_sale = 0.8;
            }
            if ($hy_lvl == 3) {
                $shop_sale = 0.7;
            }
        } else {
            $shop_sale = 1;
        }
        $item_lingshi *= $shop_sale;
        $item_lingshi = ceil($item_lingshi);
        $need_lingshi = $item_lingshi * $buy_count;
        if (item::add_lingshi(-1 * $need_lingshi)) {
            //增加消费元宝
            value::add_user_value('used_lingshi', $need_lingshi);
            //获取商城道具
            item::add_item($item_id, $buy_count, true, 0, true);
        } else {
            $buy_ok = false;
        }
    } else {
        $buy_ok = false;
        echo "数量输入错误,请您重新输入。";
        br();
    }
    if ($buy_ok) {
        cmd::addcmd("e31," . $lb, '返回上级');
    } else {
        cmd::addcmd("e129,{$item_id}," . $lb, '返回上级');
    }
}

//聊天 师门频道聊天
function e131()
{
    $chats = value::real_escape_string($_POST['chats']);
    $user_id = uid();
    $now_time = date("Y-m-d H:i:s");
    $area_id = value::get_map_value(value::get_game_user_value('in_map_id'), 'area_id');
    if ($chats) {
        if (mb_strlen($chats, 'UTF8') > 50) {
            echo "你好,内容输入长度过长。";
            br();
            cmd::addcmd('e36,3', '返回上级');
            return;
        }
        $chats = strip_tags($chats);
        $is_chushi = value::get_game_user_value('is_chushi', $user_id);
        if ($is_chushi) {
            $shifu_id = $user_id;
        } else {
            $shifu_id = value::get_game_user_value('shifu.id', $user_id);
        }
        $sql = "SELECT `chats`,`time` FROM `game_chat` WHERE `mode`=16 AND `uid`={$user_id} ORDER BY `id` DESC LIMIT 1 ";
        $result = sql($sql);
        if (list($old_chats, $time) = $result->fetch_row()) {
            if ($old_chats == $chats) {
                echo "请不要重复发言。";
                br();
                cmd::addcmd('e36,3', '返回上级');
                return;
            } else if (time() < strtotime($time) + 2) {
                echo "最低发言间隔为2秒。";
                br();
                cmd::addcmd('e36,3', '返回上级');
                return;
            }
        }
        //聊天过滤
        if (!c_check_str($chats, 0, 50)) {
            $chats = "绿色传奇:仙盟会(仙盟会游戏)";
        }
        //插入聊天
        $sql = "INSERT INTO `game_chat`(`mode`,`area_id`,`uid`,`chats`,`time`,`oid`) VALUES(16,{$area_id}," . uid() . ",'" . $chats . "','{$now_time}','{$shifu_id}')";
        sql($sql);
        e36(3);
    } else {
        echo "请输入聊天内容。";
        br();
        cmd::addcmd('e36,3', '返回上级');
    }
}

//道具 修补装备
function e132($from_list = 0, $prop_id)
{
    $prop_name = value::get_game_prop_value($prop_id, 'name');
    $prop_liangci = value::get_game_prop_zz_value($prop_id, 'liangci');
    $naijiu = value::get_game_prop_value($prop_id, 'naijiu');
    $max_naijiu = value::get_game_prop_value($prop_id, 'max_naijiu');
    $bujinlingqi = value::get_user_value('bujinlingqi');
    $lingqixiaohao = $max_naijiu - $naijiu;
    $lingqixiaohao = $bujinlingqi < $lingqixiaohao ? $bujinlingqi : $lingqixiaohao;
    $shengyulingqi = value::add_user_value('bujinlingqi', -1 * $lingqixiaohao);
    value::add_game_prop_value($prop_id, 'naijiu', $lingqixiaohao);
    echo "金光一闪,你成功为这{$prop_liangci}{$prop_name}修补了{$lingqixiaohao}点耐久。";
    br();
    if (!$shengyulingqi) {
        echo "你的补金灵气已使用完。";
        br();
    }
    if (!$from_list) {
        cmd::addcmd('e98,' . $prop_id, '返回上级');
    } else {
        cmd::addcmd('e98,' . $prop_id . ',2', '返回上级');
    }
}

//各种兑换码生成
function add_gz_cdk()
{
    cmd::addcmd('add_cdk1', '推广拉人礼包');
    br();
    cmd::addcmd('add_cdk3', '空间宣传礼包');
    br();
    cmd::addcmd('add_cdk2', '7天空间连续推广');
    br();
    cmd::addcmd('add_cdk4', '连续推广满7日超级礼包 礼包');
    br();
}

//元宝商城 兑换礼包
function rqlb_e133($mode = 0, $step = 0)
{
    if (!$mode) {
        if (!$step) {
            $url = cmd::addcmd("rqlb_e133,0,1", "兑换礼包", false, true);
            echo <<<cdkform
兑换礼包
<br>
1.请您输入游戏CDK兑换码。
<form action="{$url}" method="post">
<input type="text" name="cdk" maxlength="32" placeholder="请输入CDK兑换礼包">
<br>
<input type="submit" value="确认兑换">
</form>
cdkform;
        cmd::addcmd('e31', '返回上级');
        } else {
            $rqlb_e133 = value::get_user_value('rqlb_e133', $user_id);
            $cdk = value::real_escape_string($_POST['cdk']);
            if ($cdk == 666666) {
                if ($rqlb_e133 < 1) {
                    $user_id = uid();
                    value::set_user_value('rqlb_e133', 1, $user_id);
                    item::add_item(73, 10);
                    item::add_item(287, 200);
                    item::add_item(119, 1);
                    item::add_item(124, 1);
                    $name = value::get_game_user_value('name');
                    value::insert_user_value('nick_name', "<img src=res/img/ch/666666.gif>");
                    if (!value::get_user_value('using_nick_name')) {
                        value::set_user_value('using_nick_name', "<img src=res/img/ch/666666.gif>");
                    } 
                    c_add_guangbo('恭喜' . $name . '领取了入群礼包，获得<img src=res/img/ch/666666.gif>称号!');
                    echo '恭喜你获得了<img src=res/img/ch/666666.gif>称号。';
                    br();
                } else {
                    echo "你已经兑换过CDK!";
                    br();
                }
            } else {
                echo "CDK输入有误,请重新输入!";
                br();
            }
        }
    }
}

function lb_e133($mode = 0, $step = 0)
{
    if (!$mode) {
        if (!$step) {
            $url = cmd::addcmd("lb_e133,0,1", "兑换礼包", false, true);
            echo <<<cdkform
兑换礼包
<br>
1.请您输入游戏CDK兑换码。
<form action="{$url}" method="post">
<input type="text" name="cdk" maxlength="32" placeholder="请输入CDK兑换礼包">
<br>
<input type="submit" value="确认兑换">
</form>
cdkform;
        cmd::addcmd('e31', '返回上级');
        } else {
            $cdk = str_replace("+", "", value::real_escape_string($_POST['cdk']));
            if ($cdk) {
                $cdkok = false;
                $user_id = uid();
                $dbname = $GLOBALS['mysql_dbname'];
                sql("USE `{$dbname}`");
                sql("LOCK TABLES `cdk`");
                $sql = "SELECT `id`,`rmb`,`is_yuchong`,`is_libao`,`event`,`game` From `cdk` WHERE `is_use`=0 AND `cdk`='$cdk' LIMIT 1";
                $result = sql($sql);
                list($cdkid, $rmb, $is_yuchong, $is_libao, $event, $game) = $result->fetch_row();
                if ($cdkid && $game == 'sanguo' && $event) {
                    sql("UPDATE `cdk` SET `is_use`=1,`user_id` =$user_id,`use_time`=NOW() WHERE `id` =$cdkid LIMIT 1");
                    $cdkok = true;
                } else {
                    echo "CDK输入有误,请重新输入!";
                    br();
                }
                sql("UNLOCK TABLES `cdk`");
                sql("USE `{$GLOBALS['game_area_dbname']}`");
                if ($cdkok) {
                    //是否含有元宝
                    //触发事件
                    if ($event) {
                        call_user_func($event);
                        return;
                    }
                }
            } else {
                echo "CDK输入有误,请重新输入!";
                br();
            }
        }
    }
}

//元宝商城 兑换礼包
function e133($mode = 0, $step = 0)
{
    if (!$mode) {
        if (!$step) {
            $url = cmd::addcmd("e133,0,1", "兑换礼包", false, true);
            echo <<<cdkform
兑换礼包
<br>
1.请您输入游戏CDK兑换码。
<form action="{$url}" method="post">
<input type="text" name="cdk" maxlength="32" placeholder="请输入CDK兑换礼包">
<br>
<input type="submit" value="确认兑换">
</form>
cdkform;
            cmd::addcmd('e31', '返回上级');
        } else {
            $cdk = str_replace("+", "", value::real_escape_string($_POST['cdk']));
            if ($cdk) {
                $cdkok = false;
                $user_id = uid();
                $dbname = $GLOBALS['mysql_dbname'];
                sql("USE `{$dbname}`");
                sql("LOCK TABLES `cdk`");
                $sql = "SELECT `id`,`rmb`,`is_yuchong`,`is_libao`,`event`,`game` From `cdk` WHERE `is_use`=0 AND `cdk`='$cdk' LIMIT 1";
                $result = sql($sql);
                list($cdkid, $rmb, $is_yuchong, $is_libao, $event, $game) = $result->fetch_row();
                if ($cdkid && $game == 'sanguo' && !$event) {
                    sql("UPDATE `cdk` SET `is_use`=1,`user_id` =$user_id,`use_time`=NOW() WHERE `id` =$cdkid LIMIT 1");
                    $cdkok = true;
                } else {
                    echo "CDK输入有误,请重新输入!";
                    br();
                }
                sql("UNLOCK TABLES `cdk`");
                sql("USE `{$GLOBALS['game_area_dbname']}`");
                if ($cdkok) {
                    //是否含有元宝
                    if ($rmb) {
                        $amount = $rmb * 10;
                        if ($amount < 1000) {
                            $amount1 = $amount;
                        } else if ($amount < 2000) {
                            $amount1 = (int)($amount * 1.1);
                        } else if ($amount < 5000) {
                            $amount1 = (int)($amount * 1.2);
                        } else if ($amount < 10000) {
                            $amount1 = (int)($amount * 1.4);
                        } else if ($amount < 30000) {
                            $amount1 = (int)($amount * 1.6);
                        } else if ($amount < 50000) {
                            $amount1 = (int)($amount * 2);
                        } else if ($amount >= 50000) {
                            $amount1 = (int)($amount * 2.5);
                        }
                        item::add_item(1, $amount1, true, $user_id, true);
                        c_log('add_item()', value::get_game_user_value('name', $uid) . "(id:" . $user_id . ")在事件{兑换码充值}{$rmb}元\r\n");
                        //累计充值金额
                        if (!$is_libao) {
                            value::add_user_value("recharge_money", $rmb);
                            value::add_user_value("sc_money", $rmb);
                        }
                        cmd::addcmd('e31', '返回上级');
                    }
                    //触发事件
                    if ($event) {
                        eval($event);
                    }
                }
            } else {
                echo "CDK输入有误,请重新输入!";
                br();
            }
        }
    }
}

//副本 进入镜花水月
function e134($mode = 0)
{
    $user_id = uid();
    $today = date("Y-m-d");
    $in_jhsy_time = value::get_user_value('in_jhsy_time');
    if ($in_jhsy_time != $today) {
        value::set_user_value("in_jhsy_time", $today);
        value::set_user_value("in_jhsy_count", 0);
    }
    $in_jhsy_count = value::get_user_value("in_jhsy_count");
    if ($in_jhsy_count < 5) {
        $need_money = 3000;
    } else {
        $need_money = ($in_jhsy_count - 3) * 3000;
    }
    if ($mode) {
        if (item::add_money(-1 * $need_money)) {
            value::set_game_user_value('in_map_id', '126');
            value::add_user_value("in_jhsy_count", 1);
            e0();
            return;
        } else {
            cmd::set_return_game_br(false);
        }
    } else {
        if (user::get_max_pet_lvl($user_id) >= 30) {
            echo "你确定要花费{$need_money}金币进入镜花水月副本吗?";
            br();
            cmd::addcmd('e134,1', '确定进入');
        } else {
            echo "玩家宠物等级大于30级方可进入镜花水月副本。";
        }
    }
}

//角色 奇遇事件
function e135($mode = 0, $pet_id = 0, $choice_str = '')
{
    cmd::set_show_return_game(false);
    if (!$mode) {
        //随机宠物
        $sql = "SELECT `id`,`name`,`shuxing`,`study_skill` FROM `pet` ORDER BY RAND() LIMIT 1";
        $result = sql($sql);
        list($pet_id, $pet_name, $pet_shuxing, $pet_study_skill) = $result->fetch_row();
        if ($pet_id == 138 || $pet_id == 139) {
            $pet_name .= " ";
        }
        $xuhao_arr = array("A", "B", "C", "D");
        $mode = mt_rand(1, 5) == 1 ? 1 : 2;
        $daan = mt_rand(0, 3);
        if ($mode == 1) {
            echo "天降奇遇,请问{$pet_name}的正确属性是?";
            br();
            $wenti = "天降奇遇,请问{$pet_name}的正确属性是?";
            for ($i = 0; $i < 4; $i++) {
                if ($i) {
                    br();
                }
                if ($i == $daan) {
                    cmd::addcmd("e135,{$mode},{$pet_id},{$pet_shuxing}", "{$xuhao_arr[$i]}.{$pet_shuxing}");
                } else {
                    $sql = "SELECT `shuxing` FROM `pet` WHERE `shuxing` != '{$pet_shuxing}' ORDER BY RAND() LIMIT 1";
                    $result = sql($sql);
                    list($rand_shuxing) = $result->fetch_row();
                    cmd::addcmd("e135,{$mode},{$pet_id},{$rand_shuxing}", "{$xuhao_arr[$i]}.{$rand_shuxing}");
                }
            }
        } else {
            $skill_arr = explode(',', $pet_study_skill);
            $skill_id = $skill_arr[mt_rand(0, count($skill_arr) - 1)];
            echo "天降奇遇,选择一个{$pet_name}的正确技能:";
            br();
            $wenti = "天降奇遇,选择一个{$pet_name}的正确技能:";
            for ($i = 0; $i < 4; $i++) {
                if ($i) {
                    br();
                }
                if ($i == $daan) {
                    cmd::addcmd("e135,{$mode},{$pet_id},{$skill_id}", "{$xuhao_arr[$i]}." . value::get_skill_value($skill_id, 'name'));
                } else {
                    $sql = "SELECT `id` FROM `skill` WHERE `id` !={$skill_id} ORDER BY RAND() LIMIT 1";
                    $result = sql($sql);
                    list($rand_skill_id) = $result->fetch_row();
                    cmd::addcmd("e135,{$mode},{$pet_id},{$rand_skill_id}", "{$xuhao_arr[$i]}." . value::get_skill_value($rand_skill_id, 'name'));
                }
            }
        }
//        echo <<<wenti
//<script>
//alert("$wenti");
//</script>
//wenti;
    } else {
        //是否正确
        $ok = false;
        //奇遇总数
        value::add_user_value("qiyu_count", "1");
        //属性问题
        if ($mode == 1) {
            if (value::getvalue('pet', 'shuxing', 'id', $pet_id) == $choice_str) {
                $ok = true;
            }
        } else {
            //技能问题
            $study_skill = value::getvalue('pet', 'study_skill', 'id', $pet_id);
            $skill_arr = explode(',', $study_skill);
            foreach ($skill_arr as $skill_id) {
                if ($skill_id == $choice_str) {
                    $ok = true;
                    break;
                }
            }
        }
        if ($ok) {
            //输出提示
            echo "回答正确!";
            br();
            //成功总数
            value::add_user_value("qiyu_success", "1");
            //退出奇遇
            value::set_user_value('is_qiyu', '0');
            //奇遇奖励
            if (mt_rand(1, 5) == 1) {
                item::add_item(mt_rand(2, 5), 1);
            }
            //奇遇惩罚
            //刷将保护
            $qiyu_dclc = value::get_user_value("qiyu_dclc");
            if ($qiyu_dclc > 2) {
                value::set_user_value("qiyu_scbhsl", $qiyu_dclc * 200);
            }
        } else {
            echo "回答错误!";
            br();
            //错误总数
            value::add_user_value("qiyu_error", "1");
            //单次连错
            $qiyu_dclc = value::add_user_value("qiyu_dclc", "1");
            //单次连错最大记录
            if ($qiyu_dclc > value::get_user_value('qiyu_max_dclc')) {
                value::get_user_value('qiyu_max_dclc', $qiyu_dclc);
            }
        }
        //返回战斗模板
        e0();
    }
}

//战斗 挑战玩家事件
function e136($oid)
{
    //玩家ID
    $uid = uid();
    //是否在竞技场上
    if (value::get_map_value(user::get_game_user("in_map_id", $uid), "is_jingjichang")) {
        e204($oid);
        return;
    }
    //现行时间
    $now_time = date("Y-m-d H:i:s");
    //是否可以PK
    $can_pk = true;
    //PK错误提示
    $error_misaoshu = "";
    //等级徽章限制 同一地图要求 副本无法挑战 安全区 免战牌 宠物状态 对方是否正在PK
    $ulvl = user::get_max_pet_lvl($uid);
    $olvl = user::get_max_pet_lvl($oid);
    value::set_user_value('xs_hp', 0, $uid);
    value::set_user_value('xs_mp', 0, $uid);
    value::set_user_value('xs_hp', 0, $oid);
    value::set_user_value('xs_mp', 0, $oid);
    $u_in_map_id = value::get_game_user_value('in_map_id', $uid);
    //安全区
    if (!value::get_map_value($u_in_map_id, 'is_pk') && $can_pk) {
        $can_pk = false;
        $error_misaoshu = "这里安全区不准打架。<br>";
    }
    //玩家离线不能PK
    if (!value::get_game_user_value('is_online', $oid)) {
        $can_pk = false;
        $error_misaoshu = "对方暂时无法挑战。<br>";
    }
    //免战时间
    if ($can_pk) {
        $mianzhan_time = value::get_user_value('mianzhan.time', $oid);
        $now_time = date("Y-m-d H:i:s");
        if ($mianzhan_time > $now_time) {
            $can_pk = false;
            $error_misaoshu = "对方挂起了免战牌,无法挑战。<br>";
        }
    }
    //宠物状态
    $u_pet_id = 0;
    $o_pet_id = 0;
    if ($can_pk) {
        $u_ok = false;
        $u_pet_arr = user::get_pet_arr($uid, 1);
        foreach ($u_pet_arr as $u_pet_id) {
            $is_dead = value::get_pet_value($u_pet_id, 'is_dead');
            if (!$is_dead) {
                $u_ok = true;
                break;
            }
        }
        if (!user::get_game_user('is_dead', $uid)) {
            $u_ok = true;
        }
        $o_ok = false;
        $o_pet_arr = user::get_pet_arr($oid, 1);
        foreach ($o_pet_arr as $o_pet_id) {
            $is_dead = value::get_pet_value($o_pet_id, 'is_dead');
            if (!$is_dead) {
                $o_ok = true;
                break;
            }
        }
        if (!user::get_game_user('is_dead', $oid)) {
            $o_ok = true;
        }
        if (!$u_ok) {
            $can_pk = false;
            $error_misaoshu = "你已死亡且身上没有可以战斗的宠物了。<br>";
        }
        if (!$o_ok) {
            $can_pk = false;
            $error_misaoshu = "对方已死亡且身上没有可以战斗的宠物了。<br>";
        }
    }
    //玩家状态
    if ($can_pk) {
        //开始事务
        sql("BEGIN");
        $sql = "SELECT `is_pk` FROM `game_user` WHERE `id` = $oid  LIMIT 1 FOR UPDATE";
        $rs = sql($sql);
        list($o_is_pk) = $rs->fetch_row();
        //提交事务
        sql("COMMIT");
        //对方正在PK
        if ($o_is_pk || value::get_user_value('is_pk_settlement_doing', $uid)) {
            $can_pk = false;
            $error_misaoshu = "对方正在战斗中。<br>";
        }
        //开始事务
        sql("BEGIN");
        $sql = "SELECT `is_pk` FROM `game_user` WHERE `id` = $uid  LIMIT 1 FOR UPDATE";
        $rs = sql($sql);
        list($u_is_pk) = $rs->fetch_row();
        //提交事务
        sql("COMMIT");
        //对方正在PK
        if ($u_is_pk) {
            e0();
            return;
        }
    }
    //同一地图
    if ($u_in_map_id != value::get_game_user_value('in_map_id', $oid) && $can_pk) {
        $can_pk = false;
        $error_misaoshu = "双方必须在同一地图才能挑战。<br>";
    }
    //是否可以PK
    if (!$can_pk) {
        echo $error_misaoshu;
        cmd::addcmd('e12', '返回上级');
    } else {
        //免战效果
        $u_mianzhan_time = value::get_user_value('mianzhan.time', $uid);
        if ($u_mianzhan_time > $now_time) {
            value::set_user_value('mianzhan.time', $now_time, $uid);
            echo "主动挑战,免战效果消失。";
            br();
        }
        //双方进入战斗
        value::set_game_user_value('is_pk', 1, $uid);
        value::set_game_user_value('is_pk', 1, $oid);
        //设置己方
        //设置全宠物未PK
        sql("UPDATE `game_pet` SET `is_pk`=0 WHERE  `master_id` ={$uid} AND `master_mode`=1 LIMIT 5");
        //设置角色属性 出战宠物 回合数 对战宠物 PK状态
        value::set_game_user_value('pk.user.id', $oid, $uid);
        value::set_game_user_value('pk.now_pet.id', $u_pet_id, $uid);
        value::set_user_value('pk.huihe', '0', $uid);
        value::set_user_value('is_zd_pk', '1', $uid);
        value::set_user_value('pk.huihe.time', strtotime($now_time), $uid);
        value::set_user_value("pk_win_money", 0, $uid);
        value::set_user_value("pk_win_exp", 0, $uid);
        //清除战斗信息
        $obj = new game_user_object($uid);
        $obj->del("pk_chats");
        //设置敌方
        //设置全宠物未PK
        sql("UPDATE `game_pet` SET `is_pk`=0 WHERE  `master_id` ={$oid} AND `master_mode`=1 LIMIT 5");
        //设置角色属性 出战宠物 回合数 对战宠物 PK状态
        value::set_game_user_value('pk.user.id', $uid, $oid);
        value::set_game_user_value('pk.now_pet.id', $o_pet_id, $oid);
        value::set_user_value('pk.huihe', 0, $oid);
        value::set_user_value('pk.huihe.time', strtotime($now_time), $oid);
        value::set_user_value("pk_win_money", 0, $oid);
        value::set_user_value("pk_win_exp", 0, $oid);
        //清除战斗信息
        $obj = new game_user_object($oid);
        $obj->del("pk_chats");
        //己方进入战斗
        ctm::show_ctm('ctm_pk_user');
        //敌方进入战斗
        value::set_game_user_value('in_ctm', 'ctm_pk_user', $oid);
        cmd::delallcmd($oid);
    }
}

//战斗 战斗结果
function e137()
{
    //获取用户id
    $user_id = uid();
    $o_user_id = value::get_game_user_value('pk.user.id', $user_id);
    //提交战斗信息
    skill::add_skill_chat('', $user_id, $o_user_id, true);
    //显示战斗信息
    $obj = new game_user_object($user_id);
    $pk_chats = $obj->get("pk_chats", "string");
    echo $pk_chats;
    $obj->del("pk_chats");
    //获取PK模式
    $pk_mode = value::get_user_value("pk_mode", $user_id);
    if ($pk_mode) {
        $can_jiesuan = false;
        if ($pk_mode > 2) {
            $is_pk_settlement_doing = value::get_user_value('is_pk_settlement_doing', $user_id);
            if ($is_pk_settlement_doing == 1) {
                //结算未完 无法结算
                echo "战斗正在结算中,请稍后刷新!";
                br();
                cmd::addcmd("e137", "刷新");
                cmd::set_show_return_game(false);
                return;
            } else if ($is_pk_settlement_doing == 2) {
                //可以结算 开始结算
                $can_jiesuan = true;
            } else {
                //结算过了 返回游戏
                e5();
            }
        } else {
            $can_jiesuan = true;
        }
        if ($can_jiesuan) {
            //VIP
            $vip_lvl = user::getVipLvl();
            $wj_jy = value::get_user_value("wj_jy", $user_id);
            $sbjy_exp = value::get_user_value("sbjy_exp", $user_id) * 10;
            $vip_lvl = $vip_lvl + $wj_jy * 10 + $sbjy_exp;
            //获取宠物数组 奖励金钱 经验
            $pk_pet_arr = json_decode(value::get_user_value("pk_pet_arr", $user_id), true);
            $pk_win_money = value::get_user_value("pk_win_money", $user_id);
            $pk_win_exp = value::get_user_value("pk_win_exp", $user_id);
            //每日限额
            $xiane_arr = config::getConfigByName("xiane");
            $day_max_money = $xiane_arr['day_max_money'];
            if ($pk_mode < 4) {//野怪 NPC
                //VIP特权
                $pk_win_money *= (1 + $vip_lvl * 0.1);
                $pk_win_money = (int)$pk_win_money;
                //每日限额
                $today_money_ok = true;
                $today_money = value::get_user_value("today.jq", $user_id);
                if ($today_money > $day_max_money) {
                    $today_money_ok = false;
                }
                if ($user_id) {
                    value::add_user_value("today.jq", $pk_win_money, $user_id);
                } else {
                    $pk_win_money = 0;
                    echo "金钱奖励已达到每日限额。";
                    br();
                }
            }
            //每日限额
            //PK宠物数组
            $pk_pet_count = count($pk_pet_arr);
            //战斗奖励
            //用户获得金钱
            $sj10 = mt_rand(0, 10);
            if ($pk_win_money > 0 && $sj10 > 7) {
                $map_id = value::get_game_user_value('in_map_id', $user_id);
                $hy_xs_lvl = value::get_user_value('hy_lvl', $user_id);
                if ($hy_xs_lvl > 0) {
                    item::add_item(51, $pk_win_money);
                } else {
                    item::map_add_item($map_id, 51, $pk_win_money);
                }
            }
            //宠物获得经验
            if ($pk_mode < 4) {
                //NPC经验奖励
                if ($pk_mode > 1 && $pk_mode < 4) {
                    $pk_win_exp *= 1.5;
                }
                //帮派经验奖励
                $union_id = user::get_union($user_id);
                if ($union_id) {
                    //帮派灵气
                    $union_lingqi = union::get($union_id, 'lingqi');
                    $union_lingqi = $union_lingqi >= 1000 ? $union_lingqi : 0;
                    $union_lingqi = $union_lingqi < 50000 ? $union_lingqi : 50000;
                    $pk_win_exp = ceil($pk_win_exp * (1 + $union_lingqi / 100000));
                    //帮派双倍经验
                    $ghsbjy_time = union::get($union_id, "ghsbjy_time");
                    $pk_win_exp = ceil($pk_win_exp * ($ghsbjy_time >= time() ? 2 : 1));
                }
                //双倍经验次数奖励
                if (value::get_user_value('shuangbeijingyancishu', $user_id) > 0) {
                    $pk_win_exp *= 2;
                    if (value::add_user_value('shuangbeijingyancishu', -1, $user_id) < 1) {
                        skill::add_skill_chat("你的双倍经验次数已使用完。", $user_id, 0);
                    }
                }
                //VIP特权
                $pk_win_exp2 = 0;
                $pk_win_exp1 = 0;
                $zb_exp_jc = equip::get_user_equip_jc('exp', $user_id);
                if ($zb_exp_jc) {
                    $pk_win_exp2 = $pk_win_exp / 100 * $zb_exp_jc;
                }
                $pk_win_exp1 = $pk_win_exp + $pk_win_exp * ($vip_lvl * 0.1) + $pk_win_exp2;
                $pk_win_exp = (int)$pk_win_exp1;
                //宠物奖励
                foreach ($pk_pet_arr as $pk_pet_id) {
                    //宠物获得经验
                    pet::get_exp($pk_pet_id, (int)$pk_win_exp);
                }
                //玩家奖励
                if (!user::get_game_user('is_dead', $user_id)) {
                    //人物获得经验
                    user::get_exp($user_id, (int)$pk_win_exp);
                }
            }
            //重置PK模式 宠物数组 奖励金钱 经验
            $in_map_id = value::get_game_user_value('in_map_id', $user_id);
            $now_time = time();
            $fk_npc1 = value::get_system_value('fk_npc1');
            $fk_npc2 = value::get_system_value('fk_npc2');
            $fk_npc3 = value::get_system_value('fk_npc3');
            $fk_npc4 = value::get_system_value('fk_npc4');
            if ($in_map_id == $fk_npc1 || $in_map_id == $fk_npc2 || $in_map_id == $fk_npc3 || $in_map_id == $fk_npc4) {
                $sql = "UPDATE `map` SET `npc_time`='{$now_time}' WHERE `id`='{$in_map_id}'";
                sql($sql);
            }
            $yg_sx = value::get_map_value($in_map_id, 'yg_sx', $user_id);
            if ($yg_sx > 0) {
                $sql = "UPDATE `map` SET `yg_ys`='{$now_time}' WHERE `id`='{$in_map_id}'";
                sql($sql);
            }
            $yg_area_id = value::get_map_value($in_map_id, 'area_id', $user_id);
            if ($yg_area_id == 89 && $pk_mode < 2) {
                if ($in_map_id == 5039) {
                    $gc_id = 1;
                } else if ($in_map_id == 5040) {
                    $gc_id = 2;
                } else if ($in_map_id == 5044) {
                    $gc_id = 3;
                } else if ($in_map_id == 5045) {
                    $gc_id = 4;
                } else if ($in_map_id == 5046) {
                    $gc_id = 5;
                } else if ($in_map_id == 5048) {
                    $gc_id = 6;
                } else if ($in_map_id == 5050) {
                    $gc_id = 7;
                } else if ($in_map_id == 5051) {
                    $gc_id = 8;
                } else if ($in_map_id == 5052) {
                    $gc_id = 9;
                } else if ($in_map_id == 5054) {
                    $gc_id = 10;
                } else if ($in_map_id == 5055) {
                    $gc_id = 11;
                } else if ($in_map_id == 5059) {
                    $gc_id = 12;
                } else if ($in_map_id == 5041) {
                    $gc_id = 20;
                } else if ($in_map_id == 5058) {
                    $gc_id = 50;
                } else if ($in_map_id == 5053) {
                    $gc_id = 40;
                } else if ($in_map_id == 5049) {
                    $gc_id = 30;
                }
                value::add_user_value('gwgc_jifen', $gc_id, $user_id);
                echo "你获得了{$gc_id}荣耀积分";
                br();
            }
            if ($yg_area_id == 91) {
                $i_sl = 0;
                for ($i = 5365; $i < 5565; $i++) {
                    if ($in_map_id >= $i) {
                        $i_sl++;
                        $i1 = $i + 1;
                    }
                }
                $i_sl1 = (int)($i_sl / 20);
                if ($i_sl1 < 1) {
                    $i_sl1 = 1;
                }
                item::add_item(288, $i_sl1);
                value::add_user_value('yysl_jifen', 1, $user_id);
                echo "你获得了1点秘境积分!";
                br();
                if ($i1 > 5564) {
                    $i1 = 1;
                }
                value::set_game_user_value('in_map_id', $i1, $user_id);
                value::set_user_value('mj_yysl_csid', $i1, $user_id);
            }
            $tz_tdxt_id = value::get_user_value('tz_tdxt_id', $user_id);
            if ($tz_tdxt_id) {
                $tz_tdxt_id1 = value::get_system_value('tz_tdxt_id' . $tz_tdxt_id);
                $name1 = value::get_game_user_value('name', $tz_tdxt_id1);
                $name = value::get_game_user_value('name', $user_id);
                c_add_guangbo("恭喜玩家{$name}成功挑战{$name1}成为天梯第{$tz_tdxt_id}名！");
                value::set_system_value("tz_tdxt_id" . $tz_tdxt_id, $user_id);
            }
            $sxts_boss = value::get_map_value($in_map_id, 'sxts_boss', $user_id);
            if ($sxts_boss > 0) {
                $sql = "SELECT COUNT(*) FROM `game_pet` WHERE `map_id` = {$in_map_id} AND `star`>1 AND `master_id`=0 AND `npc_id`=0 AND `master_mode`!=8";
                $result = sql($sql);
                list($pcount22) = $result->fetch_row();
                if (!$pcount22) {
                    $sql = "UPDATE `map` SET `sxts_boss`=0 WHERE `id`='{$in_map_id}'";
                    sql($sql);
                }
            }
            value::set_user_value("pk_mode", 0, $user_id);
            value::set_user_value("pk_pet_arr", 0, $user_id);
            value::set_user_value("pk_win_money", 0, $user_id);
            value::set_user_value("pk_win_exp", 0, $user_id);
            //结算完成
            value::set_user_value('is_pk_settlement_doing', 0, $user_id);
            //任务宠物
            if ($pk_mode == 1) {
                $ok_task = false;
                $sql = "SELECT `value` FROM `game_user_value` WHERE `userid`={$user_id} AND `valuename` LIKE '{$user_id}.task' LIMIT 0,5";
                $result = sql($sql);
                while (list($task_id) = $result->fetch_row()) {
                    if (!call_task($task_id, 5, 0, 0, true)) {
                        if (call_task($task_id, 8)) {
                            $ok_task = true;
                            break;
                        }
                    }
                }
                if ($ok_task) {
                    cmd::addcmd('find_task_pet', '任务宠物');
                    br();
                }
            }
        }
    }
    if (!$pk_mode && !$pk_chats) {
        //结算完成
        value::set_user_value('is_pk_settlement_doing', 0, $user_id);
        $team_id = 0;
        if ($user_id) {
            $npc_id = value::get_game_user_value('pk.npc.id', $user_id);
            if ($npc_id) {
                //还原挑战NPCID
                value::set_game_user_value('pk.npc.id', '0', $user_id);
                //玩家离开PK
                value::set_game_user_value('is_pk', '0', $user_id);
            }
        }
        echo "该战斗已经结束。";
        br();
    }
    //返回游戏
    cmd::set_return_game_br(false);
}

//宠物 属性点转换
function e138($pet_id, $step = 0)
{
    $pet_name = value::get_pet_value($pet_id, 'name');
    $shuxingdian = value::get_pet_value($pet_id, 'shuxingdian');
    $dhsl = (int)($shuxingdian / 3);
    if (!$step) {
        echo "你要用{$pet_name}的{$shuxingdian}点属性点兑换{$dhsl}颗玉菩提吗?";
        br();
        cmd::addcmd('e138,' . $pet_id . ',1', '确定兑换');
    } else {
        echo "你用{$pet_name}的{$shuxingdian}点属性点兑换了{$dhsl}颗玉菩提。";
        item::add_item(75, $dhsl, false, 0, true);
        value::set_pet_value($pet_id, 'shuxingdian', 0);
    }
    br();
    cmd::addcmd('e78,' . $pet_id, '返回上级');
}

//角色 查看仇人列表
function e139($yeshu = 0)
{
    $user_id = uid();
    $danye_count = 15;
    //获取黑名单列表
    cmd::addcmd('e13', '状态');
    echo ">> 仇人";
    br();
    echo "-";
    br();
    cmd::addcmd('e51', '好友');
    echo " . ";
    cmd::addcmd('e36,2', '聊天');
    echo " . 仇人";
    echo " . ";
    cmd::addcmd('e71', '黑名单');
    br();
    //获取仇人数量
    $sql = "SELECT COUNT(*) FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.chouren'";
    $result = sql($sql);
    list($heiming_count) = $result->fetch_row();
    //开始获取
    $sql = "SELECT `value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.chouren'";
    $result = sql($sql);
    //黑名单计数
    $count = 0;
    //离线仇人 计数 名字数组
    $lxhm = array();
    $zxhm = array();
    $new_hm = array();
    $heiming_leixing_arr = array();
    while (list($oid) = $result->fetch_row()) {
        if ($oid) {
            if (value::get_game_user_value('is_online', $oid)) {
                array_push($zxhm, $oid);
                $heiming_leixing_arr[$oid] = 1;
            } else {
                array_push($lxhm, $oid);
                $heiming_leixing_arr[$oid] = 0;
            }
        }
        $count++;
    }
    if (!$count) {
        echo '你还没有仇人哦！';
        br();
    } else {
        $new_hm = array_merge($zxhm, $lxhm);
        cmd::set_return_game_br(false);
    }
    //输出仇人链接
    $max_count = $count < ($yeshu + 1) * $danye_count ? $count : ($yeshu + 1) * $danye_count;
    for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
        $oname = value::get_game_user_value('name', $new_hm[$i]);
        user::showVipLogo($new_hm[$i], true);
        if ($heiming_leixing_arr[$new_hm[$i]]) {
            cmd::addcmd('e12,' . $new_hm[$i] . ',4', $oname);
        } else {
            echo $oname;
        }
        $o_map_id = value::get_game_user_value('in_map_id', $new_hm[$i]);
        $o_map_name = value::get_map_value($o_map_id, 'name');
        echo "({$o_map_name})";
        echo ' ';
        cmd::addcmd('e140,' . $new_hm[$i], '删除');
        br();
    }
    //上下页操作
    $fanye = false;
    $max_page_num = (int)(($count - 1) / $danye_count) + 1;
    if ($yeshu) {
        if ($yeshu > 1) {
            cmd::addcmd("e139", '首页');
            echo "|";
        }
        cmd::addcmd('e139,' . ($yeshu - 1), '上—页');
        $fanye = true;
    }
    if ($heiming_count > ($yeshu + 1) * $danye_count) {
        if ($yeshu) {
            echo "|";
        }
        cmd::addcmd('e139,' . ($yeshu + 1), '下—页');
        if ($yeshu + 2 < $max_page_num) {
            echo "|";
            cmd::addcmd('e139,' . ($max_page_num - 1), '末页');
        }
        $fanye = true;
    }
    //是否翻页换行
    if ($fanye) {
        br();
    }
    echo "-";
    //返回操作
}

//角色 删除仇人
function e140($oid)
{
    $uid = uid();
    $oname = value::get_game_user_value('name', $oid);
    $sql = "DELETE FROM `game_user_value` WHERE `valuename` LIKE '{$uid}.chouren' AND `value` LIKE '{$oid}'";
    sql($sql);
    echo '成功将' . $oname . '从仇人列表删除。';
    br();
    e139();
}

//监狱 出狱
function e141($mode = 0, $step = 0)
{
    $user_id = uid();
    $hongming = user::get_hongming();
    if (!$mode) {
        if ($hongming) {
            echo "你还有{$hongming}点红名值,还需坐牢{$hongming}小时!";
            br();
            cmd::addcmd('e141,1', '买通守卫');
            br();
            cmd::addcmd('e141,2', '消除红名');
        } else {
            echo "你决定洗心革面,重新做人,终于出狱了。";
            br();
            e7(1);
        }
    } else if ($mode == 1) {
        $maitong_money = $hongming * 200;
        if (!$step) {
            echo "你笑眯眯的找守卫借一步说话,守卫跟你走到偏僻的角落,跟你说想出狱:你只需给我{$maitong_money}个元宝就可以了。";
            br();
            cmd::addcmd('e141,1,1', '确认给钱');
            br();
            cmd::addcmd('e141', '再考虑下');
        } else {
            if ($hongming) {
                if (item::add_item(1, -1 * $maitong_money)) {
                    echo "你从口袋里掏出了{$maitong_money}个元宝递给了守卫,他笑嘻嘻的收下了。";
                    br();
                    value::set_user_value('hongming', 0, $user_id);
                    value::set_user_value('ts_hongming', 0, $user_id);
                } else {
                    echo "守卫看你你翻了翻口袋,拿不出金币来,恶狠狠的对你说:没钱也敢来找本大爷消遣,快去干活!";
                    br();
                }
            }
            e141();
        }
    } else {
        $chongshengdian = value::get_user_value('chongshengdian');
        if ($chongshengdian) {
            $need_chongshengdian = $chongshengdian > $hongming ? $hongming : $chongshengdian;
            if (!$step) {
                echo "你确定用{$need_chongshengdian}点重生点消除{$need_chongshengdian}点红名值吗?";
                br();
                cmd::addcmd('e141,2,1', '确认消除');
                br();
                cmd::addcmd('e141', '再考虑下');
            } else {
                if ($hongming) {
                    echo "你成功用{$need_chongshengdian}点重生点消除了{$need_chongshengdian}点红名值。";
                    br();
                    value::add_user_value('chongshengdian', -1 * $need_chongshengdian);
                    value::add_user_value('hongming', -1 * $need_chongshengdian);
                }
                e141();
            }
        } else {
            echo "你没有重生点,无法消除红名。";
            br();
            e141();
        }
    }
}

//监狱 挖矿
function e142()
{
    if (user::get_hongming()) {
        $time = time();
        $last_wakuang_time = value::get_user_value('last_wakuang_time');
        if ($time > $last_wakuang_time + 60) {
            value::set_user_value('last_wakuang_time', $time);
            if (mt_rand(1, 2000) == 1) {
                echo "你抡起锄头往矿山上砸了好久,大汗淋漓。叮咚一声,终于挖到了一颗宝石,你赶紧上交给了守卫,减少了1点红名值。";
                value::add_user_value('hongming', -1);
                if (!user::get_hongming()) {
                    br();
                    echo "你已经疲惫不堪,正愁不知道什么时候才是个头,这时守卫过来悄悄的告诉你,你可以出狱了。";
                }
            } else {
                echo "你抡起锄头往矿山上砸了好久,你都眼冒金星了,也没有挖到一颗宝石。";
            }
        } else {
            echo "你抡起锄头往矿山上砸了几下,你实在是太累了,不觉的倒在了地上。";
        }
    } else {
        echo "你正准备抡起锄头往矿山上砸去,守卫过来悄悄的告诉你,你可以出狱了。";
    }
}

//物品 女娲石
function e143($pet_id, $item_id)
{
    $user_id = uid();
    $ctm = value::get_game_user_value('in_ctm', $user_id);
    //用户是否拥有该宠物
    if (user::have_pet($user_id, $pet_id)) {
        //宠物是否死亡
        if (!value::get_pet_value($pet_id, 'is_dead')) {
            $lvl = value::get_pet_value($pet_id, 'lvl');
            $max_lvl = value::get_pet_value($pet_id, 'max_lvl');
            $exp = value::get_pet_value($pet_id, 'exp');
            $max_exp = value::get_pet_value($pet_id, 'max_exp');
            if ($lvl < $max_lvl) {
                if (item::lose_item($item_id, 1)) {
                    pet::get_exp($pet_id, $max_exp - $exp);
                }
            } else {
                echo "该宠物无法继续升级了。";
                br();
            }
        } else {
            echo "宠物已死亡,无法喂食药品。";
            br();
        }
    } else {
        echo "该宠物已经不属于你了。";
        br();
        if ($ctm == 'ctm_setting') {
            cmd::addcmd('e40', '返回上级');
        } else {
            cmd::addcmd('e35', '返回上级');
        }
    }
}

//组队 邀请组队事件
function e144($oid, $mode = 0)
{
    $uid = uid();
    $uname = value::get_game_user_value('name', $uid);
    $u_in_map_id = value::get_game_user_value('in_map_id', $uid);
    if (!$mode) {
        $team_id = team::get_user_team($uid);
    } else {
        $team_id = team::get_user_team($oid);
    }
    //获取队伍成员数
    if (team::get_team_user_count($team_id) < 5) {
        //邀请加入小队
        if (!$mode) {
            if (!value::get_map_value($u_in_map_id, 'is_danrenfuben')) {
                if (!team::get_user_team($oid)) {
                    $o_in_map_id = value::get_game_user_value('in_map_id', $oid);
                    if (!value::get_map_value($o_in_map_id, 'is_danrenfuben')) {
                        echo "组队邀请已发出,请等待对方接受。";
                        c_add_xiaoxi("{$uname}邀请你加入小队!", 17, $uid, $oid);
                    } else {
                        echo "对方正在单人副本中,无法邀请。";
                    }
                } else {
                    echo "对方已在小队中,无法邀请。";
                }
            } else {
                echo "你正在单人副本中,无法邀请。";
            }
        } else {
            //申请加入小队
            if (!team::get_user_team($uid)) {
                if (!value::get_map_value($u_in_map_id, 'is_danrenfuben')) {
                    if (team::get_user_team($oid)) {
                        echo "组队请求已发出,请等待对方接受。";
                        $captain_user_id = team::get_team_captain_user_id($team_id);
                        c_add_xiaoxi("{$uname}想要加入小队!", 17, $uid, $captain_user_id, 0, 1);
                    } else {
                        echo "对方不在小队中,无法加入。";
                    }
                } else {
                    echo "你正在单人副本中,无法加入。";
                }
            } else {
                echo "你正在小队中,无法加入。";
            }
        }
    } else {
        if (!$mode) {
            echo "队伍已满,无法邀请。";
        } else {
            echo "队伍已满,无法加入。";
        }
    }
    br();
    e12();
}

//组队 踢出小队
function e145($o_user_id)
{
    $user_id = uid();
    $team_id = team::get_user_team($o_user_id);
    $captain_user_id = team::get_team_captain_user_id($team_id);
    $o_name = value::get_game_user_value('name', $o_user_id);
    if ($user_id == $captain_user_id) {
        //是否组队战斗
        if (value::get_game_user_value('in_ctm', $o_user_id) != 'ctm_pk_team_npc') {
            //踢出小队消息
            echo "你把{$o_name}踢出了小队。";
            br();
            c_add_xiaoxi("你被队长踢出了小队。", 0, 0, $o_user_id);
            //踢出小队
            team::exit_team($o_user_id);
        } else {
            //踢出小队消息
            echo "{$o_name}正在挑战NPC,无法踢出。";
            br();
        }
    } else {
        //踢出小队消息
        echo "{$o_name}已不在小队中。";
        br();
    }
    e107();
}

//组队 退出小队
function e146()
{
    $user_id = uid();
    echo "你退出了小队。";
    br();
    team::exit_team($user_id);
    e107();
}

//聊天 组队频道发言
function e147()
{
    $chats = value::real_escape_string($_POST['chats']);
    $user_id = uid();
    $team_id = team::get_user_team($user_id);
    $now_time = date("Y-m-d H:i:s");
    $area_id = value::get_map_value(value::get_game_user_value('in_map_id'), 'area_id');
    if ($chats) {
        if (mb_strlen($chats, 'UTF8') > 50) {
            echo "你好,内容输入长度过长。";
            br();
            cmd::addcmd('e36,5', '返回上级');
            return;
        }
        $chats = strip_tags($chats);
        $sql = "SELECT `chats`,`time` FROM `game_chat` WHERE `mode`=18 AND `uid`={$user_id} ORDER BY `id` DESC LIMIT 1 ";
        $result = sql($sql);
        if (list($old_chats, $time) = $result->fetch_row()) {
            if ($old_chats == $chats) {
                echo "请不要重复发言。";
                br();
                cmd::addcmd('e36,5', '返回上级');
                return;
            } else if (time() < strtotime($time) + 2) {
                echo "最低发言间隔为2秒。";
                br();
                cmd::addcmd('e36,5', '返回上级');
                return;
            }
        }
        //聊天过滤
        if (!c_check_str($chats, 0, 50)) {
            $chats = "绿色传奇:仙盟会(仙盟会游戏)";
        }
        //插入聊天
        $sql = "INSERT INTO `game_chat`(`mode`,`area_id`,`uid`,`chats`,`time`,`oid`) VALUES(18,{$area_id},{$user_id},'" . $chats . "','{$now_time}','{$team_id}')";
        sql($sql);
        e36(5);
    } else {
        echo "请输入聊天内容。";
        br();
        cmd::addcmd('e36,5', '返回上级');
    }
}

//首页 攻略
function e148($str)
{
    switch ($str) {
        case "指南":
            $gonglve_str = gstring::get("gonglve_zhinan");
            break;
        case "物品":
            $gonglve_str = gstring::get("gonglve_wupin");
            break;
        case "装备":
            $gonglve_str = gstring::get("gonglve_zhuangbei");
            break;
        case "好友":
            $gonglve_str = gstring::get("gonglve_haoyou");
            break;
        case "宠物":
            $gonglve_str = gstring::get("gonglve_chongwu");
            break;
        case "天赋":
            $gonglve_str = gstring::get("gonglve_texing");
            break;
        case "进化":
            $gonglve_str = gstring::get("gonglve_jinhua");
            break;
        case "转生":
            $gonglve_str = gstring::get("gonglve_zhuansheng");
            break;
        case "战斗":
            $gonglve_str = gstring::get("gonglve_zhandou");
            break;
        case "交易":
            $gonglve_str = gstring::get("gonglve_jiaoyi");
            break;
        case "组队":
            $gonglve_str = gstring::get("gonglve_zudui");
            break;
        case "拜师":
            $gonglve_str = gstring::get("gonglve_baishi");
            break;
        case "结婚":
            $gonglve_str = gstring::get("gonglve_jiehun");
            break;
        case "黑市":
            $gonglve_str = gstring::get("gonglve_heishi");
            break;
        case "帮派":
            $gonglve_str = gstring::get("gonglve_gonghui");
            break;
        case "副本":
            $gonglve_str = gstring::get("gonglve_fuben");
            break;
        default:
            $gonglve_str = "没有找到我们要给你看的东西了,请等会再来看看吧。";
            break;
    }
    echo $gonglve_str;
    br();
    cmd::addcmd("e166", "返回游戏");
    cmd::set_show_return_game(false);
}

//首页 游戏动态
function e149($num)
{
    if ($num == 777) {
        require_once("update.php");
        $gonglve_str = $GLOBALS['system_update_desc'];
    } else {
        $dongtai_arr = config::getConfigByName("dongtai");
        $gonglve_str = $dongtai_arr[$num]['context'];
    }
    if (!$gonglve_str) {
        $gonglve_str = "没有找到我们要给你看的东西了,请等会再来看看吧。";
    }
    echo $gonglve_str;
    br();
    cmd::addcmd("e166", "返回游戏");
    cmd::set_show_return_game(false);
}

//孵化巢 开始孵化
function e150($prop_id)
{
    $now_time = time();
    $user_id = uid();
    $prop_name = value::get_game_prop_value($prop_id, 'name');
    $sql = "SELECT `id`,`name` FROM `game_prop` WHERE `user_id`=$user_id AND `user_num`=4 LIMIT 1";
    $result = sql($sql);
    list($have_egg_id, $have_egg_name) = $result->fetch_row();
    if ($have_egg_id) {
        //刷新孵化度
        $pet_id = value::get_game_prop_value($have_egg_id, 'pet_id');
        $last_fuhua_time = value::get_pet_value2('last.fuhua.time', $pet_id);
        if ($last_fuhua_time) {
            value::add_pet_value($pet_id, 'fuhuadu', $now_time - $last_fuhua_time, false, 1);
        }
        value::set_pet_value2('last.fuhua.time', $now_time, $pet_id);
        //设置背包模式
        value::set_game_prop_value($have_egg_id, 'user_num', 1);
        echo "你从孵化巢取出了1张{$have_egg_name}。<br>你把1张{$prop_name}放进了孵化巢。";
        br();
    } else {
        echo "你把{$prop_name}放进了孵化巢。";
        br();
    }
    $new_pet_id = value::get_game_prop_value($prop_id, 'pet_id');
    value::set_pet_value2('last.fuhua.time', $now_time, $new_pet_id);
    value::set_game_prop_value($prop_id, 'user_num', 4);
    e40();
}

//孵化巢 放回背包
function e151($prop_id)
{
    $prop_name = value::get_game_prop_value($prop_id, 'name');
    value::set_game_prop_value($prop_id, 'user_num', 1);
    echo "你从孵化巢取出了1张{$prop_name}。";
    br();
    e114();
}

//孵化巢 取出宠物
function e152($prop_id)
{
    $user_id = uid();
    if (user::get_fuzhong(4) < user::get_rongliang(4)) {
        //道具名字
        $prop_name = value::get_game_prop_value($prop_id, 'name');
        //修改名字
        $pet_id = value::get_game_prop_value($prop_id, 'pet_id');
        $pet_name = value::get_pet_zz_value($pet_id, 'name');
        $sex = value::get_pet_value($pet_id, 'sex');
        $fuhao = $sex == '雄' ? '' : ' ';
        $new_pet_name = value::set_pet_value($pet_id, 'name', $pet_name . '宠物' . $fuhao);
        //放入育将
        pet::user_get_pet($user_id, $pet_id, 5, false);
        //删除宠物卡
        prop::del_prop($prop_id);
        //输出提示
        echo "你孵化了1张{$prop_name},{$new_pet_name}已进入育将袋。";
        br();
    } else {
        //输出提示
        echo "育将袋里不能放太多宠物宠物,否则它们会打架的。";
        br();
    }
    e114();
}

//育将袋 查看宠物
function e153($pet_id, $item_id = 0)
{
    $user_id = uid();
    //名字 饱食度 性格 天赋
    $sql = "SELECT `name`,`xingge`,`texing` FROM `game_pet` WHERE `id`=$pet_id LIMIT 1";
    $result = sql($sql);
    list($name, $xingge, $texing) = $result->fetch_row();
    $xingge_str = pet::get_xingge($xingge);
    $texing_str = pet::get_texing($texing, false);
    //刷新成长度
    pet::refresh_chengzhangdu($pet_id);
    //获取成长度
    $chengzhangdu = pet::get_chengzhangdu($pet_id);
    //刷新饱食度
    pet::refresh_baoshidu($pet_id);
    //获取饱食度
    $baoshidu = pet::get_baoshidu($pet_id);
    //六维���成
    $yy_jc_hp = (int)value::get_pet_value2('yuyao.jiacheng.hp', $pet_id);
    $yy_jc_pg = (int)value::get_pet_value2('yuyao.jiacheng.pugong', $pet_id);
    $yy_jc_pf = (int)value::get_pet_value2('yuyao.jiacheng.pufang', $pet_id);
    $yy_jc_tg = (int)value::get_pet_value2('yuyao.jiacheng.tegong', $pet_id);
    $yy_jc_tf = (int)value::get_pet_value2('yuyao.jiacheng.tefang', $pet_id);
    $yy_jc_mj = (int)value::get_pet_value2('yuyao.jiacheng.minjie', $pet_id);
    //喂食宠物
    if ($item_id && item::get_item($item_id, $user_id)) {
        $item_name = value::get_item_value($item_id, 'name');
        cmd::addcmd("e156,$pet_id,1,$item_id", "继续喂" . $item_name);
        br();
    }
    cmd::addcmd("e156,$pet_id", "喂食宠物");
    br();
    //输出描述
    echo "{$name}<br>性格:{$xingge_str} 天赋:{$texing_str}<br>成长度:{$chengzhangdu}%<br>饱食度:{$baoshidu}%<br>生命:+{$yy_jc_hp}<br>攻击:+{$yy_jc_pg}<br>防御:+{$yy_jc_pf}<br>魔攻:+{$yy_jc_tg}<br>魔防:+{$yy_jc_tf}<br>灵活:+{$yy_jc_mj}";
    if ($chengzhangdu > 99) {
        br();
        cmd::addcmd('e155,' . $pet_id . ',1', '取出宠物');
    }
    br();
    cmd::addcmd("e154,{$pet_id}", "放生宠物");
    br();
    cmd::addcmd('e115', '返回上级');
}

//育将袋 放生宠物
function e154($pet_id, $step = 0)
{
    $pet_name = value::get_pet_value($pet_id, 'name');
    if (!$step) {
        echo "你确定要放生这只{$pet_name}吗?";
        br();
        cmd::addcmd("e154,{$pet_id},1", "确定放生");
    } else {
        //删除宠物
        pet::del_pet($pet_id);
        //输出提示
        echo "你成功放生了这只{$pet_name}。";
        br();
        //返回育将
        e115();
        return;
    }
    br();
    cmd::addcmd("e153,{$pet_id}", "返回上级");
}

//育将袋 取出宠物
function e155($pet_id, $mode = 0)
{
    $user_id = uid();
    $fuhao = value::get_pet_value($pet_id, 'sex') == '雄' ? '' : ' ';
    $new_pet_name = value::get_pet_zz_value($pet_id, 'name') . $fuhao;
    if (pet::user_get_pet($user_id, $pet_id, 1)) {
        //六维加成
        $yy_jc_hp = value::get_pet_value2('yuyao.jiacheng.hp', $pet_id);
        $yy_jc_pg = value::get_pet_value2('yuyao.jiacheng.pugong', $pet_id);
        $yy_jc_pf = value::get_pet_value2('yuyao.jiacheng.pufang', $pet_id);
        $yy_jc_tg = value::get_pet_value2('yuyao.jiacheng.tegong', $pet_id);
        $yy_jc_tf = value::get_pet_value2('yuyao.jiacheng.tefang', $pet_id);
        $yy_jc_mj = value::get_pet_value2('yuyao.jiacheng.minjie', $pet_id);
        value::add_pet_value($pet_id, 'max_hp', $yy_jc_hp, false, 1);
        value::add_pet_value($pet_id, 'pugong', $yy_jc_pg, false, 1);
        value::add_pet_value($pet_id, 'pufang', $yy_jc_pf, false, 1);
        value::add_pet_value($pet_id, 'tegong', $yy_jc_tg, false, 1);
        value::add_pet_value($pet_id, 'tefang', $yy_jc_tf, false, 1);
        value::add_pet_value($pet_id, 'minjie', $yy_jc_mj, false, 1);
        //生命值补满 忠诚度加成
        value::set_pet_value($pet_id, 'hp', pet::get_max_hp($pet_id));
        value::set_pet_value($pet_id, 'zhongcheng', pet::get_baoshidu($pet_id));
        //修改名字
        value::set_pet_value($pet_id, 'name', $new_pet_name);
        //输出提示
        echo "你把{$new_pet_name}带在了身上。";
        br();
        e115();
        return;
    }
    if (!$mode) {
        cmd::addcmd("e115", "返回上级");
    } else {
        cmd::addcmd("e153,$pet_id", "返回上级");
    }
}

//育将袋 喂食宠物
function e156($pet_id, $mode = 0, $item_id = 0)
{
    //用户ID
    $user_id = uid();
    //名字
    $pet_name = value::get_pet_value($pet_id, 'name');
    //成长度
    $chengzhangdu = pet::get_chengzhangdu($pet_id);
    if ($chengzhangdu > 99) {
        echo "你的{$pet_name}已经长大了,无法再喂食了。";
    } else {
        //刷新饱食度
        pet::refresh_baoshidu($pet_id);
        //获取饱食度
        $baoshidu = pet::get_baoshidu($pet_id);
        //选择喂食食物
        if ($baoshidu > 99) {
            echo "你的{$pet_name}已经很饱了,无法再喂食了。";
        } else {
            if (!$mode) {
                echo "你想要给你的{$pet_name}喂食什么食物呢?";
                $item_count = 0;
                $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
                $result = sql($sql);
                while (list($id, $count) = $result->fetch_row()) {
                    $id = explode('.', $id);
                    $item_id = $id[2];
                    if ($count) {
                        if (value::get_item_value($item_id, 'is_shiwu')) {
                            br();
                            cmd::addcmd("e156,$pet_id,1,$item_id", value::get_item_value($item_id, 'name') . "x{$count}" . value::get_item_value($item_id, 'liangci'));
                            $item_count++;
                        }
                    }
                }
                if (!$item_count) {
                    br();
                    echo "你没有可以喂食的食物了。";
                }
            } else {
                //开始喂食食物
                if (item::lose_item($item_id, 1)) {
                    $miaoshu = "";
                    $item_name = value::get_item_value($item_id, 'name');
                    if ($baoshidu < 20) {
                        $miaoshu = "你的{$pet_name}饿极了,抢过{$item_name}就开始狼吞虎咽。";
                    } else if ($baoshidu < 40) {
                        $miaoshu = "你的{$pet_name}有点饿了,拿着{$item_name}几口就吃完了。";
                    } else if ($baoshidu < 60) {
                        $miaoshu = "你的{$pet_name}还没吃饱,一口一口的吃着{$item_name}。";
                    } else if ($baoshidu < 80) {
                        $miaoshu = "你的{$pet_name}快吃饱了,敏锐仔细的品尝着{$item_name}。";
                    } else if ($baoshidu < 100) {
                        $miaoshu = "你的{$pet_name}吃的饱饱的,慢慢的吃完了{$item_name}。";
                    }
                    //附加饱食度
                    $add_baoshidu = 5;
                    //宠物成长加成
                    $yy_jc_hp = (int)value::get_pet_value2('yuyao.jiacheng.hp', $pet_id);
                    $yy_jc_pg = (int)value::get_pet_value2('yuyao.jiacheng.pugong', $pet_id);
                    $yy_jc_pf = (int)value::get_pet_value2('yuyao.jiacheng.pufang', $pet_id);
                    $yy_jc_tg = (int)value::get_pet_value2('yuyao.jiacheng.tegong', $pet_id);
                    $yy_jc_tf = (int)value::get_pet_value2('yuyao.jiacheng.tefang', $pet_id);
                    $yy_jc_mj = (int)value::get_pet_value2('yuyao.jiacheng.minjie', $pet_id);
                    //增加饱食度与加成
                    $max_yy_jiacheng = value::get_system_value("is_qiangyaotai_open") ? 50 : 30;
                    switch ($item_id) {
                        //饭团
                        case 109:
                            value::add_pet_value($pet_id, 'baoshidu', 60 + $add_baoshidu, false, 1);
                            value::add_pet_value($pet_id, 'chengzhangdu', 60, false, 1);
                            //增加HP
                            if (mt_rand(1, 200) == 1 && $yy_jc_hp < $max_yy_jiacheng) {
                                value::add_pet_value2('yuyao.jiacheng.hp', 1, $pet_id);
                            }
                            break;
                        //包子
                        case 110:
                            value::add_pet_value($pet_id, 'baoshidu', 60 * 3 + $add_baoshidu, false, 1);
                            value::add_pet_value($pet_id, 'chengzhangdu', 60 * 3, false, 1);
                            //增加灵活
                            if (mt_rand(1, 66) == 1 && $yy_jc_mj < $max_yy_jiacheng) {
                                value::add_pet_value2('yuyao.jiacheng.minjie', 1, $pet_id);
                            }
                            break;
                        //肉干
                        case 111:
                            value::add_pet_value($pet_id, 'baoshidu', 60 * 5 + $add_baoshidu, false, 1);
                            value::add_pet_value($pet_id, 'chengzhangdu', 60 * 5, false, 1);
                            //增加防御或者魔防
                            if (mt_rand(1, 40) == 1) {
                                if (mt_rand(1, 2) == 1) {
                                    if ($yy_jc_pf < $max_yy_jiacheng) {
                                        value::add_pet_value2('yuyao.jiacheng.pufang', 1, $pet_id);
                                    }
                                } else {
                                    if ($yy_jc_tf < $max_yy_jiacheng) {
                                        value::add_pet_value2('yuyao.jiacheng.tefang', 1, $pet_id);
                                    }
                                }
                            }
                            break;
                        //烤肉
                        case 112:
                            value::add_pet_value($pet_id, 'baoshidu', 60 * 10 + $add_baoshidu, false, 1);
                            value::add_pet_value($pet_id, 'chengzhangdu', 60 * 10, false, 1);
                            //增加攻击或者魔攻
                            if (mt_rand(1, 20) == 1) {
                                if (mt_rand(1, 2) == 1) {
                                    if ($yy_jc_pg < $max_yy_jiacheng) {
                                        value::add_pet_value2('yuyao.jiacheng.pugong', 1, $pet_id);
                                    }
                                } else {
                                    if ($yy_jc_tg < $max_yy_jiacheng) {
                                        value::add_pet_value2('yuyao.jiacheng.tegong', 1, $pet_id);
                                    }
                                }
                            }
                            break;
                        //蜂王蜜
                        case 113:
                            value::add_pet_value($pet_id, 'baoshidu', 60 * 20 + $add_baoshidu, false, 1);
                            value::add_pet_value($pet_id, 'chengzhangdu', 60 * 20, false, 1);
                            //增加随机六维
                            if (mt_rand(1, 5) == 1) {
                                $lw_arr = array("hp", "pufang", "pugong", "tegong", "tefang", "minjie");
                                $lw_rand = mt_rand(0, 5);
                                if (value::get_pet_value2('yuyao.jiacheng.' . $lw_arr[$lw_rand], $pet_id) < $max_yy_jiacheng) {
                                    value::add_pet_value2('yuyao.jiacheng.' . $lw_arr[$lw_rand], 1, $pet_id);
                                }
                            }
                            break;
                        //千年蟠桃 能给宠物宠物增加50点饱食度和10%成长度的千年蟠桃。
                        case 86:
                            value::add_pet_value($pet_id, 'baoshidu', 60 * 50 + $add_baoshidu, false, 1);
                            $add_chengzhangdu = value::get_pet_zz_value($pet_id, 'exp') * 3600 * 5 / 10;
                            value::add_pet_value($pet_id, 'chengzhangdu', $add_chengzhangdu, false, 1);
                            //增加随机六维
                            $lw_arr = array("hp", "pufang", "pugong", "tegong", "tefang", "minjie");
                            foreach ($lw_arr as $lw_str) {
                                $add_jc = value::get_pet_value2('yuyao.jiacheng.' . $lw_str, $pet_id);
                                $add_max = $add_jc < 29 ? 2 : 1;
                                if ($add_jc < $max_yy_jiacheng) {
                                    value::add_pet_value2('yuyao.jiacheng.' . $lw_str, mt_rand(1, 10) > 2 ? 1 : $add_max, $pet_id);
                                }
                            }
                            break;
                    }
                    echo $miaoshu;
                }
                br();
                e153($pet_id, $item_id);
                return;
            }
        }
    }
    br();
    cmd::addcmd("e153,$pet_id", "返回上级");
}

//传奇论坛 查看帖子
function e157($main_bbs_id, $mode = 0, $yeshu = 0)
{
    $user_id = uid();
    //设置查看帖子ID
    value::set_user_value('look_bbs_id', $main_bbs_id, $user_id);
    value::add_bbs_value($main_bbs_id, 'read_the_number', 1);
    //主帖
    $sql = "SELECT `name`,`content`,`post_by_id`,`post_by_time`,`is_fine`,`is_lock`,`is_sticky` FROM `game_bbs` WHERE `id`=$main_bbs_id LIMIT 1";
    $rs = sql($sql);
    list($main_bbs_name, $main_bbs_content, $main_bbs_post_by_id, $main_bbs_post_by_time, $main_bbs_is_fine, $main_bbs_is_lock, $main_bbs_is_sticky) = $rs->fetch_row();
    $main_bbs_post_by_user_name = value::get_game_user_value("name", $main_bbs_post_by_id);
    echo "标题:";
    if ($main_bbs_is_sticky) {
        echo "<img src='res/img/system/bbs_sticky.png'>";
    }
    if ($main_bbs_is_fine) {
        echo "<img src='res/img/system/bbs_fine.png'>";
    }
    if ($main_bbs_is_lock) {
        echo "<img src='res/img/system/bbs_lock.png'>";
    }
    echo "{$main_bbs_name}<br>作者:";
    if (value::get_game_user_value('is_online', $main_bbs_post_by_id)) {
        cmd::addcmd("e12,{$main_bbs_post_by_id},12", $main_bbs_post_by_user_name);
    } else {
        echo $main_bbs_post_by_user_name;
    }
    echo "<br>时间:{$main_bbs_post_by_time}<br>内容:<br>{$main_bbs_content}<br>回复:";
    //帖子是否锁定
    if (!$main_bbs_is_lock) {
        //回复
        $danye_count = 5;
        $start_count = $danye_count * $yeshu;
        $bbs_count = 0;
        $sql = "SELECT `content`,`post_by_id`,`post_by_time` FROM `game_bbs` WHERE `main_bbs_id`=$main_bbs_id ORDER BY `id` ASC LIMIT $start_count,$danye_count";
        //查询回复
        $rs = sql($sql);
        while (list($bbs_content, $bbs_post_by_id, $bbs_post_by_time) = $rs->fetch_row()) {
            $bbs_count++;
            br();
            $bbs_post_by_user_name = value::get_game_user_value("name", $bbs_post_by_id);
            echo ($start_count + $bbs_count) . " .{$bbs_content}";
            br();
            if (value::get_game_user_value('is_online', $bbs_post_by_id)) {
                cmd::addcmd("e12,{$bbs_post_by_id},12", $bbs_post_by_user_name);
            } else {
                echo $bbs_post_by_user_name;
            }
            echo " {$bbs_post_by_time}";
        }
        br();
        if (!$bbs_count) {
            echo "快来抢沙发吧!";
            br();
        }
        //翻页系统
        $is_br = false;
        //帖子回复
        $sql = "SELECT COUNT(*) FROM `game_bbs` WHERE `main_bbs_id`=$main_bbs_id";
        $rs = sql($sql);
        list($main_bbs_count) = $rs->fetch_row();
        //当前所在页 帖子总页数
        $current_page = $yeshu + 1;
        $total_pages = (int)(($main_bbs_count - 1) / $danye_count) + 1;
        //上下页
        if ($current_page > 1) {
            $is_br = true;
            if ($yeshu > 1) {
                cmd::addcmd("e157,{$main_bbs_id},{$mode}", '首页');
                echo "|";
            }
            cmd::addcmd("e157,{$main_bbs_id},{$mode}," . ($yeshu - 1), "上—页");
        }
        if ($current_page < $total_pages) {
            if ($is_br) {
                echo "|";
            }
            cmd::addcmd("e157,{$main_bbs_id},{$mode}," . ($yeshu + 1), "下—页");
            if ($yeshu + 2 < $total_pages) {
                echo "|";
                cmd::addcmd("e157,{$main_bbs_id},{$mode}," . ($total_pages - 1), '末页');
            }
        }
        $url = cmd::addcmd("e158,{$main_bbs_id}", "快速回复", false, true);
        echo <<<setpageform
<form action="{$url}" method="post">
<input type="text" name="reply" maxlength="50" placeholder="快速回复">
<button type="submit">回复</button>
</form>
setpageform;
    } else {
        echo "<br>帖子已锁,无法回复。";
        br();
    }
    //版主操作
    if (value::get_game_user_value("is_bbs_banzhu", $user_id)) {
        if ($main_bbs_is_sticky) {
            cmd::addcmd("e160,$main_bbs_id,5", "取消置顶");
        } else {
            cmd::addcmd("e160,$main_bbs_id,1", "置顶帖子");
        }
        br();
        if ($main_bbs_is_lock) {
            cmd::addcmd("e160,$main_bbs_id,6", "取消锁定");
        } else {
            cmd::addcmd("e160,$main_bbs_id,2", "锁定帖子");
        }
        br();
        if ($main_bbs_is_fine) {
            cmd::addcmd("e160,$main_bbs_id,7", "取消加精");
        } else {
            cmd::addcmd("e160,$main_bbs_id,3", "加精帖子");
        }
        br();
        cmd::addcmd("e160,$main_bbs_id,4", "删除帖子");
        br();
    }
    //返回操作
    cmd::addcmd("e44,{$mode}," . value::get_user_value('bbs.look.yeshu'), "返回论坛");
}

//传奇
//论坛 回复帖子
function e158($main_bbs_id)
{
    $user_id = uid();
    if (value::get_user_value('jinyan', $user_id) > time()) {
        $jinyan_banzhu_id = value::get_user_value("jinyan.banzhu.id", $user_id);
        $jinyan_banzhu_name = value::get_game_user_value('name', $jinyan_banzhu_id);
        echo "你被{$jinyan_banzhu_name}禁言" . user::get_jinyan_str($user_id) . ",无法地区聊天与论坛发帖及回复。";
        br();
        cmd::addcmd("e157,{$main_bbs_id}", "返回帖子");
        return;
    }
    $content = value::real_escape_string($_POST['reply']);
    if ($content) {
        echo "回复成功。";
        br();
        value::set_bbs_value($main_bbs_id, 'last_reply_time', date("Y-m-d H:i:s"));
        value::add_bbs_value($main_bbs_id, 'reply_the_number', 1);
        sql("INSERT INTO `game_bbs` (`content`,`main_bbs_id`,`post_by_id`) VALUES('$content','$main_bbs_id','$user_id')");
    } else {
        echo "输入有误,请重新输入。";
        br();
    }
    e157($main_bbs_id);
}

//传奇论坛 发布帖子
function e159($old_name = "", $old_content = "")
{
    $user_id = uid();
    if (value::get_user_value('jinyan', $user_id) > time()) {
        $jinyan_banzhu_id = value::get_user_value("jinyan.banzhu.id", $user_id);
        $jinyan_banzhu_name = value::get_game_user_value('name', $jinyan_banzhu_id);
        echo "你被{$jinyan_banzhu_name}禁言" . user::get_jinyan_str($user_id) . ",无法地区聊天与论坛发帖及回复。";
        br();
        cmd::addcmd("e44", "返回论坛");
        return;
    }
    $name = value::real_escape_string($_POST['name']);
    $content = value::real_escape_string($_POST['content']);
    if ($name && $content) {
        if (c_check_str($name, 0, 20)) {
            if (c_check_str($content, 0, 1000)) {
                $sql = "INSERT INTO `game_bbs` (`name`,`content`,`post_by_id`,`is_main_bbs`) VALUES('$name','$content','$user_id','1')";
                sql($sql);
                $rs = sql("SELECT LAST_INSERT_ID()");
                list($new_bbs_id) = $rs->fetch_row();
                value::set_bbs_value($new_bbs_id, 'last_reply_time', date("Y-m-d H:i:s"));
                echo "帖子发表成功。";
                br();
                e157($new_bbs_id);
                return;
            } else {
                echo "帖子内容违规。";
                br();
                $_POST['content'] = "";
                e159($name, $content);
                return;
            }
        } else {
            echo "帖子标题违规。";
            br();
            $_POST['name'] = "";
            e159($name, $content);
            return;
        }
    } else {
        $url = cmd::addcmd("e159", "发表帖子", false, true);
        echo <<<setpageform
<form action="{$url}" method="post">
标题:<input type="text" name="name" maxlength="50" value="{$old_name}">
<br>
内容:<input type="text" name="content" maxlength="1000" value="{$old_content}">
<br>
<button type="submit">发表</button>
</form>
setpageform;
    }
    cmd::addcmd("e44", "返回论坛");
}

//传奇论坛 版主操作
function e160($bbs_id, $mode, $step)
{
    $bbs_name = value::get_bbs_value($bbs_id, 'name');
    $miaoshu = "";
    switch ($mode) {
        case 1:
            $miaoshu = "置顶";
            break;
        case 2:
            $miaoshu = "锁定";
            break;
        case 3:
            $miaoshu = "加精";
            break;
        case 4:
            $miaoshu = "删除";
            break;
        case 5:
            $miaoshu = "取消置顶";
            break;
        case 6:
            $miaoshu = "取消锁定";
            break;
        case 7:
            $miaoshu = "取消加精";
            break;
        default:
            break;
    }
    if (!$step) {
        echo "你确定要{$miaoshu}《{$bbs_name}》这篇帖子吗?";
        br();
        cmd::addcmd("e160,$bbs_id,$mode,1", $mode > 4 ? "确定取消" : "确定{$miaoshu}");
        br();
        cmd::addcmd("e157,{$bbs_id}", "返回帖子");
    } else {
        switch ($mode) {
            case 1:
                value::set_bbs_value($bbs_id, 'is_sticky', 1);
                break;
            case 2:
                value::set_bbs_value($bbs_id, 'is_lock', 1);
                break;
            case 3:
                value::set_bbs_value($bbs_id, 'is_fine', 1);
                break;
            case 4:
                sql("DELETE FROM `game_bbs` WHERE `id`=$bbs_id OR `main_bbs_id`=$bbs_id");
                break;
            case 5:
                value::set_bbs_value($bbs_id, 'is_sticky', 0);
                break;
            case 6:
                value::set_bbs_value($bbs_id, 'is_lock', 0);
                break;
            case 7:
                value::set_bbs_value($bbs_id, 'is_fine', 0);
                break;
            default:
                break;
        }
        echo "你{$miaoshu}了《{$bbs_name}》这篇帖子。";
        br();
        if ($mode != 4) {
            e157($bbs_id);
        } else {
            e44();
        }
        return;
    }
}

//角色 版主操作
function e161($o_user_id, $step = 0)
{
    $userid = uid();
    $user_name = value::get_game_user_value("name", $userid);
    $o_user_name = value::get_game_user_value('name', $o_user_id);
    if (!$step) {
        echo "你将对{$o_user_name}禁言1-24小时,禁言后对方无法在地区聊天与论坛发帖及回复。慎用版主权限,避免账号惩罚。";
        br();
        $url = cmd::addcmd("e161,{$o_user_id},1", "禁言", false, true);
        echo <<<jinyan
        <form action="{$url}" method="post">
小时:<input name="hour" type="number" min="1" max="24" value="1"><br>
<button type="submit" value="确定">确定禁言</button>
</form>
jinyan;
    } else if ($step == 1) {
        $hour = (int)post::get("hour");
        if ($hour > 0 && $hour < 25) {
            value::set_user_value("jinyan", time() + 3600 * $hour, $o_user_id);
            value::set_user_value("jinyan.banzhu.id", $userid, $o_user_id);
            echo "你成功将{$o_user_name}禁言{$hour}小时。";
            br();
            c_add_xiaoxi("你被{$user_name}禁言{$hour}小时,请你谨言慎行。", 0, $userid, $o_user_id);
            e12($o_user_id);
        } else {
            echo "请输入1-24小时的惩罚。";
            br();
            e161($o_user_id);
        }
        return;
    } else if ($step == 2) {
        echo "你将对{$o_user_name}解除禁言,解除后对方可以在地区聊天与论坛发帖及回复。慎用版主权限,避免账号惩罚。";
        br();
        cmd::addcmd("e161,{$o_user_id},3", "确定解除");
        br();
    } else if ($step == 3) {
        value::set_user_value("jinyan", time() - 1, $o_user_id);
        value::set_user_value("jinyan.banzhu.id", $userid, $o_user_id);
        echo "你成功将{$o_user_name}解除禁言。";
        br();
        c_add_xiaoxi("{$user_name}解除了你的禁言,今后请谨言慎行。", 0, $userid, $o_user_id);
        e12($o_user_id);
        return;
    }
    cmd::addcmd("e12,{$o_user_id}", "返回上级");
}

//商城 VIP系统
function e162()
{
    $vip_lvl = user::getVipLvl();
    $r_money = user::get("recharge_money");
    $vip_lvl_arr = config::getConfigByName("vip_lvl");
    $vip_libao_arr = config::getConfigByName("vip_libao");
    $up_money = $vip_lvl_arr[$vip_lvl + 1] - $r_money;
    if ($up_money > 0) {
        $next_lvl = $vip_lvl + 1;
    }
    $exp_jc = 10 * $vip_lvl;
    $money_jc = 10 * $vip_lvl;
    $dl_jc = 10 * $vip_lvl;
    cmd::addcmd('e13', '状态');
    echo ">> VIP礼包";
    br();
    echo "-";
    br();
    echo "尊贵的", user::showVipLogo(0, false), " ", user::get_game_user("name");
    br();
    //VIP礼包物品1数组 物品2数组
    $vip_item_arr = $vip_libao_arr[$vip_lvl];
    echo "-";
    br();
    if ($vip_lvl) {
        for ($i = 1; $i <= $vip_lvl; $i++) {
            $t_m = $i;
            $l_m = user::get("vip{$i}_last_month");
            if ($t_m != $l_m) {
                echo user::showVipLogo(0, false, $i);
                cmd::addcmd('e209,' . $i, '礼包领取');
                br();
            }
        }
        echo user::showVipLogo(0, false) . "礼包详情如下:";
        br();
        foreach ($vip_item_arr as $item_id => $item_count) {
            echo value::get_item_value($item_id, "name"), "*", $item_count, value::get_item_value($item_id, "liangci");
            $item_lingshi = value::get_item_value($item_id, "lingshi");
            if (!$item_lingshi) {
                echo "(无价之宝)";
            } else {
                echo "(", $item_lingshi * $item_count, "元宝)";
            }
            br();
        }
        echo user::showVipLogo(0, false) . "特权详情如下:";
        echo <<<html
        <br>
{$exp_jc}%经验加成
<br>
{$money_jc}%金钱加成
<br>
{$dl_jc}%掉落加成
<br>
VIP上线广播:
<br>
html;
    } else {
        echo "暂时没有您可以领取的礼包!";
        br();
    }
    echo "-";
    br();
    if ($up_money > 0) {
        echo "再充值{$up_money}元即可升级到" . user::showVipLogo(0, false, $next_lvl);
        echo "   ";
        cmd::addcmd('xyj_e162', '查看');
    } else {
        echo "恭喜您已经达到最尊贵的" . user::showVipLogo(0, false);
    }
    br();
    echo "-";
    br();
    cmd::addcmd('e216', '充值元宝');
    br();
    cmd::addcmd('e31', '返回商城');
}

//商城 VIP系统
function xyj_e162()
{
    $vip_lvl = user::getVipLvl();
    $r_money = user::get("recharge_money");
    $vip_lvl_arr = config::getConfigByName("vip_lvl");
    $vip_libao_arr = config::getConfigByName("vip_libao");
    $up_money = $vip_lvl_arr[$vip_lvl + 1] - $r_money;
    if ($up_money > 0) {
        $next_lvl = $vip_lvl + 1;
    }
    $exp_jc = 10 * $vip_lvl;
    $money_jc = 10 * $vip_lvl;
    $dl_jc = 10 * $vip_lvl;
    cmd::addcmd('e13', '状态');
    echo ">> VIP礼包";
    br();
    echo "-";
    br();
    echo "尊贵的", user::showVipLogo(0, false), " ", user::get_game_user("name");
    br();
    //VIP礼包物品1数组 物品2数组
    $vip_item_arr = $vip_libao_arr[$vip_lvl];
    echo "-";
    br();
    $vip_lvl++;
    $vip_item_arr = $vip_libao_arr[$vip_lvl];
    $exp_jc = 10 * $vip_lvl;
    $money_jc = 10 * $vip_lvl;
    $dl_jc = 10 * $vip_lvl;
    if ($up_money > 0) {
        echo user::showVipLogo(0, false, $next_lvl) . "礼包详情如下:";
        br();
        foreach ($vip_item_arr as $item_id => $item_count) {
            echo value::get_item_value($item_id, "name"), "*", $item_count, value::get_item_value($item_id, "liangci");
            $item_lingshi = value::get_item_value($item_id, "lingshi");
            if (!$item_lingshi) {
                echo "(无价之宝)";
            } else {
                echo "(", $item_lingshi * $item_count, "元宝)";
            }
            br();
        }
        br();
        echo user::showVipLogo(0, false, $next_lvl) . "特权详情如下:";
        br();
        echo <<<html
{$exp_jc}%经验加成
<br>
{$money_jc}%金钱加成
<br>
{$dl_jc}%掉落加成
<br>
温馨提示:升级VIP时可以立即领取新的礼包!
<br>
html;
    }
    cmd::addcmd('e162', '返回VIP');
    br();
    cmd::addcmd('e31', '返回商城');
}

//商城 累充系统
function lc_e162()
{
    $vip_lvl = user::getVipLvl();
    $r_money = user::get("recharge_money");
    $vip_lvl_arr = config::getConfigByName("vip_lvl");
    $vip_libao_arr = config::getConfigByName("vip_libao");
    $up_money = $vip_lvl_arr[$vip_lvl + 1] - $r_money;
    if ($up_money > 0) {
        $next_lvl = $vip_lvl + 1;
    }
    $exp_jc = 10 * $vip_lvl;
    $money_jc = 10 * $vip_lvl;
    $dl_jc = 10 * $vip_lvl;
    cmd::addcmd('e13', '状态');
    echo ">> 累充礼包";
    br();
    echo "-";
    br();
    echo "尊贵的", user::showVipLogo(0, false), " ", user::get_game_user("name");
    br();
    echo "-";
    br();
    $vip_leijichongzhi_libao_arr = config::getConfigByName("vip_leijichongzhi_libao");
    foreach ($vip_leijichongzhi_libao_arr as $l_rmoney => $v) {
        if ($r_money < $l_rmoney) {
            $n_money = $l_rmoney - $r_money;
            echo "-";
            br();
            echo "再充值{$n_money}元即可获得{$l_rmoney}元累计充值礼包:";
            br();
            foreach ($v as $lname => $ldata) {
                if (is_array($ldata)) {
                    switch ($lname) {
                        case "prop":
                            foreach ($ldata as $p_id => $p_data) {
                                echo "（" . prop::get_star_str($p_data["star"]) . "）" . value::get_prop_value($p_id, "name") . "*" . $p_data["count"] . value::get_prop_value($p_id, "liangci");
                                br();
                            }
                            break;
                        case "item":
                            foreach ($ldata as $item_id => $item_data) {
                                echo value::get_item_value($item_id, 'name') . "*" . $item_data["count"] . "(" . value::get_item_value($item_id, 'lingshi') . "元宝)";
                                br();
                            }
                            break;
                    }
                }
            }
            break;
        } else {
            if (!user::get("vip.ljcz.libao.{$l_rmoney}")) {
                echo "{$l_rmoney}元累计充值礼包 ";
                cmd::addcmd("e218," . $l_rmoney, "领取");
                br();
            }
        }
    }
    echo "-";
    br();
    cmd::addcmd('e216', '充值元宝');
    br();
    cmd::addcmd('e31', '返回商城');
}

//宠物袋 一键炼化
function e163($step = 0)
{
    $user_id = uid();
    if (!$step) {
        $sql = "SELECT `name`,`lvl` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=3 ORDER BY `lvl` ASC LIMIT 10";
        $result = sql($sql);
        if ($result->num_rows) {
            echo "以下宠物将被一键炼化:";
            br();
            while (list($oname, $olvl) = $result->fetch_row()) {
                echo $oname . '(' . $olvl . '级) ';
                br();
            }
            cmd::addcmd("e163,1", "开始炼化");
            br();
        } else {
            echo "没有可以炼化的宠物。";
            br();
        }
    } else if ($step == 1) {
        $cmd = cmd::addcmd('e163,2', '炼化', false);
        $lianhua_moren_jinqian = value::get_user_value('lianhua_moren_jinqian');
        if (!$lianhua_moren_jinqian) {
            $lianhua_moren_jinqian = 1;
        }
        echo <<<lianhuaform
你要给每只宠物花多少金币炼化?(1-10000)<br>
<form action="game.php?cmd=$cmd" method="post" name="lianhua_form">
    <input type="text" name="money" maxlength="5" value="{$lianhua_moren_jinqian}">
    <br>
    <input type="submit"  value="确定炼化" name="炼化">
</form>
lianhuaform;
        cmd::addcmd('e163', '返回上级');
        return;
    } else if ($step == 2) {
        $money = (int)value::real_escape_string($_POST['money']);
        if ($money < 1 || $money > 10000) {
            echo "金币输入有误,请重新输入。";
            br();
            e163(1);
            return;
        } else {
            value::set_user_value('lianhua_moren_jinqian', $money);
        }
        $today = date("Y-m-d");
        $lianhua_day = value::get_user_value("lianhua.day", $user_id);
        if ($today != $lianhua_day) {
            value::set_user_value("lianhua.day", $today, $user_id);
            value::set_user_value("lianhua.today.counts", 0, $user_id);
        }
        $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=3 ORDER BY `lvl` ASC";
        $rs = sql($sql);
        while (list($pet_id) = $rs->fetch_row()) {
            if (value::get_user_value("lianhua.today.counts", $user_id) <= 100) {
                value::add_user_value("lianhua.today.counts", 1, $user_id);
                $sql = "SELECT `pet_id`,`name`,`lvl`,`xingge` FROM `game_pet` WHERE `id`={$pet_id} LIMIT 1";
                $result = sql($sql);
                list($zzid, $name, $lvl, $xingge) = $result->fetch_row();
                $shuxing = value::getvalue('pet', 'shuxing', 'id', $zzid);
                $pet_star = value::getvalue('pet', 'star', 'id', $zzid);
                $beibaofuzhong = user::get_fuzhong();
                $beibaorongliang = user::get_rongliang();
                if ($beibaofuzhong < $beibaorongliang) {
                    if (item::add_money(-1 * $money)) {
                        //宠物熟练度
                        $lianyao_shulian = (int)($pet_star * $lvl / 100);
                        $lianyao_shulian = $lianyao_shulian < 1 ? 1 : $lianyao_shulian;
                        //金钱概率
                        $moneygl = (int)($money / 1000);
                        $moneygl = $moneygl < 1 ? 1 : $moneygl;
                        //炼妖熟练度 炼化概率
                        $lhsl = (int)value::get_user_value('lianyao.shulian');
                        $lhgl = 500;
                        if (mt_rand(1, $lhgl) <= $lhsl && mt_rand(1, 10) <= $moneygl) {
                            if (mt_rand(1, 10) > 1) {
                                $t_shuxing = explode(' ', $shuxing);
                                $zhushuxing = $t_shuxing[0];
                                $lw_name = '';
                                $pinzhi = "";
                                if (strstr($zhushuxing, '金') || strstr($zhushuxing, '人')) {
                                    $mode = 2;
                                    $lw_name = 'pugong';
                                }
                                if (strstr($zhushuxing, '木') || strstr($zhushuxing, '仙')) {
                                    $mode = 2;
                                    $lw_name = 'pufang';
                                }
                                if (strstr($zhushuxing, '水') || strstr($zhushuxing, '妖')) {
                                    $mode = 2;
                                    $lw_name = 'tegong';
                                }
                                if (strstr($zhushuxing, '火') || strstr($zhushuxing, '风')) {
                                    $mode = 2;
                                    $lw_name = 'tefang';
                                }
                                if (strstr($zhushuxing, '土') || strstr($zhushuxing, '雷')) {
                                    $mode = 2;
                                    $lw_name = 'hp';
                                }
                                if (strstr($zhushuxing, '动')) {
                                    $mode = 2;
                                    $lw_name = 'minjie';
                                }
                                if (strstr($zhushuxing, '日') || strstr($zhushuxing, '月')) {
                                    $mode = 3;
                                }
                                //随机装备
                                $sql = "SELECT `id` FROM `prop` WHERE `leixing`={$mode}";
                                if ($lw_name) {
                                    $sql .= " AND `{$lw_name}`>0";
                                }
                                //装备品质
                                $star = (int)($pet_star * $lvl / 100);
                                $star = $star <= 1 ? 1 : $star;
                                $star = $star >= 5 ? 5 : $star;
                                $star = mt_rand(1, $star);
                                //装备星级
                                $prop_star = (int)($pet_star * $lvl / 75);
                                $prop_star = $prop_star <= 1 ? 1 : $prop_star;
                                $prop_star = $prop_star >= 8 ? 8 : $prop_star;
                                $prop_star = mt_rand(1, $prop_star);
                                if ($mode == 2) {
                                    $sql .= " AND `star`={$prop_star}";
                                }
                                $sql .= " ORDER BY RAND() LIMIT 1";
                                //生成装备
                                $result = sql($sql);
                                list($prop_id) = $result->fetch_row();
                                $prop_name = value::get_prop_value($prop_id, 'name');
                                $liangci = value::get_prop_value($prop_id, 'liangci');
                                $new_prop_id = prop::new_prop($prop_id, 0, $star);
                                echo "{$name}化作一缕青烟,留下了1{$liangci}{$prop_name}。";
                                prop::user_get_prop($new_prop_id, 0, 1, false, true);
                                switch ($star) {
                                    case 1:
                                        $pinzhi = '残品';
                                        break;
                                    case 2:
                                        $pinzhi = '次品';
                                        break;
                                    case 3:
                                        $pinzhi = '正品';
                                        break;
                                    case 4:
                                        $pinzhi = '优品';
                                        break;
                                    case 5:
                                        $pinzhi = '极品';
                                        break;
                                }
                                if (($mode == 2 && $prop_star > 4) || ($mode == 3 && $star > 3)) {
                                    c_add_guangbo(value::get_game_user_value('name') . "炼化{$name},得到了1{$liangci}{$pinzhi}{$prop_name}。");
                                }
                                value::add_user_value('mssjshu', '1');
                                value::add_user_value('lianyao.shulian', $lianyao_shulian * 2);
                            } else {
                                $item_id = mt_rand(62, 74);
                                $item_name = value::get_item_value($item_id, 'name');
                                $item_liangci = value::get_item_value($item_id, 'liangci');
                                item::add_item($item_id, 1, false);
                                echo "{$name}化作一缕青烟,留下了1{$item_liangci}{$item_name}。";
                                c_add_guangbo(value::get_game_user_value('name') . "炼化{$name},得到了1{$item_liangci}{$item_name}。");
                                value::add_user_value('mssjshu', '1');
                                value::add_user_value('lianyao.shulian', $lianyao_shulian * 2);
                            }
                        } else {
                            echo "{$name}化作一缕青烟,什么都没有留下。";
                            value::add_user_value('lianyao.shulian', $lianyao_shulian);
                        }
                        pet::del_pet($pet_id);
                        br();
                    } else {
                        break;
                    }
                } else {
                    echo "背包已满,请先清理背包。";
                    br();
                    break;
                }
            } else {
                echo "每日炼化次数已使用完。";
                br();
                break;
            }
        }
    }
    cmd::addcmd('e77', '返回上级');
}

//排行 明月榜
function e164($mode = 0)
{
    if (!$mode) {
        $i = 0;
        echo '[明月榜]';
        br();
        $sql = "SELECT `userid`,`value` FROM `game_user_value` WHERE `userid`>0 AND `value`!='0' AND `valuename` LIKE '%.used_lingshi' ORDER BY CONVERT(`value`,SIGNED) DESC LIMIT 0,50 ";
        $result = sql($sql);
        while (list($oid, $ovalue) = $result->fetch_row()) {
            $i++;
            $phname = value::get_game_user_value('name', $oid);
            echo $i . '.';
            if (value::get_game_user_value('is_online', $oid)) {
                cmd::addcmd('e12,' . $oid . ',15', $phname);
            } else {
                cmd::addcmd('e12,' . $oid . ',15', $phname);
            }
            echo '(' . $ovalue . ')';
            br();
        }
        if (!$i) {
            echo '暂时无人上榜。';
            br();
        }
        cmd::addcmd("e164,1", "我要上榜");
    } else {
        echo "传奇明月,参与重现传奇荣光的玩家才能登上明月榜。";
        br();
        cmd::addcmd("e164", '返回上级');
    }
}

//排行 神兽榜
function e165($mode = 0)
{
    $i = 0;
    switch ($mode) {
        case 1:
            echo '[天地灵兽]';
            br();
            $sql = "SELECT  `id`,`name`,`star`,(`max_hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) FROM `game_pet` WHERE `master_id`>0 ORDER BY (`max_hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                $i++;
                echo $i . '.';
                echo $oname, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                br();
            }
            break;
        case 2:
            echo '[生命之泉]';
            br();
            $sql = "SELECT  `id`,`name`,`star`,`max_hp` FROM `game_pet` WHERE `master_id`>0 ORDER BY `max_hp` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                $i++;
                echo $i . '.';
                echo $oname, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                br();
            }
            break;
        case 3:
            echo '[攻击之王]';
            br();
            $sql = "SELECT  `id`,`name`,`star`,`pugong` FROM `game_pet` WHERE `master_id`>0 ORDER BY `pugong` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                $i++;
                echo $i . '.';
                echo $oname, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                br();
            }
            break;
        case 4:
            echo '[防御之岳]';
            br();
            $sql = "SELECT  `id`,`name`,`star`,`pufang` FROM `game_pet` WHERE `master_id`>0 ORDER BY `pufang` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                $i++;
                echo $i . '.';
                echo $oname, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                br();
            }
            break;
        case 5:
            echo '[魔攻之神]';
            br();
            $sql = "SELECT  `id`,`name`,`star`,`tegong` FROM `game_pet` WHERE `master_id`>0 ORDER BY `tegong` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                $i++;
                echo $i . '.';
                echo $oname, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                br();
            }
            break;
        case 6:
            echo '[魔防之壁]';
            br();
            $sql = "SELECT  `id`,`name`,`star`,`tefang` FROM `game_pet` WHERE `master_id`>0 ORDER BY `tefang` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                $i++;
                echo $i . '.';
                echo $oname, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                br();
            }
            break;
        case 7:
            echo '[灵活之影]';
            br();
            $sql = "SELECT  `id`,`name`,`star`,`minjie` FROM `game_pet` WHERE `master_id`>0 ORDER BY `minjie` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $oname, $star, $o_liuwei) = $result->fetch_row()) {
                $i++;
                echo $i . '.';
                echo $oname, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', pet::get($o_id, 'master_id')), ')';
                br();
            }
            break;
        default:
            cmd::addcmd("e165,1", "天地灵兽");
            br();
            cmd::addcmd("e165,2", "生命之泉");
            br();
            cmd::addcmd("e165,3", "攻击之王");
            br();
            cmd::addcmd("e165,4", "防御之岳");
            br();
            cmd::addcmd("e165,5", "魔攻之神");
            br();
            cmd::addcmd("e165,6", "魔防之壁");
            br();
            cmd::addcmd("e165,7", "灵活之影");
            break;
    }
    if ($mode) {
        if (!$i) {
            echo '暂时无将上榜。';
            br();
        }
        cmd::addcmd("e165", '返回上级');
    }
}

//首页 攻略助手
function e166()
{
    ctm::show_ctm("ctm_shouye");
}

//系统 合成系统
function e167($step = 0, $tmp_str = "")
{
    if (!$step) {
        $url = cmd::addcmd("e167,1," . $tmp_str, "求取ID", false, true);
        echo <<<pet_form
               合成公式:
       <form action="$url" method="post">
                            <input type="text" id="a" name="pet_3_name" width="25px">
                                   =
       <input type="text"  name="pet_1_name" width="25px">
       +
              <input type="text" name="pet_2_name" width="25px">
                     <br>
                     <input type="submit" value="提交">
       </form> 
<script>
var a=document.getElementById('a');
a.focus();
</script>
pet_form;
        cmd::addcmd("pet::check_hechonggongshi", "查看公式");
    } else {
        $pet_1_name = post::get('pet_1_name');
        $pet_2_name = post::get('pet_2_name');
        $pet_3_name = post::get('pet_3_name');
        $tmp_str .= "x'" . value::getvalue('pet', 'id', 'name', $pet_1_name) . "+" . value::getvalue('pet', 'id', 'name', $pet_2_name) . "'=>" . value::getvalue('pet', 'id', 'name', $pet_3_name);
        echo $tmp_str, "";
        br();
        e167(0, $tmp_str);
    }
    br();
    cmd::add_last_cmd("design_game");
}

//副本 进入山间小路
function e168($mode = 0)
{
    $user_id = uid();
    $today = date("Y-m-d");
    $in_sjxl_time = value::get_user_value('in_sjxl_time');
    if ($in_sjxl_time != $today) {
        value::set_user_value("in_sjxl_time", $today);
        value::set_user_value("in_sjxl_count", 0);
    }
    $once_money = 5000;
    $in_sjxl_count = value::get_user_value("in_sjxl_count");
    if ($in_sjxl_count < 5) {
        $need_money = $once_money;
    } else {
        $need_money = ($in_sjxl_count - 3) * $once_money;
    }
    if ($mode) {
        if (team::get_team_user_count(team::get_user_team($user_id)) > 2) {
            if (item::add_money(-1 * $need_money)) {
                value::set_game_user_value('in_map_id', '1025');
                value::add_user_value("in_sjxl_count", 1);
                e215(21);
            } else {
                cmd::set_return_game_br(false);
            }
        } else {
            echo "队伍人数大于3人方可进入山间小路副本。";
            br();
        }
        e0();
        return;
    } else {
        if (team::get_team_user_count(team::get_user_team($user_id)) > 2) {
            if (user::get_max_pet_lvl($user_id) > 40) {
                echo "你确定要花费{$need_money}金币进入山间小路副本吗?";
                br();
                cmd::addcmd('e168,1', '确定进入');
            } else {
                echo "玩家宠物等级大于40级方可进入山间小路副本。";
            }
        } else {
            echo "队伍人数大于3人方可进入山间小路副本。";
        }
    }
}

//副本 被动挑战
function e169($in_map_id)
{
    $user_id = uid();
    //进入地图
    value::set_game_user_value('in_map_id', $in_map_id, $user_id);
    //战斗准备
    $pk_npc_arr = array();
    $map_npc_arr = value::get_map_value($in_map_id, 'npc');
    $map_npc_arr = explode(',', $map_npc_arr);
    foreach ($map_npc_arr as $npc_id) {
        if (value::get_npc_value($npc_id, 'pet_id')) {
            array_push($pk_npc_arr, $npc_id);
        }
    }
    $pk_npc_count = count($pk_npc_arr);
    if ($pk_npc_count) {
        //获取队伍ID
        $team_id = team::get_user_team($user_id);
        //是否生成
        $shengcheng = true;
        //获取挑战NPC
        $npc_id = $pk_npc_arr[mt_rand(0, $pk_npc_count - 1)];
        $npc_name = value::get_npc_value($npc_id, 'name');
        //获取挑战NPC的宠物数组
        $pet_id_str = value::get_npc_value($npc_id, 'pet_id');
        $pet_id = 0;
        $pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($pet_arr as $pet_id) {
            $is_dead = value::get_pet_value($pet_id, 'is_dead');
            if (!$is_dead) {
                break;
            }
        }
        //开始事务
        sql("BEGIN");
        //获取队友是否正在战斗
        $sql = "SELECT 1 FROM `game_user` WHERE `team_id`={$team_id} AND `pk.npc.id`={$npc_id} LIMIT 1 FOR UPDATE";
        $result = sql($sql);
        list($team_is_pk_npc) = $result->fetch_row();
        //队伍验证
        if ($team_is_pk_npc) {
            $shengcheng = false;
        }
        //生成NPC宠物
        if ($shengcheng) {
            $pet_lvl_str = value::get_npc_value($npc_id, 'pet_lvl');
            $pet_id_arr = explode(',', $pet_id_str);
            $pet_lvl_arr = explode(',', $pet_lvl_str);
            $id_count = count($pet_id_arr);
            for ($i = 0; $i < $id_count; $i++) {
                pet::new_pet($pet_id_arr[$i], $pet_lvl_arr[$i], $in_map_id, 0, $npc_id, $user_id, $team_id);
            }
        }
        //设置挑战NPC的ID
        value::set_game_user_value('pk.npc.id', $npc_id, $user_id);
        //设置PK状态
        value::set_game_user_value('is_pk', '1', $user_id);
        //设置全宠物未PK
        sql("UPDATE `game_pet` SET `is_pk`=0 WHERE  `master_id`={$user_id} AND `master_mode`=1 LIMIT 5");
        //设置角色属性 出战宠物 回合数 对战宠物
        value::set_game_user_value('pk.now_pet.id', $pet_id, $user_id);
        value::set_user_value('pk.huihe', '0', $user_id);
        value::set_user_value("pk_win_money", 0, $user_id);
        value::set_user_value("pk_win_exp", 0, $user_id);
        value::set_user_value("last_beitouxi_time", time(), $user_id);
        //清除战斗信息
        $obj = new game_user_object($user_id);
        $obj->del("pk_chats");
        //组队挑战保存金钱经验
        if ($team_id) {
            //初始化等级经验
            $o_pet_money = 0;
            $o_pet_exp = 0;
            //获取剩余宠物
            $sql = "SELECT `id` FROM `game_pet` WHERE `npc_id`={$npc_id} AND `team_id`={$team_id} AND `is_dead`=0 ORDER BY `id` ASC LIMIT 5";
            $result = sql($sql);
            while (list($oid) = $result->fetch_row()) {
                //等级经验累加
                $o_pet_money = value::get_pet_value($oid, 'money');
                $o_pet_exp = value::get_pet_value($oid, 'exp');
            }
            //等级经验累加
            $o_pet_money = value::get_pet_value($oid, 'money');
            $o_pet_exp = value::get_pet_value($oid, 'exp');
            //计算获得金币 经验
            $u_in_map_id = value::get_game_user_value('in_map_id', $user_id);
            $u_in_map_is_duorenfuben = value::get_map_value($u_in_map_id, 'is_duorenfuben');
            $win_money = $o_pet_money;
            $win_exp = $o_pet_exp;
            $win_money = (int)$win_money;
            $win_exp = (int)$win_exp;
            //NPC额外经验奖励
            $win_exp *= 2;
            //队伍成员数量
            $team_user_count = team::get_team_user_count($team_id);
            //队伍最高三倍奖励
            $win_exp *= $team_user_count > 3 ? 3 : $team_user_count;
            //设置金钱经验
            value::set_user_value("pk_win_money", $win_money, $user_id);
            value::set_user_value("pk_win_exp", $win_exp, $user_id);
        }
        //组队播报
        $user_name = value::get_game_user_value('name', $user_id);
        $map_name = value::get_map_value($in_map_id, 'name');
        $team_user_arr = team::get_team_user($team_id);
        foreach ($team_user_arr as $team_user_id) {
            if ($team_user_id != $user_id) {
                c_add_xiaoxi("{$user_name}在{$map_name}被{$npc_name}偷袭了!", 0, $user_id, $team_user_id);
            }
        }
        //自我提示
        echo "你被{$npc_name}偷袭了!";
        br();
        //进入战斗
        value::set_user_value('pk.huihe.time', time(), $user_id);
        ctm::show_ctm('ctm_pk_team_npc');
        //提交事务
        sql("COMMIT");
    } else {
        e0();
    }
}

//组队副本 副本掉落
function e170($npc_id, $map_id, $team_id, $user_id)
{
    //物品数组
    $item_arr = array();
    //装备数组
    $prop_arr = array();
    //宠物卡数组
    $egg_arr = array();
    //地图名称
    $map_name = value::get_map_value($map_id, 'name');
    //所在区域
    $area_id = value::get_map_value($map_id, "area_id");
    //VIP等级
    $vip_lvl = user::getVipLvl($user_id);
    $wj_db = value::get_user_value('wj_db', $user_id);
    $wj_jy = value::get_user_value('wj_jy', $user_id);
    $xy_jc = $wj_db + 1 + $vip_lvl / 10;
    //读取掉落数据
    $diaoluo_arr = config::getConfigByName("npc_diaoluo");
    $diaoluo_arr = $diaoluo_arr[$area_id];
    //解析掉落数据
    foreach ($diaoluo_arr as $npc_kid => $npc_arr) {
        if ($npc_kid == $npc_id) {
            foreach ($npc_arr as $npc_key => $map_arr) {
                if ($npc_key == "*" || $npc_key == $map_name || $npc_key == $map_id) {
//                echo $npc_key,"______";
//                print_r($map_arr);
//                br();
                    foreach ($map_arr as $dl_arr_name => $dl_arr_data) {
//                        echo $dl_arr_name, "______";
//                        print_r($dl_arr_data);
//                        br();
                        switch ($dl_arr_name) {
                            case "item":
                                foreach ($dl_arr_data as $k => $v) {
                                    $gailv = explode(",", $v['r']);
                                    $need_gailv = $gailv[0] * $xy_jc;
                                    $max_gailv = $gailv[1];
                                    $ok = eval("return mt_rand(1,{$max_gailv});") <= $need_gailv ? true : false;
                                    if ($ok) {
                                        $item_arr[$k] = eval("return mt_rand({$v['c']});");
                                    }
                                }
                                break;
                            case "prop":
                                foreach ($dl_arr_data as $k => $v) {
                                    $gailv = explode(",", $v['r']);
                                    $need_gailv = $gailv[0] * $xy_jc;
                                    $max_gailv = $gailv[1];
                                    $ok = eval("return mt_rand(1,{$max_gailv});") <= $need_gailv ? true : false;
                                    if ($ok) {
                                        array_push($prop_arr, $k);
                                    }
                                }
                                break;
                            case "egg":
                                foreach ($dl_arr_data as $k => $v) {
                                    $gailv = explode(",", $v['r']);
                                    $need_gailv = $gailv[0] * $xy_jc;
                                    $max_gailv = $gailv[1];
                                    $ok = eval("return mt_rand(1,{$max_gailv});") <= $need_gailv ? true : false;
                                    if ($ok) {
                                        array_push($egg_arr, $k);
                                    }
                                }
                                break;
                        }
                    }
                }
            }
        }
    }
    //开始掉落
    //掉落物品
    foreach ($item_arr as $item_id => $item_count) {
        item::map_add_item($map_id, $item_id, 1);
        $sj = mt_rand(1, 10);
        $sj10 = mt_rand(0, 2);
        if ( $sj10 == 1) {
            if ($hy_xs_lvl > 0) {
                item::add_item(51, $sj);
            } else {
                item::map_add_item($map_id, 51, $sj);
            }
        }
    }
    //掉落装备
    foreach ($prop_arr as $prop_id) {
        $sj = mt_rand(1, 1000);
        if ($sj <= 10) {
            $sji = 3;
        } else if ($sj <= 50) {
            $sji = 2;
        } else if ($sj <= 100) {
            $sji = 1;
        } else {
            $sji = 0;
        }
        $cj_pet = value::get_npc_value($npc_id, 'name');
        $equip_id = prop::new_prop($prop_id, 0, $sji, $cj_pet);
        if (value::get_game_prop_value($equip_id, 'star1') > 0) {
            $ts_name = "恭喜玩家" . value::get_game_user_value('name') . "在" . value::get_map_value($map_id, 'name') . "击杀" . value::get_npc_value($npc_id, 'name') . "获得了1" . value::get_game_prop_zz_value($equip_id, 'liangci');
            c_add_guangbo($ts_name, $equip_id, 4);
            value::set_game_prop_value($equip_id, 'is_guangbo', 1);
        }
        prop::map_get_prop($map_id, $equip_id, $user_id);
    }
    //掉落宠物卡
    foreach ($egg_arr as $pet_id) {
        $egg_id = prop::new_pet_egg($pet_id);
        if (value::getvalue('pet', 'xiyou', 'id', $pet_id) > 4) {
            value::set_game_prop_value($egg_id, 'is_guangbo', 1);
        }
        prop::map_get_prop($map_id, $egg_id, $user_id);
    }
}

//宠物 锁定等级
function e171($pet_id, $mode)
{
    if (user::have_pet(0, $pet_id)) {
        $pet_name = pet::get($pet_id, 'name');
        $is_lock_lvl = value::get_pet_value2('is_lock_lvl', $pet_id);
        if (!$mode) {
            if ($is_lock_lvl) {
                echo "解锁等级后你的{$pet_name}将正常获得经验!";
            } else {
                echo "锁定等级后你的{$pet_name}将无法获得经验!";
            }
            br();
            if (!$is_lock_lvl) {
                cmd::addcmd("e171,$pet_id,1", "确认锁定");
            } else {
                cmd::addcmd("e171,$pet_id,2", "确认解锁");
            }
            br();
            cmd::addcmd('e62', '返回上级');
            return;
        } else if ($mode == 1) {
            $sql = "SELECT `lvl`,`max_lvl` FROM `game_pet` WHERE `id`={$pet_id} LIMIT 1";
            $result = sql($sql);
            list($lvl, $max_lvl) = $result->fetch_row();
            if ($max_lvl > 100 && $lvl < $max_lvl && $lvl > 100) {
                value::set_pet_value2('is_lock_lvl', 1, $pet_id);
                echo '锁定等级成功!';
            } else {
                echo '锁定等级失败!';
            }
            br();
        } else if ($mode == 2) {
            value::set_pet_value2('is_lock_lvl', 0, $pet_id);
            echo '解锁等级成功!';
            br();
        }
        e62();
    } else {
        echo '你已经没有这只宠物了!';
    }
}

//重生商店
function e172()
{
    $uname = value::get_game_user_value('name');
    $chongshengdian = value::get_user_value('chongshengdian');
    echo "{$uname},欢迎来到重生商店!";
    br();
    echo "  你有{$chongshengdian}点重生点  ";
    br();
    $sql = "SELECT `id`,`name`,`lingshi` FROM `item` WHERE `is_shangcheng`=1 ORDER BY LENGTH(`name`) ASC,`lingshi` ASC,`id` ASC";
    $result = sql($sql);
    while (list($oid, $oname, $olingshi) = $result->fetch_row()) {
        cmd::addcmd('e173,' . $oid, "{$oname}({$olingshi}重生点)");
        br();
    }
    echo " --";
    for ($i = 0; $i < strlen($chongshengdian); $i++) {
        echo "-";
    }
    br();
    cmd::addcmd('e0', '返回地图');
}

//重生商店 查看物品
function e173($item_id)
{
    $item_name = value::get_item_value($item_id, 'name');
    $item_desc = value::get_item_value($item_id, 'desc');
    $item_chongshengdian = value::get_item_value($item_id, 'lingshi');
    $cmd = cmd::addcmd("e174," . $item_id, '购买', false);
    echo <<<buyform
$item_name<br>$item_desc<br>价格:{$item_chongshengdian}重生点<br>
<form action="game.php?cmd=$cmd" method="post" name="buy_form">
    <input type="text" name="count" maxlength="8" value="1">
    <br>
    <input type="submit"  value="确定购买" name="购买">
</form>
buyform;
    cmd::addcmd('e172', '返回上级');
}

//重生商店 购买物品
function e174($item_id)
{
    $buy_ok = true;
    $buy_count = (int)value::real_escape_string($_POST['count']);
    if ($buy_count > 0) {
        $item_chongshengdian = value::get_item_value($item_id, 'lingshi');
        $need_chongshengdian = $item_chongshengdian * $buy_count;
        if (value::get_user_value('chongshengdian') >= $need_chongshengdian) {
            //失去重生点数
            echo "你失去了{$need_chongshengdian}点重生点。";
            br();
            value::add_user_value('chongshengdian', -1 * $need_chongshengdian);
            //增加消费重生点
            value::add_user_value('used_chongshengdian', $need_chongshengdian);
            //获取商城道具
            item::add_item($item_id, $buy_count, true, 0, true);
        } else {
            echo "你没有足够的重生点了,请重新输入。";
            br();
            $buy_ok = false;
        }
    } else {
        $buy_ok = false;
        echo "数量输入错误,请您重新输入。";
        br();
    }
    if ($buy_ok) {
        cmd::addcmd("e172", '返回上级');
    } else {
        cmd::addcmd("e173,{$item_id}", '返回上级');
    }
}

//帮派 帮派排行
function e176($yeshu = 0, $union_id = 0)
{
    if (!$union_id) {
        cmd::addcmd('e106', '帮派');
        echo "<< 排行";
        br();
        echo "-";
        //单页数量
        $danye_count = 15;
        $start_num = $yeshu * $danye_count;
        //帮派数量
        $sql = "SELECT COUNT(*) FROM `game_union` WHERE `status` = 1";
        $rs = sql($sql);
        list($union_count) = $rs->fetch_row();
        //获取预备帮派
        $i = 0;
        $sql = "SELECT `Id`,`name`,`type`,`money`/10000 FROM `game_union` WHERE `status` = 1 ORDER BY `money` DESC,`Id` LIMIT {$start_num},{$danye_count}";
        $rs = sql($sql);
        while (list($union_t_id, $union_t_name, $union_t_type, $union_t_money) = $rs->fetch_row()) {
            $i++;
            br();
            echo $start_num + $i, ".";
            cmd::addcmd("e176,$yeshu,$union_t_id", $union_t_name . union::get_type_name($union_t_type) . "(" . (int)$union_t_money . ")");
        }
        if (!$union_count) {
            br();
            echo "暂时没有正式帮派！";
            br();
            echo "-";
        }
        //上下页操作
        $fanye = true;
        $max_page_num = (int)(($union_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            br();
            $fanye = false;
            if ($yeshu > 1) {
                cmd::addcmd('e176', '首页');
                echo "|";
            }
            cmd::addcmd('e176,' . ($yeshu - 1), '上—页');
        }
        if ($union_count > ($yeshu + 1) * $danye_count) {
            if ($fanye) {
                br();
            }
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('e176,' . ($yeshu + 1), '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e176,' . ($max_page_num - 1), '末页');
            }
        }
        br();
        echo "-";
        br();
        cmd::add_last_cmd('e106');
    } else {
        union::show_union($union_id);
        br();
        cmd::addcmd("e184,$union_id", "成员列表");
        br();
        if (!user::get_union()) {
            cmd::addcmd("e191,$union_id", "申请加入");
            br();
        }
        echo "-";
        br();
        cmd::add_last_cmd("e176,$yeshu");
    }
}

//帮派 我的帮派
function e177()
{
    $union_id = value::get_game_user_value('gonghui.id');
    $union_u_lvl = value::get_game_user_value('gonghui.lvl');
    union::show_union($union_id);
    br();
    cmd::addcmd("e36,6", "帮派聊天");
    br();
    if (value::get_game_user_value("gonghui.lvl") < 2) {
        cmd::addcmd("e187", "帮派管理");
        br();
    }
    cmd::addcmd("e184,$union_id", "成员列表");
    br();
    cmd::addcmd("e185", "帮派贡献");
    br();
    cmd::addcmd("e197", "帮派仇人");
    br();
    cmd::addcmd("e180,$union_id", "捐献资金");
    br();
    cmd::addcmd("e186", "捐献宠物");
    if ($union_u_lvl) {
        br();
        cmd::addcmd("e196", "退出帮派");
    }
    br();
    cmd::add_last_cmd("e106");
}

//帮派 预备帮派
function e178($yeshu = 0, $union_id = 0)
{
    $user_id = uid();
    cmd::addcmd('e106', '帮派');
    echo "<< 预备";
    br();
    echo "-";
    br();
    if (!$union_id) {
        echo "预备帮派列表:";
        //单页数量
        $danye_count = 15;
        $start_num = $yeshu * $danye_count;
        //帮派数量
        $sql = "SELECT COUNT(*) FROM `game_union` WHERE `status` = 0";
        $rs = sql($sql);
        list($union_count) = $rs->fetch_row();
        //获取预备帮派
        $sql = "SELECT `Id`,`name`,`type` FROM `game_union` WHERE `status` = 0 LIMIT {$start_num},{$danye_count}";
        $rs = sql($sql);
        while (list($union_t_id, $union_t_name, $union_t_type) = $rs->fetch_row()) {
            br();
            cmd::addcmd("e178,$yeshu,$union_t_id", $union_t_name . union::get_type_name($union_t_type));
        }
        if (!$union_count) {
            br();
            echo "暂时没有预备帮派。";
        }
        //上下页操作
        $max_page_num = (int)(($union_count - 1) / $danye_count) + 1;
        if ($yeshu) {
            if ($yeshu > 1) {
                cmd::addcmd('e178', '首页');
                echo "|";
            }
            cmd::addcmd('e178,' . ($yeshu - 1), '上—页');
        }
        if ($union_count > ($yeshu + 1) * $danye_count) {
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('e178,' . ($yeshu + 1), '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e178,' . ($max_page_num - 1), '末页');
            }
        }
        br();
        echo "-";
        br();
        cmd::add_last_cmd('e106');
    } else {
        $creator_id = union::get($union_id, 'creator_id');
        $creator_name = value::get_game_user_value("name", $creator_id);
        $money = union::get($union_id, 'money');
        echo "帮派名称:", union::get($union_id, 'name'), union::get_type_name(union::get($union_id, 'type'));
        br();
        echo "筹集资金:", $money, "个金币";
        br();
        echo "创建者:";
        if (value::get_game_user_value('is_online', $creator_id)) {
            cmd::addcmd("e12,$creator_id", $creator_name);
        } else {
            echo $creator_name;
        }
        if (!user::get_union($user_id)) {
            br();
            cmd::addcmd("e180,$union_id", "捐献资金");
        }
        if ($money >= 1000000) {
            if (value::get_game_user_value('is_bbs_banzhu') || value::get_user_value('game_master')) {
                br();
                cmd::addcmd("e181,$union_id", "批准上线");
            }
        }
        br();
        echo "-";
        br();
        cmd::add_last_cmd("e178,$yeshu");
    }
}

//帮派 创建帮派
function e179($step = 0, $name = "", $type = 0)
{
    $user_id = uid();
    if (!value::get_game_user_value('gonghui.id')) {
        if (!$step) {
            $json_tx = json_encode(union::get_touxian());
            $post_url = cmd::addcmd('e179,1', '', false, true);
            echo <<<gonghui_form
<form action="{$post_url}" method="post">
帮派名称:
<input type="text" name="mingcheng" id="mingcheng" maxlength="3" onblur="quancheng()">
<br>
帮派类型:
<select name="leixing" id="leixing" onchange="quancheng()">
  <option value="1">军</option>
  <option value="2">帮</option>
  <option value="3">谷</option>
  <option value="4">寺</option>
  <option value="5">教</option>
  <option value="6">会</option>
  <option value="7">剑派</option>
  <option value="8">学院</option>
  <option value="9">道观</option>
  <option value="10">山庄</option>
</select>
<br>
帮派全称:<span id="quancheng" style="color:#0000ff">未取名</span>
<br>
<span id="touxian" style="color:#ff0000"></span>
<input type="submit" value="创建帮派">
</form>
<script>
function quancheng() {
    var tx_txt = '';
    var tx_obj = {$json_tx};
    var sl_obj = document.getElementById('leixing');
    var sl_index = sl_obj.selectedIndex;
    var sl_text = sl_obj.options[sl_index].text;
    var sl_value = sl_obj.options[sl_index].value;
    var mingcheng = document.getElementById('mingcheng');
    var quancheng = document.getElementById('quancheng');
    var touxian = document.getElementById('touxian');
    if (mingcheng.value) {
        tx_txt = "会长头衔:" + tx_obj[sl_value][0] + "<br>" + "副会头衔:" + tx_obj[sl_value][1] + "<br>" + "精英头衔:" + tx_obj[sl_value][2] + "<br>" + "高级头衔:" + tx_obj[sl_value][3] + "<br>" + "中级头衔:" + tx_obj[sl_value][4] + "<br>" + "低级头衔:" + tx_obj[sl_value][5] + "<br>" + "入门头衔:" + tx_obj[sl_value][6]+"<br>";
        touxian.innerHTML = tx_txt;
        quancheng.innerHTML = mingcheng.value + sl_text;
    } else {
        quancheng.innerHTML = '未取名';
        touxian.innerHTML = '';
    }
}
</script>
gonghui_form;
            cmd::add_last_cmd('e106');
        } else if ($step == 1) {
            $lvl = value::get_game_user_value('lvl');
            if ($lvl >= 30 || value::get_user_value('game_master')) {
                $i213 = item::get_item(213, $user_id);
                if ($i213 >= 1 || value::get_user_value('game_master')) {
                    $mingcheng = post::get('mingcheng');
                    //判断名称是否 中文 存在 长度
                    if (preg_match("/^[\x{4e00}-\x{9fa5}]+$/u", $mingcheng) && $mingcheng && mb_strlen($mingcheng) < 7) {
                        $leixing = (int)post::get('leixing');
                        if ($leixing > 0 && $leixing < 11) {
                            $sql = "SELECT 1 FROM `game_union` WHERE `name`= '$mingcheng' OR ( `creator_id` = $user_id AND `status` = 0 ) LIMIT 1";
                            $rs = sql($sql);
                            list($is_haved) = $rs->fetch_row();
                            if ($is_haved) {
                                echo "名称已经存在或你名下已有预备帮派!";
                            } else {
                                e179(2, $mingcheng, $leixing);
                                return;
                            }
                        } else {
                            echo "类型选择有误,请重新选择!";
                        }
                    } else {
                        echo "名称输入有误,需全中文,3字以内!";
                    }
                } else {
                    echo "创建帮派需要沃玛号角!";
                }
            } else {
                echo "玩家等级需达到30级方可创建帮派!";
            }
            br();
            cmd::add_last_cmd('e179');
        } else if ($step == 2) {
            $type_name = union::get_type_name($type);
            echo "你确定创建{$name}", $type_name, "吗?";
            br();
            cmd::addcmd("e179,3,$name,$type", '确定创建');
            br();
            cmd::add_last_cmd('e179');
        } else if ($step == 3) {
            $sql = "SELECT 1 FROM `game_union` WHERE `name`= '$name' OR ( `creator_id` = $user_id AND `status` = 0 ) LIMIT 1";
            $rs = sql($sql);
            list($is_haved) = $rs->fetch_row();
            if ($is_haved) {
                echo "名称已经存在或你名下已有预备帮派!";
            } else {
                $sql = "INSERT INTO `game_union` (`Id`, `name`, `type`, `status`, `creator_id`) VALUES (NULL,'$name','$type',0,'$user_id') ";
                sql($sql);
                if (!$GLOBALS['mysqli']->error) {
                    item::add_item(213, -1);
                    br();
                    echo "恭喜创建预备帮派成功,请筹集1000万金币的帮派资金,等待批准上线!";
                    br();
                    e178();
                } else {
                    echo "抱歉,创建预备帮派失败!";
                    br();
                    e179();
                }
                return;
            }
        }
    } else {
        echo "你已在帮派中,无法创建!";
        br();
        cmd::add_last_cmd('e106');
    }
}

//帮派 捐献资金
function e180($union_id, $step = 0)
{
    $user_id = uid();
    $in_union = user::get_union($user_id);
    $union_name = union::get_name($union_id);
    $min_money = 1;
    if ($in_union) {
        $min_money = 10000;
    }
    if (!$step) {
        $post_url = cmd::addcmd("e180,{$union_id},1", "", false, true);
        echo <<<juanxian
<form action="{$post_url}" method="post">
你要给{$union_name}捐献多少金币?
<br>
<input type="text" name="money" maxlength="7" value="$min_money">
<br>
<input type="submit" value="确认捐献">
</form>
juanxian;
    } else {
        $is_br = true;
        $money = (int)post::get("money");
        if ($in_union) {
            $max_money = 99999990;
        } else {
            $max_money = 10000000;
        }
        if ($money >= $min_money && $money <= $max_money) {
            if (!$in_union) {
                $max_money = $max_money - union::get($union_id, 'money');
                $money = $money > $max_money ? $max_money : $money;
            }
            if ($money) {
                if (item::add_money(-1 * $money)) {
                    union::add($union_id, 'money', $money);
                    if ($in_union) {
                        value::add_game_user_value("gonghui.gongxian", $money / 10000);
                    }
                    echo "你成功给{$union_name}捐献了{$money}个金币!";
                } else {
                    $is_br = false;
                }
            } else {
                echo "{$union_name}已成功筹集上线资金!";
            }
        } else {
            echo "金币输入有误,请重新输入!";
        }
        if ($is_br) {
            br();
        }
    }
    if (!$in_union) {
        cmd::add_last_cmd("e178,0,$union_id");
    } else {
        cmd::add_last_cmd("e177");
    }
}

//帮派 批准上线
function e181($union_id, $step = 0)
{
    $user_id = uid();
    $union_name = union::get_name($union_id);
    if (!$step) {
        echo "你确定要批准{$union_name}上线吗?";
        br();
        cmd::addcmd("e181,$union_id,1", "确定批准");
        br();
        cmd::add_last_cmd("e178,0,$union_id");
    } else {
        $creator_id = union::get($union_id, 'creator_id');
        if (!user::get_union($creator_id)) {
            //帮派操作
            union::add($union_id, 'money', -10000000);
            union::set($union_id, 'approver_id', $user_id);
            union::set($union_id, 'status', 1);
            //用户操作
            c_add_xiaoxi("{$union_name}已成功上线,请敏锐管理您的帮派!", 0, 0, $creator_id);
            value::set_game_user_value('gonghui.id', $union_id, $creator_id);
            value::set_game_user_value('gonghui.lvl', 0, $creator_id);
            value::set_game_user_value('gonghui.gongxian', 0, $creator_id);
            //管理操作
            echo "{$union_name}已成功上线,您已经被记录为此帮派的批准者!";
        } else {
            //管理操作
            echo "{$union_name}的创建者已有帮派,无法批准!";
        }
        br();
        e176();
    }
}

//起名事件职业介绍
function zy_e182($zy = 0)
{
    if ($zy == 0) {
        echo "<img src='rw6.png' >";
        echo "<span style='color:blue'>传奇指引大使：</span>";
        br();
        echo "<span style='color:green'>传奇为了给玩家一个真实世界感觉，<br>游戏中包括了白天、黑夜、贸易，物品等观念。<br>游戏中可以通过采矿、打猎等来获得货币，利用这些货币来进行贸易。<br>整个游戏是一个充满了魔力，具有东方色彩的极具冒险性的wap网络在线游戏。</span>";
        br();
        br();
        cmd::addcmd('zy_e182,1', '了解传奇职业');
        br();
    }
    if ($zy == 1) {
        echo "<span style='color:blue'>【战士职业介绍】</span>";
        br();
        echo "男战士：<img src='res/img/zy/zy1.gif' style='width: 60px;height: 80px;'>";
        br();
        echo "女战士：<img src='res/img/zy/zy2.gif' style='width: 60px;height: 80px;'>";
        br();
        echo "职业介绍：以强有力的体格为基础，特殊之处在于用剑法及刀法等技术。对打猎、战斗比较适用。体力强的战士能带许多东西，即便穿戴沉重的武器及铠甲也可以自由活动。但战士所戴的铠甲对魔法的防御能力相对较弱。";
        br();
        echo "<span style='color:green'>战士代表技能：：基础剑术，攻杀剑术，刺杀剑术，半月弯刀，野蛮冲撞，烈火剑法，狮子吼，逐日剑法</span>";
        br();
        br();
        cmd::addcmd('zy_e182,2', '了解法师');
        br();
    }
    if ($zy == 2) {
        echo "<span style='color:blue'>【法师职业介绍】</span>";
        br();
        echo "男法师：<img src='res/img/zy/zy3.gif' style='width: 60px;height: 80px;'>";
        br();
        echo "女法师：<img src='res/img/zy/zy4.gif' style='width: 60px;height: 80px;'>";
        br();
        echo "职业介绍:以长时间锻炼的内功为基础，能发挥强大的攻击型魔法。魔攻力卓越，但体力较弱。对体力上直接受到攻击的防御能力较低，另外，发挥高水平的魔法时需要较大魔法值，此时可能受到对方的攻击。魔法师的魔法比任何攻击能力都强大，能有效的威胁对方。";
        br();
        echo "<span style='color:green'>法师代表技能：：抗拒火环，诱惑之光，雷电术，瞬息移动，火墙，疾光电影，地狱雷光，魔法盾，圣言术，冰咆哮，寒冰掌，灭天火，流星火雨</span>";
        br();
        br();
        cmd::addcmd('zy_e182,3', '了解道士');
        br();
    }
    if ($zy == 3) {
        echo "<span style='color:blue'>【道士职业介绍】</span>";
        br();
        echo "男道士：<img src='res/img/zy/zy5.gif' style='width: 60px;height: 80px;'>";
        br();
        echo "女道士：<img src='res/img/zy/zy6.gif' style='width: 60px;height: 80px;'>";
        br();
        echo "职业介绍:以强大的精神力作为基础，可以使用治疗术帮助别人。对自然很熟悉，在用毒方面的能力最强。博学多知，能使用剑术和魔法，所以每时每刻都能发挥多样的法术，随机应变性强。";
        br();
        echo "<span style='color:green'>道士代表技能：：治愈术，精神力战法，施毒术，灵魂火符，召唤骷髅，隐身术，集体隐身术，幽灵盾，神圣战甲术，心灵启示，困魔咒，群体治愈术，召唤神兽，气功波，无极真气，噬血术</span>";
        br();
        br();
        $user_id = uid();
        value::set_user_value('user_cjjs', 1, $user_id);
        cmd::addcmd('e182,' . $game_area, '创建角色');
        br();
    }
    cmd::set_show_return_game(false);
}
//起名事件
function e182($game_area = 0)
{
    $user_id = uid();
    $user_cjjs = value::get_user_value('user_cjjs', $user_id);
    $user_name = value::get_game_user_value('name', $user_id);
    if (!$user_name) {
        if ($user_cjjs) {
            if (!$game_area) {
                $game_area = $_SESSION['game_area'];
            }
            $cmd = cmd::addcmd('e3,' . $game_area, '取名', false);
echo <<<setname
            <img src='logo2.png'><br><span>欢迎来到绿色传奇最经典的传奇,最精彩的玩法,只为让你...</span>
            <form action="game.php?cmd={$cmd}" method="post">
            <span>昵称:</span>
            <input type="text" name="name" maxlength="5"><br>
            <span>职业:</span>
            <input name="zhiye" type="radio" value="战士" checked>战士
            <input name="zhiye" type="radio" value="法师">法师
            <input name="zhiye" type="radio" value="道士">道士
            <br>
            <span>性别:</span>
            <input name="sex" type="radio" value="男" checked>男
            <input name="sex" type="radio" value="女">女
            <br>
            <span>推荐玩家：</span>
            <input type="text" name="js_id" maxlength="10" value="ID（必填）"><br>
            备注:充值时该玩家可以获得10%元宝奖励 <br>
            <input name='submit' type='submit' type='submit' title='创建' value='创建' value='创建' style='margin-top: 5px;width:80px;height: 25px;'/>
            </form>
setname;
        } else {
            zy_e182();
        }
    }
    cmd::set_show_return_game(false);
}


//聊天 帮派聊天
function e183()
{
    $chats = value::real_escape_string($_POST['chats']);
    $user_id = uid();
    $union_id = user::get_union($user_id);
    $now_time = date("Y-m-d H:i:s");
    $area_id = value::get_map_value(value::get_game_user_value('in_map_id'), 'area_id');
    if ($chats) {
        if (mb_strlen($chats, 'UTF8') > 50) {
            echo "你好,内容输入长度过长。";
            br();
            cmd::addcmd('e36,6', '返回上级');
            return;
        }
        $chats = strip_tags($chats);
        $sql = "SELECT `chats`,`time` FROM `game_chat` WHERE `mode`=4 AND `uid`={$user_id} ORDER BY `id` DESC LIMIT 1 ";
        $result = sql($sql);
        if (list($old_chats, $time) = $result->fetch_row()) {
            if ($old_chats == $chats) {
                echo "请不要重复发言。";
                br();
                cmd::addcmd('e36,5', '返回上级');
                return;
            } else if (time() < strtotime($time) + 2) {
                echo "最低发言间隔为2秒。";
                br();
                cmd::addcmd('e36,5', '返回上级');
                return;
            }
        }
        //聊天过滤
        if (!c_check_str($chats, 0, 50)) {
            $chats = "绿色传奇:仙盟会(仙盟会游戏)";
        }
        //插入聊天
        $sql = "INSERT INTO `game_chat`(`mode`,`area_id`,`uid`,`chats`,`time`,`oid`) VALUES(4,{$area_id},{$user_id},'" . $chats . "','{$now_time}','{$union_id}')";
        sql($sql);
        e36(6);
    } else {
        echo "请输入聊天内容。";
        br();
        cmd::addcmd('e36,5', '返回上级');
    }
}

//帮派 成员列表
function e184($union_id)
{
    $user_id = uid();
    $in_union = user::get_union($user_id);
    $union_name = union::get_name($union_id);
    cmd::addcmd('e106', '帮派');
    echo "<< ";
    echo $union_name;
    br();
    echo "-";
    br();
    $sql = "SELECT `id`,`name`,`is_online` FROM `game_user` WHERE `gonghui.id`={$union_id} ORDER BY `gonghui.lvl` ASC,`gonghui.gongxian` DESC LIMIT 100";
    $result = sql($sql);
    $i = 0;
    while (list($oid, $oname, $o_is_online) = $result->fetch_row()) {
        $i++;
        $o_zhiwei_name = user::get_union_lvl_name($oid);
        echo $i, ".";
        user::showVipLogo($oid, true);
        if ($o_is_online) {
            cmd::addcmd('e12,' . $oid . ',16', $oname);
        } else {
            echo $oname;
        }
        echo "($o_zhiwei_name)";
        br();
    }
    echo "    ---";
    br();
    if ($in_union != $union_id) {
        cmd::add_last_cmd("e176,0,$union_id");
    } else {
        cmd::add_last_cmd("e177");
    }
}

//帮派 帮派贡献
function e185()
{
    $union_id = user::get_union();
    $union_name = union::get_name($union_id);
    cmd::addcmd('e106', '帮派');
    echo "<< ";
    echo $union_name;
    br();
    echo "-";
    br();
    $sql = "SELECT `id`,`name`,`is_online`,`gonghui.gongxian` FROM `game_user` WHERE `gonghui.id`={$union_id} ORDER BY `gonghui.gongxian` DESC LIMIT 100";
    $result = sql($sql);
    $i = 0;
    while (list($oid, $oname, $o_is_online, $o_gonghui_gongxian) = $result->fetch_row()) {
        $i++;
        echo $i, ".";
        if ($o_is_online) {
            cmd::addcmd('e12,' . $oid . ',16', $oname);
        } else {
            echo $oname;
        }
        echo "({$o_gonghui_gongxian}点)";
        br();
    }
    echo "    ---";
    br();
    cmd::add_last_cmd("e177");

}

//帮派 捐献宠物
function e186($pet_id = 0)
{
    $user_id = uid();
    $union_id = user::get_union();
    $union_name = union::get_name($union_id);
    if (!$pet_id) {
        $cangyaofuzhong = user::get_fuzhong(3);
        $cangyaorongliang = user::get_rongliang(3);
        $sql = "SELECT `id`,`name`,`lvl`,`xingge` FROM `game_pet` WHERE `master_id`={$user_id} AND `master_mode`=3 ORDER BY `lvl` ASC";
        $result = sql($sql);
        echo "宠物容量:{$cangyaofuzhong}/{$cangyaorongliang}";
        br();
        while (list($oid, $oname, $olvl, $oxingge) = $result->fetch_row()) {
            $shuxing = value::get_pet_zz_value($oid, 'shuxing');
            echo "{$oname}({$olvl}级)<br>性格:" . pet::get_xingge($oxingge) . " 属性:" . $shuxing . "";
            br();
            cmd::addcmd('e186,' . $oid, '捐献' . $oname);
            br();
        }
        if (!$cangyaofuzhong) {
            echo '你的宠物袋里没有宠物。';
            br();
        }
        cmd::add_last_cmd("e177");
    } else {
        $name = value::get_pet_value($pet_id, 'name');
        echo "你把1只", $name, "捐献给了", $union_name, "!";
        $star = value::get_pet_zz_value($pet_id, 'star');
        $lvl = value::get_pet_value($pet_id, 'lvl');
        value::add_game_user_value('gonghui.gongxian', $star);
        union::add($union_id, 'lingqi', ceil($star * $lvl / 10));
        pet::del_pet($pet_id);
        br();
        e186();
    }
}

//帮派 帮派管理
function e187()
{
    $union_lvl = value::get_game_user_value('gonghui.lvl');
    if ($union_lvl < 2) {
        cmd::addcmd("e188", "发布公告");
        br();
        cmd::addcmd("e192", "入会申请");
        br();
        cmd::addcmd("e193", "成员管理");
        br();
        cmd::addcmd("e194", "帮派升级");
        br();
        cmd::addcmd("e195", "帮派建筑");
        br();
        cmd::addcmd("e189", "帮派商店");
        br();
        cmd::addcmd("e190", "帮派关系");
        br();
        if (!$union_lvl) {
            cmd::addcmd("e198", "转让帮派");
            br();
        }
    } else {
        echo "无权操作!";
    }
    cmd::add_last_cmd("e177");
}

//帮派 发布公告
function e188()
{
    if (union::can_guanli()) {
        $union_id = user::get_union();
        $union_name = union::get_name($union_id);
        $xgg = post::get("gonggao");
        if (!$xgg) {
            $jgg = union::get($union_id, 'gonggao');
            $post_url = cmd::addcmd("e188", "", false, true);
            echo <<<juanxian
<form action="{$post_url}" method="post">
请输入{$union_name}的新公告:
<br>
<input type="text" name="gonggao" maxlength="128" value="$jgg">
<br>
<input type="submit" value="确认修改">
</form>
juanxian;
            cmd::add_last_cmd("e187");
        } else {
            union::set($union_id, "gonggao", $xgg);
            echo "成功发布公告!";
            br();
            e177();
        }
    } else {
        e177();
    }
}

//帮派 帮派商店
function e189($item_id = 0)
{
    if (union::can_guanli()) {
        $union_id = user::get_union();
        $union_name = union::get_name($union_id);
        $union_money = union::get($union_id, 'money');
        $union_lvl = union::get($union_id, 'lvl');
        $item_arr = array("帮派双倍经验★24小时" => $union_lvl > 3 ? $union_lvl * 1000000 : 3000000);
        if (!$item_id) {
            echo $union_name, "有", $union_money, "个金币,你想要买点什么?";
            br();
            $i = 0;
            foreach ($item_arr as $iname => $imoney) {
                $i++;
                cmd::addcmd("e189," . $i, $iname . "({$imoney}个金币)");
                br();
            }
            cmd::add_last_cmd("e187");
        } else {
            $can_buy = true;
            $i = 0;
            foreach ($item_arr as $iname => $imoney) {
                $i++;
                if ($i == $item_id) {
                    break;
                }
            }
            $cant_buy_desc = "帮派暂时无法购买[" . $iname . "]!";
            switch ($iname) {
                case "帮派双倍经验★24小时":
                    if (union::get($union_id, 'ghsbjy_time') >= time()) {
                        $can_buy = false;
                        $cant_buy_desc = "帮派双倍经验尚未结束,无法购买!";
                    }
                    break;
            }
            if ($can_buy) {
                if ($imoney <= $union_money) {
                    union::add($union_id, 'money', -1 * $imoney);
                    echo "你成功为本帮派购买了[", $iname, "]!";
                    switch ($iname) {
                        case "帮派双倍经验★24小时":
                            union::set($union_id, 'ghsbjy_time', time() + 60 * 60 * 24);
                            break;
                    }
                } else {
                    echo "帮派没有足够的资金购买[", $iname, "]!";
                }
            } else {
                echo $cant_buy_desc;
            }
            br();
            e189();
        }
    } else {
        e177();
    }
}

//帮派 帮派关系
function e190($mode = 0, $o_union_id = 0)
{
    if (union::can_guanli()) {
        $union_id = user::get_union();
        $union_name = union::get_name($union_id);
        if (!$mode) {
            echo "帮派关系:[", $union_name, "]";
            br();
            echo "  -同盟帮派  --";
            br();
            $tongmeng_arr = union::get_tongmeng($union_id, $tongmeng_count);
            if ($tongmeng_count) {
                foreach ($tongmeng_arr as $tongmeng_id) {
                    echo union::get_name($tongmeng_id), " ";
                    cmd::addcmd("e190,3," . $tongmeng_id, "取消同盟");
                    br();
                }
            } else {
                echo "暂时没有同盟帮派。";
                br();
            }
            cmd::addcmd("e190,1", "申请结盟");
            br();
            echo "  -同盟请求  --";
            br();
            $tongmeng_qingqiu_count = 0;
            $sql = "SELECT `uid` FROM `game_chat` WHERE mode=19 AND chats='结盟请求' AND oid=$union_id";
            $rs = sql($sql);
            while (list($tongmeng_qingqiu_id) = $rs->fetch_row()) {
                echo union::get_name($tongmeng_qingqiu_id);
                br();
                cmd::addcmd("e190,7," . $tongmeng_qingqiu_id, "同意结盟");
                br();
                cmd::addcmd("e190,8," . $tongmeng_qingqiu_id, "拒绝结盟");
                br();
                $tongmeng_qingqiu_count++;
            }
            if (!$tongmeng_qingqiu_count) {
                echo "暂时没有同盟请求。";
                br();
            }
            echo "  -敌对帮派  --";
            br();
            $didui_arr = union::get_didui($union_id, $didui_count);
            if ($didui_count) {
                foreach ($didui_arr as $didui_id) {
                    echo union::get_name($didui_id), " ";
                    cmd::addcmd("e190,6," . $didui_id, "取消敌对");
                    br();
                }
            } else {
                echo "暂时没有敌对帮派。";
                br();
            }
            cmd::addcmd("e190,4", "设置敌对");
            br();
            cmd::add_last_cmd("e187");
        } else if ($mode == 1) {//选择同盟
            echo "请选择要同盟的帮派:";
            $union_count = 0;
            $sql = "SELECT `Id`,`name`,`type`,`money`/10000 FROM `game_union` WHERE `status` = 1 and `Id`!='$union_id' ORDER BY `money` DESC";
            $rs = sql($sql);
            while (list($union_t_id, $union_t_name, $union_t_type, $union_t_money) = $rs->fetch_row()) {
                $union_count++;
                br();
                echo $union_count, ".";
                cmd::addcmd("e190,2," . $union_t_id, $union_t_name . union::get_type_name($union_t_type) . "(" . (int)$union_t_money . ")");
            }
            if (!$union_count) {
                br();
                echo "暂时没有可以同盟帮派。";
            }
            br();
            cmd::add_last_cmd("e190");
        } else if ($mode == 2) {//申请同盟
            $now_time = time();
            $last_set_guanxi_time = union::get($union_id, 'last_set_guanxi_time');
            if ($last_set_guanxi_time + 12 * 60 * 60 < $now_time) {
                if (union::add_tongmeng($union_id, $o_union_id)) {
                    union::set($union_id, 'last_set_guanxi_time', $now_time);
                    echo "申请成功!";
                    $o_union_name = union::get_name($o_union_id);
                    union::send_guanli_msg($o_union_id, $union_name . "申请与" . $o_union_name . "结盟!");
                } else {
                    echo "申请失败,已经是同盟帮派或达到同盟帮派上限!";
                }
            } else {
                echo "申请失败,设置新的帮派关系需要间隔12小时!";
            }
            br();
            e190();
        } else if ($mode == 3) {//取消同盟
            if (union::del_tongmeng($union_id, $o_union_id)) {
                echo "取消成功!";
                $o_union_name = union::get_name($o_union_id);
                c_add_guangbo($union_name . "取消与" . $o_union_name . "结盟,从此一别个宽,海阔天空!");
            } else {
                echo "取消失败,已经不是同盟帮派!";
            }
            br();
            e190();
        } else if ($mode == 4) {//选择敌对
            echo "请选择要敌对的帮派:";
            $union_count = 0;
            $sql = "SELECT `Id`,`name`,`type`,`money`/10000 FROM `game_union` WHERE `status` = 1 and `Id`!='$union_id' ORDER BY `money` DESC";
            $rs = sql($sql);
            while (list($union_t_id, $union_t_name, $union_t_type, $union_t_money) = $rs->fetch_row()) {
                $union_count++;
                br();
                echo $union_count, ".";
                cmd::addcmd("e190,5," . $union_t_id, $union_t_name . union::get_type_name($union_t_type) . "(" . (int)$union_t_money . ")");
            }
            if (!$union_count) {
                br();
                echo "暂时没有可以敌对帮派。";
            }
            br();
            cmd::add_last_cmd("e190");
        } else if ($mode == 5) {//设置敌对
            $now_time = time();
            $last_set_guanxi_time = union::get($union_id, 'last_set_guanxi_time');
            if ($last_set_guanxi_time + 12 * 60 * 60 < $now_time) {
                if (union::set_didui($union_id, $o_union_id)) {
                    union::set($union_id, 'last_set_guanxi_time', $now_time);
                    $o_union_name = union::get_name($o_union_id);
                    c_add_guangbo($union_name . "正式对" . $o_union_name . "宣战,从此仇深似海,不共戴天!");
                    echo "设置成功!";
                } else {
                    echo "设置失败,已经是敌对帮派或达到敌对帮派上限!";
                }
            } else {
                echo "设置失败,设置新的帮派关系需要间隔12小时!";
            }
            br();
            e190();
        } else if ($mode == 6) {//取消敌对
            if (union::del_didui($union_id, $o_union_id)) {
                echo "取消成功!";
                $o_union_name = union::get_name($o_union_id);
                c_add_guangbo($union_name . "取消对" . $o_union_name . "宣战,从此风平浪静,江湖再见!");
            } else {
                echo "取消失败,已经不是敌对帮派!";
            }
            br();
            e190();
        } else if ($mode == 7) {//同意结盟
            if (union::set_tongmeng($union_id, $o_union_id)) {
                $sql = "DELETE FROM `game_chat` WHERE mode=19 AND chats='结盟请求' AND oid=$union_id AND uid=$o_union_id";
                sql($sql);
                echo "同意成功!";
                $o_union_name = union::get_name($o_union_id);
                c_add_guangbo($union_name . "同意与" . $o_union_name . "结盟,从此兄弟同心,其利断金!");
            } else {
                echo "同意失败,已经是同盟帮派或己方/对方达到同盟帮派上限!";
            }
            br();
            e190();
        } else if ($mode == 8) {//拒绝结盟
            $sql = "DELETE FROM `game_chat` WHERE mode=19 AND chats='结盟请求' AND oid=$union_id AND uid=$o_union_id";
            sql($sql);
            echo "拒绝成功!";
            $o_union_name = union::get_name($o_union_id);
            union::send_guanli_msg($union_id, $union_name . "拒绝与" . $o_union_name . "结盟!");
            br();
            e190();
        }
    } else {
        e177();
    }
}

//帮派 申请加入
function e191($union_id)
{
    $user_id = uid();
    if (value::get_user_value('last_tcgh_time', $user_id) + 60 * 60 * 24 < time()) {
        if (value::get_user_value('last_rhsq_time', $user_id) + 60 * 60 < time()) {
            union::send_msg($user_id, $union_id, "入会申请");
            union::send_guanli_msg($union_id, "收到新的入会申请,请及时处理!");
            value::set_user_value('last_rhsq_time', time(), $user_id);
            echo "申请成功!";
        } else {
            echo "申请失败,申请加入新的帮派需要间隔1小时!";
        }
    } else {
        echo "申请失败,退出帮派后再次申请加入帮派需要间隔24小时!";
    }
    br();
    e176(0, $union_id);
}

//帮派 入会申请
function e192($mode = 0, $user_id = 0)
{
    if (union::can_guanli()) {
        $union_id = user::get_union();
        $union_name = union::get_name($union_id);
        if ($mode) {
            $sql = "DELETE FROM `game_chat` WHERE mode=19 AND chats='入会申请' AND oid=$union_id AND uid=$user_id";
            sql($sql);
        }
        if (!$mode) {
            echo "入会申请:[", $union_name, "]";
            br();
            echo "  -入会请求  --";
            br();
            $ruhui_qingqiu_count = 0;
            $sql = "SELECT `uid` FROM `game_chat` WHERE mode=19 AND chats='入会申请' AND oid=$union_id";
            $rs = sql($sql);
            while (list($ruhui_qingqiu_id) = $rs->fetch_row()) {
                echo value::get_game_user_value('name', $ruhui_qingqiu_id);
                br();
                cmd::addcmd("e192,1," . $ruhui_qingqiu_id, "同意入会");
                br();
                cmd::addcmd("e192,2," . $ruhui_qingqiu_id, "拒绝入会");
                br();
                $ruhui_qingqiu_count++;
            }
            if (!$ruhui_qingqiu_count) {
                echo "暂时没有入会请求。";
                br();
            }
            cmd::add_last_cmd("e187");
        } else if ($mode == 1) {//同意入会
            union::add_user($union_id, $user_id);
            e192();
        } else if ($mode == 2) {//拒绝入会
            echo "拒绝成功!";
            br();
            c_add_xiaoxi($union_name . "拒绝了你的入会请求!", 0, $union_id, $user_id);
            e192();
        }
    } else {
        e177();
    }
}

//帮派 成员管理
function e193($mode = 0, $o_user_id = 0, $set_gonghui_lvl = 6)
{
    if (union::can_guanli()) {
        $user_id = uid();
        $user_name = value::get_game_user_value('name', $user_id);
        $union_id = user::get_union($user_id);
        $union_name = union::get_name($union_id);
        $u_union_lvl = user::get_union_lvl($user_id);
        cmd::addcmd('e106', '帮派');
        echo "<< " . $union_name;
        br();
        echo "-";
        br();
        if (!$mode) {
            $sql = "SELECT `id`,`name`,`is_online`,`gonghui.lvl` FROM `game_user` WHERE `gonghui.id`={$union_id} ORDER BY `gonghui.lvl` ASC,`gonghui.gongxian` DESC LIMIT 100";
            $result = sql($sql);
            $i = 0;
            while (list($oid, $oname, $o_is_online, $o_gonghui_lvl) = $result->fetch_row()) {
                $i++;
                $o_zhiwei_name = user::get_union_lvl_name($oid);
                echo $i, ".";
                if ($o_is_online) {
                    cmd::addcmd('e12,' . $oid . ',16', $oname);
                } else {
                    echo $oname;
                }
                echo "($o_zhiwei_name)";
                if ($u_union_lvl < $o_gonghui_lvl) {
                    echo " ";
                    cmd::addcmd('e193,1,' . $oid, "任职");
                    echo " ";
                    cmd::addcmd('e193,3,' . $oid, "踢出");
                }
                br();
            }
            echo "    ---";
            br();
            cmd::add_last_cmd("e187");
        } else if ($mode == 1) {//选择任职
            $union_type = union::get($union_id, 'type');
            $o_user_name = value::get_game_user_value('name', $o_user_id);
            echo "你要给{$o_user_name}什么职位?<br>";
            $union_lvl_name_arr = union::get_touxian($union_type);
            foreach ($union_lvl_name_arr as $k => $v) {
                if ($u_union_lvl < $k) {
                    cmd::addcmd('e193,2,' . $o_user_id . ',' . $k, $v);
                    br();
                }
            }
            cmd::add_last_cmd("e193");
        } else if ($mode == 2) {//正式任职
            //判断副会长数量
            if ($set_gonghui_lvl == 1) {
                $sql = "SELECT COUNT(*) FROM game_user WHERE `gonghui.lvl`=1 AND `gonghui.id`=$union_id";
                $rs = sql($sql);
                list($count) = $rs->fetch_row();
                if ($count > 1) {
                    echo "无法任职,达到帮派副会长上限!";
                } else {
                    echo "任职成功!";
                    value::set_game_user_value('gonghui.lvl', $set_gonghui_lvl, $o_user_id);
                    c_add_xiaoxi("你被帮派任职为" . user::get_union_lvl_name($o_user_id) . "!", 0, $union_id, $o_user_id);
                }
            } else {
                echo "任职成功!";
                value::set_game_user_value('gonghui.lvl', $set_gonghui_lvl, $o_user_id);
                c_add_xiaoxi("你被帮派任职为" . user::get_union_lvl_name($o_user_id) . "!", 0, $union_id, $o_user_id);
            }
            br();
            e193();
        } else if ($mode == 3) {//是否踢出会员
            $o_user_name = value::get_game_user_value('name', $o_user_id);
            echo "你确定要将{$o_user_name}踢出帮派吗?";
            br();
            cmd::addcmd('e193,4,' . $o_user_id, "确定踢出");
            br();
            cmd::add_last_cmd("e193");
        } else if ($mode == 4) {//确认踢出会员
            $o_user_name = value::get_game_user_value('name', $o_user_id);
            if (value::get_user_value('last_ghtr_time', $user_id) + 60 * 5 < time()) {
                value::set_user_value('last_ghtr_time', time(), $user_id);
                if (union::del_user($union_id, $o_user_id)) {
                    union::send_guanli_msg($union_id, $user_name . "将" . $o_user_name . "踢出了帮派!");
                    c_add_xiaoxi($union_name . "将你踢出了帮派!", 0, $union_id, $o_user_id);
                    echo "踢出成功!";
                    br();
                } else {
                    echo "对方已不在本帮派!";
                    br();
                }
            } else {
                echo "踢出失败,每次踢人需要间隔5分钟!";
                br();
            }
            e193();
        }
    } else {
        e177();
    }
}

//帮派 帮派升级
function e194($mode = 0)
{
    if (union::can_guanli()) {
        $user_id = uid();
        $union_id = user::get_union($user_id);
        $union_lvl = union::get($union_id, 'lvl');
        if ($union_lvl < 5) {
            $max_user_count = union::get_max_user_count($union_id);
            if (!$mode) {
                echo "帮派从", $union_lvl, "级升到", $union_lvl + 1, "级需要帮派成员人数达到", $max_user_count * 0.75, "人且消耗", ($union_lvl) * 1000000, "帮派资金,你确认要升级帮派吗?";
                br();
                cmd::addcmd("e194,1", "确认升级");
            } else {
                $user_count = union::get_user_count($union_id);
                $union_money = union::get($union_id, 'money');
                $need_money = ($union_lvl) * 1000000;
                if ($user_count >= $max_user_count * 0.75 && $union_money >= $need_money) {
                    union::add($union_id, 'money', -1 * $need_money);
                    union::add($union_id, 'lvl', 1);
                    $union_lvl = union::get($union_id, 'lvl');
                    echo "你的帮派成功升级为", $union_lvl, "级帮派!";
                    union::send_user_msg($union_id, "你的帮派成功升级为{$union_lvl}级帮派!");
                } else {
                    echo "帮派人数不足或者帮派资金不够!";
                }
            }
        } else {
            echo "帮派已经满级,无法继续升级!";
        }
        br();
        cmd::add_last_cmd("e187");
    } else {
        e177();
    }
}

//帮派 帮派建筑
function e195($mode = 0, $jianzhu_type = 0)
{
    if (union::can_guanli()) {
        $user_id = uid();
        $union_id = user::get_union($user_id);
        $union_lvl = union::get($union_id, 'lvl');
        if ($union_lvl > 1) {
            $jianzhu_arr = union::get_jianzhu();
            $jianzhu_money_arr = array(2000000, 4000000, 8000000, 16000000);
            if (!$mode) {
                echo "建筑列表:";
                br();
                foreach ($jianzhu_arr as $k => $v) {
                    $tlvl = (int)union::get($union_id, 'jz.' . $k . '.lvl');
                    echo $v;
                    if ($tlvl) {
                        echo "(", $tlvl, "级) ";
                        if ($tlvl < 4) {
                            cmd::addcmd("e195,1," . $k, "升级");
                            echo "(", $jianzhu_money_arr[$tlvl], "个金币)";
                        }
                    } else {
                        echo " ";
                        cmd::addcmd("e195,1," . $k, "建造");
                        echo "(", $jianzhu_money_arr[$tlvl], "个金币)";
                    }
                    br();
                }
                cmd::add_last_cmd("e187");
            } else if ($mode == 1) {
                $tlvl = (int)union::get($union_id, 'jz.' . $jianzhu_type . '.lvl');
                $tname = $jianzhu_arr[$jianzhu_type];
                $tmoney = $jianzhu_money_arr[$tlvl];
                $sj_desc = "";
                switch ($tname) {
                    case "神兵库":
                        $sj_desc = "(增加装备强化成功机率)";
                        break;
                    case "铁匠铺":
                        $sj_desc = "(降低修补装备最大耐久损耗)";
                        break;
                    case "合成池":
                        $sj_desc = "(增加合成宠物成功机率)";
                        break;
                    case "强妖台":
                        $sj_desc = "(增加三转宠物最大等级)";
                        break;
                }
                echo "你确定要花{$tmoney}帮派资金升级{$tname}{$sj_desc}吗?";
                br();
                cmd::addcmd('e195,2,' . $jianzhu_type, '确认升级');
                br();
                cmd::add_last_cmd("e195");
            } else if ($mode == 2) {
                $union_lvl = union::get($union_id, 'lvl');
                $union_money = union::get($union_id, 'money');
                $tlvl = (int)union::get($union_id, 'jz.' . $jianzhu_type . '.lvl');
                $tname = $jianzhu_arr[$jianzhu_type];
                $tmoney = $jianzhu_money_arr[$tlvl];
                if ($union_lvl > $tlvl + 1) {
                    if ($tlvl < 4 && $union_money >= $tmoney) {
                        union::add($union_id, 'money', -1 * $tmoney);
                        union::add($union_id, 'jz.' . $jianzhu_type . '.lvl', 1);
                        $tlvl = (int)union::get($union_id, 'jz.' . $jianzhu_type . '.lvl');
                        echo "你的帮派的{$tname}成功升级为{$tlvl}级!";
                        union::send_user_msg($union_id, "你的帮派的{$tname}成功升级为{$tlvl}级!");
                    } else {
                        echo "{$tname}已经满级或者帮派资金不够!";
                    }
                } else {
                    echo "帮派等级不够,请先升级帮派!";
                }
                br();
                e195();
            }
        } else {
            echo "2级帮派才能建造建筑!";
            br();
            cmd::add_last_cmd("e187");
        }
    } else {
        e177();
    }
}

//帮派 退出帮派
function e196($mode = 0)
{
    $user_id = uid();
    $user_name = value::get_game_user_value('name', $user_id);
    $union_id = user::get_union($user_id);
    $union_name = union::get_name($union_id);
    if (!$mode) {
        echo "你确定要退出{$union_name}吗(24小时内无法加入帮派)?";
        br();
        cmd::addcmd('e196,1', "确定退出");
        br();
        cmd::add_last_cmd("e177");
    } else if ($mode) {
        if (union::del_user($union_id, $user_id)) {
            value::set_user_value('last_tcgh_time', time(), $user_id);
            union::send_user_msg($union_id, $user_name . "退出了" . $union_name . "!");
            echo "退出成功!";
            br();
        } else {
            echo "你已不在" . $union_name . "!";
            br();
        }
        e106();
    }
}

//帮派 帮派仇人
function e197($yeshu = 0, $o_user_id = 0, $step = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    $union_name = union::get_name($union_id);
    cmd::addcmd('e106', '帮派');
    echo "<< ";
    echo $union_name;
    br();
    echo "-";
    br();
    if (!$o_user_id) {
        $danye_count = 15;
        echo "仇人列表:";
        br();
        //获取仇人数量
        $sql = "SELECT COUNT(*) FROM `game_union_value` WHERE `union_id`={$union_id}  AND `valuename` LIKE 'chouren'";
        $result = sql($sql);
        list($heiming_count) = $result->fetch_row();
        //开始获取
        $sql = "SELECT `value` FROM `game_union_value` WHERE `union_id`={$union_id}  AND  `valuename` LIKE 'chouren'";
        $result = sql($sql);
        //黑名单计数
        $count = 0;
        //离线仇人 计数 名字数组
        $lxhm = array();
        $zxhm = array();
        $new_hm = array();
        $heiming_leixing_arr = array();
        while (list($oid) = $result->fetch_row()) {
            if ($oid) {
                if (value::get_game_user_value('is_online', $oid)) {
                    array_push($zxhm, $oid);
                    $heiming_leixing_arr[$oid] = 1;
                } else {
                    array_push($lxhm, $oid);
                    $heiming_leixing_arr[$oid] = 0;
                }
            }
            $count++;
        }
        if (!$count) {
            echo '帮派还没有仇人哦。';
            br();
        } else {
            $new_hm = array_merge($zxhm, $lxhm);
        }
        //输出仇人链接
        $max_count = $count < ($yeshu + 1) * $danye_count ? $count : ($yeshu + 1) * $danye_count;
        for ($i = $yeshu * $danye_count; $i < $max_count; $i++) {
            $oname = value::get_game_user_value('name', $new_hm[$i]);
            if ($heiming_leixing_arr[$new_hm[$i]]) {
                cmd::addcmd('e12,' . $new_hm[$i], $oname);
            } else {
                echo $oname;
            }
            echo "(", (int)union::get($union_id, 'chouren.' . $new_hm[$i]), "次)";
            echo ' ';
            cmd::addcmd('e197,' . $yeshu . ',' . $new_hm[$i], '打探');
            br();
        }
        //上下页操作
        $fanye = false;
        $max_page_num = (int)(($count - 1) / $danye_count) + 1;
        if ($yeshu) {
            if ($yeshu > 1) {
                cmd::addcmd("e197", '首页');
                echo "|";
            }
            cmd::addcmd('e197,' . ($yeshu - 1), '上—页');
            $fanye = true;
        }
        if ($heiming_count > ($yeshu + 1) * $danye_count) {
            if ($yeshu) {
                echo "|";
            }
            cmd::addcmd('e197,' . ($yeshu + 1), '下—页');
            if ($yeshu + 2 < $max_page_num) {
                echo "|";
                cmd::addcmd('e197,' . ($max_page_num - 1), '末页');
            }
            $fanye = true;
        }
        //是否翻页换行
        if ($fanye) {
            br();
        }
        echo "    ---";
        br();
        cmd::add_last_cmd("e177");
    } else {
        //打探
        $oname = value::get_game_user_value('name', $o_user_id);
        if (!$step) {
            echo "你确定要花费100个金币打探{$oname}的行踪吗?";
            br();
            cmd::addcmd('e197,' . $yeshu . ',' . $o_user_id . ',1', '确认打探');
            br();
        } else {
            if (item::add_money(-100, $user_id)) {
                $is_online = value::get_game_user_value('is_online', $o_user_id);
                if ($is_online) {
                    $in_map_id = value::get_game_user_value('in_map_id', $o_user_id);
                    $in_map_name = value::get_map_value($in_map_id, 'name');
                    echo "根据可靠消息,{$oname}现在正在{$in_map_name}。";
                    br();
                } else {
                    echo "传奇之中仿佛丢失了{$oname}的消息。";
                    br();
                }
            }
        }
        cmd::add_last_cmd("e197," . $yeshu);
    }
}

//帮派 转让帮派
function e198($mode = 0, $o_user_id = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$mode) {//选择转让人选
        $sql = "SELECT `id`,`name`,`is_online`,`gonghui.lvl` FROM `game_user` WHERE `gonghui.id`={$union_id} AND `gonghui.lvl`=1 ORDER BY `gonghui.lvl` ASC,`gonghui.gongxian` DESC LIMIT 100";
        $result = sql($sql);
        $i = 0;
        while (list($oid, $oname, $o_is_online) = $result->fetch_row()) {
            $i++;
            $o_zhiwei_name = user::get_union_lvl_name($oid);
            echo $i, ".";
            if ($o_is_online) {
                cmd::addcmd('e12,' . $oid . ',16', $oname);
            } else {
                echo $oname;
            }
            echo "($o_zhiwei_name)";
            echo " ";
            cmd::addcmd('e198,1,' . $oid, "转让");
            br();
        }
        if (!$i) {
            echo "无可转让人选!";
            br();
        }
        cmd::add_last_cmd('e187');
    } else if ($mode == 1) {//确认是否转让
        $url = cmd::addcmd("e198,2," . $o_user_id, "", false, true);
        $o_user_name = value::get_game_user_value('name', $o_user_id);
        echo <<<html
<form action="$url" method="post">
你确定要转让帮派给{$o_user_name}吗?<br>
<input type="text" name="rs" placeholder="输入转让确认转让">
<br>
<input type="submit" value="确认结果">
</form>
html;
        cmd::add_last_cmd('e198');
    } else if ($mode == 2) {//正式转让帮派
        $rs = post::get('rs');
        if ($rs == '转让' && user::get_union($o_user_id) == $union_id) {
            $user_name = value::get_game_user_value('name', $user_id);
            $o_user_name = value::get_game_user_value('name', $o_user_id);
            value::set_game_user_value('gonghui.lvl', 6, $user_id);
            value::set_game_user_value('gonghui.lvl', 0, $o_user_id);
            echo "你卸任了会长,{$o_user_name}是新的会长!";
            br();
            union::send_user_msg($union_id, "{$user_name}卸任了会长,{$o_user_name}是新的会长!");
            e177();
        } else {
            echo "转让失败!";
            br();
            e198();
        }
    }
}

//帮派 修补装备
function e199($prop_id = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$prop_id) {
        echo "客官,您想要修补哪件装备?";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`prop_id` FROM `game_prop` WHERE `user_id`={$user_id} AND `user_num`=1 AND `user_num`=5 AND naijiu<max_naijiu ORDER BY LENGTH(`name`) ASC";
        $result = sql($sql);
        while (list($game_prop_id, $prop_zz_id) = $result->fetch_row()) {
            $prop_leixing = value::get_prop_value($prop_zz_id, 'leixing');
            if ($prop_leixing == 2 || $prop_leixing == 3) {
                prop::show_prop($game_prop_id, -1);
                $need_money = (value::get_game_prop_value($game_prop_id, 'max_naijiu') - value::get_game_prop_value($game_prop_id, 'naijiu')) * 20 * value::get_game_prop_value($game_prop_id, 'star');
                cmd::addcmd("e199," . $game_prop_id, "修补(" . $need_money . "个金币)");
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "你没有可以修补的装备！";
        } else {
            cmd::set_return_game_br(false);
        }
    } else {
        $need_money = (value::get_game_prop_value($prop_id, 'max_naijiu') - value::get_game_prop_value($prop_id, 'naijiu')) * 20 * value::get_game_prop_value($prop_id, 'star');
        if (item::add_money(-1 * $need_money)) {
            $whws = false;
            $lvl = union::get($union_id, 'jz.tjp.lvl');
            switch ($lvl) {
                case 1:
                    $max_naijiu = value::get_game_prop_value($prop_id, 'max_naijiu') * 0.90;
                    break;
                case 2:
                    $max_naijiu = value::get_game_prop_value($prop_id, 'max_naijiu') * 0.93;
                    break;
                case 3:
                    $max_naijiu = value::get_game_prop_value($prop_id, 'max_naijiu') * 0.96;
                    break;
                case 4:
                    $t = mt_rand(1, 100) < 20 ? 1 : 0.99;
                    if ($t == 1) {
                        $whws = true;
                    }
                    $max_naijiu = value::get_game_prop_value($prop_id, 'max_naijiu') * $t;
                    break;
                default:
                    $max_naijiu = value::get_game_prop_value($prop_id, 'max_naijiu') * 0.90;
                    break;
            }
            $max_naijiu = (int)$max_naijiu;
            value::set_game_prop_value($prop_id, 'max_naijiu', $max_naijiu);
            value::set_game_prop_value($prop_id, 'naijiu', $max_naijiu);
            echo "当!当!当!", $whws ? "完好无损!" : "", "铁匠铺成功修复了", value::get_game_prop_value($prop_id, 'name'), ",剩余最大耐久度为{$max_naijiu}!";
            br();
        }
        e199();
    }
}

//帮派 强化装备
function e200($step = 0, $id = 0, $prop_id = 0, $money = 0, $qhs = 0, $ks = 0, $xys = 0, $xys1 = 0, $xys2 = 0, $xys3 = 0, $cgl = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$step) {//选择强化装备
        cmd::addcmd("e200,", "强化");
        echo ">> 请选择强化的装备";
        br();
        echo "-";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`prop_id` FROM `game_prop` WHERE `qianghuacishu`<10 AND `user_id`={$user_id} AND (`user_num`=1 OR `user_num`=5) ORDER BY LENGTH(`name`) DESC";
        $result = sql($sql);
        while (list($id, $prop_id) = $result->fetch_row()) {
            $prop_leixing = value::get_prop_value($prop_id, 'leixing');
            if ($prop_leixing == 2) {
                cmd::addcmd("e200,1," . $id . "," . $prop_id, value::get_game_prop_value($id, 'name'));
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "背包中没有可以强化的装备！";
        } else {
            cmd::set_return_game_br(false);
        }
        echo "-";
        br();
    } else if ($step == 1) {//查看选择装备
        cmd::addcmd("e200,", "强化");
        echo ">> 请确认强化的装备";
        br();
        echo "-";
        br();
        prop::show_prop($id, -1);
        cmd::addcmd("e200,2," . $id . "," . $prop_id, "确认选择");
        br();
        echo "-";
        br();
        cmd::addcmd("e200,0,", "返回上级");
    } else if ($step == 2) {//选择消耗金币
        cmd::addcmd("e200,", "强化");
        echo ">> 强化装备需要材料";
        br();
        echo "-";
        br();
        $prop_name = value::get_game_prop_value($id, 'name');
        $qianghuacishu = prop::get($id, 'qianghuacishu');
        $xs_qh = $qianghuacishu + 1;
        $money = value::get_prop_value($prop_id, 'money');
        $money = $money * 10 * $xs_qh;
        if ($xs_qh == 1) {
            $qhs = 185;
            $ks = 175;
        } else if ($xs_qh == 2) {
            $qhs = 186;
            $ks = 176;
        } else if ($xs_qh == 3) {
            $qhs = 187;
            $ks = 177;
        } else if ($xs_qh == 4) {
            $qhs = 188;
            $ks = 178;
        } else if ($xs_qh == 5) {
            $qhs = 189;
            $ks = 179;
        } else if ($xs_qh == 6) {
            $qhs = 190;
            $ks = 180;
        } else if ($xs_qh == 7) {
            $qhs = 191;
            $ks = 181;
        } else if ($xs_qh == 8) {
            $qhs = 192;
            $ks = 182;
        } else if ($xs_qh == 9) {
            $qhs = 193;
            $ks = 183;
        } else if ($xs_qh == 10) {
            $qhs = 194;
            $ks = 184;
        }
        echo "强化：{$prop_name}";
        br();
        echo "幸运孔一：";
        if ($xys1 < 1) {
            cmd::addcmd("e200,4," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",1,". $xys1 . "," . $xys2 . "," . $xys3, "选择");
        } else {
            echo value::get_item_value($xys1, 'name');
            echo "   ";
            cmd::addcmd("e200,4," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",1,". $xys1 . "," . $xys2 . "," . $xys3, "更换");
        } 
        br();
        echo "幸运孔二：";
        if ($xys2 < 1) {
            cmd::addcmd("e200,4," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",2,". $xys1 . "," . $xys2 . "," . $xys3, "选择");
        } else {
            echo value::get_item_value($xys2, 'name');
            echo "   ";
            cmd::addcmd("e200,4," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",2,". $xys1 . "," . $xys2 . "," . $xys3, "更换");
        } 
        br();
        echo "幸运孔三：";
        if ($xys3 < 1) {
            cmd::addcmd("e200,4," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",3,". $xys1 . "," . $xys2 . "," . $xys3, "选择");
        } else {
            echo value::get_item_value($xys3, 'name');
            echo "   ";
            cmd::addcmd("e200,4," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",3,". $xys1 . "," . $xys2 . "," . $xys3, "更换");
        } 
        $cgl1 = 0;
        if ($xys1 == 195) {
            $cgl1 += 5;
        }
        if ($xys2 == 195) {
            $cgl1 += 5;
        }
        if ($xys3 == 195) {
            $cgl1 += 5;
        }
        if ($xys1 == 196) {
            $cgl1 += 10;
        }
        if ($xys2 == 196) {
            $cgl1 += 10;
        }
        if ($xys3 == 196) {
            $cgl1 += 10;
        }
        if ($xys1 == 197) {
            $cgl1 += 15;
        }
        if ($xys2 == 197) {
            $cgl1 += 15;
        }
        if ($xys3 == 197) {
            $cgl1 += 15;
        }
        $cgl = $cgl1 + 100 - $qianghuacishu * 10;
        br();
        echo $prop_name . "强化到+{$xs_qh}成功率{$cgl}%";
        br();
        $item_qhs_name = value::get_item_value($qhs, 'name');
        $item_ks_name = value::get_item_value($ks, 'name');
        echo "需要：{$item_qhs_name} * 1， {$item_ks_name} * 3";
        br();
        echo "消耗：{$money}金币";
        br();
        echo "-";
        br();
        cmd::addcmd("e200,3," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",". $xys . "," . $xys1 . "," . $xys2 . "," . $xys3 . "," . $cgl, "开始强化");
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 4) {//现在需要石
        cmd::addcmd("e200,", "强化");
        echo ">> 请选择幸运石";
        $xys_195 = item::get_item(195);
        if ($xys1 == 195 && $xys_195 > 0) {
            $xys_195 = $xys_195 - 1;
        }
        if ($xys2 == 195 && $xys_195 > 0) {
            $xys_195 = $xys_195 - 1;
        }
        if ($xys3 == 195 && $xys_195 > 0) {
            $xys_195 = $xys_195 - 1;
        }
        $xys_196 = item::get_item(196);
        if ($xys1 == 196 && $xys_196 > 0) {
            $xys_196 = $xys_196 - 1;
        }
        if ($xys2 == 196 && $xys_196 > 0) {
            $xys_196 = $xys_196 - 1;
        }
        if ($xys3 == 196 && $xys_196 > 0) {
            $xys_196 = $xys_196 - 1;
        }
        $xys_197 = item::get_item(197);
        if ($xys1 == 197 && $xys_197 > 0) {
            $xys_197 = $xys_197 - 1;
        }
        if ($xys2 == 197 && $xys_197 > 0) {
            $xys_197 = $xys_197 - 1;
        }     
        if ($xys3 == 197 && $xys_197 > 0) {
            $xys_197 = $xys_197 - 1;
        }
        br();
        echo "-";
        br();
        if ($xys_195 > 0) {
            if ($xys == 1) {
                $xys1 = 195;
            } else if ($xys == 2) {
                $xys2 = 195;
            } else if ($xys == 3) {
                $xys3 = 195;
            }
            cmd::addcmd("e200,2," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",". $xys . "," . $xys1 . "," . $xys2 . "," . $xys3, value::get_item_value(195, 'name'));
            br();
        }
        if ($xys_196 > 0) {
            if ($xys == 1) {
                $xys1 = 196;
            } else if ($xys == 2) {
                $xys2 = 196;
            } else if ($xys == 3) {
                $xys3 = 196;
            }
            cmd::addcmd("e200,2," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",". $xys . "," . $xys1 . "," . $xys2 . "," . $xys3, value::get_item_value(196, 'name'));
            br();
        }
        if ($xys_197 > 0) {
            if ($xys == 1) {
                $xys1 = 197;
            } else if ($xys == 2) {
                $xys2 = 197;
            } else if ($xys == 3) {
                $xys3 = 197;
            }
            cmd::addcmd("e200,2," . $id . "," . $prop_id . "," . $money . "," . $qhs . "," . $ks . ",". $xys . "," . $xys1 . "," . $xys2 . "," . $xys3, value::get_item_value(197, 'name'));
            br();
        }
        if ($xys_195 < 1 && $xys_196 < 1 && $xys_197 < 1) {
            echo "你没有幸运石无法加强化成功率！";
            br();
        }
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        cmd::addcmd("e200,", "强化");
        echo ">> 强化结果";
        br();
        br();
        echo "-";
        br();
        $prop_id1 = $id;
        $qhs_sl = item::get_item($qhs);
        $ks_sl = item::get_item($ks);
        $xys195 = 0;
        $xys196 = 0;
        $xys197 = 0;
        if ($xys1 == 195) {
            $xys195 += 1;
        }
        if ($xys2 == 195) {
            $xys195 += 1;
        }
        if ($xys3 == 195) {
            $xys195 += 1;
        }
        if ($xys1 == 196) {
            $xys196 += 1;
        }
        if ($xys2 == 196) {
            $xys196 += 1;
        }
        if ($xys3 == 196) {
            $xys196 += 1;
        }
        if ($xys1 == 197) {
            $xys197 += 1;
        }
        if ($xys2 == 197) {
            $xys197 += 1;
        }
        if ($xys3 == 197) {
            $xys197 += 1;
        }
        $xys1_sl = item::get_item(195);
        $xys2_sl = item::get_item(196);
        $xys3_sl = item::get_item(197);
        $qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
        $qh_xg = $qianghuacishu + 1;
        $qh_name = prop::get($prop_id1, 'xs_name');
        if (!$qh_name) {
            $qh_name = prop::get($prop_id1, 'name');
        }
        $my_money = value::get_user_value('money');
        if ($my_money >= $money) {
            if ($qhs_sl > 0) {
                if ($ks_sl >= 3) {
                    if ($xys1_sl >= $xys195) {
                        if ($xys2_sl >= $xys196) {
                            if ($xys3_sl >= $xys197) {
                                if (mt_rand(1, 100) <= $cgl) {
                                    value::add_user_value('money', -1 * $money);
                                    item::add_item($qhs, -1);
                                    item::add_item($ks, -3);
                                    if ($xys195) {
                                        item::add_item(195, -1 * $xys195);
                                    }
                                    if ($xys196) {
                                        item::add_item(196, -1 * $xys196);
                                    }
                                    if ($xys197) {
                                        item::add_item(197, -1 * $xys197);
                                    }
                                    //设置装备属性 改名
                                    $xs_name = prop::get($prop_id1, 'xs_name');
                                    if (!$xs_name) {
                                        prop::set($prop_id1, 'xs_name', prop::get($prop_id1, 'name'));
                                    }
                                    prop::add($prop_id1, 'qianghuacishu', 1);
                                    $xs_qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
                                    prop::set($prop_id1, 'name', "+" . $xs_qianghuacishu . prop::get($prop_id1, 'xs_name'));
                                    //最大耐久
                                    $max_naijiu = prop::get($prop_id1, 'max_naijiu');
                                    $xs_max_naijiu = prop::get($prop_id1, 'xs_max_naijiu');
                                    if (!$xs_max_naijiu) {
                                        prop::set($prop_id1, 'xs_max_naijiu', prop::get($prop_id1, 'max_naijiu'));
                                    }
                                    if ($xs_qianghuacishu == 1) {
                                        $qh_jc = 0.1;
                                    } elseif ($xs_qianghuacishu == 2) {
                                        $qh_jc = 0.13;
                                    } elseif ($xs_qianghuacishu == 3) {
                                        $qh_jc = 0.16;
                                    } elseif ($xs_qianghuacishu == 4) {
                                        $qh_jc = 0.19;
                                    } elseif ($xs_qianghuacishu == 5) {
                                        $qh_jc = 0.22;
                                    } elseif ($xs_qianghuacishu == 6) {
                                        $qh_jc = 0.23;
                                    } elseif ($xs_qianghuacishu == 7) {
                                        $qh_jc = 0.25;
                                    } elseif ($xs_qianghuacishu == 8) {
                                        $qh_jc = 0.28;
                                    } elseif ($xs_qianghuacishu == 9) {
                                        $qh_jc = 0.31;
                                    } elseif ($xs_qianghuacishu == 10) {
                                        $qh_jc = 0.34;
                                    }
                                    $xs_max_naijiu = prop::get($prop_id1, 'xs_max_naijiu') * $qh_jc;
                                    prop::add($prop_id1, 'naijiu', $xs_max_naijiu);
                                    prop::add($prop_id1, 'max_naijiu', $xs_max_naijiu);
                                    //攻击
                                    $pugong = prop::get($prop_id1, 'pugong');
                                    $xs_pugong = prop::get($prop_id1, 'xs_pugong');
                                    if (!$xs_pugong) {
                                        prop::set($prop_id1, 'xs_pugong', prop::get($prop_id1, 'pugong'));
                                    }
                                    $xs_pugong = prop::get($prop_id1, 'xs_pugong') * $qh_jc;
                                    prop::add($prop_id1, 'pugong', $xs_pugong);
                                    //防御
                                    $pufang = prop::get($prop_id1, 'pufang');
                                    $xs_pufang = prop::get($prop_id1, 'xs_pufang');
                                    if (!$xs_pufang) {
                                        prop::set($prop_id1, 'xs_pufang', prop::get($prop_id1, 'pufang'));
                                    }
                                    $xs_pufang = prop::get($prop_id1, 'xs_pufang') * $qh_jc;
                                    prop::add($prop_id1, 'pufang', $xs_pufang);
                                    //魔攻
                                    $tegong = prop::get($prop_id1, 'tegong');
                                    $xs_tegong = prop::get($prop_id1, 'xs_tegong');
                                    if (!$xs_tegong) {
                                        prop::set($prop_id1, 'xs_tegong', prop::get($prop_id1, 'tegong'));
                                    }
                                    $xs_tegong = prop::get($prop_id1, 'xs_tegong') * $qh_jc;
                                    prop::add($prop_id1, 'tegong', $xs_tegong);
                                    //魔防
                                    $tefang = prop::get($prop_id1, 'tefang');
                                    $xs_tefang = prop::get($prop_id1, 'xs_tefang');
                                    if (!$xs_tefang) {
                                        prop::set($prop_id1, 'xs_tefang', prop::get($prop_id1, 'tefang'));
                                    }
                                    $xs_tefang = prop::get($prop_id1, 'xs_tefang') * $qh_jc;
                                    prop::add($prop_id1, 'tefang', $xs_tefang);
                                    //生命
                                    $hp = prop::get($prop_id1, 'hp');
                                    $xs_hp = prop::get($prop_id1, 'xs_hp');
                                    if (!$xs_hp) {
                                        prop::set($prop_id1, 'xs_hp', prop::get($prop_id1, 'hp'));
                                    }
                                    $xs_hp = prop::get($prop_id1, 'xs_hp') * $qh_jc;
                                    prop::add($prop_id1, 'hp', $xs_hp);
                                    prop::add($prop_id1, 'is_jiaoyi', 1);
                                    $qhcg_name = prop::get($prop_id1, 'name');
                                    echo "恭喜你，强化成功获得了{$qhcg_name}!";
                                    $my_name = value::get_game_user_value('name');
                                    $map_id = value::get_game_user_value('in_map_id');
                                    $map_name = value::get_map_value($map_id, 'name');
                                    c_add_guangbo("恭喜玩家{$my_name}在{$map_name}强化{$qhcg_name}成功了!");
                                } else {
                                    //设置装备属性 无法强化 改名
                                    value::add_user_value('money', -1 * $money);
                                    item::add_item($qhs, -1);
                                    item::add_item($ks, -3);
                                    if ($xys195) {
                                        item::add_item(195, -1 * $xys195);
                                    }
                                    if ($xys196) {
                                        item::add_item(196, -1 * $xys196);
                                    }
                                    if ($xys197) {
                                        item::add_item(197, -1 * $xys197);
                                    }
                                    $xs_qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
                                    if ($xs_qianghuacishu == 1) {
                                        $qh_jc = 0.1;
                                    } elseif ($xs_qianghuacishu == 2) {
                                        $qh_jc = 0.13;
                                    } elseif ($xs_qianghuacishu == 3) {
                                        $qh_jc = 0.16;
                                    } elseif ($xs_qianghuacishu == 4) {
                                        $qh_jc = 0.19;
                                    } elseif ($xs_qianghuacishu == 5) {
                                        $qh_jc = 0.22;
                                    } elseif ($xs_qianghuacishu == 6) {
                                        $qh_jc = 0.23;
                                    } elseif ($xs_qianghuacishu == 7) {
                                        $qh_jc = 0.25;
                                    } elseif ($xs_qianghuacishu == 8) {
                                        $qh_jc = 0.28;
                                    } elseif ($xs_qianghuacishu == 9) {
                                        $qh_jc = 0.31;
                                    } elseif ($xs_qianghuacishu == 10) {
                                        $qh_jc = 0.34;
                                    }
                                    $xs_name = prop::get($prop_id1, 'xs_name');
                                    if (!$xs_name) {
                                        prop::set($prop_id1, 'xs_name', prop::get($prop_id1, 'name'));
                                    }
                                    if ($xs_qianghuacishu > 1) {
                                        prop::add($prop_id1, 'qianghuacishu', -1);
                                    }
                                    $xs_qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
                                    prop::set($prop_id1, 'name', "+" . $xs_qianghuacishu . prop::get($prop_id1, 'xs_name'));
                                    //最大耐久
                                    $max_naijiu = prop::get($prop_id1, 'max_naijiu');
                                    $xs_max_naijiu = prop::get($prop_id1, 'xs_max_naijiu');
                                    if (!$xs_max_naijiu) {
                                        prop::set($prop_id1, 'xs_max_naijiu', prop::get($prop_id1, 'max_naijiu'));
                                    }
                                    $xs_max_naijiu = prop::get($prop_id1, 'xs_max_naijiu') * $qh_jc;
                                    prop::add($prop_id1, 'naijiu', -$xs_max_naijiu);
                                    prop::add($prop_id1, 'max_naijiu', -$xs_max_naijiu);
                                    //攻击
                                    $pugong = prop::get($prop_id1, 'pugong');
                                    $xs_pugong = prop::get($prop_id1, 'xs_pugong');
                                    if (!$xs_pugong) {
                                        prop::set($prop_id1, 'xs_pugong', prop::get($prop_id1, 'pugong'));
                                    }
                                    $xs_pugong = prop::get($prop_id1, 'xs_pugong') * $qh_jc;
                                    prop::add($prop_id1, 'pugong', -1 * $xs_pugong);
                                    //防御
                                    $pufang = prop::get($prop_id1, 'pufang');
                                    $xs_pufang = prop::get($prop_id1, 'xs_pufang');
                                    if (!$xs_pufang) {
                                        prop::set($prop_id1, 'xs_pufang', prop::get($prop_id1, 'pufang'));
                                    }
                                    $xs_pufang = prop::get($prop_id1, 'xs_pufang') * $qh_jc;
                                    prop::add($prop_id1, 'pufang', -1 * $xs_pufang);
                                    //魔攻
                                    $tegong = prop::get($prop_id1, 'tegong');
                                    $xs_tegong = prop::get($prop_id1, 'xs_tegong');
                                    if (!$xs_tegong) {
                                        prop::set($prop_id1, 'xs_tegong', prop::get($prop_id1, 'tegong'));
                                    }
                                    $xs_tegong = prop::get($prop_id1, 'xs_tegong') * $qh_jc;
                                    prop::add($prop_id1, 'tegong', -1 * $xs_tegong);
                                    //魔防
                                    $tefang = prop::get($prop_id1, 'tefang');
                                    $xs_tefang = prop::get($prop_id1, 'xs_tefang');
                                    if (!$xs_tefang) {
                                        prop::set($prop_id1, 'xs_tefang', prop::get($prop_id1, 'tefang'));
                                    }
                                    $xs_tefang = prop::get($prop_id1, 'xs_tefang') * $qh_jc;
                                    prop::add($prop_id1, 'tefang', -1 * $xs_tefang);
                                    //生命
                                    $hp = prop::get($prop_id1, 'hp');
                                    $xs_hp = prop::get($prop_id1, 'xs_hp');
                                    if (!$xs_hp) {
                                        prop::set($prop_id1, 'xs_hp', prop::get($prop_id1, 'hp'));
                                    }
                                    $xs_hp = prop::get($prop_id1, 'xs_hp') * $qh_jc;
                                    prop::add($prop_id1, 'hp', -1 * $xs_hp);
                                    $qhcg_name = prop::get($prop_id1, 'name');
                                    echo "很遗憾，强化失败获得{$qhcg_name}!";
                                }
                            } else {
                                echo "强化+{$qh_xg}{$qh_name}需要{$xys197} * " . value::get_item_value($xys3, 'name');
                                br();
                            }
                        } else {
                            echo "强化+{$qh_xg}{$qh_name}需要{$xys196} * " . value::get_item_value($xys2, 'name');
                            br();
                        }
                    } else {
                        echo "强化+{$qh_xg}{$qh_name}需要{$xys195} * " . value::get_item_value($xys1, 'name');
                        br();
                    }
                } else {
                    echo "强化+{$qh_xg}{$qh_name}需要3 * " . value::get_item_value($ks, 'name');
                    br();
                }
            } else {
                echo "强化+{$qh_xg}{$qh_name}需要1 * " . value::get_item_value($qhs, 'name');
                br();
            }
        } else {
            echo "强化+{$qh_xg}{$qh_name}需要消耗{$money}金币";
            br();
        }
    }
}

//帮派 强化装备
function e200_fm($step = 0, $id = 0, $prop_id = 0, $sl = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$step) {//选择强化装备
        cmd::addcmd("e200_fm", "附魔");
        echo ">> 请选择附魔的装备";
        br();
        echo "-";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`prop_id` FROM `game_prop` WHERE `fm`<1 AND `user_id`={$user_id} AND (`user_num`=1 OR `user_num`=5) ORDER BY LENGTH(`name`) DESC";
        $result = sql($sql);
        while (list($id, $prop_id) = $result->fetch_row()) {
            $prop_leixing = value::get_prop_value($prop_id, 'leixing');
            if ($prop_leixing == 2) {
                cmd::addcmd("e200_fm,1," . $id . "," . $prop_id, value::get_game_prop_value($id, 'name'));
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "背包中没有可以附魔的装备！";
            br();
        } else {
            cmd::set_return_game_br(false);
        }
        echo "-";
        br();
    } else if ($step == 1) {//查看选择装备
        cmd::addcmd("e200_fm", "附魔");
        echo ">> 请确认附魔的装备";
        br();
        echo "-";
        br();
        prop::show_prop($id, -1);
        cmd::addcmd("e200_fm,2," . $id . "," . $prop_id, "确认选择");
        br();
        echo "-";
        br();
        cmd::addcmd("e200_fm", "返回上级");
    } else if ($step == 2) {//选择消耗金币
        cmd::addcmd("e200_fm", "附魔");
        echo ">> 附魔装备需要材料";
        br();
        echo "-";
        br();
        $prop_name = value::get_game_prop_value($id, 'name');
        $prop_id = value::get_game_prop_value($id, 'prop_id');
        $sx_lvl = value::get_game_prop_value($id, 'fm');
        $equip_use_lvl = value::get_prop_value($prop_id, 'equip_use_lvl');
        if (!$sl) {
            $sl = 1;
        }
        echo "附魔：{$prop_name}";
        br();
        $item_qhs_name = value::get_item_value(285, 'name');
        $equip_use_lvl1 = (int)($equip_use_lvl / 10 + 1);
        $equip_use_lvl1 = $equip_use_lvl1;
        echo "需要：{$item_qhs_name} * {$equip_use_lvl1}";
        $sl = $equip_use_lvl1;
        br();
        echo "-";
        br();
        cmd::addcmd("e200_fm,3," . $id . "," . $prop_id . "," . $sl, "开始附魔");
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        cmd::addcmd("e200_fm", "附魔");
        echo ">> 附魔结果";
        br();
        br();
        echo "-";
        br();
        $prop_id1 = $id;
        $fm_sl = item::get_item(285);
        if ($fm_sl >= $sl) {
            item::add_item(285, -1 * $sl);
            prop::add($prop_id1, 'fm', 1);
            $qh_name = value::get_game_prop_value($prop_id1, 'name');
            $qh_sx_lvl = value::get_game_prop_value($prop_id1, 'fm');
            $my_name = value::get_game_user_value('name');
            $map_id = value::get_game_user_value('in_map_id');
            $map_name = value::get_map_value($map_id, 'name');
            echo "恭喜你升<span style=color:red>附魔</span>{$qh_name}成功！";
            br();
            c_add_guangbo("恭喜玩家{$my_name}在{$map_name}<span style=color:red>附魔</span>{$qh_name}成功!");
        } else {
            $item_qhs_name = value::get_item_value(285, 'name');
            echo "附魔{$qh_name}需要消耗{$sl}* {$item_qhs_name}";
            br();
        } 
    }
}

//帮派 强化装备
function e200_kg($step = 0, $id = 0, $prop_id = 0, $sl = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$step) {//选择强化装备
        cmd::addcmd("e200_kg", "开光");
        echo ">> 请选择开光的装备";
        br();
        echo "-";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`prop_id` FROM `game_prop` WHERE `qianghuacishu`=10 AND `user_id`={$user_id} AND (`user_num`=1 OR `user_num`=5) ORDER BY LENGTH(`name`) DESC";
        $result = sql($sql);
        while (list($id, $prop_id) = $result->fetch_row()) {
            $prop_leixing = value::get_prop_value($prop_id, 'leixing');
            if ($prop_leixing == 2) {
                cmd::addcmd("e200_kg,1," . $id . "," . $prop_id, value::get_game_prop_value($id, 'name'));
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "背包中没有可以开光的装备！";
            br();
        } else {
            cmd::set_return_game_br(false);
        }
        echo "-";
        br();
    } else if ($step == 1) {//查看选择装备
        cmd::addcmd("e200_fm", "开光");
        echo ">> 请确认开光的装备";
        br();
        echo "-";
        br();
        prop::show_prop($id, -1);
        cmd::addcmd("e200_kg,2," . $id . "," . $prop_id, "确认选择");
        br();
        echo "-";
        br();
        cmd::addcmd("e200_kg", "返回上级");
    } else if ($step == 2) {//选择消耗金币
        cmd::addcmd("e200_kg", "开光");
        echo ">> 开光装备需要材料";
        br();
        echo "-";
        br();
        $prop_name = value::get_game_prop_value($id, 'name');
        $prop_id = value::get_game_prop_value($id, 'prop_id');
        if (!$sl) {
            $sl = 1;
        }
        echo "开光：{$prop_name}";
        br();
        $item_qhs_name = value::get_item_value(286, 'name');
        echo "需要：{$item_qhs_name} * 1";
        br();
        echo "-";
        br();
        cmd::addcmd("e200_kg,3," . $id . "," . $prop_id . "," . $sl, "开始开光");
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        cmd::addcmd("e200_kg", "开光");
        echo ">> 开光结果";
        br();
        br();
        echo "-";
        br();
        $prop_id1 = $id;
        $fm_sl = item::get_item(286);
        if ($fm_sl >= 1) {
            item::add_item(286, -1);
            //设置装备属性 改名
            $xs_name = prop::get($prop_id1, 'xs_name');
            if (!$xs_name) {
                prop::set($prop_id1, 'xs_name', prop::get($prop_id1, 'name'));
            }
            prop::add($prop_id1, 'qianghuacishu', 1);
            prop::set($prop_id1, 'name', "〖神〗" . prop::get($prop_id1, 'xs_name'));
            //攻击
            $prop_id = value::get_game_prop_value($prop_id1, 'prop_id');
            $pugong = value::get_prop_value($prop_id, 'pugong');
            prop::add($prop_id1, 'pugong', $pugong);
            //防御
            $pufang = value::get_prop_value($prop_id, 'pufang');
            prop::add($prop_id1, 'pufang', $pufang);
            //魔攻
            $tegong = value::get_prop_value($prop_id, 'tegong');
            prop::add($prop_id1, 'tegong', $tegong);
            //魔防
            $tefang = value::get_prop_value($prop_id, 'tefang');
            prop::add($prop_id1, 'tefang', $tefang);
            //生命
            $hp = value::get_prop_value($prop_id, 'hp');
            prop::add($prop_id1, 'hp', $hp);
            //魔法
            $mp = value::get_prop_value($prop_id, 'mp');
            prop::add($prop_id1, 'mp', $mp);
            $sj = mt_rand(1, 7);
            $sj1 = mt_rand(1, 5);
            if ($sj == 1) {
                prop::add($prop_id1, 'mz', $sj1);
            } else if ($sj == 2) {
                prop::add($prop_id1, 'mb', $sj1);
            } else if ($sj == 3) {
                prop::add($prop_id1, 'km', $sj1);
            } else if ($sj == 4) {
                prop::add($prop_id1, 'xx', $sj1);
            } else if ($sj == 5) {
                prop::add($prop_id1, 'bj', $sj1);
            } else if ($sj == 6) {
                prop::add($prop_id1, 'zd', $sj1);
            } else if ($sj == 7) {
                prop::add($prop_id1, 'kd', $sj1);
            }
            $qh_name = value::get_game_prop_value($prop_id1, 'name');
            echo "恭喜你开光{$qh_name}成功！";
            br();
            $my_name = value::get_game_user_value('name');
            $map_id = value::get_game_user_value('in_map_id');
            $map_name = value::get_map_value($map_id, 'name');
            c_add_guangbo("<span style=color:red>神兵降世，恭喜玩家{$my_name}在{$map_name}开光{$qh_name}成功!</span>");
        } else {
            $item_qhs_name = value::get_item_value(286, 'name');
            echo "开光{$qh_name}需要消耗1* {$item_qhs_name}";
            br();
        } 
    }
}

//帮派 强化装备
function e200_sx($step = 0, $id = 0, $prop_id = 0, $sl = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$step) {//选择强化装备
        cmd::addcmd("e200_sx", "升星");
        echo ">> 请选择升星的装备";
        br();
        echo "-";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`prop_id` FROM `game_prop` WHERE `sx_lvl`<100 AND `user_id`={$user_id} AND (`user_num`=1 OR `user_num`=5) ORDER BY LENGTH(`name`) DESC";
        $result = sql($sql);
        while (list($id, $prop_id) = $result->fetch_row()) {
            $prop_leixing = value::get_prop_value($prop_id, 'leixing');
            if ($prop_leixing == 2) {
                if (value::get_game_prop_value($id, 'sx_lvl')) {
                    cmd::addcmd("e200_sx,1," . $id . "," . $prop_id, value::get_game_prop_value($id, 'sx_lvl') . "星" . value::get_game_prop_value($id, 'name'));
                } else {
                    cmd::addcmd("e200_sx,1," . $id . "," . $prop_id, value::get_game_prop_value($id, 'name'));
                }
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "背包中没有可以升星的装备！";
            br();
        } else {
            cmd::set_return_game_br(false);
        }
        echo "-";
        br();
    } else if ($step == 1) {//查看选择装备
        cmd::addcmd("e200_sx", "升星");
        echo ">> 请确认升星的装备";
        br();
        echo "-";
        br();
        prop::show_prop($id, -1);
        cmd::addcmd("e200_sx,2," . $id . "," . $prop_id, "确认选择");
        br();
        echo "-";
        br();
        cmd::addcmd("e200_sx", "返回上级");
    } else if ($step == 2) {//选择消耗金币
        cmd::addcmd("e200_sx", "升星");
        echo ">> 升星装备需要材料";
        br();
        echo "-";
        br();
        $prop_name = value::get_game_prop_value($id, 'name');
        $prop_id = value::get_game_prop_value($id, 'prop_id');
        $sx_lvl = value::get_game_prop_value($id, 'sx_lvl');
        $equip_use_lvl = value::get_prop_value($prop_id, 'equip_use_lvl');
        if (!$sl) {
            $sl = 1;
        }
        echo "升星：{$prop_name}";
        br();
        $item_qhs_name = value::get_item_value(287, 'name');
        $equip_use_lvl1 = $equip_use_lvl + $sx_lvl + 1;
        echo "需要：{$item_qhs_name} * {$equip_use_lvl1}";
        br();
        $sx_lvl_money = value::get_game_prop_value($id, 'sx_lvl') * 3000;
        echo "需要：{$sx_lvl_money}金币";
        $sl = $equip_use_lvl1;
        br();
        echo "-";
        br();
        cmd::addcmd("e200_sx,3," . $id . "," . $prop_id . "," . $sl, "开始升星");
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        cmd::addcmd("e200_sx", "升星");
        echo ">> 升星结果";
        br();
        br();
        echo "-";
        br();
        $prop_id1 = $id;
        $fm_sl = item::get_item(287);
        $u_money = item::get_money();
        $sx_lvl_money = value::get_game_prop_value($id, 'sx_lvl') * 3000;
        if ($u_money >= $sx_lvl_money) {
            if ($fm_sl >= $sl) {
                item::add_money(-1 * $sx_lvl_money);
                item::add_item(287, -1 * $sl);
                prop::add($prop_id1, 'sx_lvl', 1);
                prop::add($prop_id1, 'is_jiaoyi', 1);
                $prop_id = value::get_game_prop_value($prop_id1, 'prop_id');
                //攻击
                if (value::get_prop_value($prop_id, 'pugong')) {
                    $pugong = value::get_prop_value($prop_id, 'pugong') / 100 + mt_rand(1, 10);
                    prop::add($prop_id1, 'pugong', $pugong);
                }
                //防御
                if (value::get_prop_value($prop_id, 'pufang')) {
                    $pufang = value::get_prop_value($prop_id, 'pufang') / 100 + mt_rand(1, 10);
                    prop::add($prop_id1, 'pufang', $pufang);
                }
                //魔攻
                if (value::get_prop_value($prop_id, 'tegong')) {
                    $tegong = value::get_prop_value($prop_id, 'tegong') / 100 + mt_rand(1, 10);
                    prop::add($prop_id1, 'tegong', $tegong);
                }
                //魔防
                if (value::get_prop_value($prop_id, 'tefang')) {
                    $tefang = value::get_prop_value($prop_id, 'tefang') / 100 + mt_rand(1, 10);
                    prop::add($prop_id1, 'tefang', $tefang);
                }
                //生命
                if (value::get_prop_value($prop_id, 'hp')) {
                    $hp = value::get_prop_value($prop_id, 'hp') / 100 + mt_rand(1, 10);
                    prop::add($prop_id1, 'hp', $hp);
                }
                //魔法
                if (value::get_prop_value($prop_id, 'mp')) {
                    $mp = value::get_prop_value($prop_id, 'mp') / 100 + mt_rand(1, 10);
                    prop::add($prop_id1, 'mp', $mp);
                }
                $qh_name = value::get_game_prop_value($prop_id1, 'name');
                $qh_sx_lvl = value::get_game_prop_value($prop_id1, 'sx_lvl');
                $my_name = value::get_game_user_value('name');
                $map_id = value::get_game_user_value('in_map_id');
                $map_name = value::get_map_value($map_id, 'name');
                echo "恭喜你升<span style=color:red>{$qh_sx_lvl}星</span>{$qh_name}成功！";
                br();
                c_add_guangbo("恭喜玩家{$my_name}在{$map_name}升<span style=color:red>{$qh_sx_lvl}星</span>{$qh_name}成功!");
            } else {
                $item_qhs_name = value::get_item_value(287, 'name');
                echo "升星{$qh_name}需要消耗{$sl}* {$item_qhs_name}";
                br();
            } 
        } else {
            echo "升星{$qh_name}需要消耗{$sx_lvl_money}金币！";
            br();  
        }
    }
}

function e200_cb_sx($step = 0, $id = 0, $prop_id = 0, $sl = 0)
{
    $user_id = uid();
    if ($step == 1) {//查看选择装备
        cmd::addcmd("map_cb", "升星");
        echo ">> 请确认升星的翅膀";
        br();
        echo "-";
        br();
        prop::show_prop($id, -1);
        cmd::addcmd("e200_cb_sx,2," . $id . "," . $prop_id, "确认选择");
        br();
        echo "-";
        br();
        cmd::addcmd("map_cb", "返回上级");
    } else if ($step == 2) {//选择消耗金币
        cmd::addcmd("map_cb", "升星");
        echo ">> 升星装备需要材料";
        br();
        echo "-";
        br();
        $prop_name = value::get_game_prop_value($id, 'name');
        $prop_id = value::get_game_prop_value($id, 'prop_id');
        $sx_lvl = value::get_game_prop_value($id, 'sx_lvl');
        $sj_lvl = value::get_game_prop_value($id, 'sj_lvl');
        $equip_use_lvl = value::get_prop_value($prop_id, 'equip_use_lvl');
        if (!$sl) {
            $sl = 1;
        }
        echo "升星：{$prop_name}";
        br();
        $item_qhs_name = value::get_item_value(288, 'name');
        $equip_use_lvl1 = $sj_lvl * 100 + 10 * $sx_lvl + 10;
        echo "需要：{$item_qhs_name} * {$equip_use_lvl1}";
        $sl = $equip_use_lvl1;
        br();
        echo "-";
        br();
        cmd::addcmd("e200_cb_sx,3," . $id . "," . $prop_id . "," . $sl, "开始升星");
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        cmd::addcmd("map_cb", "升星");
        echo ">> 升星结果";
        br();
        br();
        echo "-";
        br();
        $prop_id1 = $id;
        $fm_sl = item::get_item(288);
        if ($fm_sl >= $sl) {
            item::add_item(288, -1 * $sl);
            prop::add($prop_id1, 'sx_lvl', 1);
            $zhiye = value::get_game_user_value('zhiye', $user_id);
            if ($zhiye == "战士") {
                $xs_pugong = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 4 + prop::get($prop_id1, 'sj_lvl') * 10 * 4;
                $xs_pufang = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 2 + prop::get($prop_id1, 'sj_lvl') * 10 * 2;
                $xs_tefang = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 2 + prop::get($prop_id1, 'sj_lvl') * 10 * 2;
                $xs_hp = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 6 + prop::get($prop_id1, 'sj_lvl') * 10 * 6;
                //攻击
                prop::add($prop_id1, 'pugong', $xs_pugong);
                //防御
                prop::add($prop_id1, 'pufang', $xs_pufang);
                //魔防
                prop::add($prop_id1, 'tefang', $xs_tefang);
                //生命
                prop::add($prop_id1, 'hp', $xs_hp);
            }
            if ($zhiye == "法师") {
                $xs_tegong = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 5 + prop::get($prop_id1, 'sj_lvl') * 10 * 5;
                $xs_pufang = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 2 + prop::get($prop_id1, 'sj_lvl') * 10 * 2;
                $xs_tefang = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 2 + prop::get($prop_id1, 'sj_lvl') * 10 * 2;
                $xs_hp = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 4 + prop::get($prop_id1, 'sj_lvl') * 10 * 4;
                //防御
                prop::add($prop_id1, 'pufang', $xs_pufang);
                //魔攻
                prop::add($prop_id1, 'tegong', $xs_tegong);
                //魔防
                prop::add($prop_id1, 'tefang', $xs_tefang);
                //生命
                prop::add($prop_id1, 'hp', $xs_hp);
            }
            if ($zhiye == "道士") {
                $xs_pugong = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 4 + prop::get($prop_id1, 'sj_lvl') * 10 * 4;
                $xs_pufang = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 2 + prop::get($prop_id1, 'sj_lvl') * 10 * 2;
                $xs_tegong = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 4 + prop::get($prop_id1, 'sj_lvl') * 10 * 4;
                $xs_tefang = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 2 + prop::get($prop_id1, 'sj_lvl') * 10 * 2;
                $xs_hp = prop::get($prop_id1, 'sj_lvl') * 10 + prop::get($prop_id1, 'sx_lvl') - 1 + prop::get($prop_id1, 'sx_lvl') * 5 + prop::get($prop_id1, 'sj_lvl') * 10 * 5;
                //攻击
                prop::add($prop_id1, 'pugong', $xs_pugong);
                //防御
                prop::add($prop_id1, 'pufang', $xs_pufang);
                //魔攻
                prop::add($prop_id1, 'tegong', $xs_tegong);
                //魔防
                prop::add($prop_id1, 'tefang', $xs_tefang);
                //生命
                prop::add($prop_id1, 'hp', $xs_hp);
            }
            $qh_name = value::get_game_prop_value($prop_id1, 'name');
            $qh_sx_lvl = value::get_game_prop_value($prop_id1, 'sx_lvl');
            $sj_lvl = value::get_game_prop_value($prop_id1, 'sj_lvl');
            $my_name = value::get_game_user_value('name');
            $map_id = value::get_game_user_value('in_map_id');
            $map_name = value::get_map_value($map_id, 'name');
            echo "恭喜你升<span style=color:red>{$qh_sx_lvl}星</span>{$qh_name}成功！";
            br();
            c_add_guangbo("恭喜玩家{$my_name}在{$map_name}升<span style=color:red>{$qh_sx_lvl}星</span>{$qh_name}成功!");
        } else {
            $item_qhs_name = value::get_item_value(288, 'name');
            echo "升星{$qh_name}需要消耗{$sl}* {$item_qhs_name}";
            br();
        } 
    }
}

function e200_cb_sx1($step = 0, $id = 0, $prop_id = 0, $sl = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if ($step == 1) {//查看选择装备
        cmd::addcmd("map_cb", "升星");
        echo ">> 请确认升星的翅膀";
        br();
        echo "-";
        br();
        prop::show_prop($id, -1);
        cmd::addcmd("e200_cb_sx1,2," . $id . "," . $prop_id, "确认选择");
        br();
        echo "-";
        br();
        cmd::addcmd("map_cb", "返回上级");
    } else if ($step == 2) {//选择消耗金币
        cmd::addcmd("map_cb", "升星");
        echo ">> 升星装备需要材料";
        br();
        echo "-";
        br();
        $prop_name = value::get_game_prop_value($id, 'name');
        $prop_id = value::get_game_prop_value($id, 'prop_id');
        $sx_lvl = value::get_game_prop_value($id, 'sx_lvl');
        $sj_lvl = value::get_game_prop_value($id, 'sj_lvl') + 1;
        $equip_use_lvl = value::get_prop_value($prop_id, 'equip_use_lvl');
        if ($prop_id == 320) {
            $fm_sl1 = item::get_item(290);
            if ($fm_sl1 >= 1) {
                $sl1 = 290;
            } else {
                $sl1 = 293;
            }
        } elseif ($prop_id == 321) {
            $fm_sl1 = item::get_item(291);
            if ($fm_sl1 >= 1) {
                $sl1 = 291;
            } else {
                $sl1 = 294;
            }
        } elseif ($prop_id == 322) {
            $fm_sl1 = item::get_item(292);
            if ($fm_sl1 >= 1) {
                $sl1 = 292;
            } else {
                $sl1 = 295;
            }
        }
        echo "升星：{$prop_name}";
        br();
        $item_qhs_name = value::get_item_value($sl1, 'name');
        if ($sx_lvl == 0) {
            $sl = 2;
        } elseif ($sx_lvl == 1) {
            $sl = 4;
        } elseif ($sx_lvl == 2) {
            $sl = 7;
        } elseif ($sx_lvl == 3) {
            $sl = 11;
        } elseif ($sx_lvl == 4) {
            $sl = 15;
        }
        echo "需要：{$item_qhs_name} * {$sl}";
        br();
        echo "-";
        br();
        cmd::addcmd("e200_cb_sx1,3," . $id . "," . $prop_id . "," . $sl, "开始升星");
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        cmd::addcmd("map_cb", "升星");
        echo ">> 升星结果";
        br();
        br();
        echo "-";
        br();
        $prop_id1 = $id;
        if ($prop_id == 320) {
            $fm_sl1 = item::get_item(290);
            if ($fm_sl1 >= $sl) {
                $sl1 = 290;
            } else {
                $sl1 = 293;
            }
        } elseif ($prop_id == 321) {
            $fm_sl1 = item::get_item(291);
            if ($fm_sl1 >= $sl) {
                $sl1 = 291;
            } else {
                $sl1 = 294;
            }
        } elseif ($prop_id == 322) {
            $fm_sl1 = item::get_item(292);
            if ($fm_sl1 >= $sl) {
                $sl1 = 292;
            } else {
                $sl1 = 295;
            }
        }
        $fm_sl = item::get_item($sl1);
        if ($fm_sl >= $sl) {
            item::add_item($sl1, -1 * $sl);
            $sx_lvl = value::get_game_prop_value($id, 'sx_lvl');
            if ($sx_lvl == 0) {
                $sx_sx = 1;
            } elseif ($sx_lvl == 1) {
                $sx_sx = 1.2;
            } elseif ($sx_lvl == 2) {
                $sx_sx = 1.4;
            } elseif ($sx_lvl == 3) {
                $sx_sx = 1.6;
            } elseif ($sx_lvl == 4) {
                $sx_sx = 1.4;
            }
            prop::add($prop_id1, 'sx_lvl', 1);
            //攻击
            $prop_id = value::get_game_prop_value($prop_id1, 'prop_id');
            $pugong = (int)(value::get_prop_value($prop_id, 'pugong') * $sx_sx);
            prop::add($prop_id1, 'pugong', $pugong);
            //防御
            $pufang = (int)(value::get_prop_value($prop_id, 'pufang') * $sx_sx);
            prop::add($prop_id1, 'pufang', $pufang);
            //魔攻
            $tegong = (int)(value::get_prop_value($prop_id, 'tegong') * $sx_sx);
            prop::add($prop_id1, 'tegong', $tegong);
            //魔防
            $tefang = (int)(value::get_prop_value($prop_id, 'tefang') * $sx_sx);
            prop::add($prop_id1, 'tefang', $tefang);
            //生命
            $hp = (int)(value::get_prop_value($prop_id, 'hp') * $sx_sx);
            prop::add($prop_id1, 'hp', $hp);
            //设置装备属性 改名
            $qh_name = value::get_game_prop_value($prop_id1, 'name');
            $qh_sx_lvl = value::get_game_prop_value($prop_id1, 'sx_lvl');
            $my_name = value::get_game_user_value('name');
            $map_id = value::get_game_user_value('in_map_id');
            $map_name = value::get_map_value($map_id, 'name');
            echo "恭喜你升<span style=color:red>{$qh_sx_lvl}星</span>{$qh_name}成功！";
            br();
            c_add_guangbo("恭喜玩家{$my_name}在{$map_name}升<span style=color:red>{$qh_sx_lvl}星</span>{$qh_name}成功!");
        } else {
            $item_qhs_name = value::get_item_value($sl1, 'name');
            echo "升星{$qh_name}需要消耗{$sl}* {$item_qhs_name}";
            br();
        } 
    }
}

function e200_cb_sx3($step = 0, $id = 0, $prop_id = 0, $sl = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if ($step == 1) {//查看选择装备
        cmd::addcmd("map_cb", "升阶");
        echo ">> 请确认升阶的翅膀";
        br();
        echo "-";
        br();
        prop::show_prop($id, -1);
        cmd::addcmd("e200_cb_sx3,2," . $id . "," . $prop_id, "确认选择");
        br();
        echo "-";
        br();
        cmd::addcmd("map_cb", "返回上级");
    } else if ($step == 2) {//选择消耗金币
        cmd::addcmd("map_cb", "升阶");
        echo ">> 升阶装备需要材料";
        br();
        echo "-";
        br();
        $prop_name = value::get_game_prop_value($id, 'name');
        $prop_id = value::get_game_prop_value($id, 'prop_id');
        $sx_lvl = value::get_game_prop_value($id, 'sx_lvl');
        $sj_lvl = value::get_game_prop_value($id, 'sj_lvl') + 1;
        $equip_use_lvl = value::get_prop_value($prop_id, 'equip_use_lvl');
        $sl = $sj_lvl * 40;
        echo "升阶：{$prop_name}";
        br();
        $item_qhs_name = value::get_item_value(289, 'name');
        echo "需要：{$item_qhs_name} * {$sl}";
        br();
        echo "-";
        br();
        cmd::addcmd("e200_cb_sx3,3," . $id . "," . $prop_id . "," . $sl, "开始升阶");
        br();
        echo "-";
        br();
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        cmd::addcmd("map_cb", "升阶");
        echo ">> 升阶结果";
        br();
        echo "-";
        br();
        $prop_id1 = $id;
        $fm_sl = item::get_item(289);
        $sj_lvl = value::get_game_prop_value($id, 'sj_lvl') + 1;
        $sl = $sj_lvl * 40;
        if ($fm_sl >= $sl) {
            item::add_item(289, -1 * $sl);
            prop::add($prop_id1, 'sj_lvl', 1);
            prop::add($prop_id1, 'sx_lvl', -10);
            $sx_lvl = value::get_game_prop_value($id, 'sx_lvl');
            $sx_sx = 0.1;
            //攻击
            $pugong = (int)(value::get_game_prop_value($id, 'pugong') * $sx_sx);
            prop::add($prop_id1, 'pugong', $pugong);
            //防御
            $pufang = (int)(value::get_game_prop_value($id, 'pufang') * $sx_sx);
            prop::add($prop_id1, 'pufang', $pufang);
            //魔攻
            $tegong = (int)(value::get_game_prop_value($id, 'tegong') * $sx_sx);
            prop::add($prop_id1, 'tegong', $tegong);
            //魔防
            $tefang = (int)(value::get_game_prop_value($id, 'tefang') * $sx_sx);
            prop::add($prop_id1, 'tefang', $tefang);
            //生命
            $hp = (int)(value::get_game_prop_value($id, 'hp') * $sx_sx);
            prop::add($prop_id1, 'hp', $hp);
            $qh_name = value::get_game_prop_value($prop_id1, 'name');
            $qh_sj_lvl = value::get_game_prop_value($prop_id1, 'sj_lvl');
            $my_name = value::get_game_user_value('name');
            $map_id = value::get_game_user_value('in_map_id');
            $map_name = value::get_map_value($map_id, 'name');
            echo "恭喜你升<span style=color:red>{$qh_sj_lvl}阶</span>{$qh_name}成功！";
            br();
            c_add_guangbo("恭喜玩家{$my_name}在{$map_name}升<span style=color:red>{$qh_sj_lvl}阶</span>{$qh_name}成功!");
        } else {
            $item_qhs_name = value::get_item_value(289, 'name');
            echo "升阶{$qh_name}需要消耗{$sl}* {$item_qhs_name}";
            br();
        } 
    }
}

//帮派 强化装备
function qh_e200($step = 0, $prop_id1 = 0, $prop_id2 = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$step) {//选择强化装备
        echo "请选择您想要强化哪件装备!";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`prop_id` FROM `game_prop` WHERE is_qianghua!=10  AND `user_num`=1  AND `user_id`={$user_id} ORDER BY LENGTH(`name`) DESC";
        $result = sql($sql);
        while (list($game_prop_id, $prop_zz_id) = $result->fetch_row()) {
            $prop_leixing = value::get_prop_value($prop_zz_id, 'leixing');
            if ($prop_leixing == 2) {
                prop::show_prop($game_prop_id, -1);
                cmd::addcmd("e200,1," . $game_prop_id, "确认选择");
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "背包中没有可以强化的装备。";
        } else {
            cmd::set_return_game_br(false);
        }
    } else if ($step == 1) {//选择消耗装备
        echo "请选择您想要消耗哪件装备!";
        br();
        $item_count = 0;
        $sql = "SELECT `id`,`prop_id` FROM `game_prop` WHERE is_qianghua!=10 AND `user_num`=1 AND `user_id`={$user_id} AND `id`!={$prop_id1} ORDER BY LENGTH(`name`) ASC";
        $result = sql($sql);
        while (list($game_prop_id, $prop_zz_id) = $result->fetch_row()) {
            $prop_leixing = value::get_prop_value($prop_zz_id, 'leixing');
            if ($prop_leixing == 2) {
                prop::show_prop($game_prop_id, -1);
                cmd::addcmd("e200,2," . $prop_id1 . "," . $game_prop_id, "确认选择");
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "背包中没有可以消耗的装备。";
        } else {
            cmd::set_return_game_br(false);
        }
    } else if ($step == 2) {//选择消耗金币
        $qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
        $cgl = 100 - $qianghuacishu * 10;
        $xs_qh = $qianghuacishu + 1;
        $need_money = 000000000000000000000000000000000000000000000000000000000000000000000000000000000;
        $need_money1 = $need_money / 1000;
        $xs_cgl = $cgl + $need_money1;
        echo "您装备强化到+ {$xs_qh}成功率百分之{$xs_cgl}!";
        br();
        echo "请选择您想要消耗多少个金币(100-10000)强化装备?";
        br();
        $url = cmd::addcmd("e200,3," . $prop_id1 . "," . $prop_id2, "", false, true);
        echo <<<html
<form action="$url" method="post">
<input type="text" name="money" value="1" maxlength="5">
<br>
<input type="submit" value="确认强化">
</form>
html;
        cmd::set_return_game_br(false);
    } else if ($step == 3) {//开始强化
        $need_money = (int)post::get("money");
        $qhs0 = item::get_item(223);
        $qhs1 = item::get_item(224);
        $qhs2 = item::get_item(225);
        $qhs3 = item::get_item(226);
        $qhs4 = item::get_item(227);
        $qhs5 = item::get_item(228);
        $qhs6 = item::get_item(229);
        $qhs7 = item::get_item(230);
        $qhs8 = item::get_item(231);
        $qhs9 = item::get_item(232);
        $qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
        if ($qianghuacishu == 0 && $qhs0 > 0 || $qianghuacishu == 1 && $qhs1 > 0 || $qianghuacishu == 2 && $qhs2 > 0 || $qianghuacishu == 3 && $qhs3 > 0 || $qianghuacishu == 4 && $qhs4 > 0 || $qianghuacishu == 5 && $qhs5 > 0 || $qianghuacishu == 6 && $qhs6 > 0 || $qianghuacishu == 7 && $qhs7 > 0 || $qianghuacishu == 8 && $qhs8 > 0 || $qianghuacishu == 9 && $qhs9 > 0) {
            if (prop::user_have_prop($prop_id1, $user_id, 1) && prop::user_have_prop($prop_id2, $user_id, 1)) {
                if (value::get_game_prop_value($prop_id1, 'qianghuacishu') < 10) {
                    if ($need_money >= 100 && $need_money <= 10000) {
                        if (item::add_money(-1 * $need_money)) {
                            $qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
                            $cgl = 100 - $qianghuacishu * 10;
                            $need_money1 = $need_money / 1000;
                            if (mt_rand(1, 100) <= ($need_money1 + $cgl)) {
                                if ($qianghuacishu == 0) {
                                    item::add_item(223, -1);
                                } elseif ($qianghuacishu == 1) {
                                    item::add_item(224, -1);
                                } elseif ($qianghuacishu == 2) {
                                    item::add_item(225, -1);
                                } elseif ($qianghuacishu == 3) {
                                    item::add_item(226, -1);
                                } elseif ($qianghuacishu == 4) {
                                    item::add_item(227, -1);
                                } elseif ($qianghuacishu == 5) {
                                    item::add_item(228, -1);
                                } elseif ($qianghuacishu == 6) {
                                    item::add_item(229, -1);
                                } elseif ($qianghuacishu == 7) {
                                    item::add_item(230, -1);
                                } elseif ($qianghuacishu == 8) {
                                    item::add_item(231, -1);
                                } elseif ($qianghuacishu == 9) {
                                    item::add_item(232, -1);
                                }
                                //设置装备属性 改名
                                $xs_name = prop::get($prop_id1, 'xs_name');
                                if (!$xs_name) {
                                    prop::set($prop_id1, 'xs_name', prop::get($prop_id1, 'name'));
                                }
                                prop::add($prop_id1, 'qianghuacishu', 1);
                                $xs_qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
                                prop::set($prop_id1, 'name', "+" . $xs_qianghuacishu . prop::get($prop_id1, 'xs_name'));
                                //最大耐久
                                $max_naijiu = prop::get($prop_id1, 'max_naijiu');
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie');
                                if (!$xs_minjie) {
                                    prop::set($prop_id1, 'xs_minjie', prop::get($prop_id1, 'max_naijiu'));
                                }
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie') * 0.1;
                                prop::add($prop_id1, 'naijiu', $xs_minjie);
                                //攻击
                                $pugong = prop::get($prop_id1, 'pugong');
                                $xs_pugong = prop::get($prop_id1, 'xs_pugong');
                                if (!$xs_pugong) {
                                    prop::set($prop_id1, 'xs_pugong', prop::get($prop_id1, 'pugong'));
                                }
                                $xs_pugong = prop::get($prop_id1, 'xs_pugong') * 0.1;
                                prop::add($prop_id1, 'pugong', $xs_pugong);
                                //防御
                                $pufang = prop::get($prop_id1, 'pufang');
                                $xs_pufang = prop::get($prop_id1, 'xs_pufang');
                                if (!$xs_pufang) {
                                    prop::set($prop_id1, 'xs_pufang', prop::get($prop_id1, 'pufang'));
                                }
                                $xs_pufang = prop::get($prop_id1, 'xs_pufang') * 0.1;
                                prop::add($prop_id1, 'pufang', $xs_pufang);
                                //魔攻
                                $tegong = prop::get($prop_id1, 'tegong');
                                $xs_tegong = prop::get($prop_id1, 'xs_tegong');
                                if (!$xs_tegong) {
                                    prop::set($prop_id1, 'xs_tegong', prop::get($prop_id1, 'tegong'));
                                }
                                $xs_tegong = prop::get($prop_id1, 'xs_tegong') * 0.1;
                                prop::add($prop_id1, 'tegong', $xs_tegong);
                                //魔防
                                $tefang = prop::get($prop_id1, 'tefang');
                                $xs_tefang = prop::get($prop_id1, 'xs_tefang');
                                if (!$xs_tefang) {
                                    prop::set($prop_id1, 'xs_tefang', prop::get($prop_id1, 'tefang'));
                                }
                                $xs_tefang = prop::get($prop_id1, 'xs_tefang') * 0.1;
                                prop::add($prop_id1, 'tefang', $xs_tefang);
                                //生命
                                $hp = prop::get($prop_id1, 'hp');
                                $xs_hp = prop::get($prop_id1, 'xs_hp');
                                if (!$xs_hp) {
                                    prop::set($prop_id1, 'xs_hp', prop::get($prop_id1, 'hp'));
                                }
                                $xs_hp = prop::get($prop_id1, 'xs_hp') * 0.1;
                                prop::add($prop_id1, 'hp', $xs_hp);
                                //灵活
                                $minjie = prop::get($prop_id1, 'minjie');
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie');
                                if (!$xs_minjie) {
                                    prop::set($prop_id1, 'xs_minjie', prop::get($prop_id1, 'minjie'));
                                }
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie') * 0.1;
                                prop::add($prop_id1, 'minjie', $xs_minjie);
                                echo "当!当!当!强化成功!";
                            } else {
                                //设置装备属性 无法强化 改名
                                if ($qianghuacishu == 0) {
                                    item::add_item(223, -1);
                                } elseif ($qianghuacishu == 1) {
                                    item::add_item(224, -1);
                                } elseif ($qianghuacishu == 2) {
                                    item::add_item(225, -1);
                                } elseif ($qianghuacishu == 3) {
                                    item::add_item(226, -1);
                                } elseif ($qianghuacishu == 4) {
                                    item::add_item(227, -1);
                                } elseif ($qianghuacishu == 5) {
                                    item::add_item(228, -1);
                                } elseif ($qianghuacishu == 6) {
                                    item::add_item(229, -1);
                                } elseif ($qianghuacishu == 7) {
                                    item::add_item(230, -1);
                                } elseif ($qianghuacishu == 8) {
                                    item::add_item(231, -1);
                                } elseif ($qianghuacishu == 9) {
                                    item::add_item(232, -1);
                                }
                                $qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
                                $xs_name = prop::get($prop_id1, 'xs_name');
                                if (!$xs_name) {
                                    prop::set($prop_id1, 'xs_name', prop::get($prop_id1, 'name'));
                                }
                                if ($qianghuacishu > 1) {
                                    prop::add($prop_id1, 'qianghuacishu', -1);
                                }
                                $xs_qianghuacishu = prop::get($prop_id1, 'qianghuacishu');
                                prop::set($prop_id1, 'name', "+" . $xs_qianghuacishu . prop::get($prop_id1, 'xs_name'));
                                //最大耐久
                                $max_naijiu = prop::get($prop_id1, 'max_naijiu');
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie');
                                if (!$xs_minjie) {
                                    prop::set($prop_id1, 'xs_minjie', prop::get($prop_id1, 'max_naijiu'));
                                }
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie') * 0.1;
                                prop::add($prop_id1, 'naijiu', -$xs_minjie);
                                //攻击
                                $pugong = prop::get($prop_id1, 'pugong');
                                $xs_pugong = prop::get($prop_id1, 'xs_pugong');
                                if (!$xs_pugong) {
                                    prop::set($prop_id1, 'xs_pugong', prop::get($prop_id1, 'pugong'));
                                }
                                $xs_pugong = prop::get($prop_id1, 'xs_pugong') * 0.1;
                                prop::add($prop_id1, 'pugong', -$xs_pugong);
                                //防御
                                $pufang = prop::get($prop_id1, 'pufang');
                                $xs_pufang = prop::get($prop_id1, 'xs_pufang');
                                if (!$xs_pufang) {
                                    prop::set($prop_id1, 'xs_pufang', prop::get($prop_id1, 'pufang'));
                                }
                                $xs_pufang = prop::get($prop_id1, 'xs_pufang') * 0.1;
                                prop::add($prop_id1, 'pufang', -$xs_pufang);
                                //魔攻
                                $tegong = prop::get($prop_id1, 'tegong');
                                $xs_tegong = prop::get($prop_id1, 'xs_tegong');
                                if (!$xs_tegong) {
                                    prop::set($prop_id1, 'xs_tegong', prop::get($prop_id1, 'tegong'));
                                }
                                $xs_tegong = prop::get($prop_id1, 'xs_tegong') * 0.1;
                                prop::add($prop_id1, 'tegong', -$xs_tegong);
                                //魔防
                                $tefang = prop::get($prop_id1, 'tefang');
                                $xs_tefang = prop::get($prop_id1, 'xs_tefang');
                                if (!$xs_tefang) {
                                    prop::set($prop_id1, 'xs_tefang', prop::get($prop_id1, 'tefang'));
                                }
                                $xs_tefang = prop::get($prop_id1, 'xs_tefang') * 0.1;
                                prop::add($prop_id1, 'tefang', -$xs_tefang);
                                //生命
                                $hp = prop::get($prop_id1, 'hp');
                                $xs_hp = prop::get($prop_id1, 'xs_hp');
                                if (!$xs_hp) {
                                    prop::set($prop_id1, 'xs_hp', prop::get($prop_id1, 'hp'));
                                }
                                $xs_hp = prop::get($prop_id1, 'xs_hp') * 0.1;
                                prop::add($prop_id1, 'hp', -$xs_hp);
                                //灵活
                                $minjie = prop::get($prop_id1, 'minjie');
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie');
                                if (!$xs_minjie) {
                                    prop::set($prop_id1, 'xs_minjie', prop::get($prop_id1, 'minjie'));
                                }
                                $xs_minjie = prop::get($prop_id1, 'xs_minjie') * 0.1;
                                prop::add($prop_id1, 'minjie', -$xs_minjie);
                                echo "当!当!当!强化失败!";
                            }
                            //显示装备详情
                            br();
                            prop::show_prop($prop_id1, -1);
                            prop::del_prop($prop_id2);
                        }
                    } else {
                        echo "请输入1-10000000的金币数量!";
                        br();
                    }
                } else {
                    echo "装备不符合强化条件!";
                    br();
                }
            } else {
                echo "你不是装备的主人!";
                br();
            }
        } else {
            $xy_qianghuacishu = prop::get($prop_id1, 'qianghuacishu') + 1;
            echo "你背包没有强化石{$xy_qianghuacishu}无法强化装备!";
            br();
        }
        cmd::addcmd("e200", "继续强化");
    }
}

//帮派 合成宠物
function e201($step = 0, $o_user_id = 0, $u_pet_id = 0, $o_pet_id = 0, $baoshi_id = 0)
{
    $user_id = uid();
    $union_id = user::get_union($user_id);
    if (!$step) {//选择对方玩家
        $in_map_id = value::get_game_user_value('in_map_id', $user_id);
        //开始获取在线玩家
        $ucount = 0;
        $sql = "SELECT `id`,`name` FROM `game_user` WHERE `id`!='{$user_id}' AND `name`!='' AND `in_map_id` = {$in_map_id} AND `gonghui.id`={$union_id} AND `is_online` =1 LIMIT 0, 4";
        $result = sql($sql);
        while (list($oid, $oname) = $result->fetch_row()) {
            $ucount++;
            if ($ucount == 1) {
                echo "请选择你要与之合成宠物的帮派玩家:";
                br();
            }
            $union_id = user::get_union($oid);
            if ($union_id) {
                $oname = "[" . union::get_name($union_id) . "]" . $oname;
            }
            cmd::addcmd('e201,1,' . $oid, $oname);
        }
        if (!$ucount) {
            echo "这里没有其它帮派玩家!";
        }
    } else if ($step == 1) {//选择宠物妈妈
        echo "请选择宠物妈妈:";
        $pet_count = 0;
        $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`=$user_id AND `master_mode`=1 AND `sex`='雌' LIMIT 5";
        $rs = sql($sql);
        while (list($pet1_id) = $rs->fetch_row()) {
            br();
            $pet_count++;
            $pet_nick_name = value::getvalue('game_pet', 'nick_name', 'id', $pet1_id);
            $pet_name = value::getvalue('game_pet', 'name', 'id', $pet1_id);
            $pet_lvl = value::getvalue('game_pet', 'lvl', 'id', $pet1_id);
            $pet_is_dead = value::getvalue('game_pet', 'is_dead', 'id', $pet1_id);
            cmd::addcmd("e201,2,$o_user_id,$pet1_id", ($pet_nick_name ? "({$pet_nick_name})" : "") . $pet_name . '(' . $pet_lvl . '级)');
            echo $pet_is_dead ? "(已死亡)" : "";
        }
        if (!$pet_count) {
            br();
            echo "没有找到宠物妈妈,无法合成。";
        }
    } else if ($step == 2) {//选择宠物爸爸
        //错误语句
        $error = "";
        //判断宠物妈妈是否符合条件
        $pet1_id = $u_pet_id;
        $pet1_ok = true;
        if (pet::is_yesheng($pet1_id)) {
            $pet1_ok = false;
            $error = "宠物妈妈还是野生宠物,无法合成。";
        } else if (pet::get($pet1_id, 'is_dead')) {
            $pet1_ok = false;
            $error = "宠物妈妈已经死亡,无法合成。";
        } else if (pet::get($pet1_id, 'hechongcishu') < 1) {
            $pet1_ok = false;
            $error = "宠物妈妈没有合成次数,无法合成。";
        } else if (pet::get($pet1_id, 'lvl') < pet::get_zz($pet1_id, 'star') * 20) {
            $pet1_ok = false;
            $error = "宠物妈妈等级不够,无法合成。";
        }
        if ($pet1_ok) {
            echo "请选择宠物爸爸:";
            $pet_count = 0;
            $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`=$o_user_id AND `master_mode`=1 AND `sex`='雄' LIMIT 5";
            $rs = sql($sql);
            while (list($pet1_id) = $rs->fetch_row()) {
                br();
                $pet_count++;
                $pet_nick_name = value::getvalue('game_pet', 'nick_name', 'id', $pet1_id);
                $pet_name = value::getvalue('game_pet', 'name', 'id', $pet1_id);
                $pet_lvl = value::getvalue('game_pet', 'lvl', 'id', $pet1_id);
                $pet_is_dead = value::getvalue('game_pet', 'is_dead', 'id', $pet1_id);
                cmd::addcmd("e201,3,$o_user_id,$u_pet_id,$pet1_id", ($pet_nick_name ? "({$pet_nick_name})" : "") . $pet_name . '(' . $pet_lvl . '级)');
                echo $pet_is_dead ? "(已死亡)" : "";
            }
            if (!$pet_count) {
                br();
                echo "没有找到宠物爸爸,无法合成。";
            }
        } else {
            echo $error;
        }
    } else if ($step == 3) {//选择宝石
        //错误语句
        $error = "";
        //判断宠物爸爸是否符合条件
        $pet1_id = $u_pet_id;
        $pet2_id = $o_pet_id;
        $pet1_zz_id = pet::get($pet1_id, 'pet_id');
        $pet2_zz_id = pet::get($pet2_id, 'pet_id');
        //是否合成新将ID
        if ($pet1_zz_id == $pet2_zz_id) {
            $new_pet_id = $pet1_zz_id;
        } else {
            $new_pet_id = pet::get_hechengchongwu($pet1_zz_id, $pet2_zz_id);
        }
        $pet2_ok = true;
        if (pet::is_yesheng($pet2_id)) {
            $pet2_ok = false;
            $error = "宠物爸爸还是野生宠物,无法合成。";
        } else if (pet::get($pet2_id, 'is_dead')) {
            $pet2_ok = false;
            $error = "宠物爸爸已经死亡,无法合成。";
        } else if (pet::get($pet2_id, 'lvl') < pet::get_zz($pet2_id, 'star') * 20) {
            $pet2_ok = false;
            $error = "宠物爸爸等级不够,无法合成。";
        } else if ($pet1_zz_id != $pet2_zz_id && !$new_pet_id) {
            $pet2_ok = false;
            $pet1_name = pet::get($pet1_id, 'name');
            $pet2_name = pet::get($pet2_id, 'name');
            $error = "{$pet1_name}与{$pet2_name}无法合成。";
        }
        if ($pet2_ok) {
            echo "请选择合成宝石提高几率:";
            br();
            $baoshi_arr = array(22, 23, 24, 25);
            foreach ($baoshi_arr as $baoshi_id) {
                $baoshi_name = value::get_item_value($baoshi_id, 'name');
                $baoshi_count = item::get_item($baoshi_id, $user_id);
                if ($baoshi_count) {
                    cmd::addcmd("e201,4,$o_user_id,$u_pet_id,$o_pet_id,$baoshi_id", $baoshi_name . "x" . $baoshi_count . "颗");
                    br();
                }
            }
            cmd::addcmd("e201,4,$o_user_id,$u_pet_id,$o_pet_id,0", "不使用宝石");
        } else {
            echo $error;
        }
    } else if ($step == 4) {//确认合成
        //合成新将ID
        $pet1_id = $u_pet_id;
        $pet2_id = $o_pet_id;
        $pet1_zz_id = pet::get($pet1_id, 'pet_id');
        $pet2_zz_id = pet::get($pet2_id, 'pet_id');
        if ($pet1_zz_id == $pet2_zz_id) {
            $new_pet_id = $pet1_zz_id;
        } else {
            $new_pet_id = pet::get_hechengchongwu($pet1_zz_id, $pet2_zz_id);
        }
        //输出成功率语句与确认语句
        $desc = "";
        //默认合成率
        $hyc_lvl = union::get($union_id, 'jz.hyc.lvl');
        $defult_chenggonglv = $max_jccgl = 60 + 5 * $hyc_lvl;
        $defult_chenggonglv = $defult_chenggonglv - value::getvalue('pet', 'exp', 'id', $new_pet_id) + 40;
        $defult_chenggonglv = $defult_chenggonglv > $max_jccgl ? $max_jccgl : $defult_chenggonglv;
        $defult_chenggonglv = $defult_chenggonglv < 30 ? 30 : $defult_chenggonglv;
        //宝石
        $baoshi_chenggonglv_arr = array(22 => 5, 23 => 10, 24 => 15, 25 => 20);
        if ($baoshi_id) {
            $baoshi_name = value::get_item_value($baoshi_id, 'name');
            $desc = "使用{$baoshi_name}的";
            $chenggonglv = $defult_chenggonglv + $baoshi_chenggonglv_arr[$baoshi_id];
        } else {
            $chenggonglv = $defult_chenggonglv;
        }
        $pet1_name = pet::get($pet1_id, 'name');
        $pet2_name = pet::get($pet2_id, 'name');
        echo "{$pet1_name}与{$pet2_name}{$desc}合成几率为{$chenggonglv}%,你确定要发出合成请求吗?";
        br();
        cmd::addcmd("e201,5,$o_user_id,$u_pet_id,$o_pet_id,$baoshi_id", "发出请求");
    } else if ($step == 5) {
        echo "合成请求已发出,请等待对方回应。";
        c_add_xiaoxi("$u_pet_id,$o_pet_id,$baoshi_id", 20, $user_id, $o_user_id);
    } else if ($step == 6) {
        $user_id = $o_user_id;
        $pet1_id = $u_pet_id;
        $pet2_id = $o_pet_id;
        //错误语句
        $error = "";
        //判断宠物妈妈是否符合条件
        $pet1_ok = true;
        if (pet::is_yesheng($pet1_id)) {
            $pet1_ok = false;
            $error = "宠物妈妈还是野生宠物,无法合成。";
        } else if (pet::get($pet1_id, 'is_dead')) {
            $pet1_ok = false;
            $error = "宠物妈妈已经死亡,无法合成。";
        } else if (pet::get($pet1_id, 'hechongcishu') < 1) {
            $pet1_ok = false;
            $error = "宠物妈妈没有合成次数,无法合成。";
        } else if (pet::get($pet1_id, 'lvl') < pet::get_zz($pet1_id, 'star') * 20) {
            $pet1_ok = false;
            $error = "宠物妈妈等级不够,无法合成。";
        } else if (!user::have_pet($user_id, $pet1_id)) {
            $pet1_ok = false;
            $error = "宠物妈妈已经不在对方身上。";
        }
        //判断宠物爸爸是否符合条件
        $pet1_zz_id = pet::get($pet1_id, 'pet_id');
        $pet2_zz_id = pet::get($pet2_id, 'pet_id');
        //是否合成新将ID
        if ($pet1_zz_id == $pet2_zz_id) {
            $new_pet_id = $pet1_zz_id;
        } else {
            $new_pet_id = pet::get_hechengchongwu($pet1_zz_id, $pet2_zz_id);
        }
        $pet2_ok = true;
        if (pet::is_yesheng($pet2_id)) {
            $pet2_ok = false;
            $error = "宠物爸爸还是野生宠物,无法合成。";
        } else if (pet::get($pet2_id, 'is_dead')) {
            $pet2_ok = false;
            $error = "宠物爸爸已经死亡,无法合成。";
        } else if (pet::get($pet2_id, 'lvl') < pet::get_zz($pet2_id, 'star') * 20) {
            $pet2_ok = false;
            $error = "宠物爸爸等级不够,无法合成。";
        } else if ($pet1_zz_id != $pet2_zz_id && !$new_pet_id) {
            $pet2_ok = false;
            $pet1_name = pet::get($pet1_id, 'name');
            $pet2_name = pet::get($pet2_id, 'name');
            $error = "{$pet1_name}与{$pet2_name}无法合成。";
        } else if (!user::have_pet(uid(), $pet2_id)) {
            $pet1_ok = false;
            $error = "宠物爸爸已经不在己方身上。";
        }
        if ($pet1_ok && $pet2_ok) {
            //判断宝石是否存在
            if (item::get_item($baoshi_id, $user_id) || !$baoshi_id) {
                $hyc_lvl = union::get($union_id, 'jz.hyc.lvl');
                $defult_chenggonglv = $max_jccgl = 60 + 5 * $hyc_lvl;
                $defult_chenggonglv = $defult_chenggonglv - value::getvalue('pet', 'exp', 'id', $new_pet_id) + 40;
                $defult_chenggonglv = $defult_chenggonglv > $max_jccgl ? $max_jccgl : $defult_chenggonglv;
                $defult_chenggonglv = $defult_chenggonglv < 30 ? 30 : $defult_chenggonglv;
                $baoshi_chenggonglv_arr = array(22 => 5, 23 => 10, 24 => 15, 25 => 20);
                $pet1_name = pet::get($pet1_id, 'name');
                $pet2_name = pet::get($pet2_id, 'name');
                if ($baoshi_id) {
                    item::lose_item($baoshi_id, 1, false, $user_id);
                    $chenggonglv = $defult_chenggonglv + $baoshi_chenggonglv_arr[$baoshi_id];
                } else {
                    $chenggonglv = $defult_chenggonglv;
                }
                value::add_pet_value($pet1_id, 'hechongcishu', -1, false, 1);
                //echo "成功率:$chenggonglv%";br();
                if (mt_rand(1, 100) < $chenggonglv) {
                    //新宠物初经
                    $new_pet_chujing = value::getvalue('pet', 'exp', 'id', $new_pet_id);
                    //获取种族ID 初经 星级
                    $pet1_zz_id = pet::get_zz($pet1_id, 'id');
                    $pet1_zz_star = pet::get_zz($pet1_id, 'star');
                    $pet1_zz_exp = pet::get_zz($pet1_id, 'exp');
                    $pet1_zz_bili = $pet1_zz_exp * $pet1_zz_star * (pet::get_zz($pet1_id, 'is_shengshou') ? 5 : 1) * (pet::get_zz($pet1_id, 'is_xiongshou') ? 5 : 1);
                    $pet2_zz_id = pet::get_zz($pet2_id, 'id');
                    $pet2_zz_star = pet::get_zz($pet2_id, 'star');
                    $pet2_zz_exp = pet::get_zz($pet2_id, 'exp');
                    $pet2_zz_bili = $pet2_zz_exp * $pet2_zz_star * (pet::get_zz($pet2_id, 'is_shengshou') ? 5 : 1) * (pet::get_zz($pet2_id, 'is_xiongshou') ? 5 : 1);
                    //获取宠物父母性格 天赋 转生
                    $pet1_xingge = pet::get($pet1_id, 'xingge');
                    $pet1_texing = pet::get($pet1_id, 'texing');
                    $pet1_zhuansheng = pet::get($pet1_id, 'zhuansheng');
                    $pet2_xingge = pet::get($pet2_id, 'xingge');
                    $pet2_texing = pet::get($pet2_id, 'texing');
                    $pet2_zhuansheng = pet::get($pet2_id, 'zhuansheng');
                    //随机父母性格
                    $new_pet_xingge = mt_rand(1, 2) == 1 ? $pet1_xingge : $pet2_xingge;
                    //随机父母天赋
                    $texing_jilv = $pet1_zz_bili * 8 + $pet2_zz_bili * 2;
                    //echo "天赋:".($pet1_zz_bili*8)."/{$texing_jilv}";br();
                    $pet1_texing_ok = pet::zz_have_texing($new_pet_id, $pet1_texing);
                    $pet2_texing_ok = pet::zz_have_texing($new_pet_id, $pet2_texing);
                    if ($pet1_texing_ok && $pet2_texing_ok) {
                        $new_pet_texing = mt_rand(1, $texing_jilv) < $pet1_zz_bili * 8 ? $pet1_texing : $pet2_texing;
                    } else if ($pet1_texing_ok) {
                        $new_pet_texing = $pet1_texing;
                    } else if ($pet2_texing_ok) {
                        $new_pet_texing = $pet2_texing;
                    } else {
                        $new_pet_texing = mt_rand(1, $texing_jilv) < $pet1_zz_bili * 8 ? $pet1_texing : $pet2_texing;
                    }
                    //转生次数 相同宠物初经提升
                    $pet1_zhuansheng += $pet2_zhuansheng + 1;
                    if ($pet1_zz_id == $pet2_zz_id) {
                        $new_pet_chujing *= (1 + $pet1_zhuansheng * 0.02);
                    }
                    //生蛋
                    $new_egg_id = prop::new_pet_egg($new_pet_id, $new_pet_xingge, $new_pet_texing, "雄", $new_pet_chujing, $pet2_name, $pet1_name);
                    $new_egg_name = value::get_game_prop_value($new_egg_id, 'name');
                    $new_egg_pet_id = value::get_game_prop_value($new_egg_id, 'pet_id');
                    //输出提示
                    echo "{$pet2_name}与{$pet1_name}之间发出了强烈的光芒,", value::get_game_user_value('name', $user_id), "获得了一颗{$new_egg_name}!";
                    c_add_xiaoxi("{$pet2_name}与{$pet1_name}之间发出了强烈的光芒,你获得了一颗{$new_egg_name}!", 0, 0, $user_id);
                    prop::user_get_prop($new_egg_id, $user_id, 1, false, true);
                    //转生奖励
                    list($pet1_hp, $pet1_pg, $pet1_pf, $pet1_tg, $pet1_tf, $pet1_mj) = pet::mget($pet1_id, array("max_hp", "pugong", "pufang", "tegong", "tefang", "minjie"));
                    list($pet2_hp, $pet2_pg, $pet2_pf, $pet2_tg, $pet2_tf, $pet2_mj) = pet::mget($pet2_id, array("max_hp", "pugong", "pufang", "tegong", "tefang", "minjie"));
                    //父母六维
                    $pet1_hp += $pet2_hp;
                    $pet1_hp *= 1.5;
                    $pet1_pg += $pet2_pg;
                    $pet1_pf += $pet2_pf;
                    $pet1_tg += $pet2_tg;
                    $pet1_tf += $pet2_tf;
                    $pet1_mj += $pet2_mj;
                    $pet1_mj /= 1.5;
                    //奖励六维
                    $pet1_hp *= $pet1_zhuansheng * 0.0025;
                    $pet1_pg *= $pet1_zhuansheng * 0.0025;
                    $pet1_pf *= $pet1_zhuansheng * 0.0025;
                    $pet1_tg *= $pet1_zhuansheng * 0.0025;
                    $pet1_tf *= $pet1_zhuansheng * 0.0025;
                    $pet1_mj *= $pet1_zhuansheng * 0.0025;
                    $max_yy_jiacheng = value::get_system_value("is_qiangyaotai_open") ? 50 : 30;
                    value::set_pet_value2('yuyao.jiacheng.hp', $pet1_hp < $max_yy_jiacheng ? $pet1_hp : $max_yy_jiacheng, $new_egg_pet_id);
                    value::set_pet_value2('yuyao.jiacheng.pugong', $pet1_pg < $max_yy_jiacheng ? $pet1_pg : $max_yy_jiacheng, $new_egg_pet_id);
                    value::set_pet_value2('yuyao.jiacheng.pufang', $pet1_pf < $max_yy_jiacheng ? $pet1_pf : $max_yy_jiacheng, $new_egg_pet_id);
                    value::set_pet_value2('yuyao.jiacheng.tegong', $pet1_tg < $max_yy_jiacheng ? $pet1_tg : $max_yy_jiacheng, $new_egg_pet_id);
                    value::set_pet_value2('yuyao.jiacheng.tefang', $pet1_tf < $max_yy_jiacheng ? $pet1_tf : $max_yy_jiacheng, $new_egg_pet_id);
                    value::set_pet_value2('yuyao.jiacheng.minjie', $pet1_mj < $max_yy_jiacheng ? $pet1_mj : $max_yy_jiacheng, $new_egg_pet_id);
                } else {
                    echo "{$pet1_name}与{$pet2_name}之间光芒黯淡了,合成失败!";
                    c_add_xiaoxi("{$pet1_name}与{$pet2_name}之间光芒黯淡了,合成失败!", 0, 0, $user_id);
                }
                if ($baoshi_id) {
                    c_add_xiaoxi("你失去了1" . value::get_item_value($baoshi_id, 'liangci') . value::get_item_value($baoshi_id, 'name') . "!", 0, 0, $user_id);
                }
            } else {
                echo "对方宝石不够,无法合成。";
                c_add_xiaoxi("你的宝石不够,无法合成!", 0, 0, $user_id);
            }
        } else {
            echo $error;
        }
    } else if ($step == 7) {
        echo "你拒绝了", value::get_game_user_value("name", $o_user_id), "的合成请求!";
        c_add_xiaoxi(value::get_game_user_value("name", uid()) . "拒绝了你的合成请求!", 0, 0, $o_user_id);
    }
}

//排行 神兵榜
function e202($mode = 0)
{
    $i = 0;
    switch ($mode) {
        case 1:
            echo '[神兵利器]';
            br();
            $sql = "SELECT  `id`,`name`,`star1`,(`hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) FROM `game_prop` ORDER BY (`hp`+`pugong`+`pufang`+`tegong`+`tefang`+minjie) DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                if (!$o_liuwei) {
                    break;
                }
                $i++;
                echo $i . '.';
                $o_user_id = prop::get($o_id, 'user_id');
                if (!$o_user_id) {
                    $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                };
                echo $name, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                br();
            }
            break;
        case 2:
            echo '[生命之泉]';
            br();
            $sql = "SELECT  `id`,`name`,`star1`,`hp` FROM `game_prop`  ORDER BY `hp` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                if (!$o_liuwei) {
                    break;
                }
                $i++;
                echo $i . '.';
                $o_user_id = prop::get($o_id, 'user_id');
                if (!$o_user_id) {
                    $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                };
                echo $name, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                br();
            }
            break;
        case 3:
            echo '[攻击之王]';
            br();
            $sql = "SELECT  `id`,`name`,`star1`,`pugong` FROM `game_prop`  ORDER BY `pugong` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                if (!$o_liuwei) {
                    break;
                }
                $i++;
                echo $i . '.';
                $o_user_id = prop::get($o_id, 'user_id');
                if (!$o_user_id) {
                    $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                };
                echo $name, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                br();
            }
            break;
        case 4:
            echo '[防御之岳]';
            br();
            $sql = "SELECT  `id`,`name`,`star1`,`pufang` FROM `game_prop`  ORDER BY `pufang` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                if (!$o_liuwei) {
                    break;
                }
                $i++;
                echo $i . '.';
                $o_user_id = prop::get($o_id, 'user_id');
                if (!$o_user_id) {
                    $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                };
                echo $name, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                br();
            }
            break;
        case 5:
            echo '[魔攻之神]';
            br();
            $sql = "SELECT  `id`,`name`,`star1`,`tegong` FROM `game_prop`  ORDER BY `tegong` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                if (!$o_liuwei) {
                    break;
                }
                $i++;
                echo $i . '.';
                $o_user_id = prop::get($o_id, 'user_id');
                if (!$o_user_id) {
                    $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                };
                echo $name, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                br();
            }
            break;
        case 6:
            echo '[魔防之壁]';
            br();
            $sql = "SELECT  `id`,`name`,`star1`,`tefang` FROM `game_prop`  ORDER BY `tefang` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                if (!$o_liuwei) {
                    break;
                }
                $i++;
                echo $i . '.';
                $o_user_id = prop::get($o_id, 'user_id');
                if (!$o_user_id) {
                    $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                };
                echo $name, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                br();
            }
            break;
        case 7:
            echo '[灵活之影]';
            br();
            $sql = "SELECT  `id`,`name`,`star1`,`minjie` FROM `game_prop`  ORDER BY `minjie` DESC LIMIT 20";
            $result = sql($sql);
            while (list($o_id, $name, $star1, $o_liuwei) = $result->fetch_row()) {
                if (!$o_liuwei) {
                    break;
                }
                $i++;
                echo $i . '.';
                $o_user_id = prop::get($o_id, 'user_id');
                if (!$o_user_id) {
                    $o_user_id = pet::get(prop::get($o_id, 'pet_id'), "master_id");
                };
                echo $name, '(', (int)$o_liuwei, '★', value::get_game_user_value('name', $o_user_id), ')';
                br();
            }
            break;
        default:
            cmd::addcmd("e202,1", "神兵利器");
            br();
            cmd::addcmd("e202,2", "生命之泉");
            br();
            cmd::addcmd("e202,3", "攻击之王");
            br();
            cmd::addcmd("e202,4", "防御之岳");
            br();
            cmd::addcmd("e202,5", "魔攻之神");
            br();
            cmd::addcmd("e202,6", "魔防之壁");
            br();
            cmd::addcmd("e202,7", "灵活之影");
            break;
    }
    if ($mode) {
        if (!$i) {
            echo '暂无兵器上榜。';
            br();
        }
        cmd::addcmd("e202", '返回上级');
    }
}

//竞技场 挑战消息
function e203($chat_id, $mode = 0)
{
    //挑战消息
    $l = "SELECT * FROM game_chat WHERE id={$chat_id} LIMIT 1";
    $rs = sql($l);
    $chat_arr = $rs->fetch_array(MYSQLI_ASSOC);
    if (!is_array($chat_arr)) {
        echo "竞技已经失效!";
        return;
    }
    //己方数据
    $user_id = uid();
    $user_name = user::get_game_user("name", $user_id);
    //对方数据
    $o_user_id = $chat_arr['uid'];
    $o_user_name = user::get_game_user("name", $o_user_id);
    //print_r($chat_arr);
    if (!$mode) {
        //图片开关
        //输出图片 描述
        $tpkg = value::get_user_value('kg.xscwtp');
        //己方身上宠物
        $pet_str = "";
        $u_pet_arr = user::get_pet_arr($user_id, 1);
        foreach ($u_pet_arr as $u_pet_id) {
            $image = pet::get_zz($u_pet_id, "image");
            if (!$tpkg && $image) {
                $pet_str .= pet::img($image, false);
            }
            $pet_str .= value::get_pet_value($u_pet_id, 'lvl') . '级' . value::get_pet_value($u_pet_id, 'name') . "<br>性格:" . pet::get_xingge(pet::get($u_pet_id, 'xingge')) . " 天赋:" . pet::get_texing(pet::get($u_pet_id, 'texing'), false) . "<br>";
        }
        $pet_str = mb_substr($pet_str, 0, -4);
        //对方身上宠物
        $o_pet_str = "";
        $o_pet_arr = user::get_pet_arr($o_user_id, 1);
        foreach ($o_pet_arr as $o_pet_id) {
            $image = pet::get_zz($o_pet_id, "image");
            if (!$tpkg && $image) {
                $o_pet_str .= pet::img($image, false);
            }
            $o_pet_str .= value::get_pet_value($o_pet_id, 'lvl') . '级' . value::get_pet_value($o_pet_id, 'name') . "<br>性格:" . pet::get_xingge(pet::get($o_pet_id, 'xingge')) . " 天赋:" . pet::get_texing(pet::get($o_pet_id, 'texing'), false) . "<br>";
        }
        $o_pet_str = mb_substr($o_pet_str, 0, -4);
        //输出详情
        echo"武林争霸：" . $o_user_name . "VS" . $user_name;
        br();
        echo"-";
        br();
        $o_user_lvl = user::get_game_user("lvl", $o_user_id);
        echo"挑战方：{$o_user_lvl}级.";
        cmd::addcmd('e12,' . $o_user_id . ',17', $o_user_name);
        br();
        $user_lvl = user::get_game_user("lvl", $user_id);
        echo"被挑战方：{$user_lvl}级.";
        cmd::addcmd('e12,' . $user_id . ',17', $user_name);
        br();
        echo"赌注：{$chat_arr['chats']}个金币";
        br();
        cmd::addcmd("e203,$chat_id,1", "接受挑战");
        br();
        cmd::addcmd("e203,$chat_id,2", "拒绝挑战");
    } else if ($mode == 1) {
        sports::accept_sports($chat_id);
    } else if ($mode == 2) {
        echo "你拒绝了{$o_user_name}的竞技场挑战!";
        c_add_xiaoxi("{$user_name}拒绝了你的竞技场挑战!", 0, $user_id, $o_user_id);
        c_del_xiaoxi($chat_id);
    }
}

//竞技场 发起挑战
function e204($o_user_id)
{
    //用户属性
    $user_id = uid();
    value::set_user_value('6.hd_hyd_sz', 5, $user_id);
    $time_h = date("H");
    $sl_h = value::get_user_value('hd_hydz_h6', $user_id);
    if ($sl_h != $time_h) {
        value::add_user_value('hd_hydz', 5, $user_id);
        value::set_user_value('hd_hydz_h6', $time_h, $user_id);
    }
    $user_name = user::get_game_user("name", $user_id);
    $o_user_name = user::get_game_user("name", $o_user_id);
    $zhp_money = value::get_user_value('money');
    //押注或者发起挑战
    $money = post::get("money");
    if (!$money) {
        $url = cmd::addcmd2url("e204," . $o_user_id);
        $zhp_money = value::get_user_value('money');
        echo <<<html
你有{$zhp_money}个金币
<br>
你要押上多少个金币挑战争霸者?
<form action="$url" method="post">
<input type="text" name="money" maxlength="8" placeholder="1-10000000">
<br>
<input type="submit" value="确认挑战">
</form>
html;
    } else {
        sports::launch_a_sports($o_user_id, $money);
    }
    cmd::set_return_game_br(false);
}

//竞技场 我要押注
function e205($sports_id)
{
    $uid = uid();
    $time = time();//现在时间
    $sports_arr = sports::get_arr($sports_id);//竞技详情
    $sports_time = strtotime($sports_arr['time']);
    if ($sports_time + 10 < $time) {
        echo "押注时间已过!";
        br();
    } else {
        echo "请在", $sports_time + 10 - $time, "秒内下注!";
        br();
    }
    $zhp_money = value::get_user_value('zahuopu.money');
    echo "杂货铺里有{$zhp_money}个金币";
    br();
    //己方数据
    $user_id = $sports_arr['oid'];
    $user_name = user::get_game_user("name", $user_id);
    $l = "SELECT SUM(money) FROM game_sports_stake WHERE sports_id=$sports_id AND winner=$user_id";
    $r = sql($l);
    list($user_stake) = $r->fetch_row();
    $user_stake += $sports_arr['money'] / 2;
    //对方数据
    $o_user_id = $sports_arr['uid'];
    $o_user_name = user::get_game_user("name", $o_user_id);
    $l = "SELECT SUM(money) FROM game_sports_stake WHERE sports_id=$sports_id AND winner=$o_user_id";
    $r = sql($l);
    list($o_user_stake) = $r->fetch_row();
    $o_user_stake += $sports_arr['money'] / 2;
    //输出详情
    echo "{$o_user_name}VS{$user_name} ";
    cmd::addcmd("e205," . $sports_id, "刷新");
    br();
    //图片开关
    //输出图片 描述
    $tpkg = value::get_user_value('kg.xscwtp');
    //己方身上宠物
    $pet_str = "";
    $u_pet_arr = user::get_pet_arr($user_id, 1);
    foreach ($u_pet_arr as $u_pet_id) {
        $image = pet::get_zz($u_pet_id, "image");
        if (!$tpkg && $image) {
            $pet_str .= pet::img($image, false);
        }
        $pet_str .= value::get_pet_value($u_pet_id, 'lvl') . '级' . value::get_pet_value($u_pet_id, 'name') . "<br>性格:" . pet::get_xingge(pet::get($u_pet_id, 'xingge')) . " 天赋:" . pet::get_texing(pet::get($u_pet_id, 'texing'), false) . "<br>";
    }
    $pet_str = mb_substr($pet_str, 0, -4);
    //对方身上宠物
    $o_pet_str = "";
    $o_pet_arr = user::get_pet_arr($o_user_id, 1);
    foreach ($o_pet_arr as $o_pet_id) {
        $image = pet::get_zz($o_pet_id, "image");
        if (!$tpkg && $image) {
            $o_pet_str .= pet::img($image, false);
        }
        $o_pet_str .= value::get_pet_value($o_pet_id, 'lvl') . '级' . value::get_pet_value($o_pet_id, 'name') . "<br>性格:" . pet::get_xingge(pet::get($o_pet_id, 'xingge')) . " 天赋:" . pet::get_texing(pet::get($o_pet_id, 'texing'), false) . "<br>";
    }
    $o_pet_str = mb_substr($o_pet_str, 0, -4);
    //总押注
    $sports_stake = $user_stake + $o_user_stake;
    $user_peilv = sprintf("%.02f", $o_user_stake / $user_stake);
    $o_user_peilv = sprintf("%.02f", $user_stake / $o_user_stake);
    //输出详情
    echo"擂台争霸：";
    br();
    echo"-";
    br();
    $o_user_lvl = user::get_game_user("lvl", $o_user_id);
    echo"挑战方：{$o_user_lvl}级.";
    cmd::addcmd('e12,' . $o_user_id . ',17', $o_user_name);
    br();
    echo"押注:{$o_user_stake}个金币";
    br();
    if ($uid != $user_id && $uid != $o_user_id) {
        cmd::addcmd("e208,{$sports_id},{$o_user_id},{$uid}", "押{$o_user_name}(1赔{$o_user_peilv})");
        br();
    }
    $user_lvl = user::get_game_user("lvl", $user_id);
    echo"被挑战方：{$user_lvl}级.";
    cmd::addcmd('e12,' . $user_id . ',17', $user_name);
    br();
    echo"押注:{$user_stake}个金币";
    br();
    if ($uid != $user_id && $uid != $o_user_id) {
        cmd::addcmd("e208,{$sports_id},{$user_id},{$uid}", "押{$user_name}(1赔{$user_peilv})");
        br();
    }
    echo"赌注:{$sports_stake}个金币";
    br();
    cmd::addcmd("e34", "押注列表");
}

//竞技场 积分兑换 积分排行
function e206()
{
    $i = 0;
    echo '[积分榜]';
    br();
    $sql = "SELECT `id`,`jingji.jifen` FROM `game_user` WHERE `jingji.jifen` >0 AND `name`!='' ORDER BY `jingji.jifen` DESC,`is_online` DESC LIMIT 0,20 ";
    $result = sql($sql);
    while (list($oid, $ovalue) = $result->fetch_row()) {
        $i++;
        echo $i . '.';
        echo user::get_game_user("name", $oid);
        echo '(' . $ovalue . '积分)';
        echo "   ";
        cmd::addcmd('jj_ltjf,' . $oid . ',' . $i, "领奖");
        br();
    }
    if (!$i) {
        echo '暂时无人上榜。';
        br();
    }
    cmd::add_last_cmd("hd_wlzb_1");
}

//竞技场 兑换积分
function e207()
{
    $jifen_count = (int)post::get("count");
    $duihuan_arr = config::getConfigByName("duihuan");
    $bili = $duihuan_arr["tb:jjjf"];
    $zhp_money = value::get_user_value('zahuopu.money');
    if (!$jifen_count) {
        $url = cmd::addcmd2url("e207");
        echo <<<html
杂货铺里有{$zhp_money}个金币
<br>
你想兑换多少点竞技积分({$bili}金币可兑换1积分★比例可能实时变动)?
<form action="$url" method="post">
<input type="text" name="count" maxlength="8">
<br>
<input type="submit" value="确认兑换">
</form>
html;

    } else {
        if ($jifen_count > 0) {
            $zmoney = $jifen_count * $bili;
            if ($zhp_money >= $zmoney) {
                item::add_zhp_money(-1 * $zmoney);
                value::add_game_user_value("jingji.jifen", $jifen_count);
                echo "你成功用{$zmoney}个金币兑换了{$jifen_count}点竞技积分!";
                br();
                e33();
            } else {
                echo "杂货铺里没有足够的金币了!";
            }
        } else {
            echo "输入的兑换数量有误!";
        }
        br();
    }
    cmd::add_last_cmd("e33");
}

//竞技场 押注下注
function e208($sports_id, $winner, $user_id)
{
    sports::stake($sports_id, $winner, $user_id);
}

//VIP系统 领取礼包
function e209($vip_lvl)
{
    //验证月份
    $t_m = $vip_lvl;
    $l_m = user::get("vip{$vip_lvl}_last_month");
    if ($t_m != $l_m) {
        //发放礼包奖品
        c_add_guangbo("尊贵的" . user::get_game_user("name") . "领取了" . user::showVipLogo(0, false, $vip_lvl) . "礼包!");
        echo "你领取了" . user::showVipLogo(0, false, $vip_lvl) . "礼包~";
        br();
        $libao_arr = config::getConfigByName("vip_libao");
        $item_arr = $libao_arr[$vip_lvl];
        foreach ($item_arr as $item => $count) {
            item::add_item($item, $count);
        }
        //记录本月领取
        user::set("vip{$vip_lvl}_last_month", $t_m);
    } else {
        echo "你已经领取过" . user::showVipLogo(0, false, $vip_lvl) . "礼包~";
        br();
    }
    //返回VIP系统
    e162();
}

//首冲系统 领取礼包
function sc_e209($vip_lvl)
{
    //验证月份
    $user_id = uid();
    $r_money = user::get("sc_money");
    $t_m = $vip_lvl;
    $name = value::get_game_user_value('name', $user_id);
    $l_m = user::get("sc{$vip_lvl}_last_month");
    if ($r_money >= $vip_lvl) {
        if ($t_m != $l_m) {
            //发放礼包奖品
            c_add_guangbo("玩家{$name}领取了首冲{$vip_lvl}元礼包！");
            echo "你领取了首冲" . $vip_lvl . "元礼包~";
            br();
            $libao_arr = config::getConfigByName("sc_libao");
            $item_arr = $libao_arr[$vip_lvl];
            foreach ($item_arr as $item => $count) {
                item::add_item($item, $count);
            }
            //记录本月领取
            user::set("sc{$vip_lvl}_last_month", $t_m);
        } else {
            echo "你已经领取过首冲" . $vip_lvl . "元礼包~";
            br();
        }
    } else {
        echo "你今日充值没有到达" . $vip_lvl . "元~";
        br();
    }
    //返回VIP系统
    map_lb();
}

//天下第一礼包
function sy_txdy_lb($user_id, $item_id)
{
    $user_id = uid();
    $item_name = value::get_item_value($item_id, "name");
    echo "你使用了" . $item_name . "礼包~";
    br();
    $sj = mt_rand(300, 500);
    $sj1 = mt_rand(10, 50);
    item::add_item(287, $sj);
    item::add_item(288, $sj1);
    item::add_item(289, 10);
}


//会员系统 领取礼包
function hy_e209()
{
    //验证月份
    $user_id = uid();
    $t_m = date("d");
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    $l_m = user::get("hy{$hy_lvl}_last_month");        
    $hy_name = value::get_game_user_value('hy_name', $user_id);
    if ($hy_lvl > 0) {
        if ($t_m != $l_m) {
            //发放礼包奖品
            c_add_guangbo("尊贵的" . user::get_game_user("name") . "领取了" . $hy_name . "礼包!");
            echo "你领取了" . $hy_name . "礼包~";
            br();
            $libao_arr = config::getConfigByName("hy_libao");
            $item_arr = $libao_arr[$hy_lvl];
            foreach ($item_arr as $item => $count) {
                item::add_item($item, $count);
            }
            //记录本天领取
            user::set("hy{$hy_lvl}_last_month", $t_m);
        } else {
            echo "你已经领取过" . $hy_name . "礼包~";
            br();
        }
    } else {
        echo "你还不是会员无法领取礼包！";
        br();
    }
    //返回VIP系统
    map_hy();
}


//攻略 宝箱开箱概率披露
function e210()
{
    $baoxianggailv_arr = config::getConfigByName("baoxianggailv");
    foreach ($baoxianggailv_arr as $item_id => $item_gailv_data) {
        echo "[", value::get_item_value($item_id, "name"), "]";
        br();
        foreach ($item_gailv_data as $data) {
            $oname_str = "";
            echo $data['name'], ":", $data['gailv'] * 100, "%";
            br();
            $add_sql = $data['query_sql_condition'];
            $sql = "SELECT `name` FROM `pet` WHERE `star`>3 $add_sql ORDER BY `exp` DESC,`id` ASC";
            $result = sql($sql);
            while (list($oname) = $result->fetch_row()) {
                $oname_str .= $oname . "|";
            }
            $oname_str = trim($oname_str, "|");
            echo $oname_str;
            br();
        }
    }
    cmd::add_last_cmd("e0");
}

//攻略 宠物合成公式披露
function e211()
{
    echo "合成公式:";
    br();
    $hc_arr = pet::get_hechonggongshi();
    foreach ($hc_arr as $hc_key => $value) {
        echo "";
        $tmp_arr = explode("+", $hc_key);
        echo value::getvalue('pet', 'name', 'id', $value), "=", value::getvalue('pet', 'name', 'id', $tmp_arr[0]), "+", value::getvalue('pet', 'name', 'id', $tmp_arr[1]);
        echo value::getvalue('pet', 'is_hecheng_open', 'id', $value) ? "" : "(未开放)";
        br();
    }
    cmd::add_last_cmd("e0");
}

//道具 还原强化
function e212($from_list = 0, $prop_id, $step)
{
    $prop_name = value::get_game_prop_value($prop_id, 'name');
    $prop_liangci = value::get_game_prop_zz_value($prop_id, 'liangci');
    $qianghuacishu = value::get_game_prop_value($prop_id, 'qianghuacishu');
    $huanyuanlingshi = $qianghuacishu * 200;
    if (!$step) {
        echo "你确定要花费{$huanyuanlingshi}颗元宝来还原这{$prop_liangci}{$prop_name}为可强化吗?";
        br();
        cmd::addcmd("e212,{$from_list},{$prop_id},1", "确认还原");
        br();
    } else {
        if (item::add_lingshi(-1 * $huanyuanlingshi)) {
            if (mb_substr($prop_name, 0, 1) == "*") {
                value::set_game_prop_value($prop_id, 'name', mb_substr($prop_name, 1));
            }
            value::set_game_prop_value($prop_id, 'is_qianghua', 1);
            echo "还原这{$prop_liangci}{$prop_name}为可强化成功!";
            br();
        }
    }
    if (!$from_list) {
        cmd::addcmd('e98,' . $prop_id, '返回上级');
    } else {
        cmd::addcmd('e98,' . $prop_id . ',2', '返回上级');
    }
}

//VIP 上线广播
function e213()
{
    $is_open = user::get('vip_login_guangbo') ? false : true;
    if ($is_open) {
        echo "你关闭了VIP上线广播!";
        user::set('vip_login_guangbo', 1);
    } else {
        echo "你开启了VIP上线广播!";
        user::set('vip_login_guangbo', 0);
    }
    br();
    e73();
}

//副本 进入天枢幻境
function e214($mode = 0)
{
    $user_id = uid();
    $today = date("Y-m-d");
    $in_tshj_time = value::get_user_value('in_tshj_time');
    if ($in_tshj_time != $today) {
        value::set_user_value("in_tshj_time", $today);
        value::set_user_value("in_tshj_count", 0);
    }
    $once_money = 10000;
    $in_tshj_count = value::get_user_value("in_tshj_count");
    if ($in_tshj_count < 5) {
        $need_money = $once_money;
    } else {
        $need_money = ($in_tshj_count - 3) * $once_money;
    }
    if ($mode) {
        if (team::get_team_user_count(team::get_user_team($user_id)) > 2) {
            if (item::add_money(-1 * $need_money)) {
                value::set_game_user_value('in_map_id', 1096);
                value::add_user_value("in_tshj_count", 1);
                e215(22);
            } else {
                cmd::set_return_game_br(false);
            }
        } else {
            echo "队伍人数大于3人方可进入天枢幻境副本。";
            br();
        }
        e0();
        return;
    } else {
        $low_lvl = 100;
        if (team::get_team_user_count(team::get_user_team($user_id)) > 2) {
            if (user::get_max_pet_lvl($user_id) > $low_lvl) {
                echo "你确定要花费{$need_money}金币进入天枢幻境副本吗?";
                br();
                cmd::addcmd('e214,1', '确定进入');
            } else {
                echo "玩家宠物等级大于{$low_lvl}级方可进入天枢幻境副本。";
            }
        } else {
            echo "队伍人数大于3人方可进入天枢幻境副本。";
        }
    }
}

//组队副本 进入前清除数据
function e215($area_id)
{
    $user_id = uid();
    //清除拦路
    $ql = "SELECT id FROM npc WHERE area_id={$area_id} and is_lanlu=1";
    $r = sql($ql);
    while (list($nid) = $r->fetch_row()) {
        value::set_user_value("map.lanlu.{$nid}", 0, $user_id);
    }
    //清除首次挑战
    $ql = "DELETE FROM game_user_value WHERE userid={$user_id} AND valuename like '%.first.drfb.npc.%'";
    sql($ql);
}

//元宝商城 充值元宝
function e216($step = 0)
{
    if (!$step) {
        $post_url = cmd::addcmd("e216,1", "", false, true);
        $vip_lvl = user::getVipLvl();
        $r_money = user::get("recharge_money");
        $vip_lvl_arr = config::getConfigByName("vip_lvl");
        $up_money = $vip_lvl_arr[$vip_lvl + 1] - $r_money;
        if ($up_money > 0) {
            $next_lvl = $vip_lvl + 1;
        }
        echo user::get_game_user("name"), " ", user::showVipLogo(0, false);
        echo <<<chongzhi
<form action="$post_url" method="post">
充值比例:￥1元=10元宝
<br>
充值金额(元):
<select name="select_money" id="s_m" onchange="set_money(this);">
<option value="50">￥50（500元宝）</option>
<option value="100">￥100（1100元宝）</option>
<option value="200">￥200（2400元宝）</option>
<option value="500">￥500（7000元宝）</option>
<option value="1000">￥1000（16000元宝）</option>
<option value="3000">￥3000（60000元宝）</option>
<option value="5000">￥5000（125000元宝）</option>
</select>
<br>
确认金额(元):
<input type="number" name="money" id="money" value="50" min="1" max="5000">
<br>
<input type="submit" value="确认充值">
</form>
<script >
function set_money(sl_obj) {
    var sl_index = sl_obj.selectedIndex;
    var sl_value = sl_obj.options[sl_index].value;
    var money=document.getElementById("money");
    money.value=sl_value;
}
</script>
<img src="res/img/system/tips.png" alt="vip" style="width: 20px;height: 20px;">  
chongzhi;
        if ($up_money > 0) {
            echo "再充值{$up_money}元即可升级到" . user::showVipLogo(0, false, $next_lvl);
        } else {
            echo "恭喜您已经达到最尊贵的" . user::showVipLogo(0, false);
        }
        br();
        cmd::addcmd('e31', '返回上级');
    } else {
        $money = (int)post::get("money");
        if ($money >= 0 && $money <= 5000) {
            c_recharge($money);
            return;
        } else {
            echo "单笔充值金额最低50元,最高5000元!";
        }
        br();
        cmd::addcmd('e216', '返回上级');
    }
}

//师徒 一键拜师
function e217()
{
    $last_time = user::get("last_yjbs_time");
    if ($last_time + 3600 < time()) {
        $sql = "SELECT id FROM game_user WHERE is_online=1 AND lvl>=30";
        $rs = sql($sql);
        while (list($oid) = $rs->fetch_row()) {
            c_add_bsqq($oid);
        }
        echo "拜师请求已经发出,请静候佳音!";
        user::set("last_yjbs_time", time());
    } else {
        echo "拜师请求过于频繁,请稍后再试!";
    }
    br();
    e105(4);
}

//VIP 累计充值礼包领取
function e218($money)
{
    if (!user::get("vip.ljcz.libao.{$money}")) {
        echo "恭喜你领取了{$money}元累计充值礼包!";
        c_add_guangbo(user::get_game_user("name") . "领取了{$money}元累计充值礼包!");
        br();
        $vip_leijichongzhi_libao_arr = config::getConfigByName("vip_leijichongzhi_libao");
        $v = $vip_leijichongzhi_libao_arr[$money];
        foreach ($v as $lname => $ldata) {
            if (is_array($ldata)) {
                switch ($lname) {
                    case "prop":
                        foreach ($ldata as $p_id => $p_data) {
                            for ($i = 0; $i < $p_data['count']; $i++) {
                                $gp_id = prop::new_prop($p_id, 0, $p_data['star']);
                                if (user::get_rongliang() > user::get_fuzhong()) {
                                    prop::user_get_prop($gp_id, 0, 1, true, true);
                                } else {
                                    prop::user_get_prop($gp_id, 0, 2, false, true);
                                    echo value::get_game_prop_value($gp_id, 'name') . "存入了仓库。";
                                    br();
                                }
                            }
                        }
                        break;
                    case "item":
                        foreach ($ldata as $item_id => $item_data) {
                            item::add_item($item_id, $item_data['count']);
                        }
                        break;
                }
            }
        }
        user::set("vip.ljcz.libao.{$money}", 1);
    } else {
        echo "请勿重复领取礼包!";
        br();
    }
    lc_e162();
}

function e219()
{
    $vip_leijichongzhi_libao_arr = config::getConfigByName("vip_leijichongzhi_libao");
    foreach ($vip_leijichongzhi_libao_arr as $l_rmoney => $v) {
        echo "{$l_rmoney}元累计充值礼包:";
        br();
        foreach ($v as $lname => $ldata) {
            if (is_array($ldata)) {
                switch ($lname) {
                    case "prop":
                        foreach ($ldata as $p_id => $p_data) {
                            echo prop::get_star_str($p_data["star"]) . value::get_prop_value($p_id, "name") . "*" . $p_data["count"] . value::get_prop_value($p_id, "liangci");
                            br();
                        }
                        break;
                    case "egg":
                        foreach ($ldata as $pet_id => $pet_data) {
                            echo $pet_data['sex'] . "性" . value::getvalue("pet", "name", "id", $pet_id) . "宠物卡*1";
                            br();
                        }
                        break;
                }
            }
        }
    }
    cmd::add_last_cmd("e162");
}

//查看附体神兽
function e220($ozzid)
{
    //获取种族属性
    $sql = "SELECT `pet_image`,`pet_desc`,`pet_name` FROM `pet` WHERE `id`={$ozzid}" . " LIMIT 1";
    $result = sql($sql);
    list($image, $desc, $oname) = $result->fetch_row();
    if (!$oname) {
        //���回地图
        echo '你已经没有这只宠物了。';
        br();
        e35();
        return;
    }
    //输出宠物名字
    echo $oname;
    br();
    //输出图片 描述
    if (!value::get_user_value('kg.xscwtp')) {
        if ($image != "") {
            $img_str = "<img src='res/img/{$image}.gif' onerror=\"javascript:this.src='logo.png';\">";
            echo $img_str;
            br();
        }
    }
    if ($desc != "") {
        echo $desc;
    } else {
        echo "这是一只" . $oname . "。";
    }
    br();
    cmd::add_last_cmd("e62");
}

//pet掉落
function e221($pet_id, $map_id, $user_id)
{
    //物品数组
    $item_arr = array();
    //装备数组
    $prop_arr = array();
    //宠物卡数组
    $egg_arr = array();
    //地图名称
    $map_name = value::get_map_value($map_id, 'name');
    //所在区域
    $area_id = value::get_map_value($map_id, "area_id");
    //Pet_zz_id
    $pet_zz_id = value::get_pet_value($pet_id, 'pet_id');
    if ($pet_zz_id > 84 && $pet_zz_id < 97) {
        value::set_user_value('7.hd_hyd_sz', 10, $user_id);
        $time_h = date("H");
        $sl_h = value::get_user_value('hd_hydz_h7', $user_id);
        if ($sl_h != $time_h) {
            value::add_user_value('hd_hydz', 10, $user_id);
            value::set_user_value('hd_hydz_h7', $time_h, $user_id);
        }
    }
    if ($pet_zz_id == 71 || ($pet_zz_id > 78 && $pet_zz_id < 85)) {
        value::set_user_value('8.hd_hyd_sz', 10, $user_id);
        $time_h = date("H");
        $sl_h = value::get_user_value('hd_hydz_h8', $user_id);
        if ($sl_h != $time_h) {
            value::add_user_value('hd_hydz', 10, $user_id);
            value::set_user_value('hd_hydz_h8', $time_h, $user_id);
        }
    }
    $hyd_star = value::get_pet_value($pet_zz_id, 'star');
    value::add_user_value('11.hd_hyd_sz', 1, $user_id);
    $hd_hyd_sz = value::add_user_value('11.hd_hyd_sz', $user_id);
    if ($hd_hyd_sz > 9 && $hyd_star > 2) {
        value::set_user_value('9.hd_hyd_sz', 20, $user_id);
        $time_h = date("H");
        $sl_h = value::get_user_value('hd_hydz_h9', $user_id);
        if ($sl_h != $time_h) {
            value::add_user_value('hd_hydz', 20, $user_id);
            value::set_user_value('hd_hydz_h9', $time_h, $user_id);
        }
    }
    if ($hd_hyd_sz > 1999) {
        value::set_user_value('10.hd_hyd_sz', 20, $user_id);
        $time_h = date("H");
        $sl_h = value::get_user_value('hd_hydz_h10', $user_id);
        if ($sl_h != $time_h) {
            value::add_user_value('hd_hydz', 20, $user_id);
            value::set_user_value('hd_hydz_h10', $time_h, $user_id);
        }
    }
    //VIP等级
    $vip_lvl = user::getVipLvl($user_id);
    $wj_db = value::get_user_value('wj_db', $user_id);
    $wj_jy = value::get_user_value('wj_jy', $user_id);
    $xy_jc = $wj_db + 1 + $vip_lvl / 10;
    //读取掉落数据
    $diaoluo_arr = config::getConfigByName("pet_diaoluo");
    $diaoluo_arr = $diaoluo_arr[$area_id];
    //解析掉落数据
    foreach ($diaoluo_arr as $pet_kid => $pet_arr) {
        if ($pet_kid == $pet_zz_id) {
            echo "!";
            foreach ($pet_arr as $pet_key => $map_arr) {
                if ($pet_key == "*" || $pet_key == $map_name || $pet_key == $map_id) {
                    foreach ($map_arr as $dl_arr_name => $dl_arr_data) {
                        switch ($dl_arr_name) {
                            case "item":
                                foreach ($dl_arr_data as $k => $v) {
                                    $gailv = explode(",", $v['r']);
                                    $need_gailv = $gailv[0] * $xy_jc;
                                    $max_gailv = $gailv[1];
                                    $ok = eval("return mt_rand(1,{$max_gailv});") <= $need_gailv ? true : false;
                                    if ($ok) {
                                        $item_arr[$k] = eval("return mt_rand({$v['c']});");
                                    }
                                }
                                break;
                            case "prop":
                                foreach ($dl_arr_data as $k => $v) {
                                    $gailv = explode(",", $v['r']);
                                    $need_gailv = $gailv[0] * $xy_jc;
                                    $max_gailv = $gailv[1];
                                    $ok = eval("return mt_rand(1,{$max_gailv});") <= $need_gailv ? true : false;
                                    if ($ok) {
                                        array_push($prop_arr, $k);
                                    }
                                }
                                break;
                            case "egg":
                                foreach ($dl_arr_data as $k => $v) {
                                    $gailv = explode(",", $v['r']);
                                    $need_gailv = $gailv[0] * $xy_jc;
                                    $max_gailv = $gailv[1];
                                    $ok = eval("return mt_rand(1,{$max_gailv});") <= $need_gailv ? true : false;
                                    if ($ok) {
                                        array_push($egg_arr, $k);
                                    }
                                }
                                break;
                        }
                    }
                }
            }
        }
    }
    //开始掉落
    //掉落物品
    foreach ($item_arr as $item_id => $item_count) {
        item::map_add_item($map_id, $item_id, 1);
        $sj = mt_rand(1, 10);
        $sj10 = mt_rand(0, 2);
        if ($sj10 == 1 || value::getvalue('pet', 'star', 'id', $pet_id) > 9) {
            $hy_xs_lvl = value::get_user_value('hy_lvl', $user_id);
            if ($hy_xs_lvl > 0) {
                item::add_item(51, $sj);
            } else {
                item::map_add_item($map_id, 51, $sj);
            }
        }
    }
    //掉落装备
    foreach ($prop_arr as $prop_id) {
        $sj = mt_rand(1, 1000);
        if ($sj <= 10) {
            $sji = 3;
        } else if ($sj <= 50) {
            $sji = 2;
        } else if ($sj <= 100) {
            $sji = 1;
        } else {
            $sji = 0;
        }
        $cj_pet = value::get_pet_value($pet_id, 'name');
        $equip_id = prop::new_prop($prop_id, 0, $sji, $cj_pet);
        if (value::get_game_prop_value($equip_id, 'star1') > 0) {
            $ts_name = "恭喜玩家" . value::get_game_user_value('name') . "在" . value::get_map_value($map_id, 'name') . "击杀" . value::get_pet_value($pet_id, 'name') . "获得了1" . value::get_game_prop_zz_value($equip_id, 'liangci');
            c_add_guangbo($ts_name, $equip_id, 4);
            value::set_game_prop_value($equip_id, 'is_guangbo', 1);
        }
        $zbpj_ys = value::get_user_value('zbpj_ys', $user_id);
        $zbpj_lvl = value::get_user_value('zbpj_lvl', $user_id);
        $zb_lvl = value::get_game_prop_zz_value($equip_id, 'equip_use_lvl');
        if ($zbpj_ys > 0) {
            if ($zb_lvl >= $zbpj_lvl) {
                if ($zbpj_ys == 1) {
                    if (value::get_game_prop_value($equip_id, 'star1') < 1) {
                        prop::user_get_prop($equip_id, $user_id, 1, false, true);
                        echo "你获得了" . value::get_game_prop_value($equip_id, 'name');
                        br();
                    } else {
                        prop::map_get_prop($map_id, $equip_id, $user_id);
                    }
                }
                if ($zbpj_ys == 2) {
                    if (value::get_game_prop_value($equip_id, 'star1') > 0) {
                        prop::user_get_prop($equip_id, $user_id, 1, false, true);
                        echo "你获得了" . value::get_game_prop_value($equip_id, 'name');
                        br();
                    } else {
                        prop::map_get_prop($map_id, $equip_id, $user_id);
                    }
                }
                if ($zbpj_ys == 3) {
                    prop::user_get_prop($equip_id, $user_id, 1, false, true);
                    echo "你获得了" . value::get_game_prop_value($equip_id, 'name');
                    br();
                }
            } else {
                prop::map_get_prop($map_id, $equip_id, $user_id);
            }
        } else {
            prop::map_get_prop($map_id, $equip_id, $user_id);
        }
    }
    //公测怪物特殊掉落
    if ($pet_zz_id == 221) {
        $pet_id = 221;
        $prop_id = mt_rand(282, 311);
        $cj_pet = value::get_pet_value($pet_id, 'name');
        $equip_id = prop::new_prop($prop_id, 0, 3, $cj_pet);
        prop::map_get_prop($map_id, $equip_id, $user_id);
        item::map_add_item($map_id, 222, 1);
        item::map_add_item($map_id, 294, 1);
        for ($i = 1; $i < 16; $i++) {
            item::map_add_item($map_id, 301, 1);
        }
        for ($i = 1; $i < 7; $i++) {
            item::map_add_item($map_id, 302, 1);
        }
        for ($i = 1; $i < 9; $i++) {
            $i1 = $i + 184;
            item::map_add_item($map_id, $i1, 1);
        }
        for ($i = 1; $i < 7; $i++) {
            item::map_add_item($map_id, 195, 1);
        }
        for ($i = 1; $i < 7; $i++) {
            item::map_add_item($map_id, 196, 1);
        }
        for ($i = 1; $i < 4; $i++) {
            item::map_add_item($map_id, 285, 1);
        }
        for ($i = 1; $i < 11; $i++) {
            item::map_add_item($map_id, 289, 1);
        }
    }
    if ($pet_zz_id == 222) {
        $pet_id = 222;
        $prop_id = mt_rand(242, 251);
        $cj_pet = value::get_pet_value($pet_id, 'name');
        $equip_id = prop::new_prop($prop_id, 0, 3, $cj_pet);
        prop::map_get_prop($map_id, $equip_id, $user_id);
        item::map_add_item($map_id, 222, 1);
        item::map_add_item($map_id, 222, 1);
        item::map_add_item($map_id, 295, 1);
        for ($i = 1; $i < 31; $i++) {
            item::map_add_item($map_id, 301, 1);
        }
        for ($i = 1; $i < 13; $i++) {
            item::map_add_item($map_id, 302, 1);
        }
        for ($i = 1; $i < 11; $i++) {
            $i1 = $i + 184;
            item::map_add_item($map_id, $i1, 1);
        }
        for ($i = 1; $i < 21; $i++) {
            item::map_add_item($map_id, 289, 1);
        }
        for ($i = 1; $i < 7; $i++) {
            item::map_add_item($map_id, 195, 1);
        }
        for ($i = 1; $i < 7; $i++) {
            item::map_add_item($map_id, 196, 1);
        }
        for ($i = 1; $i < 7; $i++) {
            item::map_add_item($map_id, 197, 1);
        }
        for ($i = 1; $i < 6; $i++) {
            item::map_add_item($map_id, 285, 1);
        }
    }
}

//事件系统

//玩家 选择装备
function e10001($subtype)
{
    equip::user_choice_equip($subtype);
    cmd::add_last_cmd('map_zb');
}

function e10001_sz($subtype)
{
    equip::user_choice_equip_sz($subtype);
    cmd::add_last_cmd('map_zb1');
}

function e10001_cb($subtype)
{
    equip::user_choice_equip_cb($subtype);
    cmd::add_last_cmd('map_cb');
}
//玩家 装备装备
function e10002($eid, $userID = 0)
{
    $user_zd = 0;
    $new_equip_use_lvl = value::get_game_prop_zz_value($eid, 'equip_use_lvl');
    $new_equip_use_name = value::get_game_prop_zz_value($eid, 'name');
    $new_equip_use_sex = value::get_game_prop_zz_value($eid, 'sex');
    $new_equip_use_zhiye = value::get_game_prop_zz_value($eid, 'zhiye');
    $leixing = value::get_game_prop_zz_value($eid, 'leixing');
    $name = value::get_game_user_value('name');
    $sex = value::get_game_user_value('sex');
    $zhiye = value::get_game_user_value('zhiye');
    if ($new_equip_use_sex || $new_equip_use_zhiye || value::get_game_user_value('lvl') >= $new_equip_use_lvl) {
        if (value::get_game_user_value('lvl') >= $new_equip_use_lvl) {
            if ($new_equip_use_sex) {
                if ($new_equip_use_sex != $sex) {
                    $user_zd = 1;
                }
            }
            if ($new_equip_use_zhiye) {
                if ($new_equip_use_zhiye != $zhiye) {
                    $user_zd = 1;
                }
            }
            if ($user_zd == 0) {
                equip::user_get_equip($eid, $userID);
                cmd::add_last_cmd("map_zb");
            } else {
                echo "你没满足穿戴要求无法穿戴{$new_equip_use_name}！";
                br();
            }
        } else {
            echo "你的的等级不足还不能穿戴{$new_equip_use_name}！";
            br();
        }
    } else {
        echo "你没满足穿戴要求无法穿戴{$new_equip_use_name}！";
        br();
    }
}

function e10002_sz($eid, $userID = 0)
{
    $user_zd = 0;
    $new_equip_use_lvl = value::get_game_prop_zz_value($eid, 'equip_use_lvl');
    $new_equip_use_name = value::get_game_prop_zz_value($eid, 'name');
    $new_equip_use_sex = value::get_game_prop_zz_value($eid, 'sex');
    $new_equip_use_zhiye = value::get_game_prop_zz_value($eid, 'zhiye');
    $leixing = value::get_game_prop_zz_value($eid, 'leixing');
    $name = value::get_game_user_value('name');
    $sex = value::get_game_user_value('sex');
    $zhiye = value::get_game_user_value('zhiye');
    if ($new_equip_use_sex || $new_equip_use_zhiye || value::get_game_user_value('lvl') >= $new_equip_use_lvl) {
        if (value::get_game_user_value('lvl') >= $new_equip_use_lvl) {
            if ($new_equip_use_sex) {
                if ($new_equip_use_sex != $sex) {
                    $user_zd = 1;
                }
            }
            if ($new_equip_use_zhiye) {
                if ($new_equip_use_zhiye != $zhiye) {
                    $user_zd = 1;
                }
            }
            if ($user_zd == 0) {
                equip::user_get_equip_sz($eid, $userID);
                cmd::add_last_cmd("map_zb1");
            } else {
                echo "你没满足穿戴要求无法穿戴{$new_equip_use_name}！";
                br();
            }
        } else {
            echo "你的的等级不足还不能穿戴{$new_equip_use_name}！";
            br();
        }
    } else {
        echo "你没满足穿戴要求无法穿戴{$new_equip_use_name}！";
        br();
    }
}

function e10002_cb($eid, $userID = 0)
{
    $user_zd = 0;
    $new_equip_use_lvl = value::get_game_prop_zz_value($eid, 'equip_use_lvl');
    $new_equip_use_name = value::get_game_prop_zz_value($eid, 'name');
    $new_equip_use_sex = value::get_game_prop_zz_value($eid, 'sex');
    $new_equip_use_zhiye = value::get_game_prop_zz_value($eid, 'zhiye');
    $leixing = value::get_game_prop_zz_value($eid, 'leixing');
    $name = value::get_game_user_value('name');
    $sex = value::get_game_user_value('sex');
    $zhiye = value::get_game_user_value('zhiye');
    if ($new_equip_use_sex || $new_equip_use_zhiye || value::get_game_user_value('lvl') >= $new_equip_use_lvl) {
        if (value::get_game_user_value('lvl') >= $new_equip_use_lvl) {
            if ($new_equip_use_sex) {
                if ($new_equip_use_sex != $sex) {
                    $user_zd = 1;
                }
            }
            if ($new_equip_use_zhiye) {
                if ($new_equip_use_zhiye != $zhiye) {
                    $user_zd = 1;
                }
            }
            if ($user_zd == 0) {
                equip::user_get_equip_cb($eid, $userID);
                cmd::add_last_cmd("map_cb");
            } else {
                echo "你没满足穿戴要求无法穿戴{$new_equip_use_name}！";
                br();
            }
        } else {
            echo "你的的等级不足还不能穿戴{$new_equip_use_name}！";
            br();
        }
    } else {
        echo "你没满足穿戴要求无法穿戴{$new_equip_use_name}！";
        br();
    }
}

//玩家 查看装备
function e10003($eid, $mode = 0)
{
    equip::show_equip($eid, $mode);
}

//玩家 卸下装备
function e10004($eid)
{
    equip::user_lose_equip($eid);
    cmd::add_last_cmd('map_zb');
}

function e10004_sz($eid)
{
    equip::user_lose_equip_sz($eid);
    cmd::add_last_cmd('map_zb1');
}

function e10004_cb($eid)
{
    equip::user_lose_equip_cb($eid);
    cmd::add_last_cmd('map_cb');
}

//玩家技能 学习技能
function e10005($sid, $userId = 0)
{
    if (!$userId) {
        $userId = uid();
    }
    $userName = user::get_game_user("name", $userId);
    if (user_skill::study_skill($sid, $userId)) {
        echo $userName . "学会了" . value::getvalue("skill", "name", "id", $sid) . "。";
    } else {
        echo $userName . "暂时无法学习" . value::getvalue("skill", "name", "id", $sid) . "。";
    }
    br();
}

//玩家创建时学习技能
function cj_e10005($sid, $userId = 0)
{
    if (!$userId) {
        $userId = uid();
    }
    user_skill::study_skill($sid, $userId);
}

//玩家技能书学习技能
function xxjn($item_id)
{
    if (!$userId) {
        $userId = uid();
    }
    $name = value::get_item_value($item_id, 'name');
    $zy = value::get_item_value($item_id, 'zy');
    $wj_zy = value::get_game_user_value('zhiye');
    $wj_lvl = value::get_game_user_value('lvl');
    $lvl = value::get_item_value($item_id, 'lvl');
    $is_shuji = value::get_item_value($item_id, 'is_shuji');
    if ($zy == $wj_zy) {
        if ($wj_lvl >= $lvl) {
            item::lose_item($item_id, 1);
            switch ($item_id) {
                case 19:
                    e10005(3);
                    break;
                case 20:
                    e10005(4);
                    break;
                case 21:
                    e10005(5);
                    break;
                case 24:
                    e10005(8);
                    break;
                case 22:
                    e10005(6);
                    break;
                case 43:
                    e10005(14);
                    break;
                case 42:
                    e10005(15);
                    break;
                case 40:
                    e10005(16);
                    break;
                case 32:
                    e10005(17);
                    break;
                case 26:
                    e10005(10);
                    break;
                case 29:
                    e10005(12);
                    break;
                case 84:
                    e10005(18);
                    break;
                case 88:
                    e10005(21);
                    break;
                case 89:
                    e10005(22);
                    break;
                case 90:
                    e10005(23);
                    break;
                case 91:
                    e10005(24);
                    break;
                case 92:
                    e10005(25);
                    break;
                case 23:
                    e10005(7);
                    break;
                case 27:
                    e10005(11);
                    break;
                case 28:
                    e10005(29);
                    break;
                case 30:
                    e10005(13);
                    break;
                case 31:
                    e10005(30);
                    break;
                case 33:
                    e10005(31);
                    break;
                case 34:
                    e10005(32);
                    break;
                case 35:
                    e10005(33);
                    break;
                case 37:
                    e10005(34);
                    break;
                case 38:
                    e10005(35);
                    break;
                case 39:
                    e10005(36);
                    break;
                case 41:
                    e10005(37);
                    break;
                case 44:
                    e10005(38);
                    break;
                case 94:
                    e10005(39);
                    break;
                case 95:
                    e10005(40);
                    break;
                case 96:
                    e10005(41);
                    break;
                case 97:
                    e10005(42);
                    break;
                case 98:
                    e10005(43);
                    break;
                case 99:
                    e10005(44);
                    break;
                case 100:
                    e10005(45);
                    break;
                case 101:
                    e10005(46);
                    break;
                case 102:
                    e10005(47);
                    break;
                case 103:
                    e10005(49);
                    break;
                case 104:
                    e10005(50);
                    break;
                case 105:
                    e10005(51);
                    break;
                case 106:
                    e10005(52);
                    break;
                case 107:
                    e10005(53);
                    break;
                case 108:
                    e10005(54);
                    break;
                case 109:
                    e10005(55);
                    break;
                case 110:
                    e10005(56);
                    break;
                case 111:
                    e10005(57);
                    break;
                case 112:
                    e10005(58);
                    break;
                case 36:
                    e10005(18);
                    break;
                case 25:
                    e10005(9);
                    break;
                case 225:
                    e10005(45);
                    break;
                case 226:
                    e10005(45);
                    break;
                case 227:
                    e10005(46);
                    break;
                case 228:
                    e10005(46);
                    break;
            }
        } else {
            echo "你无法学习" . $name . "，需要" . $lvl . "级才能学习！";
            br();
        }
    } else {
        echo "你无法学习" . $name . "，需要" . $zy . "才能学习！";
        br();
    }
}

//战斗 招降宠物
function e60($oid)
{
    $user_id = uid();
    //获取宠物名称 种族ID 招降难度 宠物星级
    $pet_name = value::getvalue('game_pet', 'name', 'id', $oid);
    $pet_lvl = value::getvalue('game_pet', 'lvl', 'id', $oid);
    $pet_hp = value::getvalue('game_pet', 'hp', 'id', $oid);
    $pet_max_hp1 = value::getvalue('game_pet', 'max_hp', 'id', $oid) / 3;
    $lvl = value::get_game_user_value('lvl', $user_id) + 5;
    $pet_zzid = value::get_pet_value($oid, 'pet_id');
    $fynd = value::getvalue('pet', 'fynd', 'id', $pet_zzid);
    $star = value::getvalue('pet', 'star', 'id', $pet_zzid);
    //宠物是否还存在
    if ($pet_name) {
        if (pet::user_get_pet($user_id, $oid)) {
            if ($pet_hp < $pet_max_hp1) {
                if ($lvl >= $pet_lvl) {
                    //玩家退出战斗
                    user::exit_pk($user_id);
                    //显示战斗信息
                    $obj = new game_user_object($user_id);
                    echo $obj->get("pk_chats", "string");
                    $obj->del("pk_chats");
                    //玩家获得封怪名声
                    $today = date("Y-m-d");
                    $fengyao_day = value::get_user_value("fengyao.day", $user_id);
                    if ($fengyao_day != $today) {
                        value::set_user_value("fengyao.day", $today);
                        value::set_user_value("fengyao.mingsheng", 0, $user_id);
                    }
                    if (value::get_user_value("fengyao.mingsheng", $user_id) < 100) {
                        value::add_user_value("fengyao.mingsheng", $star, $user_id);
                        value::add_user_value('fengyaoms', $star, $user_id);
                    }
                    //野生宠物敌人归零
                    value::set_pet_value($oid, 'enemy_user', 0);
                    //野生宠物学习技能
                    $study_lvl = value::getvalue('pet', 'study_lvl', 'id', value::get_pet_value($oid, 'pet_id'));
                    $can_study_fashu = (int)($olvl / $study_lvl + 1);
                    $can_study_fashu = $can_study_fashu > 10 ? 10 : $can_study_fashu;
                    $can_study_count = $can_study_fashu > 4 ? 4 : $can_study_fashu;
                    //读取种族技能
                    $p_study_skill_str = value::getvalue('pet', 'study_skill', 'id', $pet_zzid);
                    $p_study_skill_arr = explode(',', $p_study_skill_str);
                    //开始学习
                    for ($i = 1; $i <= $can_study_count; $i++) {
                        skill::study_skill($oid, $p_study_skill_arr[$can_study_fashu - $i], -1, false);
                    }
                    //招降广播
                    if ($star > 1) {
                        c_add_guangbo(value::get_game_user_value('name', $user_id) . "在" . value::getvalue('map', 'name', 'id', value::get_game_user_value('in_map_id')) . "成功招降了" . $pet_name . "!");
                    }
                    //输出提示
                    echo '你获得了胜利。';
                    br();
                    echo '你成功的招降了' . $pet_name . "!";
                    value::set_user_value("e60", 1, $user_id);
                    return;
                } else {
                    echo '只能收服比自己大5级的怪物！';
                    br();
                }
            } else {
                echo '只能收服低于3分之一血的怪物！';
                br();
            }
        } else {
            echo '身上只能携带5只宠物!';
        }
    } else {
        echo '这只宠物已经不在这里了!';
    }
}

//玩家辅助技能
function fz_jnxg($skillId, $userId, $oUserId, $oPetId)
{
    //技能
    $sql = "SELECT * FROM `skill` WHERE `id`={$skillId} LIMIT 1";
    $rs = sql($sql);
    $jn = $rs->fetch_array(MYSQLI_ASSOC);
    //己方属性
    $sql = "SELECT * FROM `game_user` WHERE `id`={$userId} LIMIT 1";
    $rs = sql($sql);
    $uv = $rs->fetch_array(MYSQLI_ASSOC);
    $uv['max_hp'] += equip::get_user_equip_jc('hp', $userId);
    $uv['pugong'] += equip::get_user_equip_jc('pugong', $userId);
    $uv['pufang'] += equip::get_user_equip_jc('pufang', $userId);
    $uv['tegong'] += equip::get_user_equip_jc('tegong', $userId);
    $uv['tefang'] += equip::get_user_equip_jc('tefang', $userId);
    $uv['minjie'] += equip::get_user_equip_jc('minjie', $userId);
    //敌方属性
    if ($oUserId) {
        $sql = "SELECT * FROM `game_user` WHERE `id`={$oUserId} LIMIT 1";
        $rs = sql($sql);
        $ov = $rs->fetch_array(MYSQLI_ASSOC);
    }
    $ov['max_hp'] += equip::get_user_equip_jc('hp', $oUserId);
    $ov['pugong'] += equip::get_user_equip_jc('pugong', $oUserId);
    $ov['pufang'] += equip::get_user_equip_jc('pufang', $oUserId);
    $ov['tegong'] += equip::get_user_equip_jc('tegong', $oUserId);
    $ov['tefang'] += equip::get_user_equip_jc('tefang', $oUserId);
    $ov['minjie'] += equip::get_user_equip_jc('minjie', $oUserId);
    //敌方宠物属性
    if ($oPetId) {
        $sql = "SELECT * FROM `game_pet` WHERE `id`={$oPetId} LIMIT 1";
        $rs = sql($sql);
        $opv = $rs->fetch_array(MYSQLI_ASSOC);
    }
    $opv['max_hp'] += pet::get_liuwei_jiacheng($oPetId, 'hp');
    $opv['pugong'] += pet::get_liuwei_jiacheng($oPetId, 'pugong');
    $opv['pufang'] += pet::get_liuwei_jiacheng($oPetId, 'pufang');
    $opv['tegong'] += pet::get_liuwei_jiacheng($oPetId, 'tegong');
    $opv['tefang'] += pet::get_liuwei_jiacheng($oPetId, 'tefang');
    $opv['minjie'] += pet::get_liuwei_jiacheng($oPetId, 'minjie');
    //技能属性
    $jLeiXing = $jn['leixing'];
    //诱惑之光
    if ($skillId == 18) {
        $pet_id = $opv['pet_id'];
        $o_npcid = $opv['npc_id'];
        $o_star = $opv['star'];
        $o_pet_name = $opv['name'];
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = $jn_lvl * $jn['weili'] + $jn['weili'];
        if (!$oUserId && !$o_npcid) {
            //开始封怪操作
            value::set_user_value('zd_tz', 1, $userId);
            if (mt_rand(1, 100) < $jn_wl) {
                if ($o_star < 2) {
                    $fysql = "SELECT COUNT(*) FROM `game_pet` WHERE `master_id`={$userId} AND `master_mode`=1";
                    $fyresult = sql($fysql);
                    list($pet_count) = $fyresult->fetch_row();
                    if ($pet_count < 5) {
                        e60($oPetId);
                        return;
                    } else {
                        skill::add_skill_chat('身上只能携带5只宠物。', $userId, $oUserId);
                    }
                } else {
                    skill::add_skill_chat('眼看你就要收服' . $o_pet_name . ',结果还是让它给跑了。', $userId, $oUserId);
                }
            } else {
                skill::add_skill_chat('眼看你就要收服' . $o_pet_name . ',结果还是让它给跑了。', $userId, $oUserId);
            }
        } else {
            skill::add_skill_chat('无法招降有主人的宠物。', $userId, $oUserId);
        }
    }
    //灵魂火符
    if ($skillId == 12) {
        value::set_user_value('zd_tz', 1, $userId);
        $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
        if ($zb_hf > 0) {
            value::set_user_value('zd_tz', 0, $userId);
        } else {
            skill::add_skill_chat($uv['name'] . '没有护身符无法使用' . $jn['name'], $userId, $oUserId);
        }
    }
    //治愈技能
    if ($skillId == 4) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
        $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
        if ($uv['mp'] >= $jn_lvl_mp) {
            $sj = mt_rand(1, $jn_wl);
            value::set_user_value('zd_tz', 1, $userId);
            value::add_game_user_value('hp', $sj, $userId);
            skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '恢复了' . $sj . '点血', $userId, $oUserId);
        }
    }
    if ($skillId == 44) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
        $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
        if ($uv['mp'] >= $jn_lvl_mp) {
            $sj = mt_rand(1, $jn_wl);
            value::set_user_value('zd_tz', 1, $userId);
            value::add_game_user_value('hp', $sj, $userId);
            skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '恢复了' . $sj . '点血', $userId, $oUserId);
        }
    }
    if ($skillId == 6) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = ($jn_lvl + 1) * $jn['weili'];
        $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
        value::set_user_value('zd_tz', 1, $userId);
        if ($uv['mp'] >= $jn_lvl_mp) {
            value::set_user_value('zd_jn_6', 3, $userId);
            $sj = mt_rand(1, $jn_wl);
            value::set_user_value('jn_mz', $sj, $userId);
            skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '增加了' . $sj . '点命中', $userId, $oUserId);
        }
    }
    if ($skillId == 9) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = ($jn_lvl + 1) * $jn['weili'];
        $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
        value::set_user_value('zd_tz', 1, $userId);
        if ($uv['mp'] >= $jn_lvl_mp) {
            $zb_hf = equip::get_user_equip_jc('zb_dy', $userId);
            if ($zb_hf > 0) {
                if ($zb_hf == 2) {
                    if ($oUserId) {
                        value::set_user_value('zd_zd', 3, $oUserId);
                    }
                    if ($oPetId) {
                        value::set_pet_value2('zd_zd', 3, $oPetId);
                    }
                }
                if ($zb_hf == 1) {
                    if ($oUserId) {
                        value::set_user_value('dy_zd', 3, $oUserId);
                        value::set_user_value('dy_fy', $jn_wl, $oUserId);
                    }
                    if ($oPetId) {
                        value::set_pet_value2('dy_zd', 3, $oPetId);
                        value::set_pet_value2('dy_fy', $jn_wl, $oPetId);
                    }
                }
                skill::add_skill_chat($uv['name'] . '成功使用' . $jn['name'] . '', $userId, $oUserId);
            } else {
                skill::add_skill_chat($uv['name'] . '没有药粉无法使用' . $jn['name'], $userId, $oUserId);
            }
        }
    }
    if ($skillId == 39) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = ($jn_lvl + 1) * $jn['weili'];
        $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
        value::set_user_value('zd_tz', 1, $userId);
        if ($uv['mp'] >= $jn_lvl_mp) {
            $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
            if ($zb_hf > 0) {
                if ($oPetId) {
                    if (mt_rand(0, 100) < $jn_wl) {
                        value::set_pet_value2('zd_tz', 1, $oPetId);
                        skill::add_skill_chat($uv['name'] . '成功使用' . $jn['name'] . '', $userId, $oUserId);
                    } else {
                        skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '失败', $userId, $oUserId);
                    }
                }
            } else {
                skill::add_skill_chat($uv['name'] . '没有护身符无法使用' . $jn['name'], $userId, $oUserId);
            }
        }
    }
    if ($skillId == 43) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = ($jn_lvl + 1) * $jn['weili'];
        $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
        value::set_user_value('zd_tz', 1, $userId);
        if ($uv['mp'] >= $jn_lvl_mp) {
            if (mt_rand(0, 100) < $jn_wl) {
                if ($oUserId && $uv['lvl'] > $ov['lvl']) {
                    value::set_user_value('zd_tz', 2, $oUserId);
                }
                if ($oPetId && $uv['lvl'] > $opv['lvl']) {
                    value::set_pet_value2('zd_tz', 2, $oPetId);
                }
                skill::add_skill_chat($uv['name'] . '成功使用' . $jn['name'] . '', $userId, $oUserId);
            } else {
                skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '失败', $userId, $oUserId);
            }
        }
    }
    if ($skillId == 46) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = ($jn_lvl + 1) * $jn['weili'];
        value::set_user_value('zd_tz', 1, $userId);
        value::set_user_value('zd_fs_hd', 3, $userId);
        value::set_user_value('zd_fs_fy', $jn_wl, $userId);
        skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '获得' . $jn_wl . '防御', $userId, $oUserId);
    }
    if ($skillId == 54) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = ($jn_lvl + 1) * $jn['weili'];
        value::set_user_value('zd_tz', 1, $userId);
        value::set_user_value('zd_ds_qm', 3, $userId);
        value::set_user_value('zd_ds_gj', $jn_wl, $userId);
        skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '获得' . $jn_wl . '攻击', $userId, $oUserId);
    }
    if ($skillId == 10) {
        $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
        $jn_wl = ($jn_lvl + 1) * $jn['weili'];
        $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
        value::set_user_value('zd_tz', 1, $userId);
        if ($uv['mp'] >= $jn_lvl_mp) {
            if (mt_rand(0, 100) < $jn_wl) {
                if ($oUserId && $uv['lvl'] > $ov['lvl']) {
                    value::set_user_value('zd_tz', 2, $oUserId);
                    value::set_user_value('zd_tz', 0, $userId);
                }
                if ($oPetId && $uv['lvl'] > $opv['lvl']) {
                    value::set_pet_value2('zd_tz', 2, $oPetId);
                    value::set_user_value('zd_tz', 0, $userId);
                }
                skill::add_skill_chat($uv['name'] . '成功使用' . $jn['name'] . '', $userId, $oUserId);
            } else {
                skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '失败', $userId, $oUserId);
            }
        }
    }
    if ($skillId == 13) {
        value::set_user_value('zd_tz', 1, $userId);
        $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
        if ($zb_hf > 0) {
            $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
            $jn_wl = ($jn_lvl + 1) * $jn['weili'];
            value::set_user_value('ds_hd', 3, $userId);
            value::set_user_value('ds_mf_fy', $jn_wl, $userId);
            skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '获得' . $jn_wl .'魔法防御', $userId, $oUserId);
        } else {
            skill::add_skill_chat($uv['name'] . '没有护身符无法使用' . $jn['name'], $userId, $oUserId);
        }
    }
    if ($skillId == 30) {
        value::set_user_value('zd_tz', 1, $userId);
        $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
        if ($zb_hf > 0) {
            $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
            $jn_wl = ($jn_lvl + 1) * $jn['weili'];
            value::set_user_value('ds_fy', 3, $userId);
            value::set_user_value('ds_wl_fy', $jn_wl, $userId);
            skill::add_skill_chat($uv['name'] . '使用' . $jn['name'] . '获得' . $jn_wl .'物理防御', $userId, $oUserId);
        } else {
            skill::add_skill_chat($uv['name'] . '没有护身符无法使用' . $jn['name'], $userId, $oUserId);
        }
    }
    //圣言术
    if ($skillId == 47) {
        if ($oUserId) {
            value::set_user_value('jn_sy', 1, $oUserId);
            skill::add_skill_chat($uv['name'] . '对' . $ov['name'] . '的' . $opv['name'] . '成功使用' . $jn['name'] . '', $userId, $oUserId);
        } else {
            skill::add_skill_chat('圣言术只能对有主人的宠物使用', $userId, $oUserId);
        }
    }
}

//玩家地图使用技能
function map_syjn($skillId, $userId)
{
    //技能
    $sql = "SELECT * FROM `skill` WHERE `id`={$skillId} LIMIT 1";
    $rs = sql($sql);
    $jn = $rs->fetch_array(MYSQLI_ASSOC);
    //己方属性
    $sql = "SELECT * FROM `game_user` WHERE `id`={$userId} LIMIT 1";
    $rs = sql($sql);
    $uv = $rs->fetch_array(MYSQLI_ASSOC);
    $uv['max_hp'] += equip::get_user_equip_jc('hp', $userId);
    $uv['pugong'] += equip::get_user_equip_jc('pugong', $userId);
    $uv['pufang'] += equip::get_user_equip_jc('pufang', $userId);
    $uv['tegong'] += equip::get_user_equip_jc('tegong', $userId);
    $uv['tefang'] += equip::get_user_equip_jc('tefang', $userId);
    $uv['minjie'] += equip::get_user_equip_jc('minjie', $userId);
    //技能属性
    $jLeiXing = $jn['leixing'];
    if (mt_rand(1, 100) < $jn['mingzhong']) {
        switch ($skillId) {
            case 4:
                $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                if ($uv['mp'] >= $jn_lvl_mp) {
                    $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                    $sj = mt_rand(1, $jn_wl);
                    value::add_game_user_value('hp', $sj, $userId);
                    value::add_user_value('skill.' . $jn['id'] . '.exp', 1, $userId);
                    echo $uv['name'] . '使用' . $jn['name'] . '恢复了' . $sj . '点血';
                    br();
                } else {
                    echo "{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                    br();
                }
                break;
            case 44:
                $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                if ($uv['mp'] >= $jn_lvl_mp) {
                    $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                    $sj = mt_rand(1, $jn_wl);
                    value::add_game_user_value('hp', $sj, $userId);
                    value::add_user_value('skill.' . $jn['id'] . '.exp', 1, $userId);
                    echo $uv['name'] . '使用' . $jn['name'] . '恢复了' . $sj . '点血';
                    br();
                } else {
                    echo "{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                    br();
                }
                break;
            case 32:
                $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
                if ($zb_hf > 0) {
                    pet::prop_mosun2($userId, -1, 0);
                    $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                    $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                    $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                    if ($uv['mp'] >= $jn_lvl_mp) {
                        $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                        $sj = mt_rand(1, $jn_wl);
                        value::add_user_value('map_gw_dg', $sj, $userId);
                        value::add_user_value('skill.' . $jn['id'] . '.exp', 1, $userId);
                        echo $uv['name'] . '使用' . $jn['name'] . '获得了' . $sj . '次逃避怪物主动攻击';
                        br();
                    } else {
                        echo"{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                        br();
                    }
                } else {
                    skill::add_skill_chat($uv['name'] . '没有护身符无法使用' . $jn['name'], $userId, $oUserId);
                }
                break;
            case 31:
                $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                if ($uv['mp'] >= $jn_lvl_mp) {
                    $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                    $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
                    $new_pet_id = 33;
                    if ($zb_hf > 0) {
                        pet::prop_mosun2($userId, -1, 0);
                        value::add_user_value('skill.' . $jn['id'] . '.exp', 1, $userId);
                        $new_pet_id = pet::new_pet(33, 0, 0, $userId, 0, 0, 0, 0, 0, 0);
                        $new_pet_name = value::getvalue('pet', 'name', 'id', 33);
                        $pet_name = "{$uv['name']}使用{$jn['name']}获得了{$new_pet_name}!";
                        pet::user_get_pet1($userId, $new_pet_id, 1, $pet_name);
                    } else {
                        echo"{$uv['name']}没有护身符无法使用{$jn['name']}";
                        br();
                    }
                } else {
                    echo"{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                    br();
                }
                break;
            case 58:
                $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                if ($uv['mp'] >= $jn_lvl_mp) {
                    $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                    $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
                    $new_pet_id = 78;
                    if ($zb_hf > 0) {
                        pet::prop_mosun2($userId, -1, 0);
                        value::add_user_value('skill.' . $jn['id'] . '.exp', 1, $userId);
                        $new_pet_id = pet::new_pet(78, 0, 0, $userId, 0, 0, 0, 0, 0, 0);
                        $new_pet_name = value::getvalue('pet', 'name', 'id', 78);
                        $pet_name = "{$uv['name']}使用{$jn['name']}获得了{$new_pet_name}!";
                        pet::user_get_pet1($userId, $new_pet_id, 1, $pet_name);
                    } else {
                        echo"{$uv['name']}没有护身符无法使用{$jn['name']}";
                        br();
                    }
                } else {
                    echo"{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                    br();
                }
                break;
            case 33:
                $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
                if ($zb_hf > 0) {
                    pet::prop_mosun2($userId, -1, 0);
                    $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                    $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                    $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                    if ($uv['mp'] >= $jn_lvl_mp) {
                        $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                        $sj = mt_rand(1, $jn_wl);
                        value::add_user_value('map_gw_dg', $sj, $userId);
                        value::add_user_value('skill.' . $jn['id'] . '.exp', 1, $userId);
                        echo $uv['name'] . '使用' . $jn['name'] . '获得了' . $sj . '次逃避怪物主动攻击';
                        br();
                    } else {
                        echo"{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                        br();
                    }
                } else {
                    skill::add_skill_chat($uv['name'] . '没有护身符无法使用' . $jn['name'], $userId, $oUserId);
                }
                break;
            case 34:
                pet::prop_mosun2($userId, -1, 0);
                $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                if ($uv['mp'] >= $jn_lvl_mp) {
                    $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                    $user_id = uid();
                    $in_map_id = value::get_game_user_value('in_map_id');
                    $area_id = value::get_map_value($in_map_id, 'area_id', $user_id);
                    $sql = "SELECT COUNT(*) FROM `map` WHERE `area_id`='{$area_id}'";
                    $result = sql($sql);
                    list($map_count1) = $result->fetch_row();
                    $sj = mt_rand(1, $map_count1);
                    $sql = "SELECT `name`,`id` FROM `map` WHERE `area_id`='{$area_id}' AND `ts_map`<1 LIMIT {$sj}, 1";
                    $result = sql($sql);
                    list($map_name, $map_id) = $result->fetch_row();
                    echo "你使用{$jn['name']}传送到" . $map_name;
                    br();
                    if ($map_id) {
                        value::set_game_user_value('in_map_id', $map_id);
                    }
                } else {
                    echo"{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                    br();
                }
                break;
            case 78:
                pet::prop_mosun2($userId, -1, 0);
                $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                if ($uv['mp'] >= $jn_lvl_mp) {
                    $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                    $user_id = uid();
                    $in_map_id = value::get_game_user_value('in_map_id');
                    $area_id = value::get_map_value($in_map_id, 'area_id', $user_id);
                    $sql = "SELECT COUNT(*) FROM `map` WHERE `area_id`='{$area_id}'";
                    $result = sql($sql);
                    list($map_count1) = $result->fetch_row();
                    $sj = mt_rand(1, $map_count1);
                    $sql = "SELECT `name`,`id` FROM `map` WHERE `area_id`='{$area_id}' AND `ts_map`<1 LIMIT {$sj}, 1";
                    $result = sql($sql);
                    list($map_name, $map_id) = $result->fetch_row();
                    echo "你使用{$jn['name']}传送到" . $map_name;
                    br();
                    if ($map_id) {
                        value::set_game_user_value('in_map_id', $map_id);
                    }
                } else {
                    echo"{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                    br();
                }
                break;
            case 45:
                $jn_lvl = value::get_user_value('skill.' . $jn['id'] . '.lvl', $userId);
                $jn_wl = $jn_lvl * ($jn['weili'] / 5) + $jn['weili'];
                $jn_lvl_mp = $jn['mp'] * ( $jn_lvl + 1 );
                if ($uv['mp'] >= $jn_lvl_mp) {
                    $uv['mp'] = user::add_game_user('mp', -1 * $jn_lvl_mp, $UserId);
                    $zb_hf = equip::get_user_equip_jc('zb_hf', $userId);
                    $new_pet_id = 34;
                    if ($zb_hf > 0 || value::get_game_user_value('zhiye', $userId) != '道士') {
                        pet::prop_mosun2($userId, -1, 0);
                        value::add_user_value('skill.' . $jn['id'] . '.exp', 1, $userId);
                        $new_pet_id = pet::new_pet(34, 0, 0, $userId, 0, 0, 0, 0, 0, 0);
                        $new_pet_name = value::getvalue('pet', 'name', 'id', 34);
                        $pet_name = "{$uv['name']}使用{$jn['name']}获得了{$new_pet_name}!";
                        pet::user_get_pet1($userId, $new_pet_id, 1, $pet_name);
                    } else {
                        echo"{$uv['name']}没有护身符无法使用{$jn['name']}";
                        br();
                    }
                } else {
                    echo"{$uv['name']}没有足够魔法值使用了{$jn['name']}";
                    br();
                }
                break;
        }
    } else {
        echo "{$uv['name']}使用了{$jn['name']}失败";
        br();
    }
}

function sy_money($user_id, $item_id)
{
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    switch ($item_id) {
        case 222:
            item::add_money(1000000);
            break;
        case 223:
            item::add_money(5000000);
            break;
        case 224:
            item::add_money(10000000);
            break;
    }
}

function sy_jp_ch($user_id, $item_id)
{
    $user_id = uid();
    $ch_yjhd = value::get_user_value('ch_yjhd' . $item_id);
    if (!$ch_yjhd) {
        $user_name = value::get_game_user_value('name');
        $item_name = value::get_item_value($item_id, 'name');
        $item_liangci = value::get_item_value($item_id, 'liangci');
        value::insert_user_value('nick_name', $item_name);
        value::set_user_value('ch_yjhd' . $item_id, 1);
        if (!value::get_user_value('using_nick_name')) {
            value::set_user_value('using_nick_name', $item_name);
        }
        echo "恭喜你获得了{$item_name}称号！";
        br();
        c_add_guangbo("恭喜玩家,{$user_name}获得了{$item_name}称号");
    } else {
        echo "你已经获得了{$item_name}称号！";
        br();
    }
}

//玩家使用宠物宝箱
function sy_cwbx($user_id, $item_id)
{
    //随机宠物
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    $xingyun = mt_rand(1, 1000);
    if ($xingyun <= 1 && $xingyun <= 5) {
        $add_sql = "`star`=10";
    } else if ($xingyun > 5 && $xingyun <= 10) {
        $add_sql = "`star`=9";
    } else if ($xingyun > 10 && $xingyun <= 20) {
        $add_sql = "`star`=8";
    } else if ($xingyun > 20 && $xingyun <= 30) {
        $add_sql = "`star`=7";
    } else if ($xingyun > 30 && $xingyun <= 50) {
        $add_sql = "`star`=6";
    } else if ($xingyun > 50 && $xingyun <= 80) {
        $add_sql = "`star`=5";
    } else if ($xingyun > 80 && $xingyun <= 100) {
        $add_sql = "`star`=4";
    } else if ($xingyun > 100 && $xingyun <= 150) {
        $add_sql = "`star`=3";
    } else if ($xingyun > 150 && $xingyun <= 200) {
        $add_sql = "`star`=2";
    } else {
        $add_sql = "`star`<2";
    }
    //宠物id
    $sql = "SELECT `id` FROM `pet` WHERE $add_sql ORDER BY RAND() DESC LIMIT 1";
    $result = sql($sql);
    list($pet_id) = $result->fetch_row();
    if (!$pet_id) {
        $sql = "SELECT `id`,`star` FROM `pet` WHERE `star`<2 ORDER BY RAND() DESC LIMIT 1";
        $result = sql($sql);
        list($pet_id, $star) = $result->fetch_row();
    }
    //开始生成
    $new_pet_id = pet::new_pet($pet_id, 1, 0, $user_id, 0, 0, 0, 0, 0, 0);
    cj_cw($new_pet_id);
    $new_pet_name = value::get_pet_value($new_pet_id, 'name');
    //输出提示
    $pet_id = value::get_pet_value($new_pet_id, 'pet_id');
    $img = value::getvalue('pet', 'image', 'id', $pet_id);
    $img1 = pet::img1($img, true, false);
    echo "你打开了1{$item_liangci}{$item_name},惊天动地,从宝箱里蹦出了1个的{$img1}{$new_pet_name}!";
    br();
    if (pet::user_get_pet($user_id, $new_pet_id, 1, false)) {
    } else {
        pet::user_get_pet($user_id, $new_pet_id, 2);
        echo $new_pet_name . '存入了仓库。';
        br();
    }
    //输出广播
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    $ts_name1 = "神宠现世,{$user_name}打开{$item_name},获得了{$xj}星";
    c_add_guangbo($ts_name1, $new_pet_id, 5);
}

function sy_cwbx1($user_id, $item_id)
{
    //随机宠物
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    //宠物id
    $sql = "SELECT `id` FROM `pet` WHERE `star`=5 AND `is_yj`>0 ORDER BY RAND() DESC LIMIT 1";
    $result = sql($sql);
    list($pet_id) = $result->fetch_row();
    if (!$pet_id) {
        $sql = "SELECT `id`,`star` FROM `pet` WHERE `star`<2 ORDER BY RAND() DESC LIMIT 1";
        $result = sql($sql);
        list($pet_id, $star) = $result->fetch_row();
    }
    //开始生成
    $new_pet_id = pet::new_pet($pet_id, 1, 0, $user_id, 0, 0, 0, 0, 0, 0);
    cj_cw($new_pet_id);
    $new_pet_name = value::get_pet_value($new_pet_id, 'name');
    //输出提示
    $pet_id = value::get_pet_value($new_pet_id, 'pet_id');
    $img = value::getvalue('pet', 'image', 'id', $pet_id);
    $img1 = pet::img1($img, true, false);
    echo "你打开了1{$item_liangci}{$item_name},惊天动地,从宝箱里蹦出了1个的{$img1}{$new_pet_name}!";
    br();
    if (pet::user_get_pet($user_id, $new_pet_id, 1, false)) {
    } else {
        pet::user_get_pet($user_id, $new_pet_id, 2);
        echo $new_pet_name . '存入了仓库。';
        br();
    }
    //输出广播
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    $ts_name1 = "神宠现世,{$user_name}打开{$item_name},获得了{$xj}星";
    c_add_guangbo($ts_name1, $new_pet_id, 5);
}
function sy_cwbx2($user_id, $item_id)
{
    //随机宠物
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    //宠物id
    $sql = "SELECT `id` FROM `pet` WHERE `star`=6 AND `is_yj`>0 ORDER BY RAND() DESC LIMIT 1";
    $result = sql($sql);
    list($pet_id) = $result->fetch_row();
    if (!$pet_id) {
        $sql = "SELECT `id`,`star` FROM `pet` WHERE `star`<2 ORDER BY RAND() DESC LIMIT 1";
        $result = sql($sql);
        list($pet_id, $star) = $result->fetch_row();
    }
    //开始生成
    $new_pet_id = pet::new_pet($pet_id, 1, 0, $user_id, 0, 0, 0, 0, 0, 0);
    cj_cw($new_pet_id);
    $new_pet_name = value::get_pet_value($new_pet_id, 'name');
    //输出提示
    $pet_id = value::get_pet_value($new_pet_id, 'pet_id');
    $img = value::getvalue('pet', 'image', 'id', $pet_id);
    $img1 = pet::img1($img, true, false);
    echo "你打开了1{$item_liangci}{$item_name},惊天动地,从宝箱里蹦出了1个的{$img1}{$new_pet_name}!";
    br();
    if (pet::user_get_pet($user_id, $new_pet_id, 1, false)) {
    } else {
        pet::user_get_pet($user_id, $new_pet_id, 2);
        echo $new_pet_name . '存入了仓库。';
        br();
    }
    //输出广播
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    $ts_name1 = "神宠现世,{$user_name}打开{$item_name},获得了{$xj}星";
    c_add_guangbo($ts_name1, $new_pet_id, 5);
}

function sy_cwbx3($user_id, $item_id)
{
    //随机宠物
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    //宠物id
    $sql = "SELECT `id` FROM `pet` WHERE `star`=7 AND `is_yj`>0 ORDER BY RAND() DESC LIMIT 1";
    $result = sql($sql);
    list($pet_id) = $result->fetch_row();
    if (!$pet_id) {
        $sql = "SELECT `id`,`star` FROM `pet` WHERE `star`<2 ORDER BY RAND() DESC LIMIT 1";
        $result = sql($sql);
        list($pet_id, $star) = $result->fetch_row();
    }
    //开始生成
    $new_pet_id = pet::new_pet($pet_id, 1, 0, $user_id, 0, 0, 0, 0, 0, 0);
    cj_cw($new_pet_id);
    $new_pet_name = value::get_pet_value($new_pet_id, 'name');
    //输出提示
    $pet_id = value::get_pet_value($new_pet_id, 'pet_id');
    $img = value::getvalue('pet', 'image', 'id', $pet_id);
    $img1 = pet::img1($img, true, false);
    echo "你打开了1{$item_liangci}{$item_name},惊天动地,从宝箱里蹦出了1个的{$img1}{$new_pet_name}!";
    br();
    if (pet::user_get_pet($user_id, $new_pet_id, 1, false)) {
    } else {
        pet::user_get_pet($user_id, $new_pet_id, 2);
        echo $new_pet_name . '存入了仓库。';
        br();
    }
    //输出广播
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    $ts_name1 = "神宠现世,{$user_name}打开{$item_name},获得了{$xj}星";
    c_add_guangbo($ts_name1, $new_pet_id, 5);
}

function sy_cwbx4($user_id, $item_id)
{
    //随机宠物
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    //宠物id
    $sql = "SELECT `id` FROM `pet` WHERE `star`=8 AND `is_yj`>0 ORDER BY RAND() DESC LIMIT 1";
    $result = sql($sql);
    list($pet_id) = $result->fetch_row();
    if (!$pet_id) {
        $sql = "SELECT `id`,`star` FROM `pet` WHERE `star`<2 ORDER BY RAND() DESC LIMIT 1";
        $result = sql($sql);
        list($pet_id, $star) = $result->fetch_row();
    }
    //开始生成
    $new_pet_id = pet::new_pet($pet_id, 1, 0, $user_id, 0, 0, 0, 0, 0, 0);
    cj_cw($new_pet_id);
    $new_pet_name = value::get_pet_value($new_pet_id, 'name');
    //输出提示
    $pet_id = value::get_pet_value($new_pet_id, 'pet_id');
    $img = value::getvalue('pet', 'image', 'id', $pet_id);
    $img1 = pet::img1($img, true, false);
    echo "你打开了1{$item_liangci}{$item_name},惊天动地,从宝箱里蹦出了1个的{$img1}{$new_pet_name}!";
    br();
    if (pet::user_get_pet($user_id, $new_pet_id, 1, false)) {
    } else {
        pet::user_get_pet($user_id, $new_pet_id, 2);
        echo $new_pet_name . '存入了仓库。';
        br();
    }
    //输出广播
    //输出宠物星级
    if ($star <= 1) {
        $xj = "一";
    } else if ($star == 2) {
        $xj = "二";
    } else if ($star == 3) {
        $xj = "三";
    } else if ($star == 4) {
        $xj = "四";
    } else if ($star == 5) {
        $xj = "五";
    } else if ($star == 6) {
        $xj = "六";
    } else if ($star == 7) {
        $xj = "七";
    } else if ($star == 8) {
        $xj = "八";
    } else if ($star == 9) {
        $xj = "九";
    } else if ($star == 10) {
        $xj = "十";
    } else {
        $xj = "神级";
    }
    $ts_name1 = "神宠现世,{$user_name}打开{$item_name},获得了{$xj}星";
    c_add_guangbo($ts_name1, $new_pet_id, 5);
}

//玩家使用装备宝箱
function sy_zbbx($user_id, $item_id)
{
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    //随机装备
    $sj = mt_rand(1, 1000);
    if ($sj <= 10) {
        $sji = 3;
        $add_sql = "AND star>3";
    } else if ($sj <= 50) {
        $sji = 2;
        $add_sql = "AND star=3";
    } else if ($sj <= 100) {
        $sji = 1;
        $add_sql = "AND star=2";
    } else {
        $sji = 0;
        $add_sql = "AND star<2";
    }
    $sj6 = mt_rand(1, 1000);
    if ($sj6 <= 10) {
        $add_sql = "AND star>3";
    } else if ($sj6 <= 50) {
        $add_sql = "AND star=3";
    } else if ($sj6 <= 100) {
        $add_sql = "AND star=2";
    } else {
        $add_sql = "AND star<2";
    }
    //装备id
    $sql = "SELECT `id`,`liangci`,`name` FROM `prop` WHERE `leixing`=2 {$add_sql} ORDER BY RAND() LIMIT 1";
    $result = sql($sql);
    list($prop_id, $prop_liangci, $prop_name) = $result->fetch_row();
    //装备星级
    $prop_star = $sji;
    $prop_pinzhi = prop::get_star_str($prop_star);
    //生成装备
    echo "你打开了1{$item_liangci}{$item_name},金光炫目,获得了1{$prop_liangci}{$prop_pinzhi}{$prop_name}!";
    br();
    if (user::get_rongliang() > user::get_fuzhong()) {
        $equip_id = prop::new_prop($prop_id, 0, $sji);
        prop::user_get_prop($equip_id, 0, 1, false, true);
    } else {
        $equip_id = prop::new_prop($prop_id, 0, $sji);
        prop::user_get_prop($equip_id, 0, 2, false, true);
        echo "{$prop_name}存入了仓库。";
        br();
    }
    $ts_name = "神兵出世,{$user_name}打开{$item_name},获得了1{$prop_liangci}{$prop_pinzhi}";
    c_add_guangbo($ts_name, $equip_id, 4);
}

//玩家使用会员副本卷
function sy_hy_fb($user_id, $item_id)
{
    $user_id = uid();
    $day = date("d");
    $map_60_day = value::get_user_value('map_60_day', $user_id);
    if ($item_id == 279) {
        item::add_item($item_id, 1);
        if ($day != $map_60_day) {
            $map_60_time = date('Y-m-d H:i:s', strtotime('+60 minute'));
            value::set_user_value('map_60_time', $map_60_time);
            value::set_user_value('map_60_day', $day);
            value::set_game_user_value('in_map_id', 3052);
            item::add_item($item_id, -1);
        } else {
            echo "今天已经使用一次，不能传送进入！";
            br();
        }
    }
    $map_60_day = value::get_user_value('mapgb_60_day', $user_id);
    if ($item_id == 405) {
        item::add_item($item_id, 1);
        if ($day != $map_60_day) {
            $map_60_time = date('Y-m-d H:i:s', strtotime('+60 minute'));
            value::set_user_value('mapgb_60_time', $map_60_time);
            value::set_user_value('mapgb_60_day', $day);
            value::set_game_user_value('in_map_id', 5566);
            item::add_item($item_id, -1);
        } else {
            echo "今天已经使用一次，不能传送进入！";
            br();
        }
    }
    $map_80_day = value::get_user_value('map_80_day', $user_id);
    if ($item_id == 280) {
        item::add_item($item_id, 1);
        if ($day != $map_80_day) {
            $map_60_time = date('Y-m-d H:i:s', strtotime('+60 minute'));
            value::set_user_value('map_80_time', $map_60_time);
            value::set_user_value('map_80_day', $day);
            value::set_game_user_value('in_map_id', 4393);
            item::add_item($item_id, -1);
        } else {
            echo "今天已经使用一次，不能传送进入！";
            br();
        }
    }
}
//玩家使用商场祝福道具
function sy_exp($user_id, $item_id)
{
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    switch ($item_id) {
        case 201:
            user::get_exp($user_id, 10000);
            break;
        case 202:
            user::get_exp($user_id, 20000);
            break;
        case 203:
            user::get_exp($user_id, 30000);
            break;
        case 204:
            user::get_exp($user_id, 40000);
            break;
        case 205:
            user::get_exp($user_id, 50000);
            break;
        case 206:
            user::get_exp($user_id, 100000);
            break;
        case 207:
            user::get_exp($user_id, 200000);
            break;
        case 208:
            user::get_exp($user_id, 500000);
            break;
        case 209:
            user::get_exp($user_id, 1500000);
            break;
    }
}
//玩家使用商场祝福道具
function sy_scdj($user_id, $item_id)
{
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    switch ($item_id) {
        case 114:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('mianzhan.time', $user_id);
            if ($mianzhan_time < $now_time) {
                $now_time = date("Y-m-d H:i:s");
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
                $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
                $mz_hour = (int)($mzsysj / 3600);
                $mz_min = (int)($mzsysj % 3600 / 60);
                value::set_user_value('mianzhan.time', $new_mianzhan_time);
                echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入免战状态,持续{$mz_hour}小时{$mz_min}分钟!";
                br();
            } else {
                $shengyu_time = strtotime($mianzhan_time) - strtotime($now_time);
                $shengyu_hour = (int)($shengyu_time / 3600);
                $shengyu_minute = (int)($shengyu_time % 3600 / 60);
                echo "你的免战时间效果还剩{$shengyu_hour}小时{$shengyu_minute}分钟,无法使用{$item_name}!";
                br();
            }
            break;
        case 115:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_jy.time', $user_id);
            $wj_jy = value::get_user_value('wj_jy');
            if ($mianzhan_time < $now_time || $wj_jy != 2) { 
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_jy', 2);
            $wj_jy = value::get_user_value('wj_jy');
            value::set_user_value('wj_jy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_jy}倍经验状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 116:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_jy.time', $user_id);
            $wj_jy = value::get_user_value('wj_jy');
            if ($mianzhan_time < $now_time || $wj_jy != 3) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_jy', 3);
            $wj_jy = value::get_user_value('wj_jy');
            value::set_user_value('wj_jy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_jy}倍经验状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 117:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_jy.time', $user_id);
            $wj_jy = value::get_user_value('wj_jy');
            if ($mianzhan_time < $now_time || $wj_jy != 5) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_jy', 5);
            $wj_jy = value::get_user_value('wj_jy');
            value::set_user_value('wj_jy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_jy}倍经验状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 118:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_jy.time', $user_id);
            $wj_jy = value::get_user_value('wj_jy');
            if ($mianzhan_time < $now_time || $wj_jy != 8) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_jy', 8);
            $wj_jy = value::get_user_value('wj_jy');
            value::set_user_value('wj_jy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_jy}倍经验状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 119:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_jy.time', $user_id);
            $wj_jy = value::get_user_value('wj_jy');
            if ($mianzhan_time < $now_time || $wj_jy != 10) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_jy', 10);
            $wj_jy = value::get_user_value('wj_jy');
            value::set_user_value('wj_jy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_jy}倍经验状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 120:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_db.time', $user_id);
            $wj_db = value::get_user_value('wj_db');
            if ($mianzhan_time < $now_time || $wj_db != 2) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_db', 2);
            $wj_db = value::get_user_value('wj_db');
            value::set_user_value('wj_db.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_db}倍掉宝状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 121:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_db.time', $user_id);
            $wj_db = value::get_user_value('wj_db');
            if ($mianzhan_time < $now_time || $wj_db != 3) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_db', 3);
            $wj_db = value::get_user_value('wj_db');
            value::set_user_value('wj_db.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_db}倍掉宝状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 122:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_db.time', $user_id);
            $wj_db = value::get_user_value('wj_db');
            if ($mianzhan_time < $now_time || $wj_db != 5) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_db', 5);
            $wj_db = value::get_user_value('wj_db');
            value::set_user_value('wj_db.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_db}倍掉宝状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 123:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_db.time', $user_id);
            $wj_db = value::get_user_value('wj_db');
            if ($mianzhan_time < $now_time || $wj_db != 8) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_db', 8);
            $wj_db = value::get_user_value('wj_db');
            value::set_user_value('wj_db.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_db}倍掉宝状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 124:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_db.time', $user_id);
            $wj_db = value::get_user_value('wj_db');
            if ($mianzhan_time < $now_time || $wj_db != 10) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_db', 10);
            $wj_db = value::get_user_value('wj_db');
            value::set_user_value('wj_db.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_db}倍掉宝状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 125:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bj.time', $user_id);
            $wj_bj = value::get_user_value('wj_bj');
            if ($mianzhan_time < $now_time || $wj_bj != 2) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bj', 2);
            $wj_bj = value::get_user_value('wj_bj');
            value::set_user_value('wj_bj.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_bj}倍暴击状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 126:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bj.time', $user_id);
            $wj_bj = value::get_user_value('wj_bj');
            if ($mianzhan_time < $now_time || $wj_bj != 3) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bj', 3);
            $wj_bj = value::get_user_value('wj_bj');
            value::set_user_value('wj_bj.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_bj}倍暴击状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 127:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bj.time', $user_id);
            $wj_bj = value::get_user_value('wj_bj');
            if ($mianzhan_time < $now_time || $wj_bj != 5) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bj', 5);
            $wj_bj = value::get_user_value('wj_bj');
            value::set_user_value('wj_bj.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_bj}倍暴击状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 128:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bj.time', $user_id);
            $wj_bj = value::get_user_value('wj_bj');
            if ($mianzhan_time < $now_time || $wj_bj != 8) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bj', 8);
            $wj_bj = value::get_user_value('wj_bj');
            value::set_user_value('wj_bj.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_bj}倍暴击状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 129:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bj.time', $user_id);
            $wj_bj = value::get_user_value('wj_bj');
            if ($mianzhan_time < $now_time || $wj_bj != 10) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 60);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bj', 10);
            $wj_bj = value::get_user_value('wj_bj');
            value::set_user_value('wj_bj.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入{$wj_bj}倍暴击状态,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 130:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+7day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 1);
            $hy_name = "<span style=color:red>【ST会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:red>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 131:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+30day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 1);
            $hy_name = "<span style=color:red>【ST会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:red>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 132:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+365day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 1);
            $hy_name = "<span style=color:red>【ST会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:red>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 133:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+7day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 2);
            $hy_name = "<span style=color:green>【贵宾会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:green>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 134:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+30day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 2);
            $hy_name = "<span style=color:green>【贵宾会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:green>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 135:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+365day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 2);
            $hy_name = "<span style=color:green>【贵宾会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:green>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 136:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+7day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 3);
            $hy_name = "<span style=color:purple>【帝王会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:purple>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 272:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 3);
            $hy_name = "<span style=color:purple>【帝王会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:purple>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 284:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 2);
            $hy_name = "<span style=color:green>【贵宾会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:green>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 283:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 1);
            $hy_name = "<span style=color:red>【ST会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:green>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 137:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+30day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 3);
            $hy_name = "<span style=color:purple>【帝王会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:purple>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 138:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_hy.time', $user_id);
            $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+365day"));
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_day = (int)($mzsysj / 3600 / 24);
            $mz_hour = (int)($mzsysj % 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('hy_lvl', 3);
            $hy_name = "<span style=color:purple>【帝王会员】</span>";
            value::set_game_user_value('hy_name', $hy_name);
            $tp = value::get_game_user_value('tp', $user_id);
            $tp = "<span style=color:purple>{$tp}</span>";
            value::set_game_user_value('name', $tp);
            value::set_user_value('wj_hy.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name},念动真言,获得{$hy_name}效果,持续{$mz_day}天{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 139:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_tls.time', $user_id);
            $wj_tls = value::get_user_value('wj_tls');
            if ($mianzhan_time < $now_time || $wj_tls != 2000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_tls', 2000);
            $wj_tls = value::get_user_value('wj_tls');
            value::set_user_value('wj_tls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_tls}生命加成,持续{$mz_min}分钟!";
            br();
            break;
        case 140:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mls.time', $user_id);
            $wj_mls = value::get_user_value('wj_mls');
            if ($mianzhan_time < $now_time || $wj_mls != 2000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mls', 2000);
            $wj_mls = value::get_user_value('wj_mls');
            value::set_user_value('wj_mls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mls}魔法加成,持续{$mz_min}分钟!";
            br();
            break;
        case 141:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_tls.time', $user_id);
            $wj_tls = value::get_user_value('wj_tls');
            if ($mianzhan_time < $now_time || $wj_tls != 4000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_tls', 4000);
            $wj_tls = value::get_user_value('wj_tls');
            value::set_user_value('wj_tls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_tls}生命加成,持续{$mz_min}分钟!";
            br();
            break;
        case 142:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_tls.time', $user_id);
            $wj_tls = value::get_user_value('wj_tls');
            if ($mianzhan_time < $now_time || $wj_tls != 6000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_tls', 6000);
            $wj_tls = value::get_user_value('wj_tls');
            value::set_user_value('wj_tls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_tls}生命加成,持续{$mz_min}分钟!";
            br();
            break;
        case 143:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_tls.time', $user_id);
            $wj_tls = value::get_user_value('wj_tls');
            if ($mianzhan_time < $now_time || $wj_tls != 8000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_tls', 8000);
            $wj_tls = value::get_user_value('wj_tls');
            value::set_user_value('wj_tls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_tls}生命加成,持续{$mz_min}分钟!";
            br();
            break;
        case 144:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_tls.time', $user_id);
            $wj_tls = value::get_user_value('wj_tls');
            if ($mianzhan_time < $now_time || $wj_tls != 10000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_tls', 10000);
            $wj_tls = value::get_user_value('wj_tls');
            value::set_user_value('wj_tls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_tls}生命加成,持续{$mz_min}分钟!";
            br();
            break;
        case 145:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mls.time', $user_id);
            $wj_mls = value::get_user_value('wj_mls');
            if ($mianzhan_time < $now_time || $wj_mls != 4000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mls', 4000);
            $wj_mls = value::get_user_value('wj_mls');
            value::set_user_value('wj_mls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mls}魔法加成,持续{$mz_min}分钟!";
            br();
            break;
        case 146:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mls.time', $user_id);
            $wj_mls = value::get_user_value('wj_mls');
            if ($mianzhan_time < $now_time || $wj_mls != 6000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mls', 6000);
            $wj_mls = value::get_user_value('wj_mls');
            value::set_user_value('wj_mls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mls}魔法加成,持续{$mz_min}分钟!";
            br();
            break;
        case 147:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mls.time', $user_id);
            $wj_mls = value::get_user_value('wj_mls');
            if ($mianzhan_time < $now_time || $wj_mls != 8000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mls', 8000);
            $wj_mls = value::get_user_value('wj_mls');
            value::set_user_value('wj_mls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mls}魔法加成,持续{$mz_min}分钟!";
            br();
            break;
        case 148:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mls.time', $user_id);
            $wj_mls = value::get_user_value('wj_mls');
            if ($mianzhan_time < $now_time || $wj_mls != 10000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mls', 10000);
            $wj_mls = value::get_user_value('wj_mls');
            value::set_user_value('wj_mls.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mls}魔法加成,持续{$mz_min}分钟!";
            br();
            break;
        case 149:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_gjs.time', $user_id);
            $wj_gjs = value::get_user_value('wj_gjs');
            if ($mianzhan_time < $now_time || $wj_gjs != 1000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_gjs', 1000);
            $wj_gjs = value::get_user_value('wj_gjs');
            value::set_user_value('wj_gjs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_gjs}攻击加成,持续{$mz_min}分钟!";
            br();
            break;
        case 150:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_gjs.time', $user_id);
            $wj_gjs = value::get_user_value('wj_gjs');
            if ($mianzhan_time < $now_time || $wj_gjs != 2000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_gjs', 2000);
            $wj_gjs = value::get_user_value('wj_gjs');
            value::set_user_value('wj_gjs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_gjs}攻击加成,持续{$mz_min}分钟!";
            br();
            break;
        case 151:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_gjs.time', $user_id);
            $wj_gjs = value::get_user_value('wj_gjs');
            if ($mianzhan_time < $now_time || $wj_gjs != 3000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_gjs', 3000);
            $wj_gjs = value::get_user_value('wj_gjs');
            value::set_user_value('wj_gjs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_gjs}攻击加成,持续{$mz_min}分钟!";
            br();
            break;
        case 152:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_gjs.time', $user_id);
            $wj_gjs = value::get_user_value('wj_gjs');
            if ($mianzhan_time < $now_time || $wj_gjs != 4000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_gjs', 4000);
            $wj_gjs = value::get_user_value('wj_gjs');
            value::set_user_value('wj_gjs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_gjs}攻击加成,持续{$mz_min}分钟!";
            br();
            break;
        case 153:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_gjs.time', $user_id);
            $wj_gjs = value::get_user_value('wj_gjs');
            if ($mianzhan_time < $now_time || $wj_gjs != 5000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_gjs', 5000);
            $wj_gjs = value::get_user_value('wj_gjs');
            value::set_user_value('wj_gjs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_gjs}攻击加成,持续{$mz_min}分钟!";
            br();
            break;
        case 154:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_fys.time', $user_id);
            $wj_fys = value::get_user_value('wj_fys');
            if ($mianzhan_time < $now_time || $wj_fys != 1000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_fys', 1000);
            $wj_fys = value::get_user_value('wj_fys');
            value::set_user_value('wj_fys.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_fys}防御加成,持续{$mz_min}分钟!";
            br();
            break;
        case 155:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_fys.time', $user_id);
            $wj_fys = value::get_user_value('wj_fys');
            if ($mianzhan_time < $now_time || $wj_fys != 2000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_fys', 2000);
            $wj_fys = value::get_user_value('wj_fys');
            value::set_user_value('wj_fys.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_fys}防御加成,持续{$mz_min}分钟!";
            br();
            break;
        case 156:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_fys.time', $user_id);
            $wj_fys = value::get_user_value('wj_fys');
            if ($mianzhan_time < $now_time || $wj_fys != 3000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_fys', 3000);
            $wj_fys = value::get_user_value('wj_fys');
            value::set_user_value('wj_fys.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_fys}防御加成,持续{$mz_min}分钟!";
            br();
            break;
        case 157:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_fys.time', $user_id);
            $wj_fys = value::get_user_value('wj_fys');
            if ($mianzhan_time < $now_time || $wj_fys != 4000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_fys', 4000);
            $wj_fys = value::get_user_value('wj_fys');
            value::set_user_value('wj_fys.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_fys}防御加成,持续{$mz_min}分钟!";
            br();
            break;
        case 158:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_fys.time', $user_id);
            $wj_fys = value::get_user_value('wj_fys');
            if ($mianzhan_time < $now_time || $wj_fys != 5000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_fys', 5000);
            $wj_fys = value::get_user_value('wj_fys');
            value::set_user_value('wj_fys.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_fys}防御加成,持续{$mz_min}分钟!";
            br();
            break;
        case 159:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mgs.time', $user_id);
            $wj_mgs = value::get_user_value('wj_mgs');
            if ($mianzhan_time < $now_time || $wj_mgs != 1000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mgs', 1000);
            $wj_mgs = value::get_user_value('wj_mgs');
            value::set_user_value('wj_mgs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mgs}魔攻加成,持续{$mz_min}分钟!";
            br();
            break;
        case 160:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mgs.time', $user_id);
            $wj_mgs = value::get_user_value('wj_mgs');
            if ($mianzhan_time < $now_time || $wj_mgs != 2000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mgs', 2000);
            $wj_mgs = value::get_user_value('wj_mgs');
            value::set_user_value('wj_mgs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mgs}魔攻加成,持续{$mz_min}分钟!";
            br();
            break;
        case 161:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mgs.time', $user_id);
            $wj_mgs = value::get_user_value('wj_mgs');
            if ($mianzhan_time < $now_time || $wj_mgs != 3000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mgs', 3000);
            $wj_mgs = value::get_user_value('wj_mgs');
            value::set_user_value('wj_mgs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mgs}魔攻加成,持续{$mz_min}分钟!";
            br();
            break;
        case 162:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mgs.time', $user_id);
            $wj_mgs = value::get_user_value('wj_mgs');
            if ($mianzhan_time < $now_time || $wj_mgs != 4000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mgs', 4000);
            $wj_mgs = value::get_user_value('wj_mgs');
            value::set_user_value('wj_mgs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mgs}魔攻加成,持续{$mz_min}分钟!";
            br();
            break;
        case 163:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mgs.time', $user_id);
            $wj_mgs = value::get_user_value('wj_mgs');
            if ($mianzhan_time < $now_time || $wj_mgs != 5000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mgs', 5000);
            $wj_mgs = value::get_user_value('wj_mgs');
            value::set_user_value('wj_mgs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mgs}魔攻加成,持续{$mz_min}分钟!";
            br();
            break;
        case 164:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mfs.time', $user_id);
            $wj_mfs = value::get_user_value('wj_mfs');
            if ($mianzhan_time < $now_time || $wj_mfs != 1000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mfs', 1000);
            $wj_mfs = value::get_user_value('wj_mfs');
            value::set_user_value('wj_mfs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mfs}魔防加成,持续{$mz_min}分钟!";
            br();
            break;
        case 165:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mfs.time', $user_id);
            $wj_mfs = value::get_user_value('wj_mfs');
            if ($mianzhan_time < $now_time || $wj_mfs != 2000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mfs', 2000);
            $wj_mfs = value::get_user_value('wj_mfs');
            value::set_user_value('wj_mfs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mfs}魔防加成,持续{$mz_min}分钟!";
            br();
            break;
        case 166:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mfs.time', $user_id);
            $wj_mfs = value::get_user_value('wj_mfs');
            if ($mianzhan_time < $now_time || $wj_mfs != 3000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mfs', 3000);
            $wj_mfs = value::get_user_value('wj_mfs');
            value::set_user_value('wj_mfs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mfs}魔防加成,持续{$mz_min}分钟!";
            br();
            break;
        case 167:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mfs.time', $user_id);
            $wj_mfs = value::get_user_value('wj_mfs');
            if ($mianzhan_time < $now_time || $wj_mfs != 4000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mfs', 4000);
            $wj_mfs = value::get_user_value('wj_mfs');
            value::set_user_value('wj_mfs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mfs}魔防加成,持续{$mz_min}分钟!";
            br();
            break;
        case 168:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_mfs.time', $user_id);
            $wj_mfs = value::get_user_value('wj_mfs');
            if ($mianzhan_time < $now_time || $wj_mfs != 5000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_mfs', 5000);
            $wj_mfs = value::get_user_value('wj_mfs');
            value::set_user_value('wj_mfs.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得{$wj_mfs}魔防加成,持续{$mz_min}分钟!";
            br();
            break;
        case 170:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bt.time', $user_id);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            if ($mianzhan_time < $now_time || $wj_bt_hp != 1000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+24hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 3600 + 24);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "hour"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bt_hp', 1000);
            value::set_user_value('wj_bt_mp', 500);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            $wj_bt_mp = value::get_user_value('wj_bt_mp');
            value::set_user_value('wj_bt.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得战斗自动回血{$wj_bt_hp}回蓝{$wj_bt_mp}加成,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 171:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bt.time', $user_id);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            if ($mianzhan_time < $now_time || $wj_bt_hp != 2000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+24hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 3600 + 24);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "hour"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bt_hp', 2000);
            value::set_user_value('wj_bt_mp', 1000);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            $wj_bt_mp = value::get_user_value('wj_bt_mp');
            value::set_user_value('wj_bt.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得战斗自动回血{$wj_bt_hp}回蓝{$wj_bt_mp}加成,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 172:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bt.time', $user_id);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            if ($mianzhan_time < $now_time || $wj_bt_hp != 3000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+24hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 3600 + 24);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "hour"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bt_hp', 3000);
            value::set_user_value('wj_bt_mp', 1500);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            $wj_bt_mp = value::get_user_value('wj_bt_mp');
            value::set_user_value('wj_bt.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得战斗自动回血{$wj_bt_hp}回蓝{$wj_bt_mp}加成,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 173:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bt.time', $user_id);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            if ($mianzhan_time < $now_time || $wj_bt_hp != 4000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+24hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 3600 + 24);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "hour"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bt_hp', 4000);
            value::set_user_value('wj_bt_mp', 2000);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            $wj_bt_mp = value::get_user_value('wj_bt_mp');
            value::set_user_value('wj_bt.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得战斗自动回血{$wj_bt_hp}回蓝{$wj_bt_mp}加成,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 174:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bt.time', $user_id);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            if ($mianzhan_time < $now_time || $wj_bt_hp != 5000) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+24hour"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 3600 + 24);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "hour"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_hour = (int)($mzsysj / 3600);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bt_hp', 5000);
            value::set_user_value('wj_bt_mp', 2500);
            $wj_bt_hp = value::get_user_value('wj_bt_hp');
            $wj_bt_mp = value::get_user_value('wj_bt_mp');
            value::set_user_value('wj_bt.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得战斗自动回血{$wj_bt_hp}回蓝{$wj_bt_mp}加成,持续{$mz_hour}小时{$mz_min}分钟!";
            br();
            break;
        case 198:
            $now_time = date("Y-m-d H:i:s");
            $mianzhan_time = value::get_user_value('wj_bg.time', $user_id);
            $wj_bg = value::get_user_value('wj_bg');
            if ($mianzhan_time < $now_time || $wj_bg < 1) {
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+10minute"));
            } else {
                $mzsysj = strtotime($mianzhan_time) - strtotime($now_time);
                $mz_min = (int)($mzsysj / 60 + 10);
                $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+" . $mz_min . "minute"));
            }
            $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
            $mz_min = (int)($mzsysj % 3600 / 60);
            value::set_user_value('wj_bg', 1);
            $wj_bg = value::get_user_value('wj_bg');
            value::set_user_value('wj_bg.time', $new_mianzhan_time);
            echo "你拿出了1{$item_liangci}{$item_name}, 念动真言,获得躲避怪物效果,持续{$mz_min}分钟!";
            br();
            break;
    }
}

function sy_yjqdx1()
{   $zbpj1 = "";
    $zbpj = value::real_escape_string($_POST['zbpj']);
    $js_id = value::real_escape_string($_POST['js_id']);
    value::set_user_value('zbpj_ys', $zbpj);
    value::set_user_value('zbpj_lvl', $js_id);
    if ($zbpj == "捡普通装备") {
        value::set_user_value('zbpj_ys', 1);
    }
    if ($zbpj == "捡颜色装备") {
        value::set_user_value('zbpj_ys', 2);
    }
    if ($zbpj == "捡全部装备") {
        value::set_user_value('zbpj_ys', 3);
    }
    echo "你设置一键捡{$js_id}级{$zbpj}成功!";
    br();
    cmd::addcmd('e0', '返回游戏');
    cmd::set_show_return_game(false);
}
function sy_yjqdx($user_id, $item_id)
{
    $user_id = uid();
    $user_name = value::get_game_user_value('name');
    $item_name = value::get_item_value($item_id, 'name');
    $item_liangci = value::get_item_value($item_id, 'liangci');
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('sy_yjqdx_time', $user_id);
    $now_time = date("Y-m-d H:i:s");
    $new_mianzhan_time = date("Y-m-d H:i:s", strtotime("+1hour"));
    $mzsysj = strtotime($new_mianzhan_time) - strtotime($now_time);
    $mz_hour = (int)($mzsysj / 3600);
    $mz_min = (int)($mzsysj % 3600 / 60);
    value::set_user_value('sy_yjqdx_time', $new_mianzhan_time);
    echo "你拿出了1{$item_liangci}{$item_name},念动真言,进入一键捡装备状态,持续{$mz_hour}小时{$mz_min}分钟!";
    br();
    $cmd = cmd::addcmd('sy_yjqdx1', '');
echo <<<setname
<br><span>请设置一键捡装备属性：</span>
<form action="game.php?cmd={$cmd}" method="post">
<span>装备颜色:</span>
<input name="zbpj" type="radio" value="捡普通装备" checked>捡普通装备
<input name="zbpj" type="radio" value="捡颜色装备">捡颜色装备
<input name="zbpj" type="radio" value="捡全部装备">捡全部装备
<br>
<span>捡装备最低等级要求：</span>
<input type="text" name="js_id" maxlength="2" value="10"><br>
备注:设置10就是捡10或者以上等级的装备 <br>
<input name='submit' type='submit' title='设置' value='设置' style='margin-top: 5px;width:80px;height: 25px;'/>
</form>
setname;
    cmd::set_show_return_game(false);
}
//玩家使用护符毒药
function sy_hfdy($user_id, $item_id)
{
    switch ($item_id) {
        case 65:
            prop::user_get_prop(prop::new_prop(52, 0, 0), 0, 1, true, true);
            break;
        case 66:
            prop::user_get_prop(prop::new_prop(53, 0, 0), 0, 1, true, true);
            break;
        case 67:
            prop::user_get_prop(prop::new_prop(54, 0, 0), 0, 1, true, true);
            break;
        case 61:
            prop::user_get_prop(prop::new_prop(55, 0, 0), 0, 1, true, true);
            break;
        case 62:
            prop::user_get_prop(prop::new_prop(56, 0, 0), 0, 1, true, true);
            break;
        case 63:
            prop::user_get_prop(prop::new_prop(57, 0, 0), 0, 1, true, true);
            break;
        case 64:
            prop::user_get_prop(prop::new_prop(58, 0, 0), 0, 1, true, true);
            break;
    }
}

//玩家技能 遗忘技能
function e10006($sid, $userId = 0)
{
    if (!$userId) {
        $userId = uid();
    }
    $userName = user::get_game_user("name", $userId);
    if (user_skill::forget_skill($sid, $userId)) {
        echo $userName . "遗忘了" . value::getvalue("skill", "name", "id", $sid) . "。";
    } else {
        echo $userName . "暂时无法遗忘" . value::getvalue("skill", "name", "id", $sid) . "。";
    }
    br();
}

//玩家快捷 触发快捷
function e10007()
{

}

//玩家快捷 设置快捷
function e10008($step = 0, $item_id = 0, $skill_id = 0)
{
    $user_id = uid();
    $user_hp = value::get_game_user_value('hp', $user_id);
    if ($user_hp > 0) {
        if (!$step) {
            echo '请选择需要的物品:';
            br();
            $item_count = 0;
            $sql = "SELECT `valuename`,`value` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%'";
            $result = sql($sql);
            while (list($id, $count) = $result->fetch_row()) {
                if ($count) {
                    $id = explode('.', $id);
                    $item_id = $id[2];
                    if (value::getvalue('item', 'is_pk_use', 'id', $item_id) && value::getvalue('item', 'is_user_use', 'id', $item_id)) {
                        $name = value::getvalue('item', 'name', 'id', $item_id);
                        $liangci = value::getvalue('item', 'liangci', 'id', $item_id);
                        cmd::addcmd('e10008,1,' . $item_id, $name . "x" . $count . $liangci);
                        br();
                    }
                    $item_count++;
                }
            }
            if (!$item_count) {
                echo '没有可以使用的物品了!';
                br();
            }
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        } else if ($step == 1) {
            //补血药品 招降符咒 状态恢复药品
            if (($item_id > 1 && $item_id < 13) || $item_id == 52 || $item_id == 80 || $item_id == 212 || ($item_id > 229 && $item_id < 241)) {
                if (item::lose_item($item_id, 1, false, $user_id)) {
                    $name = value::get_game_user_value('name', $user_id);
                    $new_hp = 0;
                    $new_mp = 0;
                    $mp = value::get_game_user_value('mp', $user_id);
                    $max_mp = value::get_game_user_value('max_mp', $user_id);
                    $hp = value::get_game_user_value('hp', $user_id);
                    $max_hp = value::get_game_user_value('max_hp', $user_id);
                    switch ($item_id) {
                        case 2:
                            $new_hp = 30;
                            value::add_game_user_value('hp', 30);
                            break;
                        case 3:
                            $new_hp = 70;
                            value::add_game_user_value('hp', 70);
                            break;
                        case 4:
                            $new_hp = 110;
                            value::add_game_user_value('hp', 110);
                            break;
                        case 5:
                            $new_hp = 170;
                            value::add_game_user_value('hp', 170);
                            break;
                        case 6:
                            $new_hp = 200;
                            value::add_game_user_value('hp', 200);
                            break;
                        case 7:
                            $new_mp = 40;
                            value::add_game_user_value('mp', 40);
                            break;
                        case 8:
                            $new_mp = 100;
                            value::add_game_user_value('mp', 100);
                            break;
                        case 9:
                            $new_mp = 180;
                            value::add_game_user_value('mp', 180);
                            break;
                        case 10:
                            $new_mp = 250;
                            value::add_game_user_value('mp', 250);
                            break;
                        case 11:
                            $new_mp = 300;
                            value::add_game_user_value('mp', 300);
                            break;
                        case 12:
                            $new_mp = 5;
                            $new_mp = 5;
                            value::add_game_user_value('hp', 5);
                            value::add_game_user_value('mp', 5);
                            break;
                        case 52:
                            $new_mp = 110;
                            $new_hp = 70;
                            value::add_game_user_value('mp', 110);
                            value::add_game_user_value('hp', 70);
                            break;
                        case 80:
                            $new_mp = 110;
                            $new_mp = 180;
                            value::add_game_user_value('hp', 110);
                            value::add_game_user_value('mp', 180);
                            break;
                        case 212:
                            $new_mp = 170;
                            $new_mp = 250;
                            value::add_game_user_value('hp', 5000);
                            value::add_game_user_value('mp', 10000);
                            break;
                        case 230:
                            item::add_item(2, 9);
                            break;
                        case 231:
                            item::add_item(3, 9);
                            break;
                        case 232:
                            item::add_item(4, 9);
                            break;
                        case 233:
                            item::add_item(5, 9);
                            break;
                        case 234:
                            item::add_item(6, 9);
                            break;
                        case 235:
                            item::add_item(7, 9);
                            break;
                        case 236:
                            item::add_item(8, 9);
                            break;
                        case 237:
                            item::add_item(9, 9);
                            break;
                        case 238:
                            item::add_item(10, 9);
                            break;
                        case 239:
                            item::add_item(11, 9);
                            break;
                        case 240:
                            item::add_item(212, 9);
                            break;
                        default:
                            break;
                    }
                    if ($hp >= $max_hp) {
                        value::set_game_user_value('hp', $max_hp, $user_id);
                    }
                    if ($mp >= $max_mp) {
                        value::set_game_user_value('mp', $max_mp, $user_id);
                    }
                    $max_hp1 = $max_hp - $hp;
                    if ($max_hp1 > $new_hp) {
                        $new_hp1 = $new_hp;
                    } else {
                        $new_hp1 = $max_hp1;
                    }
                    $max_mp1 = $max_mp - $mp;
                    if ($max_mp1 > $new_mp) {
                        $new_mp1 = $new_mp;
                    } else {
                        $new_mp1 = $max_mp1;
                    }
                    if ($new_hp > 0) {
                        $skillChat1 = $name . "使用" . value::get_item_value($item_id, 'name') . "回复了{$new_hp1}点生命值！";
                    } else {
                        $skillChat1 = $name . "使用" . value::get_item_value($item_id, 'name') . "恢复了{$new_mp1}点魔法值！";
                    }
                    skill::add_skill_chat($skillChat1, $user_id, 0);
                    //清除交换宠物 逃跑操作
                    value::set_user_value('pk.next_pet.id', 0, $user_id);
                    value::set_user_value('pk.next_taopao', 0, $user_id);
                    value::set_user_value('pk.next_item.id6', $item_id, $user_id);
                    //设置下回合使用药品
                    e82();
                    return;
                }
                //清除交换宠物 逃跑操作
                value::set_user_value('pk.next_pet.id', 0, $user_id);
                value::set_user_value('pk.next_taopao', 0, $user_id);
                value::set_user_value('pk.next_item.id6', $item_id, $user_id);
                //设置下回合使用药品
                e82();
                return;
            }
        }
    } else {
        echo '玩家死亡无法使用物品！';
        br();
        cmd::addcmd('e82', '返回上级');
        cmd::set_show_return_game(false);
    }
}

//战斗 玩家使用技能
function e10009($skillId)
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    //是否拥有此技能
    if (user_skill::have_skill($skillId, $user_id)) {
        $can_change_skill = true;
        //更换技能
        if ($can_change_skill) {
            $u->set('next.skill.id', $skillId);
        }
    }
    e82();
}

//战斗 玩家更换技能
function e10010()
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    echo '请选择要使用的技能:';
    br();
    $moren_skill_id = $u->get('skill_moren.id');
    $i = 0;
    $uSkillArr = $u->jget('skill.arr');
    foreach ($uSkillArr as $skill_id) {
        echo "[" . value::getvalue('skill', 'shuxing', 'id', $skill_id) . "]";
        if ($moren_skill_id == $skill_id) {
            echo "★";
        }
        cmd::addcmd('e10009,' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
        echo skill::get_skill_leixing($skill_id);
        br();
        $i++;
    }
    cmd::add_last_cmd('e0');
    cmd::set_show_return_game(false);
}

//战斗 玩家使用技能快捷键
function e10013($step, $skillId)
{
    if ($step == 1) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        //是否拥有此技能
        if (user_skill::have_skill($skillId, $user_id)) {
            $can_change_skill = true;
            //更换技能
            if ($can_change_skill) {
                $u->set('next.skill.id', $skillId);
                $u->set('next.skill.id1', $skillId);
            }
        }
        e82();
    } else if ($step == 2) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        //是否拥有此技能
        if (user_skill::have_skill($skillId, $user_id)) {
            $can_change_skill = true;
            //更换技能
            if ($can_change_skill) {
                $u->set('next.skill.id', $skillId);
                $u->set('next.skill.id2', $skillId);
            }
        }
        e82();
    } else if ($step == 3) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        //是否拥有此技能
        if (user_skill::have_skill($skillId, $user_id)) {
            $can_change_skill = true;
            //更换技能
            if ($can_change_skill) {
                $u->set('next.skill.id', $skillId);
                $u->set('next.skill.id3', $skillId);
            }
        }
        e82();
    }
}

//战斗 玩家使用技能快捷键
function jn_e10013($step, $skillId)
{
    if ($step == 1) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        //是否拥有此技能
        if (user_skill::have_skill($skillId, $user_id)) {
            $can_change_skill = true;
            //更换技能
            if ($can_change_skill) {
                $u->set('next.skill.id1', $skillId);
            }
        }
        jn_e96();
    } else if ($step == 2) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        //是否拥有此技能
        if (user_skill::have_skill($skillId, $user_id)) {
            $can_change_skill = true;
            //更换技能
            if ($can_change_skill) {
                $u->set('next.skill.id2', $skillId);
            }
        }
        jn_e96();
    } else if ($step == 3) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        //是否拥有此技能
        if (user_skill::have_skill($skillId, $user_id)) {
            $can_change_skill = true;
            //更换技能
            if ($can_change_skill) {
                $u->set('next.skill.id3', $skillId);
            }
        }
        jn_e96();
    }
}
//战斗 玩家使用技能快捷键
function e10015()
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    //是否拥有此技能
    if (user_skill::have_skill($skillId, $user_id)) {
        $can_change_skill = true;
        //更换技能
        if ($can_change_skill) {
            $u->set('next.skill.id', $skillId);
        }
    }
    e82();
}

//战斗 玩家更换技能
function e10014($step)
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    echo '请选择要使用的技能:';
    br();
    $moren_skill_id = $u->get('skill_moren.id');
    $i = 0;
    $uSkillArr = $u->jget('skill.arr');
    foreach ($uSkillArr as $skill_id) {
        echo "[" . value::getvalue('skill', 'shuxing', 'id', $skill_id) . "]";
        if ($moren_skill_id == $skill_id) {
            echo "★";
        }
        cmd::addcmd('e10013,' . $step . ',' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
        echo skill::get_skill_leixing($skill_id);
        br();
        $i++;
    }
    cmd::add_last_cmd('e0');
    cmd::set_show_return_game(false);
}

//战斗 玩家更换技能
function jn_e10014($step)
{
    $user_id = uid();
    $u = new game_user_object($user_id);
    echo '请选择要使用的技能:';
    br();
    $moren_skill_id = $u->get('skill_moren.id');
    $i = 0;
    $uSkillArr = $u->jget('skill.arr');
    foreach ($uSkillArr as $skill_id) {
        echo "[" . value::getvalue('skill', 'shuxing', 'id', $skill_id) . "]";
        if ($moren_skill_id == $skill_id) {
            echo "★";
        }
        cmd::addcmd('jn_e10013,' . $step . ',' . $skill_id, value::getvalue('skill', 'name', 'id', $skill_id));
        echo skill::get_skill_leixing($skill_id);
        br();
        $i++;
    }
    cmd::add_last_cmd('e82');
    cmd::set_show_return_game(false);
}

//战斗 玩家更换技能
function e10016($step)
{
    if ($step == 1) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        $u->set('next.skill.id1', 0);
        jn_e96();
    } else if ($step == 2) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        $u->set('next.skill.id2', 0);
        jn_e96();
    } else if ($step == 3) {
        $user_id = uid();
        $u = new game_user_object($user_id);
        $u->set('next.skill.id3', 0);
        jn_e96();
    }
}

//选项 设置快捷物品
function e10011($kj_num = 0, $item_id = 0, $step = 0, $mode = 0)
{
    $user_id = uid();
    if (!$step) {
        echo '请设置快捷物品:';
        br();
        $sql = "SELECT `valuename` FROM `game_user_value` WHERE `valuename` LIKE '{$user_id}.i.%' AND `value`!=0";
        $result = sql($sql);
        $item_count = 0;
        while (list($id) = $result->fetch_row()) {
            $id = explode('.', $id);
            if (value::get_item_value($id[2], 'is_pk_use') && value::get_item_value($id[2], 'is_user_use')) {
                $name = value::getvalue('item', 'name', 'id', $id[2]);
                cmd::addcmd("e10011,{$kj_num},{$id[2]},1," . $mode, $name);
                br();
                $item_count++;
            }
        }
        if (!$item_count) {
            echo "你身上什么东西都没有。";
            br();
        }
        if (!$mode) {
            cmd::addcmd('e0', '返回上级');
            cmd::set_show_return_game(false);
        } else {
            cmd::addcmd('e96', '返回上级');
        }
    } else {
        value::set_user_value("kjwp.{$kj_num}.id", $item_id);
        if (!$mode) {
            e0();
        } else {
            e96();
        }
    }
}
//获得职业技能书
function xs_mj($user_id, $item_id)
{
    if (value::get_game_user_value('zhiye') == '战士') {
        item::add_item(21, 1);
    }
    if (value::get_game_user_value('zhiye') == '法师') {
        item::add_item(19, 1);
    }
    if (value::get_game_user_value('zhiye') == '道士') {
        item::add_item(20, 1);
    }
}

//获得物品
function sc_hdzb($user_id, $item_id)
{
    if ($item_id == 241) {
        prop::user_get_prop(prop::new_prop(170, 0, 0), 0, 1, false, true);
    }
    if ($item_id == 242) {
        prop::user_get_prop(prop::new_prop(172, 0, 0), 0, 1, false, true);
    }
    if ($item_id == 243) {
        prop::user_get_prop(prop::new_prop(174, 0, 0), 0, 1, false, true);
    }
    if ($item_id == 229) {
        item::add_item(171, 1);
        user::get_exp($user_id, 100000);
        item::add_money(1000, $user_id);
    }
}

//在线玩家地图场景获得属性
function map_wj_zx()
{
    $user_id = uid();
    $rc_h = date("H");
    if ($rc_h < 23) {
        $sc_money = value::get_user_value("sc_money", $user_id);
        value::set_user_value('1.sc_money', $sc_money, $user_id);
    }
    //规定小时双倍经验
    $sb_time_h = date("H");
    if ($sb_time_h == 12 || $sb_time_h == 22) {
        value::set_user_value('sbjy_exp', 1, $user_id);
    } else {
        value::set_user_value('sbjy_exp', 0, $user_id);
    }
    //在线玩家每小时获得元宝卷
    $xs_yb_sz = value::get_system_value('xs_yb_sz');
    if ($xs_yb_sz > 0) {
        $sql = "SELECT COUNT(*) FROM `game_user` WHERE `id`>0 AND `name`!='' AND `is_online` =1";
        $result = sql($sql);
        list($u_count1) = $result->fetch_row();
        if ($u_count1 > 0) {
            $sj = mt_rand(0, $u_count1);
            $i = 1;
            $sql = "SELECT `id`,`name` FROM `game_user` WHERE `id`>0 AND `name`!='' AND `is_online` =1 LIMIT 0, 5";
            if ($sql) {
                $result = sql($sql);
                while (list($u_id, $u_name) = $result->fetch_row()) {
                    $i++;
                    value::set_system_value('xs_yb_sz_id' . $i, $u_id);
                    value::set_system_value('xs_xy_yb_sz_id' . $i, $u_id);
                    $xs_yb_name .= $u_name . "，";
                }
            }
            value::set_system_value('xs_yb_sz', 0);
            c_add_guangbo("恭喜{$xs_yb_name}被系统抽中成为幸运玩家获得100<span style=color:purple>元宝</span>,100W经验，1W金币!");
        }
    }
    //在线玩家获得元宝卷
    $xs_yb_sz_id1 = value::get_system_value('xs_yb_sz_id1');
    $xs_yb_sz_id2 = value::get_system_value('xs_yb_sz_id2');
    $xs_yb_sz_id3 = value::get_system_value('xs_yb_sz_id3');
    $xs_yb_sz_id4 = value::get_system_value('xs_yb_sz_id4');
    $xs_yb_sz_id5 = value::get_system_value('xs_yb_sz_id5');
    if ($xs_yb_sz_id1 == $user_id || $xs_yb_sz_id2 == $user_id || $xs_yb_sz_id3 == $user_id || $xs_yb_sz_id4 == $user_id || $xs_yb_sz_id5 == $user_id) {
        for ($i = 1; $i <= 5; $i++) {
            if (value::get_system_value('xs_yb_sz_id' . $i) == $user_id) {
                value::set_system_value('xs_yb_sz_id' . $i, 0);
                value::set_user_value("xy_e60", 1, $user_id);
                return;
            }
        }
    }
    //更新vip属性
    $map_xs_vip_lvl = value::get_user_value('map_xs_vip_lvl', $user_id);
    $vip_lvl = value::get_user_value('vip_lvl', $user_id);
    if ($vip_lvl > $map_xs_vip_lvl) {
        c_add_guangbo("玩家" . user::get_game_user("name") . "成为了尊贵的" . user::showVipLogo(0, false, $vip_lvl) . "!");
        $xt_xx = "<span style=color:blue>恭喜你成为" . user::showVipLogo(0, false, $vip_lvl) . "，可以领取" . user::showVipLogo(0, false, $vip_lvl) . "礼包啦！</span>";
        c_add_xiaoxi($xt_xx, 0, $user_id, $user_id);
        value::set_user_value('map_xs_vip_lvl', $vip_lvl);
    }
    //更新会员属性
    $map_xs_hy_lvl = value::get_user_value('map_xs_hy_lvl', $user_id);
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    $hy_name = value::get_game_user_value('hy_name', $user_id);
    if ($hy_lvl > $map_xs_hy_lvl) {
        c_add_guangbo("玩家" . user::get_game_user("name") . "成为了尊贵的" . $hy_name . "!");
        $xt_xx = "<span style=color:blue>恭喜你成为" . $hy_name . "，可以领取" . $hy_name . "礼包啦！</span>";
        c_add_xiaoxi($xt_xx, 0, $user_id, $user_id);
        value::set_user_value('map_xs_hy_lvl', $hy_lvl);
    }
    //在线礼包每天更新属性
    $lb_qd_xt_day = value::get_system_value('lb_qd_xt_day');
    $lb_qd_xt_time = value::get_user_value('lb_qd_xt_time', $user_id);
    if ($lb_qd_xt_day != $lb_qd_xt_time) {
        value::set_user_value('lb_qd_xt_time', $lb_qd_xt_day, $user_id);
        value::set_user_value('lb_qd_sz1', 0, $user_id);
        value::set_user_value('lb_qd_sz2', 0, $user_id);
        value::set_user_value('lb_qd_sz3', 0, $user_id);
        value::set_user_value('lb_qd_sz4', 0, $user_id);
        value::set_user_value('lb_qd_sz5', 0, $user_id);
        value::set_user_value('lb_qd_sz6', 0, $user_id);
        value::set_user_value('lb_qd_sz0', 0, $user_id);
    }
    $lb_time = date("i");
    $lb_fz_i = value::get_user_value('lb_fz_i', $user_id);
    $lb_zx_fz_time = value::get_user_value('lb_zx_fz_time', $user_id);
    if ($lb_time != $lb_fz_i) {
        if ($lb_zx_fz_time == 5 || $lb_zx_fz_time == 10 || $lb_zx_fz_time == 30 || $lb_zx_fz_time == 60 || $lb_zx_fz_time == 90 || $lb_zx_fz_time == 120) {
            $xt_xx = "<span style=color:blue>亲爱的玩家，可以领取在线{$lb_zx_fz_time}分钟礼包！</span>";
            c_add_xiaoxi($xt_xx, 0, $user_id, $user_id);
        }
        value::set_user_value('lb_fz_i', $lb_time, $user_id);
    }
    $lb_zx_fz_xt_day = value::get_system_value('lb_zx_fz_xt_day');
    $lb_zx_fz_day = value::get_user_value('lb_zx_fz_day', $user_id);
    if ($lb_zx_fz_xt_day != $lb_zx_fz_day) {
        //每天清空首冲金额
        value::set_user_value('lb_zx_fz_day', $lb_zx_fz_xt_day, $user_id);
        value::set_user_value('lb_zx_fz_time', 0, $user_id);
        value::set_user_value('lb_zx_fz_sz5', 0, $user_id);
        value::set_user_value('lb_zx_fz_sz10', 0, $user_id);
        value::set_user_value('lb_zx_fz_sz30', 0, $user_id);
        value::set_user_value('lb_zx_fz_sz60', 0, $user_id);
        value::set_user_value('lb_zx_fz_sz90', 0, $user_id);
        value::set_user_value('lb_zx_fz_sz120', 0, $user_id);
    }
    $vip_lvl = user::getVipLvl($user_id);
    value::set_user_value('vip_lvl', $vip_lvl, $user_id);
    $mb_jc = equip::get_user_equip_jc('mb', $user_id);
    $km_jc = equip::get_user_equip_jc('km', $user_id);
    $minjie_jc = equip::get_user_equip_jc('minjie', $user_id);
    $mz_jc = equip::get_user_equip_jc('mz', $user_id);
    $xx_jc = equip::get_user_equip_jc('xx', $user_id);
    $zd_jc = equip::get_user_equip_jc('zd', $user_id);
    $kd_jc = equip::get_user_equip_jc('kd', $user_id);
    $bj_jc = equip::get_user_equip_jc('bj', $user_id);
    value::set_user_value('is_zd_pk', 0, $user_id);
    value::set_user_value('mb_jc', $mb_jc, $user_id);
    value::set_user_value('km_jc', $km_jc, $user_id);
    value::set_user_value('minjie_jc', $minjie_jc, $user_id);
    value::set_user_value('mz_jc', $mz_jc, $user_id);
    value::set_user_value('xx_jc', $xx_jc, $user_id);
    value::set_user_value('zd_jc', $zd_jc, $user_id);
    value::set_user_value('kd_jc', $kd_jc, $user_id);
    value::set_user_value('bj_jc', $bj_jc, $user_id);
    $u_pet_arr = user::get_pet_arr($user_id, 1);
    foreach ($u_pet_arr as $pet_id) {
        value::set_pet_value2('xs_hp', 0, $pet_id);
        $is_dead = value::get_pet_value($pet_id, 'is_dead');
    }
    value::set_user_value('xs_hp', 0, $user_id);
    value::set_user_value('xs_mp', 0, $user_id);
    $i51 = item::get_item(51, $user_id);
    if ($i51) {
        item::add_item(51, -$i51, false);
        value::add_user_value('money', $i51, $user_id);
    }
    $hp = value::get_game_user_value('hp', $user_id);
    $mp = value::get_game_user_value('mp', $user_id);
    $zcsj_wp = value::get_user_value('zcsj_wp', $user_id);
    if ($zcsj_wp < 1) {
        if (value::get_game_user_value('sex', $user_id) == "男") {
            prop::user_get_prop(prop::new_prop(6, 0, 0), 0, 1, false, true);
            prop::user_get_prop(prop::new_prop(5, 0, 0), 0, 1, false, true);
            value::set_user_value('zcsj_wp', 1, $user_id);
        } else {
            prop::user_get_prop(prop::new_prop(7, 0, 0), 0, 1, false, true);
            prop::user_get_prop(prop::new_prop(5, 0, 0), 0, 1, false, true);
            value::set_user_value('zcsj_wp', 1, $user_id);
        }
        prop::user_get_prop(prop::new_prop(313, 0, 0), 0, 1, false, true);
        prop::user_get_prop(prop::new_prop(314, 0, 0), 0, 1, false, true);
        prop::user_get_prop(prop::new_prop(315, 0, 0), 0, 1, false, true);
        prop::user_get_prop(prop::new_prop(317, 0, 0), 0, 1, false, true);
        prop::user_get_prop(prop::new_prop(318, 0, 0), 0, 1, false, true);
        prop::user_get_prop(prop::new_prop(319, 0, 0), 0, 1, false, true);
        item::add_item(283, 2);
        item::add_item(199, 1000);
    }
    $ss_hp = value::get_user_value('ss_hp', $user_id);
    $ss_mp = value::get_user_value('ss_mp', $user_id);
    $jd_hp = value::get_game_user_value('jd_hp', $user_id);
    $jd_mp = value::get_game_user_value('jd_mp', $user_id);
    $sji_hp = value::get_game_user_value('sji_hp', $user_id);
    $sji_mp = value::get_game_user_value('sji_mp', $user_id);
    $lvl = value::get_game_user_value('lvl', $user_id);
    $user_is_dead = value::get_game_user_value('is_dead', $user_id);
    $hp_jc = equip::get_user_equip_jc('hp');
    $mp_jc = equip::get_user_equip_jc('mp');
    $money = (int)(value::get_user_value('money'));
    value::set_user_value('money', $money, $user_id);
    $wj_tls = value::get_user_value('wj_tls');
    $wj_mls = value::get_user_value('wj_mls');
    $tz_hp = value::get_game_user_value('tz_hp', $user_id);
    $tz_mp = value::get_game_user_value('tz_mp', $user_id);
    $ch_sx_hp = value::get_user_value('ch_sx_hp');
    $max_hp = (int)($wj_tls + $hp_jc + 50 + $sji_hp + $jd_hp + $ss_hp + $tz_hp + $ch_sx_hp);
    $max_mp = (int)($wj_mls + $mp_jc + 10 + $sji_mp + $jd_mp + $ss_mp + $tz_mp);
   //场景玩家护身戒指
    $ts_jz4 = equip::get_user_equip_jc('ts_jz4', $user_id);
    if ($ts_jz4 > 0) {
        $max_hp += $max_mp;
    }
    //场景玩家火焰戒指 
    $ts_jz8 = equip::get_user_equip_jc('ts_jz8', $user_id);
    $zhiye = value::get_game_user_value('zhiye', $user_id);
    if ($ts_jz8 > 0 && $zhiye != '法师' && !user_skill::have_skill(3, $user_id)) {
        e10005(3);
    } else {
        if ($ts_jz8 < 1 && $zhiye != '法师' && user_skill::have_skill(3, $user_id)) {
            e10006(3);
        }
    }
    //场景玩家防御戒指
    $ts_jz5 = equip::get_user_equip_jc('ts_jz5', $user_id);
    $zhiye = value::get_game_user_value('zhiye', $user_id);
    if ($ts_jz5 > 0 && $zhiye != '道士' && !user_skill::have_skill(4, $user_id)) {
        e10005(4);
    } else {
        if ($ts_jz5 < 1 && $zhiye != '道士' && user_skill::have_skill(4, $user_id)) {
            e10006(4);
        }
    }
    //玩家组队加成效果
    $team_id = team::get_user_team($user_id);
    $team_count = 0;
    if ($team_id) {
        $captain_user_id = team::get_team_captain_user_id($team_id);
        $team_user_name = value::get_game_user_value('name', $captain_user_id);
        $sql = "SELECT `id` FROM `game_user` WHERE `team_id`={$team_id} LIMIT 5";
        $result = sql($sql);
        while (list($team_oid) = $result->fetch_row()) {
            $team_count += 3;
        }
    }
   //场景玩家会员加成
   $team_count1 = $team_count;
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    $wj_sx_qzwd_jc = value::get_user_value('wj_sx_qzwd_jc', $user_id);
    $hy_lvl1 = $hy_lvl * 10 + $wj_sx_qzwd_jc;
    if ($hy_lvl1 > 0) {
        $max_hp += (int)(($max_hp / 100) * $hy_lvl1);
        $max_mp += (int)(($max_mp / 100) * $hy_lvl1);
    }
    if ($team_count1 > 0) {
        $max_hp += (int)(($max_hp / 100) * $team_count1);
        $max_mp += (int)(($max_mp / 100) * $team_count1);
    }
    //场景魔血加成
    $ts_jz10 = equip::get_user_equip_jc('ts_jz10', $userId);
    if ($ts_jz10 > 4) {
        $max_hp = (int)($max_hp + ($max_mp / 2));
        $max_mp = (int)($max_mp / 2);
    }
    value::set_game_user_value('max_hp', $max_hp, $user_id);
    value::set_game_user_value('max_mp', $max_mp, $user_id);
    if (value::get_game_user_value('zhiye') == '战士') {
        value::set_game_user_value('max_hp', $max_hp, $user_id);
    }
    if (value::get_game_user_value('zhiye') == '法师') {
        value::set_game_user_value('max_mp', $max_mp, $user_id);
    }
    if (value::get_game_user_value('zhiye') == '道士') {
        value::set_game_user_value('max_hp', $max_hp, $user_id);
        value::set_game_user_value('max_mp', $max_mp, $user_id);
    }
    value::set_game_user_value('max_lvl', 100, $user_id);
    if ($hp > $max_hp) {
        value::set_game_user_value('hp', $max_hp, $user_id);
    }
    if ($mp > $max_mp) {
        value::set_game_user_value('mp', $max_mp, $user_id);
    }
    $sql = "SELECT `id` FROM `game_pet` WHERE `is_dead`>0 AND `master_id`=$user_id AND `is_yj`<1";
    $rs = sql($sql);
    while (list($d_pet_id) = $rs->fetch_row()) {
        pet::del_pet($d_pet_id);
    }
    //玩家死亡地图场景获得属性
    $user_is_dead = value::get_game_user_value('is_dead', $user_id);
    if ($user_is_dead > 0) {
        $sql = "SELECT `id` FROM `game_pet` WHERE `master_id`=$user_id AND `is_yj`<1";
        $rs = sql($sql);
        while (list($d_pet_id) = $rs->fetch_row()) {
            pet::del_pet($d_pet_id);
        }
        value::set_game_user_value('hp', $max_hp, $user_id);
        value::set_game_user_value('mp', $max_mp, $user_id);
        value::set_game_user_value('is_dead', 0, $user_id);
        $m_cs_map = value::get_user_value('cs_map', $user_id);
        $map_ts_map = value::get_map_value($m_cs_map, 'ts_map');
        if ($map_ts_map) {
            $m_cs_map = 1;
        }
        $m_cs_map1 = value::get_user_value('cs_map1', $user_id);
        $map_ts_map1 = value::get_map_value($m_cs_map1, 'ts_map');
        if ($map_ts_map1) {
            $m_cs_map1 = 1;
        }
        $in_map_name = value::get_map_value($m_cs_map, 'name');
        $in_map_name1 = value::get_map_value($m_cs_map1, 'name');
        if ($m_cs_map1) {
            value::set_game_user_value('in_map_id', $m_cs_map1);
            echo "你回到了" . $in_map_name1 . "了！";
            br();
        } else {
            value::set_game_user_value('in_map_id', $m_cs_map);
            echo "你回到了" . $in_map_name . "满血复活了！";
            br();
        }
    }
}
//玩家地图场景祝福效果
function map_wjsw_jzhhd($jzhhd = 0)
{
    $user_id = uid();
    $i169 = item::get_item(169, $user_id);
    $sw_map = value::get_user_value('sw_map', $user_id);
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    $hy_name = value::get_game_user_value('hy_name');
    $name = value::get_game_user_value('name', $user_id);
    $in_map_name = value::get_map_value($sw_map, 'name');
    $ts_jz2  = equip::get_user_equip_jc('ts_jz2');
    if ($jzhhd == 0) {
        if ($hy_lvl) {
            $hy_sj = mt_rand(1, 100);
            $hy_sj_dj = $hy_lvl * 10;
            if ($hy_sj <  $hy_sj_dj) {
                map_wjsw_jzhhd(2);
                return;
            } else {
                echo "你使用" . $hy_name . "特权原地复活失败了！";
                br();
                map_wj_zx();
                br();
                return;
            }
        }
        if ($ts_jz2) {
            $hy_sj = mt_rand(1, 100);
            if ($hy_sj <  10) {
                map_wjsw_jzhhd(3);
                return;
            } else {
                echo "你使用复活戒指原地复活失败了！";
                br();
                map_wj_zx();
                br();
                return;
            }
        }
        echo "你在" . $in_map_name . "死亡了";
        br();
        echo "-";
        br();
        cmd::addcmd('map_wjsw_jzhhd,1', '原地复活(九转还魂丹*1)');
        br();
        echo "-";
        br();
        cmd::addcmd('map_wj_zx', '返回游戏');
        cmd::set_show_return_game(false);
        return;
    }
    if ($jzhhd == 1) {
        if ($i169 > 0) {
            item::add_item(169, -1);
            echo "你使用九转还魂丹原地复活了！";
            br();
            if ($sw_map) {
                value::set_user_value('cs_map1', $sw_map);
                map_wj_zx();
                return;
            }
        } else {
            echo "你没有九转还魂丹无法原地复活，九转还魂丹商场有售！";
            br();
        }
    }
    if ($jzhhd == 2) {
        if ($hy_lvl > 0) {
            echo "你使用" . $hy_name . "特权原地复活了！";
            br();
            if ($sw_map) {
                value::set_user_value('cs_map1', $sw_map);
                map_wj_zx();
                return;
            }
        } else {
            echo "你不是会员无法原地复活，会员卡商场有售！";
            br();
        }
    }
    if ($jzhhd == 3) {
        echo "你使用复活戒指原地复活了！";
        br();
        if ($sw_map) {
            value::set_user_value('cs_map1', $sw_map);
            map_wj_zx();
            return;
        }
    }
}

//玩家地图场景祝福效果
function map_zf_xg()
{
    $user_id = uid();
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('sy_yjqdx_time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('zbpj_ys', 0, $user_id);
        value::set_user_value('zbpj_lvl', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_bt.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_bt_hp', 0, $user_id);
        value::set_user_value('wj_bt_mp', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_db.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_db', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_jy.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_jy', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_bj.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_bj', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_tls.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_tls', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_mls.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_mls', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_gjs.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_gjs', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_fys.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_fys', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_mgs.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_mgs', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_mfs.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_mfs', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_hy.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('hy_lvl', 0, $user_id);
        value::set_game_user_value('hy_name', '', $user_id);
        $tp = value::get_game_user_value('tp', $user_id);
        value::set_game_user_value('name', $tp, $user_id);
        value::set_user_value('map_xs_hy_lvl', 0, $user_id);
    }
    $now_time = date("Y-m-d H:i:s");
    $mianzhan_time = value::get_user_value('wj_bg.time');
    if ($mianzhan_time < $now_time) {
        value::set_user_value('wj_bg', 0, $user_id);
    }
    value::set_user_value('tz_tdxt_id', 0, $user_id);
    //队友图标
    $tp = value::get_game_user_value('tp', $user_id);
    if ($tp) {
        xs_zd($user_id);
    }
}

function xs_zd($user_id)
{
    //队友图标
    $dy_name = value::get_game_user_value('tp', $user_id);
    $hy_xs_lvl = value::get_user_value('hy_lvl', $user_id);
    if ($hy_xs_lvl == 1) {
        $tp = "<span style=color:red>{$dy_name}</span>";
    }
    if ($hy_xs_lvl < 1) {
        $tp = $dy_name;
    }
    if ($hy_xs_lvl == 2) {
        $tp = "<span style=color:green>{$dy_name}</span>";
    }
    if ($hy_xs_lvl == 3) {
        $tp = "<span style=color:purple>{$dy_name}</span>";
    }
    value::set_game_user_value('tp1', $dy_name, $user_id);
    $team_id = team::get_user_team($user_id);
    if ($team_id) {
        $captain_user_id = team::get_team_captain_user_id($team_id);
        if ($captain_user_id == $user_id) {
            $tp1 = "<img src=zd_dz.png>" . value::get_game_user_value('tp1', $user_id);
            value::set_game_user_value('name', $tp1, $user_id);
        } else {
            $tp1 = "<img src=zd_dy.png>" . value::get_game_user_value('tp1', $user_id);
            value::set_game_user_value('name', $tp1, $user_id);
        }
    } else {
        $dy_name = value::get_game_user_value('tp', $user_id);
        $hy_xs_lvl = value::get_user_value('hy_lvl', $user_id);
        if ($hy_xs_lvl == 1) {
            $tp = "<span style=color:red>{$dy_name}</span>";
        }
        if ($hy_xs_lvl < 1) {
            $tp = $dy_name;
        }
        if ($hy_xs_lvl == 2) {
            $tp = "<span style=color:green>{$dy_name}</span>";
        }
        if ($hy_xs_lvl == 3) {
            $tp = "<span style=color:purple>{$dy_name}</span>";
        }
        value::set_game_user_value('name', $tp, $user_id);
    }
}

function xs_mj1($user_id, $item_id)
{
    if (value::get_game_user_value('zhiye') == '战士') {
        item::add_item(24, 1);
    }
    if (value::get_game_user_value('zhiye') == '法师') {
        item::add_item(42, 1);
        item::add_item(40, 1);
        item::add_item(43, 1);
    }
    if (value::get_game_user_value('zhiye') == '道士') {
        item::add_item(22, 1);
    }
}

function zb_csjz()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $map_name = value::getvalue('map', 'name', 'id', $in_map_id);
    $area_id = value::getvalue('map', 'area_id', 'id', $in_map_id);
    $sql = "SELECT `id`, `name` FROM `map` WHERE `area_id` = '" . $area_id . " AND `ts_map`<1 ORDER BY  `id` ASC";
    echo '当前:' . $map_name . '(s' . $in_map_id . ')';
    br();
    echo "-";
    br();
    echo '选择传送地图:';
    br();
    $result = sql($sql);
    while (list($id, $name) = $result->fetch_row()) {
        echo $name . '(s' . $id . ')';
        cmd::addcmd('e7,' . $id, "传送");
        br();
    }
    echo "-";
    br();
    cmd::set_return_game_br(false);
}

function map_vip_tz()
{
    $user_id = uid();
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    echo '会员专属副本地图:';
    br();
    echo "-";
    br();
    if ($hy_lvl >=1) {
        cmd::addcmd('map_cs_id1,3052', 'ST副本');
    } else {
        cmd::addcmd('map_vip_tz1', 'ST副本');
    }
    echo ':（60级~爆ST会员套装）';
    br();
    if ($hy_lvl >=2) {
        cmd::addcmd('map_cs_id1,5566', '贵宾副本');
    } else {
        cmd::addcmd('map_vip_tz1', '贵宾副本');
    }
    echo ':（100级~爆贵宾会员套装）';
    br();
    echo "-";
    br();
    cmd::set_return_game_br(false);
}

function map_vip_zj()
{
    $user_id = uid();
    $hy_lvl = value::get_user_value('hy_lvl', $user_id);
    echo '会员之家地图:';
    br();
    echo "-";
    br();
    if ($hy_lvl >=1) {
        $map_jymj_cs = value::get_user_value('map_hyzj_cs', $user_id);
        $ts_time = date("Y-m-d H:i:s");
        $map_60_time = value::get_user_value('map_hyzj_time', $user_id);
        if (!$map_jymj_cs || $ts_time < $map_60_time) {
            if ($ts_time < $map_60_time) {
                $mzsysj = strtotime($map_60_time) - strtotime($ts_time);
                $mz_min = (int)($mzsysj % 3600 / 60);
                echo "提示:你还剩<span style=color:red>{$mz_min}</span>分钟无法进入</span>!";
                br();
                cmd::addcmd('map_cs_id1,5731', '进入会员之家');
            } else {
                echo "你今天可以免费一次进入经验秘境！";
                br();
                cmd::addcmd('map_cs_id1,5731', '进入会员之家');
            }
            $map_60_time1 = date('Y-m-d H:i:s', strtotime('+60 minute'));
            if ($ts_time > $map_60_time) {
                value::set_user_value('map_hyzj_time', $map_60_time1, $user_id);
            }
        } else {
            if ($map_jymj_cs < 2) {
                $i296 = item::get_item(518);
                if ($i296 > 0) {
                    item::add_item(518, -1);
                    $item_qhs_name = value::get_item_value(518, 'name');
                    echo "你已经免费进去了一次，现在需要{$item_qhs_name}才能进入！";
                    br();
                    cmd::addcmd('map_cs_id1,5731', '进入会员之家');
                    $map_60_time = date('Y-m-d H:i:s', strtotime('+60 minute'));
                    value::set_user_value('map_jymj_time', $map_60_time, $user_id);
                } else {
                    $item_qhs_name = value::get_item_value(518, 'name');
                    echo "你已经免费进去了一次，现在需要{$item_qhs_name}才能进入！";
                }
            } else {
                echo "会员之家限制:每天限使用二次！";
            }
        }
    } else {
        cmd::addcmd('map_vip_zj1', '进入会员之家');
    }
    br();
    echo "-";
    br();
    cmd::set_return_game_br(false);
}

function map_vip_zj1()
{
    $user_id = uid();
    echo '你不是会员无法进入专属会员之家地图!';
    br();
    cmd::set_return_game_br(false);
}

function map_vip_tz1()
{
    $user_id = uid();
    echo '你会员等级不足无法进入专属副本地图!';
    br();
    cmd::set_return_game_br(false);
}

function xs_mj2($user_id, $item_id)
{
    if (value::get_game_user_value('zhiye') == '战士') {
        item::add_item(32, 1);
    }
    if (value::get_game_user_value('zhiye') == '法师') {
        item::add_item(26, 1);
    }
    if (value::get_game_user_value('zhiye') == '道士') {
        item::add_item(29, 1);
    }
}

//使用回城卷
function sy_hcj()
{
    $user_id = uid();
    $m_cs_map = value::get_user_value('cs_map', $user_id);
    $map_name = value::get_map_value($m_cs_map, 'name', $user_id);
    echo "你使用回城卷回到" . $map_name;
    br();
    if ($m_cs_map) {
        value::set_game_user_value('in_map_id', $m_cs_map);
    }
}

//使用boss卷轴
function sy_boss($user_id, $item_id)
{
    $user_id = uid();
    if ($item_id == 264) {
        $m_cs_map = 2380;
    }
    if ($item_id == 265) {
        $m_cs_map = 2381;
    }
    if ($item_id == 266) {
        $m_cs_map = 2382;
    }
    if ($item_id == 267) {
        $m_cs_map = 2383;
    }
    if ($item_id == 268) {
        $m_cs_map = 2384;
    }
    if ($item_id == 269) {
        $m_cs_map = 2385;
    }
    $name = value::get_game_user_value('name', $user_id);
    $map_name = value::get_map_value($m_cs_map, 'name', $user_id);
    echo "你使用{$map_name}卷轴传送" . $map_name . "了！";
    c_add_guangbo("玩家{$name}使用{$map_name}卷轴传送{$map_name}了!");
    br();
    if ($m_cs_map) {
        value::set_game_user_value('in_map_id', $m_cs_map);
    }
}

//使用神秘系列
function sy_sm_tz($user_id, $item_id)
{
    $user_id = uid();
    $sx_wp = item::get_item(278);
    if ($sx_wp) {
        item::add_item(278, -1);
        $sj = mt_rand(1, 1000);
        if ($sj <= 10) {
            $sji = 3;
        } else if ($sj <= 50) {
            $sji = 2;
        } else if ($sj <= 100) {
            $sji = 1;
        } else {
            $sji = 0;
        }
        if ($item_id == 273) {
            prop::user_get_prop(prop::new_prop(271, 0, $sji), 0, 1, false, true);
        }
        if ($item_id == 274) {
            prop::user_get_prop(prop::new_prop(272, 0, $sji), 0, 1, false, true);
        }
        if ($item_id == 275) {
            prop::user_get_prop(prop::new_prop(273, 0, $sji), 0, 1, false, true);
        }
        if ($item_id == 276) {
            prop::user_get_prop(prop::new_prop(274, 0, $sji), 0, 1, false, true);
        }
        if ($item_id == 277) {
            prop::user_get_prop(prop::new_prop(275, 0, $sji), 0, 1, false, true);
        }
    } else {
        echo "你没有<span style=color:green>神水</span>无法解除诅咒！";
        br();
    }
}

//使用随机传送卷
function sy_sjcsj()
{
    $user_id = uid();
    $in_map_id = value::get_game_user_value('in_map_id');
    $area_id = value::get_map_value($in_map_id, 'area_id', $user_id);
    $sql = "SELECT COUNT(*) FROM `map` WHERE `area_id`='{$area_id}'";
    $result = sql($sql);
    list($map_count1) = $result->fetch_row();
    $sj = mt_rand(1, $map_count1);
    $sql = "SELECT `name`,`id` FROM `map` WHERE `area_id`='{$area_id}' AND `ts_map`<1 LIMIT {$sj}, 1";
    $result = sql($sql);
    list($map_name, $map_id) = $result->fetch_row();
    echo "你使用随机传送卷传送到" . $map_name;
    br();
    if ($map_id) {
        value::set_game_user_value('in_map_id', $map_id);
    }
}

//使用随机传送卷
function game_gg()
{
    $user_id = uid();
    if ($user_id < 1) {
        $qh = "738323424";
        $wz = "仙盟会-梦回";
    } else {
        $qh = "qq-738323424";
        $wz = "cq.仙盟会-梦回";
    } 
    echo "<span style=color:blue>
    亲爱的《绿色传奇》玩家：</span><br>
    <br>
    <span style=color:green>游戏调试中.....游戏将于5月14日早上10点正式公测<br>
    绿色传奇游戏专群:{$qh}<br>
    </span>";
}

//攻略
function map_gy()
{
    $user_id = uid();
    echo "游戏攻略：";
    br();
    echo "-";
    br();
    cmd::addcmd('map_dl_dq', '掉落介绍');
    echo " . ";
    cmd::addcmd('map_gy_pk', 'PK介绍');
    br();
    cmd::addcmd('map_gy_zb', '游戏装备');
    echo " . ";
    cmd::addcmd('map_gy_zz', '种植练丹');
    br();
    echo "-";
}

//掉落大全
function map_dl_dq()
{
    $user_id = uid();
    echo "请选择查看的怪物区域掉落：";
    br();
    echo "-";
    br();
    $map_area_name_arr = config::getConfigByName("map_area_name");
    foreach ($map_area_name_arr as $k => $v) {
        cmd::addcmd('map_dl_dq1,' . $k, $v);
        br();
    }
    echo "-";
}

function map_pmh()
{
    $user_id = uid();
    echo "请选择拍卖的类型：";
    br();
    echo "-";
    br();
    cmd::addcmd('e22', '宠物拍卖');
    br();
    cmd::addcmd('e23,1', '装备拍卖');
    br();
    echo "-";
}

function map_dl_dq1($area_id)
{
    $user_id = uid();
    echo "请选择地图区域怪物：";
    br();
    echo "-";
    //读取掉落数据
    $diaoluo_arr = config::getConfigByName("pet_diaoluo");
    $diaoluo_arr = $diaoluo_arr[$area_id];
    foreach ($diaoluo_arr as $pet_kid => $pet_arr) {
        $pet_name = value::getvalue('pet', 'name', 'id', $pet_kid);
        cmd::addcmd('map_dl_dq2,' . $pet_kid . ',' . $area_id, $pet_name);
        br();
    }
    echo "-";
}

function map_gy_pk($area_id)
{
    $user_id = uid();
    cmd::addcmd('map_gy', '攻略');
    br();
    echo "-";
    br();
    echo "pk功能介绍<br>
    pk失败掉落背包金钱-30%<br>
    pk失败有小几率掉落随机装备x1<br>
    ----------------------<br>
    玩家保护系统<br>
    玩家每天被恶意pk击败10次后，会免费进入4小时保护期<br>
    进入保护期后，玩家主动攻击了，保护期消失<br>
    当今天在次被恶意击败10次之后会在次触发保护<br>
    10次之后，每10次触发一次保护<br>
    ----------------------<br>
    主动pk胜利后+1点红名值<br>
    被动pk获胜不加红名值<br>
    红名值每在线一个小时，自动减一点<br>
    红名≥10之后，被npc/玩家击败后会被关进监狱<br>
    红名≥10之后，回安全区有几率被正义联盟(npc)攻击<br>
    ----------------------<br>
    pk悬赏系统<br>
    pk失败之后，攻击的玩家会出现在你的仇人例表里<br>
    可以回安全中心，正义联盟npc那里花费金币/元宝，悬赏仇人<br>
    击杀者获得其赏金<br>
    ";
    echo "-";
}

function map_gy_zb($area_id)
{
    $user_id = uid();
    cmd::addcmd('map_gy', '攻略');
    br();
    echo "-";
    br();
    echo "攻略→游戏装备<br>
    游戏内的所有装备都是通过打怪掉落，顶级装备在副本与会员副本<br>
    ----------------<br>
    装备绑定，打怪掉落的是新装备是不绑定的，使用了之后/或者强化了之后会变成绑定的<br>
    ----------------<br>
    装备强化，强化石可以交易，最高可强化致+10，强化石目前的产地只有攻城战与推广礼包，即将陆续续增加产地<br>
    强化的矿石，去杂贸铺买一把锄头，买后一定要穿上，然后去矿地就可以挖矿了<br>
    ----------------<br>
    装备开光:只有强化+10的装备才可以开光，开光后装备名字变更，前缀加“神”的标识，开光后装备属性大量增加，同时随机加一条特殊属性<br>
    ----------------<br>
    装备升星:装备升星后会加一定的属性，装备升星石目前产地有、竞技场、天下第一参与礼包，即将陆续续增加产地<br>
    ----------------<br>
    装备附魔<br>
    没有附魔的装备打怪是会掉耐久的，耐久为零时装备会消失，请及时注意修复装备<br>
    装备修复神油，元宝卷商城、元宝商城、野外npc均有掉落<br>
    装备可以用天外神铁来附魔，附魔后装备永不掉耐久<br>
    天外神铁可交易<br>
    天外神铁目前产地，竞争场、攻城战，即将陆续续增加产地<br>
    ----------------<br>
    装备时装，目前只有天下第一奖励武器时装<br>
    ";
    echo "-";
}

function map_gy_zz($area_id)
{
    $user_id = uid();
    cmd::addcmd('map_gy', '攻略');
    br();
    echo "-";
    br();
    echo "攻略→种植练丹<br>
    种植的种子，玩家可以每天跟具自己的需求领取对应的种子<br>
    种子不可以交易、种成成品后可以交易、丹药可以交易<br>
    超级种子，目前只有通过推广活动与运营活动获取<br>
    ";
    echo "-";
}

function map_dl_dq2($pet_kid1, $area_id)
{
    $user_id = uid();
    //物品数组
    $item_arr = array();
    //装备数组
    $prop_arr = array();
    $pet_name = value::getvalue('pet', 'name', 'id', $pet_kid1);
    echo $pet_name . "怪物掉落：";
    br();
    echo "-";
    br();
    //读取掉落数据
    $diaoluo_arr = config::getConfigByName("pet_diaoluo");
    $diaoluo_arr = $diaoluo_arr[$area_id];
    foreach ($diaoluo_arr as $pet_kid => $pet_arr) {
        if ($pet_kid == $pet_kid1) {
            foreach ($pet_arr as $pet_key => $map_arr) {
                if ($pet_key == "*" || $pet_key == $area_id) {
                    foreach ($map_arr as $dl_arr_name => $dl_arr_data) {
                        switch ($dl_arr_name) {
                            case "item":
                                foreach ($dl_arr_data as $k => $v) {
                                    $item_name = value::get_item_value($k, 'name');
                                    cmd::addcmd('ck_e41,' . $k, $item_name);
                                    br();
                                }
                                break;
                            case "prop":
                                foreach ($dl_arr_data as $k => $v) {
                                    $item_name =  value::getvalue('prop', 'name', 'id', $k);
                                    cmd::addcmd('gm_show_prop1,' . $k, $item_name);
                                    br();
                                }
                                break;
                        }
                    }
                }
            }
        }
    }
    echo "-";
}

function ck_map_dl_dq2($pet_kid1, $area_id)
{
    $user_id = uid();
    //物品数组
    $item_arr = array();
    //装备数组
    $prop_arr = array();
    $pet_name = value::getvalue('pet', 'name', 'id', $pet_kid1);
    echo $pet_name . "掉落：";
    //读取掉落数据
    $diaoluo_arr = config::getConfigByName("pet_diaoluo");
    $diaoluo_arr = $diaoluo_arr[$area_id];
    foreach ($diaoluo_arr as $pet_kid => $pet_arr) {
        if ($pet_kid == $pet_kid1) {
            foreach ($pet_arr as $pet_key => $map_arr) {
                if ($pet_key == "*" || $pet_key == $area_id) {
                    foreach ($map_arr as $dl_arr_name => $dl_arr_data) {
                        switch ($dl_arr_name) {
                            case "item":
                                foreach ($dl_arr_data as $k => $v) {
                                    $item_name = value::get_item_value($k, 'name');
                                    cmd::addcmd('ck_e41,' . $k, $item_name);
                                    echo ",";
                                }
                                break;
                            case "prop":
                                foreach ($dl_arr_data as $k => $v) {
                                    $item_name =  value::getvalue('prop', 'name', 'id', $k);
                                    cmd::addcmd('gm_show_prop1,' . $k, $item_name);
                                    echo ",";
                                }
                                break;
                        }
                    }
                }
            }
        }
    }
    br();
}

function map_tz_xg($user_id)
{
    $user_id = uid();
    $equip_subtype_arr = config::getConfigByName("equip_tz");
    foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
        $tz_jc = equip::get_user_equip_tz($equip_num);
        if ($equip_num) {
            if ($equip_num == 1) {
                $tz_ys = "red";
            }
            if ($equip_num == 2) {
                $tz_ys = "green";
            }
            if ($equip_num == 3) {
                $tz_ys = "green";
            }
            if ($equip_num == 4) {
                $tz_ys = "purple";
            }
            if ($tz_jc >= 4) {
                echo "<span style=color:" . $tz_ys . ">";
                echo $equip_subtype  . "套装[" . $tz_jc . "/ 10]";
                br();
                $tz_mp = $equip_num * 2000;
                echo $equip_subtype  . "套装(4)：魔法 +  " .  $tz_mp;
                br();
            }
            if ($tz_jc >= 6) {
                $tz_hp = $equip_num * 2000;
                echo $equip_subtype  . "套装(6)：生命 +  " .  $tz_hp;
                br();
            }
            if ($tz_jc >= 8) {
                $tz_fy = $equip_num * 1500;
                echo $equip_subtype  . '套装(8)： 防御 + ' .  $tz_fy;
                br();
            }
            if ($tz_jc >= 9 && $equip_subtype == "会员") {
                echo $equip_subtype  . '套装(9)： 伤害减免5%';
                br();
            }
            if ($tz_jc >= 9 && $equip_subtype == "贵宾") {
                echo $equip_subtype  . '套装(9)： 伤害减免10%';
                br();
            }
            if ($tz_jc >= 10) {
                $tz_gj = $equip_num * 1000;
                echo $equip_subtype  . '套装(10)： 攻击 + ' .  $tz_gj;
                br();
            }
            if ($tz_jc >= 10 && $equip_subtype == "会员") {
                echo $equip_subtype  . '套装(10)： 伤害加深5%';
                br();
            }
            if ($tz_jc >= 10 && $equip_subtype == "贵宾") {
                echo $equip_subtype  . '套装(10)： 伤害加深10%';
                br();
            }
            echo "</span>";
        }
    }
}

function map_tz_xg1($user_id)
{
    $equip_subtype_arr = config::getConfigByName("equip_tz");
    foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
        $tz_jc = equip::get_user_equip_tz1($equip_num, $user_id);
        if ($equip_num) {
            if ($equip_num == 1) {
                $tz_ys = "red";
            }
            if ($equip_num == 2) {
                $tz_ys = "green";
            }
            if ($equip_num == 3) {
                $tz_ys = "purple";
            }
            if ($tz_jc >= 4) {
                echo "<span style=color:" . $tz_ys . ">";
                echo $equip_subtype  . "套装[" . $tz_jc . "/ 10]";
                br();
                $tz_mp = $equip_num * 2000;
                echo $equip_subtype  . "套装(4)：魔法 +  " .  $tz_mp;
                br();
            }
            if ($tz_jc >= 6) {
                $tz_hp = $equip_num * 2000;
                echo $equip_subtype  . "套装(6)：生命 +  " .  $tz_hp;
                br();
            }
            if ($tz_jc >= 8) {
                $tz_fy = $equip_num * 1500;
                echo $equip_subtype  . '套装(8)： 防御 + ' .  $tz_fy;
                br();
            }
            if ($tz_jc >= 9 && $equip_subtype == "会员") {
                echo $equip_subtype  . '套装(9)： 伤害减免5%';
                br();
            }
            if ($tz_jc >= 9 && $equip_subtype == "贵宾") {
                echo $equip_subtype  . '套装(9)： 伤害减免10%';
                br();
            }
            if ($tz_jc >= 10) {
                $tz_gj = $equip_num * 1000;
                echo $equip_subtype  . '套装(10)： 攻击 + ' .  $tz_gj;
                br();
            }
            if ($tz_jc >= 10 && $equip_subtype == "会员") {
                echo $equip_subtype  . '套装(10)： 伤害加深5%';
                br();
            }
            if ($tz_jc >= 10 && $equip_subtype == "贵宾") {
                echo $equip_subtype  . '套装(10)： 伤害加深10%';
                br();
            }
            echo "</span>";
        }
    }
}

function map_tz_jc($user_id)
{
    $user_id = uid();
    $tz_mp = 0;
    $tz_hp = 0;
    $tz_fy = 0;
    $tz_gj = 0;
    $tz_gj_jm = 0;
    $tz_gj_js = 0;
    $equip_subtype_arr = config::getConfigByName("equip_tz");
    foreach ($equip_subtype_arr as $equip_num => $equip_subtype) {
        $tz_jc = equip::get_user_equip_tz($equip_num);
        if ($equip_num) {
            if ($tz_jc >= 4) {
                $tz_mp += $equip_num * 2000;
            }
            if ($tz_jc >= 6) {
                $tz_hp += $equip_num * 2000;
            }
            if ($tz_jc >= 8) {
                $tz_fy += $equip_num * 1500;
            }
            if ($tz_jc >= 9 && $equip_subtype == "会员") {
                $tz_gj_jm = 5;
            }
            if ($tz_jc >= 9 && $equip_subtype == "贵宾") {
                $tz_gj_jm = 10;
            }
            if ($tz_jc >= 10) {
                $tz_gj += $equip_num * 1000;
            }
            if ($tz_jc >= 10 && $equip_subtype == "会员") {
                $tz_gj_js = 5;
            }
            if ($tz_jc >= 10 && $equip_subtype == "贵宾") {
                $tz_gj_js = 10;
            }
        }
    }
    value::set_game_user_value('tz_mp', $tz_mp, $user_id);
    value::set_game_user_value('tz_hp', $tz_hp, $user_id);
    value::set_game_user_value('tz_fy', $tz_fy, $user_id);
    value::set_game_user_value('tz_gj', $tz_gj, $user_id);
    value::set_user_value('tz_gj_jm', $tz_gj_jm, $user_id);
    value::set_user_value('tz_gj_js', $tz_gj_js, $user_id);
}

//人物 属性加点事件
function rw_e78($user_id, $mode = 0, $dianshu = 1)
{
    $user_id = uid();
    cmd::addcmd('e13', '状态');
    echo ">> 属性加点";
    br();
    echo "-";
    br();
    //获取宠物六维
    $sql = "SELECT `jd_hp`,`max_hp`,`max_mp`,`jd_mp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`shuxingdian`,`is_dead` FROM `game_user` WHERE `id`={$user_id} LIMIT 1";
    $result = sql($sql);
    list($jd_hp, $max_hp, $max_mp, $jd_mp, $pugong, $pufang, $tegong, $tefang, $minjie, $shuxingdian, $is_dead) = $result->fetch_row();
    if (!$is_dead) {
        //处理属性加点
        if ($shuxingdian) {
            switch ($mode) {
                case 1:
                    value::add_game_user_value('shuxingdian', -1 * $dianshu, $user_id);
                    value::add_game_user_value('jd_hp', 1 * $dianshu, $user_id);
                    $sxd_max_hp = $dianshu;
                    break;
                case 2:
                    value::add_game_user_value('shuxingdian', -1 * $dianshu, $user_id);
                    value::add_game_user_value('pugong', 1 * $dianshu, $user_id);
                    $sxd_pugong = $dianshu;
                    break;
                case 3:
                    value::add_game_user_value('shuxingdian', -1 * $dianshu, $user_id);
                    value::add_game_user_value('pufang', 1 * $dianshu, $user_id);
                    $sxd_pufang = $dianshu;
                    break;
                case 4:
                    value::add_game_user_value('shuxingdian', -1 * $dianshu, $user_id);
                    value::add_game_user_value('tegong', 1 * $dianshu, $user_id);
                    $sxd_tegong = $dianshu;
                    break;
                case 5:
                    value::add_game_user_value('shuxingdian', -1 * $dianshu, $user_id);
                    value::add_game_user_value('tefang', 1 * $dianshu, $user_id);
                    $sxd_tefang = $dianshu;
                    break;
                case 6:
                    value::add_game_user_value('shuxingdian', -1 * $dianshu, $user_id);
                    value::add_game_user_value('minjie', 1 * $dianshu, $user_id);
                    $sxd_minjie = $dianshu;
                    break;
                case 7:
                    value::add_game_user_value('shuxingdian', -1 * $dianshu, $user_id);
                    value::add_game_user_value('jd_mp', 1 * $dianshu, $user_id);
                    $sxd_max_mp = $dianshu;
                    break;
            }
        }
        $sql = "SELECT `jd_hp`,`max_hp`,`max_mp`,`jd_mp`,`pugong`,`pufang`,`tegong`,`tefang`,`minjie`,`shuxingdian`,`is_dead` FROM `game_user` WHERE `id`={$user_id} LIMIT 1";
        $result = sql($sql);
        list($jd_hp, $max_hp, $max_mp, $jd_mp, $pugong, $pufang, $tegong, $tefang, $minjie, $shuxingdian, $is_dead) = $result->fetch_row();
        //显示加点操作
        echo "<span style='color:green'>你有" . $shuxingdian . "属性点：</span>";
        br();
        echo '生命值：' . (int)$max_hp . "(+" . $sxd_max_hp . ")";
        if ($shuxingdian > 0) {
            cmd::addcmd('rw_e78,' . $user_id . ',1,1', '+1');
        }
        if ($shuxingdian > 2) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',1,3', '+3');
        }
        if ($shuxingdian > 4) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',1,5', '+5');
        }
        br();
        echo '魔法值：' . (int)$max_mp . "(+" . $sxd_max_mp . ")";
        if ($shuxingdian > 0) {
            cmd::addcmd('rw_e78,' . $user_id . ',7,1', '+1');
        }
        if ($shuxingdian > 2) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',7,3', '+3');
        }
        if ($shuxingdian > 4) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',7,5', '+5');
        }
        br();
        echo '攻击：' . (int)$pugong . "(+" . $sxd_pugong . ")";
        if ($shuxingdian > 0) {
            cmd::addcmd('rw_e78,' . $user_id . ',2,1', '+1');
        }
        if ($shuxingdian > 2) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',2,3', '+3');
        }
        if ($shuxingdian > 4) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',2,5', '+5');
        }
        br();
        echo '防御：' . (int)$pufang . "(+" . $sxd_pufang . ")";
        if ($shuxingdian > 0) {
            cmd::addcmd('rw_e78,' . $user_id . ',3,1', '+1');
        }
        if ($shuxingdian > 2) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',3,3', '+3');
        }
        if ($shuxingdian > 4) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',3,5', '+5');
        }
        br();
        echo '魔攻：' . (int)$tegong . "(+" . $sxd_tegong . ")";
        if ($shuxingdian > 0) {
            cmd::addcmd('rw_e78,' . $user_id . ',4,1', '+1');
        }
        if ($shuxingdian > 2) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',4,3', '+3');
        }
        if ($shuxingdian > 4) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',4,5', '+5');
        }
        br();
        echo '魔防：' . (int)$tefang . "(+" . $sxd_tefang . ")";
        if ($shuxingdian > 0) {
            cmd::addcmd('rw_e78,' . $user_id . ',5,1', '+1');
        }
        if ($shuxingdian > 2) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',5,3', '+3');
        }
        if ($shuxingdian > 4) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',5,5', '+5');
        }
        br();
        echo '灵活：' . (int)$minjie . "(+" . $sxd_minjie . ")";
        if ($shuxingdian > 0) {
            cmd::addcmd('rw_e78,' . $user_id . ',6,1', '+1');
        }
        if ($shuxingdian > 2) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',6,3', '+3');
        }
        if ($shuxingdian > 4) {
            echo " ";
            cmd::addcmd('rw_e78,' . $user_id . ',6,5', '+5');
        }
        br();
    } else {
        echo '你已死亡,无法加点。';
        br();
    }
    echo "-";
    br();
    cmd::addcmd('e13', '返回上级');
}

function get_ubb($str) {
 
    $str = preg_replace( "/(\#)(.*?)(\#)/i" , "<img src=\'res/img/lt/\\2.gif\'>", $str);
    return $str;
}
